import{d as G,r as T,k as D,a0 as P,o as N,W as $,y as d,z as v,$ as z,A as o,I as w,X as M,G as i,a3 as R,ad as U,U as W,_ as j}from"./BkRx7U8b.js";import{e as r}from"./DG6QdPnO.js";import{d as b}from"./DeEbP9sG.js";import{f as X}from"./Ds4KxLLa.js";import{K as k}from"./B4rpyJsK.js";import{o as Y,S as A}from"./Wv4Ty0OG.js";import{f as J}from"./C723tzWh.js";import{f as K}from"./D53hIzv4.js";import{a as Q}from"./Gl1UmUM-.js";import{c as Z}from"./CVx03s7S.js";function ee(f,p){return p===void 0&&(p=Q),Y(function(S,s){var t=null,u=null,c=null,H=function(){if(t){t.unsubscribe(),t=null;var a=u;u=null,s.next(a)}};function l(){var a=c+f,m=p.now();if(m<a){t=this.schedule(void 0,a-m),s.add(t);return}H()}S.subscribe(Z(s,function(a){u=a,c=p.now(),t||(t=p.schedule(l,f),s.add(t))},function(){H(),s.complete()},void 0,function(){u=t=null}))})}const ne={class:"result"},te=["innerHTML"],le=["innerHTML"],ae=["innerHTML"],se=["innerHTML"],ue=["innerHTML"],oe=["innerHTML"],ie=["innerHTML"],re=["innerHTML"],ce={key:1,class:"selected"},de=["innerHTML"],ve=["innerHTML"],fe={class:"input"},pe=["readonly"],me=["readonly"],ye=G({__name:"InputText",props:{rootElement:{type:HTMLElement,default(){return null}},overrideFocused:{type:Boolean,default:!1},readonly:{type:Boolean,required:!1,default:!1},multiline:{type:Boolean,required:!1,default:!0},name:{type:String,default:"value"},modelValue:{type:String,default:void 0},model:{type:Object,required:!1,default(){return{value:"Input Value"}}}},emits:["blur","refresh","input","update:model-value","enter","keydown","keyup"],setup(f,{expose:p,emit:S}){const s=f,t=S,u=T(null),c=T(s.overrideFocused),H=T(0),l=T(0),a=T(0),m=T(!1),E=T(!1);let y=new A;const n=D({get(){return s.modelValue||""},set(e){t("update:model-value",e)}}),O=D(()=>({readonly:s.readonly,multiline:s.multiline,"selection-empty":!H.value,focused:c.value,"shift-active":m.value,"caps-lock-active":E.value}));P(()=>s.overrideFocused,e=>{c.value=e}),P(()=>c.value,e=>{e?F():I()}),N(()=>{u.value?.setSelectionRange(n.value.length,n.value.length),_(),c.value&&F()}),$(()=>{y.unsubscribe()});function F(){y.add(b.pointerDown.pipe(J(({target:e})=>{const h=W(),L=s.rootElement||h?.parent?.vnode.el;return!X(e,L)}),K()).subscribe(I)),y.add(b.keyPress.subscribe(()=>{u.value?.focus()})),y.add(b.keyDown.subscribe(({code:e})=>{switch(e){case k.SHIFT_LEFT:case k.SHIFT_RIGHT:m.value=!0;break;case k.CAPS_LOCK:E.value=!E.value;break}})),y.add(b.keyUp.subscribe(e=>{switch(e.code){case k.SHIFT_LEFT:case k.SHIFT_RIGHT:m.value=!1;break}t("keyup",e)})),u.value?.focus()}function I(){y.unsubscribe(),y=new A,u.value?.blur(),t("blur")}function _(){const e=u.value;e&&(l.value=e.selectionStart||0,a.value=e.selectionEnd||0,H.value=a.value-l.value,t("refresh"))}function q(e){c.value=e}function x(){const e=b.pointerMove.pipe(ee(128)).subscribe(()=>{_()});b.pointerUp.pipe(K()).subscribe(()=>{e.unsubscribe()})}function C(){_(),t("input")}function g(){c.value?_():q(!0)}function B(e){!s.multiline&&e.code===k.ENTER?(e.preventDefault(),e.stopPropagation(),t("enter",n.value),_()):(t("keydown",e),_())}function V(e){t("keyup",e),_()}return p({resetSelection:()=>{u.value?.setSelectionRange(0,0)},controlShiftActive:m,controlCapsLockActive:E}),(e,h)=>(v(),d("div",{class:z(["wb-env-element-input-text",O.value])},[o("div",null,[o("div",ne,[n.value.length>0&&a.value>0?(v(),d(M,{key:0},[l.value>=0&&a.value===n.value.length?(v(),d(M,{key:0},[o("span",{innerHTML:i(r)(n.value.slice(0,l.value))},null,8,te),o("span",{class:"selected",innerHTML:i(r)(n.value.slice(l.value,a.value+1))||" "},null,8,le)],64)):l.value&&l.value===a.value?(v(),d(M,{key:1},[o("span",{innerHTML:i(r)(n.value.slice(0,l.value))},null,8,ae),o("span",{class:"selected",innerHTML:i(r)(n.value.slice(l.value,l.value+1))||" "},null,8,se),o("span",{innerHTML:i(r)(n.value.slice(l.value+1,n.value.length))},null,8,ue)],64)):(v(),d(M,{key:2},[o("span",{innerHTML:i(r)(n.value.slice(0,l.value))},null,8,oe),o("span",{class:"selected",innerHTML:i(r)(n.value.slice(l.value,a.value))},null,8,ie),o("span",{innerHTML:i(r)(n.value.slice(a.value,n.value.length))},null,8,re)],64))],64)):w("",!0),!l.value&&n.value===""?(v(),d("span",ce," ")):n.value.length>0&&!l.value&&l.value===a.value?(v(),d(M,{key:2},[o("span",{class:"selected",innerHTML:i(r)(n.value.slice(0,1))},null,8,de),o("span",{innerHTML:i(r)(n.value.slice(1,n.value.length))},null,8,ve)],64)):w("",!0)]),o("div",fe,[f.multiline?R((v(),d("textarea",{key:0,ref_key:"inputEl",ref:u,"onUpdate:modelValue":h[0]||(h[0]=L=>n.value=L),readonly:f.readonly,onPointerdown:x,onInput:C,onClick:g,onKeydown:B,onKeyup:V,onFocus:g},null,40,pe)),[[U,n.value]]):w("",!0),f.multiline?w("",!0):R((v(),d("input",{key:1,ref_key:"inputEl",ref:u,"onUpdate:modelValue":h[1]||(h[1]=L=>n.value=L),type:"text",readonly:f.readonly,onPointerdown:x,onInput:C,onClick:g,onKeydown:B,onKeyup:V,onFocus:g},null,40,me)),[[U,n.value]])])])],2))}}),we=j(ye,[["__scopeId","data-v-c79d5e15"]]);export{we as E};
