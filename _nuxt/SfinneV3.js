import{i as e}from"./BHmTNEz3.js";import{d as a,m as l}from"./Bx5hh_92.js";import{d as t,r as o,k as r,a0 as i,o as n,y as s,z as u,A as c,Z as d,$ as v,_ as h}from"./BfpYGSxR.js";function drawColorWheelCircle(a,l,t,o,r=e(1,1)){if(1===r)return function drawColorWheelCircleArc(e,a,l,t){const o=t/2;if(!(o<=0))for(let r=0;r<=360;r++){const i=(r-1)*Math.PI/180,n=r*Math.PI/180,s=hsvToRgb(r,1,1);e.beginPath(),e.moveTo(a+t/2,l+t/2),e.arc(a+t/2,l+t/2,o,i,n),e.closePath(),e.fillStyle=`rgb(${s.r},${s.g},${s.b})`,e.fill()}}(a,l,t,o);const i=o/2;if(!(i<=0))for(let e=0;e<o;e+=r.y)for(let n=0;n<o;n+=r.x){const o=n+r.x/2-i,s=e+r.y/2-i;if(Math.sqrt(o*o+s*s)<=i){let i=180*Math.atan2(s,o)/Math.PI;i<0&&(i+=360);const u=hsvToRgb(i,1,1);a.fillStyle=`rgb(${u.r},${u.g},${u.b})`,a.fillRect(Math.round(l+n),Math.round(t+e),Math.round(r.x),Math.round(r.y))}}}function hsvToRgb(e,a,l){let t,o,r;const i=Math.floor(e/60),n=e/60-i,s=l*(1-a),u=l*(1-n*a),c=l*(1-(1-n)*a);switch(i%6){case 0:t=l,o=c,r=s;break;case 1:t=u,o=l,r=s;break;case 2:t=s,o=l,r=c;break;case 3:t=s,o=u,r=l;break;case 4:t=c,o=s,r=l;break;case 5:t=l,o=s,r=u;break;default:t=0,o=0,r=0}return{r:Math.round(255*t),g:Math.round(255*o),b:Math.round(255*r)}}function getPixelColorFromCanvas(e,l,t,o,r){if(e<0||e>=o||l<0||l>=r)return new a(0,0,0,0);const i=t.getImageData(e*window.devicePixelRatio,l*window.devicePixelRatio,1,1).data,n=i[0],s=i[1],u=i[2],c=i[3];return new a(n,s,u,c)}function drawRgbaSlider(l,t,o,r,i,n,s=e(1,1),u=new a(0,0,0,255)){if(!(i<=0||n<=0))switch(l){case"red":{const e=s.y;for(let a=0;a<n;a+=e){const l=Math.floor(a/(n-e)*255);t.fillStyle=`rgba(${l}, ${u.g}, ${u.b}, ${u.a})`,t.fillRect(o,r+a,i,e)}}break;case"green":{const e=s.y;for(let a=0;a<n;a+=e){const l=Math.floor(a/(n-e)*255);t.fillStyle=`rgba(${u.r}, ${l}, ${u.b}, ${u.a})`,t.fillRect(o,r+a,i,e)}}break;case"blue":{const e=s.y;for(let a=0;a<n;a+=e){const l=Math.floor(a/(n-e)*255);t.fillStyle=`rgba(${u.r}, ${u.g}, ${l}, ${u.a})`,t.fillRect(o,r+a,i,e)}}break;case"alpha":{const e=s.y;for(let a=0;a<n;a+=e){const l=a/(n-e);t.fillStyle=`rgba(${u.r}, ${u.g}, ${u.b}, ${l})`,t.fillRect(o,r+a,i,e)}}}}function drawHslaSlider(l,t,o,r,i,n,s=e(1,1),u=new a(0,0,0,255)){if(i<=0||n<=0)return;const[c,d,v]=u.toHsl();switch(l){case"hue":{const e=s.y;for(let l=0;l<n;l+=e){const s=360*Math.min(l/(n-e),1),u=a.fromHsl(s,d,v);t.fillStyle=u.toHex(),t.fillRect(o,r+l,i,e)}}break;case"saturation":{const e=s.y;for(let l=0;l<n;l+=e){const s=l/n,u=a.fromHsl(c,s,v);t.fillStyle=u.toHex(),t.fillRect(o,r+l,i,e)}}break;case"lightness":{const e=s.y;for(let l=0;l<n;l+=e){const s=l/(n-e),u=a.fromHsl(c,d,s);t.fillStyle=u.toHex(),t.fillRect(o,r+l,i,e)}}break;case"alpha":{const e=s.y;for(let l=0;l<n;l+=e){const s=l/(n-e),u=a.fromHsl(c,d,s);u.a=Math.round(255*s),t.fillStyle=u.toHex(),t.fillRect(o,r+l,i,e)}}}}var f=(e=>(e.CIRCLE="circle",e.SQUARE="square",e.SQUARE_EXTEND="square_extend",e.HSLA_HUE="hsla_hue",e.HSLA_SATURATION="hsla_saturation",e.HSLA_LIGHTNESS="hsla_lightness",e.HSLA_ALPHA="hsla_alpha",e.RGBA_RED="rgba_red",e.RGBA_GREEN="rgba_green",e.RGBA_BLUE="rgba_blue",e.RGBA_ALPHA="rgba_alpha",e.ALPHA="alpha",e))(f||{});const g=h(t({__name:"ColorPicker",props:{width:{},height:{},modelValue:{},type:{},density:{},grid:{type:Boolean}},emits:["hover","update:model-value"],setup(t,{emit:h}){const f=o(null),g=o(null),w=h,b=4*window.devicePixelRatio;let y=e(0,0);const x=o(e(0,0)),R=o(e(b,b)),m=t,_=r(()=>m.type||"square"),k=r(()=>m.density),p=r(()=>e(()=>Math.round(y/k.value))),S=o(null);function refrehsLayout(){if(f.value&&g.value&&S.value){if(x.value=e(m.width*window.devicePixelRatio,(m.height||m.width)*window.devicePixelRatio),"circle"!==m.type){const a=e(()=>(x.value-R.value)/window.devicePixelRatio),l=e(()=>Math.round(a/k.value)*k.value*window.devicePixelRatio);x.value=l}y=e(()=>x.value-2*b),g.value.style.width=x.value.x/window.devicePixelRatio+"px",g.value.style.height=x.value.y/window.devicePixelRatio+"px",g.value.width=x.value.x,g.value.height=x.value.y,S.value&&(S.value.width=y.x,S.value.height=y.y)}}i(()=>m.modelValue,()=>{refresh({background:!1})}),i(()=>m.density,()=>{refrehsLayout(),refresh()}),n(()=>{S.value=document.createElement("canvas"),refrehsLayout(),refresh()});const P=o();function onPointerDown(a){if(!g.value)return;const l=g.value.getBoundingClientRect(),t=a.clientX-l.left-b/window.devicePixelRatio,o=a.clientY-l.top-b/window.devicePixelRatio;if(!g.value.getContext("2d"))return;const r=getPixelColorFromCanvas(t,o,S.value.getContext("2d"),S.value.width,S.value.height),i=p.value;C.value=e(()=>Math.floor(e(t,o)/(p.value/window.devicePixelRatio))*i),refresh({background:!1}),w("update:model-value",r)}function onPointerOut(){if(!g.value)return;g.value.getContext("2d")&&(P.value=void 0,refresh({background:!1}))}function onPointerMove(a){if(!g.value)return;const l=g.value.getBoundingClientRect(),t=a.clientX-l.left-b/window.devicePixelRatio,o=a.clientY-l.top-b/window.devicePixelRatio;if(!g.value.getContext("2d"))return;const r=getPixelColorFromCanvas(t,o,S.value.getContext("2d"),S.value.width,S.value.height),i=p.value;P.value=e(()=>Math.floor(e(t,o)/(p.value/window.devicePixelRatio))*i),refresh({background:!1}),w("hover",r)}function refresh({background:t}={background:!0}){const o=g.value.getContext("2d"),r=S.value.getContext("2d");o.clearRect(0,0,x.value.x,x.value.y),t&&(r.clearRect(0,0,x.value.x,x.value.y),function drawBackground(t,o,r){if(!t||!g.value)return;const i=m.modelValue;switch(_.value){case"hsla_hue":drawHslaSlider("hue",t,0,0,o,r,p.value,i);break;case"hsla_saturation":drawHslaSlider("saturation",t,0,0,o,r,p.value,i);break;case"hsla_lightness":drawHslaSlider("lightness",t,0,0,o,r,p.value,i);break;case"hsla_alpha":drawHslaSlider("alpha",t,0,0,o,r,p.value,i);break;case"rgba_red":drawRgbaSlider("red",t,0,0,o,r,p.value);break;case"rgba_green":drawRgbaSlider("green",t,0,0,o,r,p.value);break;case"rgba_blue":drawRgbaSlider("blue",t,0,0,o,r,p.value);break;case"rgba_alpha":drawRgbaSlider("alpha",t,0,0,o,r,p.value,i);break;case"circle":drawColorWheelCircle(t,0,0,Math.min(o,r),p.value);break;case"square_extend":!function drawColorWheelSquareExtend(l,t,o,r,i=e(1,1),n=new a(255,0,0,255)){const s=e(()=>r/i);if(s.x<=0||s.y<=0)return;const u=n.toHsv()[0];for(let e=0;e<s.y;e++)for(let a=0;a<s.x;a++){const r=hsvToRgb(u,1-e/(s.y-1),a/(s.x-1));l.fillStyle=`rgb(${r.r},${r.g},${r.b})`,l.fillRect(t+a*i.x,o+e*i.y,i.x,i.y)}}(t,0,0,o,p.value,i);break;default:!function drawColorWheelSquare(a,t,o,r,i=e(1,1)){const n=e(()=>r/i);if(!(n.x<=0||n.y<=0))for(let e=0;e<n.y;e++)for(let r=0;r<n.x;r++){const s=360*(r/n.x-1),u=1-e/n.y,c=l(s,u,.5);a.fillStyle=`rgb(${c.r},${c.g},${c.b})`,a.fillRect(t+r*i.x,o+e*i.y,i.x,i.y)}}(t,0,0,o,p.value)}}(r,S.value.width,S.value.height)),function draw(e){window.cancelAnimationFrame($.value),$.value=window.requestAnimationFrame(()=>{if(!e||!g.value||!S.value)return;e.drawImage(S.value,R.value.x,R.value.y);const a=P.value;a&&a.x>=0&&a.y>=0&&a.x<y.x-2*b&&a.y<y.y-2*b&&a&&(!C.value||C.value&&a&&!a.equals(C.value))&&(e.globalCompositeOperation="difference",e.strokeStyle="rgba(255, 255, 255, 1)",e.lineWidth=b,e.strokeRect(b/2+a.x,b/2+a.y,p.value.x+b,p.value.y+b),e.setLineDash([]),e.lineWidth=1,e.globalCompositeOperation="source-over"),C.value&&(e.globalCompositeOperation="hard-light",e.lineWidth=b,e.strokeStyle="rgba(255, 255, 255, 1)",e.strokeRect(b/2+C.value.x,b/2+C.value.y,p.value.x+b,p.value.y+b),e.globalCompositeOperation="source-over"),e.lineWidth=1})}(o)}i(()=>m.modelValue,()=>{switch(_.value){case"hsla_hue":case"hsla_saturation":case"hsla_lightness":case"square_extend":case"hsla_alpha":case"rgba_alpha":S.value&&refresh()}});const C=o(),$=o(null);return(e,a)=>(u(),s("div",{ref_key:"rootEl",ref:f,class:v(["wb-disks-extras13-web-paint-color-picker",{grid:e.grid}]),style:d({...R.value.toCSSVars("offset"),...x.value.toCSSVars("outer-dimension")})},[c("canvas",{ref_key:"canvasEl",ref:g,onPointerdown:onPointerDown,onPointermove:onPointerMove,onPointerout:onPointerOut},null,544)],6))}}),[["__scopeId","data-v-52c86cdd"]]);export{g as C,f as T};
