import{d as G,r as b,j as A,a0 as P,o as W,W as Y,t as d,v as f,Y as $,x as i,F as S,Z as M,D as r,a3 as R,af as O,ae as z,_ as Z}from"./BRP7lMhW.js";import{f as U,e as c}from"./DIR0ob6O.js";import{d as H}from"./YY0LfIuj.js";import{a as k,c as J}from"./DYHHCWM9.js";import{o as Q,S as K}from"./6C4StZv5.js";import{c as X,f as ee}from"./CSlkdJUE.js";import{a as ne}from"./BWR5uye1.js";function le(p,m){return m===void 0&&(m=ne),Q(function(E,u){var l=null,o=null,v=null,L=function(){if(l){l.unsubscribe(),l=null;var a=o;o=null,u.next(a)}};function t(){var a=v+p,y=m.now();if(y<a){l=this.schedule(void 0,a-y),u.add(l);return}L()}E.subscribe(X(u,function(a){o=a,v=m.now(),l||(l=m.schedule(t,p),u.add(l))},function(){L(),u.complete()},void 0,function(){o=l=null}))})}const te={class:"result"},ae=["innerHTML"],se=["innerHTML"],ue=["innerHTML"],oe=["innerHTML"],ie=["innerHTML"],re=["innerHTML"],ce=["innerHTML"],ve=["innerHTML"],de={key:1,class:"selected"},fe=["innerHTML"],pe=["innerHTML"],me={class:"input"},ye=["readonly"],_e=["readonly"],Te=G({__name:"InputText",props:{rootElement:{type:HTMLElement,default(){return null}},overrideFocused:{type:Boolean,default:!1},readonly:{type:Boolean,required:!1,default:!1},multiline:{type:Boolean,required:!1,default:!0},name:{type:String,default:"value"},modelValue:{type:String,default:void 0},model:{type:Object,required:!1,default(){return{value:"Input Value"}}}},emits:["blur","refresh","input","update:model-value","enter","keydown","keyup"],setup(p,{expose:m,emit:E}){const u=p,l=E,o=b(null),v=b(u.overrideFocused),L=b(0),t=b(0),a=b(0),y=b(!1),g=b(!1);let _=new K;const n=A({get(){return u.modelValue||""},set(e){l("update:model-value",e)}}),q=A(()=>({readonly:u.readonly,multiline:u.multiline,"selection-empty":!L.value,focused:v.value,"shift-active":y.value,"caps-lock-active":g.value}));P(()=>u.overrideFocused,e=>{v.value=e}),P(()=>v.value,e=>{e?F():I()}),W(()=>{var e;(e=o.value)==null||e.setSelectionRange(n.value.length,n.value.length),T(),v.value&&F()}),Y(()=>{_.unsubscribe()});function F(){var e;_.add(H.pointerDown.pipe(ee(({target:s})=>{var V;const h=z(),j=u.rootElement||((V=h==null?void 0:h.parent)==null?void 0:V.vnode.el);return!J(s,j)}),U()).subscribe(I)),_.add(H.keyPress.subscribe(()=>{var s;(s=o.value)==null||s.focus()})),_.add(H.keyDown.subscribe(({code:s})=>{switch(s){case k.SHIFT_LEFT:case k.SHIFT_RIGHT:y.value=!0;break;case k.CAPS_LOCK:g.value=!g.value;break}})),_.add(H.keyUp.subscribe(s=>{switch(s.code){case k.SHIFT_LEFT:case k.SHIFT_RIGHT:y.value=!1;break}l("keyup",s)})),(e=o.value)==null||e.focus()}function I(){var e;_.unsubscribe(),_=new K,(e=o.value)==null||e.blur(),l("blur")}function T(){const e=o.value;e&&(t.value=e.selectionStart||0,a.value=e.selectionEnd||0,L.value=a.value-t.value,l("refresh"))}function N(e){v.value=e}function x(){const e=H.pointerMove.pipe(le(128)).subscribe(()=>{T()});H.pointerUp.pipe(U()).subscribe(()=>{e.unsubscribe()})}function C(){T(),l("input")}function w(){v.value?T():N(!0)}function B(e){!u.multiline&&e.code===k.ENTER?(e.preventDefault(),e.stopPropagation(),l("enter",n.value),T()):(l("keydown",e),T())}function D(e){l("keyup",e),T()}return m({resetSelection:()=>{var e;(e=o.value)==null||e.setSelectionRange(0,0)},controlShiftActive:y,controlCapsLockActive:g}),(e,s)=>(f(),d("div",{class:$(["wb-env-atom-input-text",q.value])},[i("div",null,[i("div",te,[n.value.length>0&&a.value>0?(f(),d(M,{key:0},[t.value>=0&&a.value===n.value.length?(f(),d(M,{key:0},[i("span",{innerHTML:r(c)(n.value.slice(0,t.value))},null,8,ae),i("span",{class:"selected",innerHTML:r(c)(n.value.slice(t.value,a.value+1))||" "},null,8,se)],64)):t.value&&t.value===a.value?(f(),d(M,{key:1},[i("span",{innerHTML:r(c)(n.value.slice(0,t.value))},null,8,ue),i("span",{class:"selected",innerHTML:r(c)(n.value.slice(t.value,t.value+1))||" "},null,8,oe),i("span",{innerHTML:r(c)(n.value.slice(t.value+1,n.value.length))},null,8,ie)],64)):(f(),d(M,{key:2},[i("span",{innerHTML:r(c)(n.value.slice(0,t.value))},null,8,re),i("span",{class:"selected",innerHTML:r(c)(n.value.slice(t.value,a.value))},null,8,ce),i("span",{innerHTML:r(c)(n.value.slice(a.value,n.value.length))},null,8,ve)],64))],64)):S("",!0),!t.value&&n.value===""?(f(),d("span",de," ")):n.value.length>0&&!t.value&&t.value===a.value?(f(),d(M,{key:2},[i("span",{class:"selected",innerHTML:r(c)(n.value.slice(0,1))},null,8,fe),i("span",{innerHTML:r(c)(n.value.slice(1,n.value.length))},null,8,pe)],64)):S("",!0)]),i("div",me,[p.multiline?R((f(),d("textarea",{key:0,ref_key:"inputEl",ref:o,"onUpdate:modelValue":s[0]||(s[0]=h=>n.value=h),readonly:p.readonly,onPointerdown:x,onInput:C,onClick:w,onKeydown:B,onKeyup:D,onFocus:w},null,40,ye)),[[O,n.value]]):S("",!0),p.multiline?S("",!0):R((f(),d("input",{key:1,ref_key:"inputEl",ref:o,"onUpdate:modelValue":s[1]||(s[1]=h=>n.value=h),type:"text",readonly:p.readonly,onPointerdown:x,onInput:C,onClick:w,onKeydown:B,onKeyup:D,onFocus:w},null,40,_e)),[[O,n.value]])])])],2))}}),we=Z(Te,[["__scopeId","data-v-68ef80a7"]]);export{we as A};
