import{A as T}from"./xeZm7TXO.js";import{d as x,M as C,u as S}from"./BL9b5cpI.js";import{h as B,u as A}from"./CDSNOiTq.js";import{A as P}from"./DHk24l9J.js";import{d as W,r as b,t as g,v as y,z as N,_ as O,K as R,j as h,a0 as w,o as k,a1 as I,D as M}from"./BRP7lMhW.js";import{C as V}from"./ey0azPGz.js";import{b as E,c as u}from"./C6cURfET.js";import{u as D}from"./YcwuoW3W.js";import"./DIR0ob6O.js";import"./c7yvS0cq.js";import"./DdQrQ7-5.js";import"./6C4StZv5.js";import"./D4lI5vpz.js";import"./CSlkdJUE.js";import"./YY0LfIuj.js";import"./DYHHCWM9.js";import"./BGIFtisS.js";import"./DN3eHOnZ.js";import"./Ce6njBYG.js";import"./djI3_XgP.js";import"./RAasLaaH.js";import"./BWR5uye1.js";import"./CV0dHcg-.js";import"./L24w7Tb1.js";import"./DMqoVgoU.js";import"./DchX226r.js";import"./BRvRi0Mv.js";import"./BH9FFkim.js";import"./CVMiNqhH.js";import"./WZmY4AAg.js";import"./CJLX7oOC.js";import"./BdxTbgrk.js";import"./BY0KaPQX.js";import"./C5mdboMC.js";import"./CnnF2WpI.js";const K={class:"wb-disks-extras13-web-basic-info"},$=W({__name:"Info",setup(n){const o=b(["# WebBasic",`Version: **1.0**  
Created by **Thorn-Welf Walli**`].join(`
`));return(m,c)=>(y(),g("div",K,[N(P,{content:o.value},null,8,["content"])]))}}),F=O($,[["__scopeId","data-v-89a6d845"]]),H=x(({core:n,model:o})=>{return[{order:0,title:"Editor",items:[{title:"New",hotKey:"N",keyCode:78,action:m},{title:"Open…",hotKey:"O",keyCode:79,action:f},{title:"Save",hotKey:"S",keyCode:83,action:c},{title:"Save As…",action:s},{type:C.SEPARATOR},{hotKey:"I",keyCode:73,title:"Info",action:_},{title:"Close",action:v}]},{order:1,title:"Document Settings",items:[{title:"Has Window Output",type:C.CHECKBOX,name:V.HAS_WINDOW_OUTPUT,model:o.value}]},{order:1,title:"Run",hotKey:"R",keyCode:82,action:d},{order:2,title:"Preview",type:C.CHECKBOX,name:E.WEB_BASIC_SHOW_PREVIEW,model:n.config.observable,action(e){return n.config.set(E.WEB_BASIC_SHOW_PREVIEW,e)}}];function m(){var e;(e=o.actions)==null||e.reset()}function c(){return p()}function s(){return p(!0)}async function p(e=!1){const i={...o.value,content:o.value[u.CONTENT].split(/\n/g)},r=await B(JSON.stringify(i));let a;if(!e&&o.fsItem)return a=await n.executeCommand(`editfile "${o.fsItem.getPath()}" --data="${r}"`),a?n.executeCommand('openDialog "File saved."'):n.executeCommand('openDialog "File could not be saved."');{const t=await n.executeCommand(`saveFileDialog --data="${r}" --extension="bs"`);return t?(o.fsItem=R(t),o.fsItem):null}}async function f(){const e=await n.executeCommand("openFileDialog");if(e)if(u.CONTENT in e.value){const i={...e.value,[u.CONTENT]:[].concat(e.value[u.CONTENT]).join(`
`)};o.fsItem=e.fsItem,o.value=i}else throw new Error("Can't read file content")}async function d(){var i;const e=[];await((i=n.modules.parser)==null?void 0:i.parseBasic(o.value[u.CONTENT].split(/\n/),async(r,a)=>{const t=await n.executeCommand(r,a);return a.message&&(Array.isArray(a.message)?e.push(...a.message):e.push(a.message)),t})),o.output=e.map(r=>A(r))}function v(){var e;return(e=o.actions)==null?void 0:e.close()}function _(){var e;(e=n.modules.windows)==null||e.addWindow({component:F,componentData:{model:o},options:{title:"Info",scaleX:!1,scaleY:!1,scrollX:!1,scrollY:!1}},{group:"extras13WebBasic"})}}),U={class:"wb-disks-extras13-web-basic"},X=W({__name:"WebBasic",props:{model:{}},emits:["refresh","update:value"],setup(n,{emit:o}){const m=b(null),c=o,s=n,{core:p}=S(),{setContextMenu:f,preserveContextMenu:d,parentFocused:v}=D();f(H,{model:s.model}),d();const _=h(()=>s.model.value.content),e=h(()=>{var t;return!!((t=p.value)!=null&&t.config.observable[E.WEB_BASIC_SHOW_PREVIEW])});w(()=>s.model.value,()=>{a()}),w(()=>_.value,t=>{t&&(c("update:value",{...s.model.value,content:t}),I(()=>{var l;(l=m.value)==null||l.resetSelection(),c("refresh",{scroll:!0})}))}),w(()=>e.value,t=>{var l;(l=s.model.actions)==null||l.togglePreview(t)}),k(()=>{e.value&&I(()=>{var t;(t=s.model.actions)==null||t.togglePreview()})});function i(t){c("update:value",{...s.model.value,content:t})}function r(){a()}function a(){I(()=>{c("refresh",{scroll:!0})})}return(t,l)=>(y(),g("div",U,[N(T,{ref:"input","override-focused":M(v)||!1,"model-value":t.model.value.content,"onUpdate:modelValue":i,onRefresh:r},null,8,["override-focused","model-value"])]))}}),Ne=O(X,[["__scopeId","data-v-eeed1cca"]]);export{Ne as default};
