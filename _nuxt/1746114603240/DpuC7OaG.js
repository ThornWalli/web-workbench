const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./DURuX0vI.js","./CDSNOiTq.js","./DHk24l9J.js","./BRP7lMhW.js","./BOXo5Fuj.css","./YcwuoW3W.js","./CnnF2WpI.js","./BL9b5cpI.js","./L24w7Tb1.js","./DMqoVgoU.js","./CXbNF4JJ.css","./B0vCzVqO.css","./DKSL1iiK.js","./BV7m95iv.js","./C3zvzGZe.css","./DK5mOmiz.js","./iKMg5t-_.css","./LDaXBbxb.js","./8q2Z1dNm.css","./BD-spFIS.js","./B4g_dQXt.js","./BSpeqbCM.css","./DchX226r.js","./BGIFtisS.js","./RAasLaaH.js","./D4lI5vpz.js","./DdQrQ7-5.js","./6C4StZv5.js","./CSlkdJUE.js","./SrmTDuH6.css","./BDAkpjrJ.js","./pCkh-wP3.css","./uOA4b3M2.css","./CQWxZAey.js","./D0Z5k6NX.css","./Bvjzbiw0.js","./DIR0ob6O.js","./c7yvS0cq.js","./BIzvQSzn.css","./7fvok3Hs.js","./C5mdboMC.js","./Ba9r8HTT.js","./D_5tq7_O.css","./cfaNwG5f.css","./BkbWwMYx.js","./DrMhIDnQ.js","./DwCo2nxe.js","./iZ1DQg6G.css","./uYZ_NxVx.css","./PS5SoCZn.js","./Cd9UeY_V.js","./CfrwDXeG.js","./AyGIKDDV.js","./DHvoSegL.js","./CXIFHnCy.css","./_JMdGGz8.js","./DL6-OeHf.js","./Da08gh79.js","./DAg-IR-e.js","./DYZJdah4.js","./DQOUG96d.js","./BRod885_.js","./DCegKuwx.js","./C6HPuhbs.js","./Cpj98o6Y.js","./YY0LfIuj.js","./DYHHCWM9.js","./DN3eHOnZ.js","./Ce6njBYG.js","./djI3_XgP.js","./ITCLPEJ-.css","./Bcq-nyF3.js","./BrnYFkyh.js","./eBXRN4wu.js","./IkWbOj4M.js","./DbsAJ1wc.js","./fq_v9z0v.js","./4DDNh6tc.js","./DtBDrrlO.js","./Ca_RXg2H.js","./D54PQ1Ai.js","./aR-c4dp6.js","./BSJz-noo.js","./9goD9h78.js","./To25sE6P.js","./C-kUqqHQ.js","./xaBB-X9e.js","./CYbhhVTB.js","./BuCB7tGk.js","./CztbXIR3.js","./DIn2FXiD.js","./BtrkvE0t.js","./CsyPOYyp.js","./BntSCJuW.js","./C257ATGS.js","./BjPn19nA.js","./92a_xlrI.js","./Bvm3nXRb.js","./B2cSGNdA.js","./BkTYNy84.js","./Bt3gnWuQ.js","./UZYWONdB.js","./At0wDPo9.js","./BumnFGeb.js","./he4oskg3.js","./BUotbKXJ.js","./E8FB1OjU.js","./Xqi6U2Zu.js","./dCDVMCRi.js","./DYcmhopS.js","./Y1zWTHV-.js","./Cbi2UzLH.js","./DjU8GORk.js","./GNnvmWBb.js","./D_-ZfEZH.js","./DUKXdUn1.js","./BOp0u3Oj.js","./D6ImQKfV.js","./40MWhL9K.js","./DuVZGx5L.js"])))=>i.map(i=>d[i]);
var vt=Object.defineProperty;var qe=a=>{throw TypeError(a)};var At=(a,e,t)=>e in a?vt(a,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):a[e]=t;var _=(a,e,t)=>At(a,typeof e!="symbol"?e+"":e,t),Je=(a,e,t)=>e.has(a)||qe("Cannot "+t);var u=(a,e,t)=>(Je(a,e,"read from private field"),t?t.call(a):e.get(a)),v=(a,e,t)=>e.has(a)?qe("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(a):e.set(a,t),O=(a,e,t,r)=>(Je(a,e,"write to private field"),r?r.call(a,t):e.set(a,t),t);var U=(a,e,t,r)=>({set _(i){O(a,e,i,t)},get _(){return u(a,e,r)}});import{C as Rt}from"./neTX6t9g.js";import{M as xe,W as Tt}from"./DCegKuwx.js";import{a as Fe,b as et,l as Dt,r as Pt,s as Ae,c as Nt}from"./DIR0ob6O.js";import{u as N,i as Me,a as H,w as Re,e as S,b as Lt,p as Ot,f as $t,g as tt,c as rt,S as xt,C as Ct,s as Ne}from"./CDSNOiTq.js";import{c as ut}from"./C5mdboMC.js";import{d as ye,A as d,T as De}from"./C6HPuhbs.js";import{K as L,H as g,a9 as Wt,I as ge,t as ne,v as q,x as J,d as mt,j as Be,F as pe,z as Le,D as at,X as Vt,_ as dt,r as kt,A as Ft,C as st}from"./BRP7lMhW.js";import{c as Ue,d as pt,D as Ye,T as Te,F as we,R as Mt,e as Bt,a as Ge,W as it,C as D,O as K,f as fe,I as We,E as Pe}from"./DchX226r.js";import{i as je}from"./BGIFtisS.js";import{C as Ut,a as Yt}from"./ey0azPGz.js";import{d as Ke,M as W,I as A,S as w}from"./BL9b5cpI.js";import{C as Xe}from"./CnnF2WpI.js";import{c as Gt}from"./DXMv6liJ.js";import{W as nt}from"./DK5mOmiz.js";import{W as Xt}from"./BDAkpjrJ.js";import{W as zt}from"./LDaXBbxb.js";import{O as Ht,i as ft}from"./DdQrQ7-5.js";import{p as jt,a as Kt,f as ht}from"./CYq5lAAG.js";import{m as Zt,e as Qt}from"./DN3eHOnZ.js";import{c as qt}from"./CSlkdJUE.js";import{S as Jt}from"./RAasLaaH.js";import"./CSceaZGY.js";import"./BY0KaPQX.js";import"./BJmh0rUk.js";import"./BH9FFkim.js";import"./D4lI5vpz.js";import"./CV0dHcg-.js";import"./YY0LfIuj.js";import"./DYHHCWM9.js";import"./djI3_XgP.js";import"./Ce6njBYG.js";import"./6C4StZv5.js";import"./c7yvS0cq.js";import"./Cpj98o6Y.js";import"./L24w7Tb1.js";import"./DMqoVgoU.js";import"./CJLX7oOC.js";var er=Array.isArray,tr=Object.getPrototypeOf,rr=Object.prototype,ar=Object.keys;function sr(a){if(a.length===1){var e=a[0];if(er(e))return{args:e,keys:null};if(ir(e)){var t=ar(e);return{args:t.map(function(r){return e[r]}),keys:t}}}return{args:a,keys:null}}function ir(a){return a&&typeof a=="object"&&tr(a)===rr}function nr(a,e){return a.reduce(function(t,r,i){return t[r]=e[i],t},{})}function or(){for(var a=[],e=0;e<arguments.length;e++)a[e]=arguments[e];var t=jt(a),r=Kt(a),i=sr(a),s=i.args,n=i.keys;if(s.length===0)return ht([],t);var l=new Ht(lr(s,t,n?function(o){return nr(n,o)}:ft));return r?l.pipe(Zt(r)):l}function lr(a,e,t){return t===void 0&&(t=ft),function(r){ot(e,function(){for(var i=a.length,s=new Array(i),n=i,l=i,o=function(m){ot(e,function(){var E=ht(a[m],e),p=!1;E.subscribe(qt(r,function(f){s[m]=f,p||(p=!0,l--),l||r.next(t(s.slice()))},function(){--n||r.complete()}))},r)},c=0;c<i;c++)o(c)},r)}}function ot(a,e,t){a?Qt(t,a,e):e()}var ze=(a=>(a.STRING="string",a.ANY="any",a.INTEGER="integer",a.TERM="term",a.BOOLEAN="boolean",a.DOUBLE="double",a))(ze||{});function he(a,e){return a.separator===e}function cr(a){return{rawCommand:"",mergeArgs:!1,mergeArgsBy:/^[+,]$/,hasProgram:!1,activeArgument:void 0,isLongArgument:!1,isKeyWordArgument:!1,isString:!1,stringTmpValue:void 0,additionSpecial:!1,specialChar:["+",";",","],isBufferWrite:!1,isBufferValue:!1,isBufferString:!1,rawBuffer:void 0,lastChar:void 0,isSeparating:!1,escaped:!1,currentTick:Et,isClamp:!1,...a,separator:a.separator||gt}}function ae(a,{separator:e,forceProgram:t,mergeArgs:r,mergeArgsBy:i}={}){var l,o;const s=cr({separator:e||gt});a=`${String(a).trim()}${s.separator}`,s.rawCommand=a,s.mergeArgs=r||!1,s.mergeArgsBy=i||s.mergeArgsBy;const n=[];for(;s.rawCommand.length;){const c=s.rawCommand[0];s.rawCommand=s.rawCommand.slice(1);const m=s.rawCommand[0];if(he(s,m)){if(s.isSeparating&&he(s,c))s.isSeparating=!1;else if(!s.isBufferWrite&&he(s,c)){s.isSeparating=!0;continue}}else s.isSeparating=!1;if((he(s,c)&&!s.isClamp||s.rawCommand.length<1)&&(!s.escaped&&s.isBufferValue&&!s.isBufferString&&(s.isBufferWrite=!1),!s.isBufferWrite&&(s.isBufferValue&&Ir(s),s.activeArgument))){Sr(s,n);continue}if(c===wt&&s.activeArgument){s.isKeyWordArgument=!0;continue}else if((c===Ve&&(/[ +a-zA-Z]/.test(m)||m===Ve)||s.activeArgument&&!s.isKeyWordArgument)&&!s.isBufferWrite&&!s.specialChar.includes(c))if(s.activeArgument){!((o=(l=s.activeArgument)==null?void 0:l.name)!=null&&o.length)&&c===Ve?s.isLongArgument=!0:s.activeArgument.name+=c;continue}else{s.activeArgument={name:re},s.isLongArgument&&(s.activeArgument.long=s.isLongArgument);continue}Er(s,c)}return fr(n,{forceProgram:t,mergeArgs:r,mergeArgsBy:i})}function ur(a){var e,t,r;return((e=a.value)==null?void 0:e.type)==="any"&&!a.name&&((t=a.value)==null?void 0:t.raw)&&/^[a-zA-Z]+$/.test((r=a.value)==null?void 0:r.raw)||!1}function mr(a){var e;return((e=a.value)==null?void 0:e.raw)==="+"}function dr(a,e=/^[+]$/){return a.reduce((t,r)=>{var n,l,o,c,m,E;const i=(l=(n=t[t.length-1])==null?void 0:n.value)==null?void 0:l.raw,s=i&&i[String(i).length-1];if(typeof e=="string"&&(String((o=r.value)==null?void 0:o.raw)===e||String(s)===e)||e instanceof RegExp&&(e.test(String((c=r.value)==null?void 0:c.raw))||e.test(String(s)))){const p=t[t.length-1].value;p&&p.raw&&typeof p.value=="string"&&(p.raw+=(m=r.value)==null?void 0:m.raw,p.value+=((E=r.value)==null?void 0:E.value)||"",p.type="any")}else t.push(r);return t},Array())}function pr(a,e){const t=[];return a&&t.push(a),t.push(...e.map(r=>{var i,s;if(r.plain)return((i=r.value)==null?void 0:i.raw)||r.name||re;{const n=r.long?"--":"-",l=r.name||re,o=((s=r.value)==null?void 0:s.raw)||re,c=r.value?wt:"";return`${n}${l}${c}${o}`}})),t}function fr(a,{forceProgram:e,mergeArgs:t,mergeArgsBy:r}={}){var c;const i=a[0],s=a[1];let n;(!s||!mr(s))&&i&&(ur(i)||e)&&(a=a.filter(m=>m!==i),n=(c=i.value)==null?void 0:c.raw);let l=a;t&&(l=dr(a,r));const o=pr(n,l);return{program:n,args:l,rawArgs:o}}const hr="\\",re="",gt=" ",Ve="-",wt="=",Et='"',gr="'";function wr(a){return a===hr}function Er(a,e){wr(e)?a.escaped=!0:(!a.escaped&&!a.isBufferValue&&!he(a,e)?(a.isBufferWrite=!0,a.isBufferValue=!0,(e===gr||e===Et)&&!a.isClamp&&(a.currentTick=e,a.isBufferString=!0),a.isBufferString=e===a.currentTick,a.rawBuffer=void 0,a.activeArgument=a.activeArgument||{value:void 0,plain:!0}):e===a.currentTick&&a.isBufferString&&!a.escaped&&!a.isClamp&&(a.isBufferWrite=!1),(e!==a.currentTick||a.isClamp||a.escaped&&e===a.currentTick)&&((!a.isBufferWrite&&a.isBufferString||a.isBufferWrite&&!a.isBufferString)&&!a.isClamp&&a.specialChar.includes(e)&&!a.additionSpecial?(a.rawCommand=" "+e+" "+a.rawCommand,a.additionSpecial=!0):(a.additionSpecial=!1,a.rawBuffer=(a.rawBuffer||"")+e)),a.escaped=!1),a.isBufferWrite&&(e==="("?a.isClamp=!0:e===")"&&(a.isClamp=!1)),a.lastChar=e}function _r(a){var e,t,r;return a.plain&&!a.name&&((e=a.value)==null?void 0:e.type)==="any"&&(((t=a.value)==null?void 0:t.raw)===void 0||((r=a.value)==null?void 0:r.raw)===re)}function Sr(a,e){a.activeArgument&&(a.isLongArgument&&(a.activeArgument.long=a.isLongArgument),_r(a.activeArgument)||e.push(a.activeArgument)),a.activeArgument=void 0,a.isLongArgument=!1,a.isKeyWordArgument=!1}function Ir(a){const e=a.rawBuffer||re;if(a.isBufferString)a.activeArgument.value={type:"string",value:a.rawBuffer,raw:`${a.currentTick}${a.rawBuffer||""}${a.currentTick}`};else{let t="any",r=e;/^[+-]?\d+$/.test(e)?(t="integer",r=Math.round(Number(e))):/^[+-]?(?:\d+\.?\d*|\.\d+)$/.test(e)?(t="double",r=Number(e)):/^true|false$/.test(e)?(t="boolean",r=e==="true"):/^[a-zA-Z$]+$/.test(e)?(t="any",r=String(e).replace(/ /g,re)):/^[\d+\-*./a-zA-Z$]+$/.test(e)&&(t="term",r=String(e).replace(/ /g,re)),a.activeArgument.value={type:t,value:r,raw:a.rawBuffer}}a.rawBuffer=void 0,a.isBufferValue=!1,a.isBufferString=!1}var Ee;const F=class F{constructor(e){v(this,Ee);O(this,Ee,e)}async parse(e){const t=ae(e,{forceProgram:!0}),r=await this.getArguments(t);return{origin:e,unresolved:yr(t),args:r.args,kwargs:r.kwargs,command:t.program||"",commandValue:e}}async getArguments(e){return{args:await Promise.all(e.args.filter(t=>t.plain).map(t=>{if(t.value)return this.parseValue(t.value)})),kwargs:Object.fromEntries(await Promise.all(e.args.filter(t=>!t.plain).map(async t=>[ut(t.name||""),t.value!==void 0?await this.parseValue(t.value):void 0])))}}parseValue({value:e,type:t}){return typeof e=="string"&&[ze.ANY,ze.TERM].includes(t)?u(this,Ee).parse(e.replace(/ *([a-zA-Z_-]+) */,"$1")):Promise.resolve(e)}static extractStrings(e){let t=!1,r=0;const i=[];let s=!1;for(let l=e.length-1;l>=0;l--){const o=e[Number(l)],c=e[l-1];!s&&o==='"'&&c!=="\\"?t?(t=!1,i.push(e.slice(l,r+1))):(s=!1,t=!0,r=l):(!t&&s||s)&&o==="'"&&c!=="\\"&&(t?(s=!1,t=!1,i.push(e.slice(l,r+1))):(s=!0,t=!0,r=l))}if(t)throw new Error("can't extract values; "+e);return{result:i.reduce((l,o,c)=>l.replace(o,F.resolveKey(c)),e),values:i}}static extractValues(e,t=" "){let r=!1,i=0;const s=[];let n=!1;for(let o=e.length-1;o>=0;o--){const c=e[Number(o)],m=e[o-1];!n&&c==='"'&&m!=="\\"?r?(r=!1,s.push(e.slice(o,i+1))):(n=!1,r=!0,i=o):(!r&&n||n)&&c==="'"&&m!=="\\"&&(r?(n=!1,r=!1,s.push(e.slice(o,i+1))):(n=!0,r=!0,i=o))}if(r)throw new Error("can't extract values; "+e);return s.forEach((o,c)=>{e=e.replace(o,F.resolveKey(c))}),{params:e.split(t).filter(o=>o),values:s}}static resolveKey(e){return`$$$$$$${e}`}static resolveValues({params:e,values:t}){return e.map(r=>F.resolveValue(r,t))}static valueUnresolved(e){return typeof e=="string"&&F.REGEX_VALUE_RESOLVE.test(e)}static resolveValue(e,t){var i;let r=e;if(F.valueUnresolved(e)){if(r=(i=String(e).match(/[$]{3}(\d+)/g))==null?void 0:i.reduce((s,n)=>s.replace(n,t[Number(n.replace(F.REGEX_VALUE_RESOLVE,"$1"))]),String(e)),/[\w]+[$%]?[ ]*\(/.test(r||""))return r;if(typeof r=="string"){if(r==="undefined")return;if(br(r))return Number(r);if(!r.startsWith('"'))return r}}return r}};Ee=new WeakMap,_(F,"REGEX_VALUE_RESOLVE",/[$]{3}(\d+)/),_(F,"REGEX_COMMAND_REPLACE",/^([a-zA-Z]+[a-zA-Z0-9_]+) (.*)$/),_(F,"REGEX_PARAM_KWARG",/^[-]{0,2}([\\-\w]+)=(.*)$/),_(F,"REGEX_PARAM_ARG",/^[-]{1,2}([\\-\w]+)$/);let V=F;function br(a){return!isNaN(Number(a))}function yr(a){return{args:a.args.filter(e=>e.plain).map(e=>{var t;return((t=e.value)==null?void 0:t.raw)||""}),kwargs:Object.fromEntries(a.args.filter(e=>!e.plain).map(e=>{var t;return[ut(e.name||""),((t=e.value)==null?void 0:t.raw)||""]}))}}var oe;class _t{constructor(e,t,r,i){_(this,"name");v(this,oe);_(this,"global",!1);_(this,"readonly",!1);this.name=e,O(this,oe,t),this.global=r||this.global,this.readonly=i||this.readonly}get value(){return u(this,oe)}set value(e){this.readonly||O(this,oe,e)}}oe=new WeakMap;class vr extends _t{constructor(e,t,r=!1){super(e,t,r,!0)}async execute(...e){if(typeof this.value=="function")return this.value(...e)}}class He extends _t{}var P,ee,$;class Ze{constructor(){v(this,P,new Map);v(this,ee,new Map);v(this,$,[])}reset(){this.resetPrefixStack(),u(this,P).clear(),u(this,ee).clear()}resetPrefixStack(){O(this,$,[])}get prefixStack(){return u(this,$)}get currentPrefixStack(){return u(this,$)[u(this,$).length-1]}has(e){var t;return e=e.replace(/(.*[^ ])[ ]+$/,"$1"),e=e.replace(/[$%]$/,""),(!u(this,P).get(e)||u(this,P).get(e)&&!((t=u(this,P).get(e))!=null&&t.global))&&(e=this.prepareName(e)),u(this,P).has(e)}add(e,t,r=!1,i=!1){e=e.replace(/(.*[^ ])[ ]+$/,"$1"),/\$$/.test(e)?t===void 0&&(t=""):/\\%$/.test(e)&&t===void 0&&(t=0),e=e.replace(/[$%]$/,""),e=this.prepareName(e),this.has(e)||u(this,P).set(e,new He(e,t,r,i))}get(e){var i;e=e.replace(/(.*[^ ])[ ]+$/,"$1");const t=e;e=e.replace(/[$%]$/,""),(!u(this,P).get(e)||u(this,P).get(e)&&!((i=u(this,P).get(e))!=null&&i.global))&&(e=this.prepareName(e));const r=u(this,P).get(e);if(r){let s=r.value;return s&&typeof s=="string"&&(/\$$/.test(t)?s=String(s):/\\%$/.test(t)||/^\d+$/.test(s)?s=parseInt(s):/^[\d.]+$/.test(s)&&(s=parseFloat(s))),s}}set(e,t,r=!1,i=!1){if(e=e.replace(/(.*[^ ])[ ]+$/,"$1"),typeof t=="string"&&(/[$]$/.test(e)?t===void 0?t="":t=String(t):/[%]$/.test(e)&&(t===void 0?t=0:t=parseInt(t))),e=e.replace(/[$%]$/,""),e=this.prepareName(e),this.has(e)){const s=u(this,P).get(e);s instanceof He&&s&&(s.value=t)}else this.add(e,t,r,i)}addSub(e,t){e=this.prepareName(e,!1),this.has(e)||u(this,ee).set(e,new vr(e,t))}async executeSub(e,t=[],r=!1){t=t||[],e=this.prepareName(e,!1),u(this,$).push({name:`${Math.round(Math.random()*1e4)}`,global:r});const i=u(this,ee).get(e);return i==null?void 0:i.execute(...t).then(s=>(u(this,P).forEach(n=>{RegExp(`[$]{3}${u(this,$)[u(this,$).length-1].name}$`).test(n.name)&&u(this,P).delete(n.name)}),u(this,$).pop(),s))}hasSub(e){return e=this.prepareName(e,!1),u(this,ee).has(e)}prepareName(e,t=!0){return typeof e=="string"&&(e=e.replace(/ /g,"")),t&&u(this,$).length&&!/[$]{3}/.test(e)&&(e=`${e}$$$${u(this,$)[u(this,$).length-1].name}`),e}get dims(){return u(this,P)}get subs(){return u(this,ee)}}P=new WeakMap,ee=new WeakMap,$=new WeakMap;var se,_e,T,M,Z,Se,Ie,C,be,ie,Q,x,te,Y,G,ct;let Ar=(ct=class{constructor(e,t,r,i,s,n){_(this,"debug",!1);v(this,se);v(this,_e);v(this,T);v(this,M);v(this,Z);v(this,Se,9999999999);v(this,Ie,0);v(this,C);v(this,be,[]);v(this,ie,0);v(this,Q,[]);v(this,x,-1);v(this,te,[]);v(this,Y,[]);v(this,G,-1);O(this,Z,e),O(this,M,t||(()=>Promise.resolve(void 0))),O(this,T,r||new Ze),O(this,se,i),O(this,_e,s),this.debug=n!==void 0?n:this.debug}get memory(){return u(this,T)}get lines(){return u(this,Z)}parse(e){var r;e=e||Array().concat(u(this,Z));const t=(r=e.shift())==null?void 0:r.trim();return new Promise(i=>{if(u(this,C)&&t!=="END SUB"){t&&u(this,C).lines.push(t),i(void 0);return}if(u(this,Se)>0&&u(this,Ie)>u(this,Se))throw new Error("BASIC INTERPRETER OVERFLOW");if(U(this,Ie)._++,u(this,G)>=0){const s=u(this,Y)[u(this,G)];if(s){if(u(this,Y).forEach(n=>{s.count===0&&n&&t&&n.count===0&&n.lines.push(t)}),t&&(t==="WEND"||/NEXT /.test(t)))return s.condition().then(async n=>{if(s.tmpLines=s.tmpLines||e,n){const l=s.lines;return s.count++,s&&typeof s.step=="function"&&await s.step(),l.length>0?this.parse(Array().concat(l)):(u(this,Y)[u(this,G)]=!1,U(this,G)._--,u(this,Y).pop(),null)}else return u(this,Y)[u(this,G)]=!1,U(this,G)._--,u(this,Y).pop(),null}).then(i);i(void 0)}else i(void 0)}else i(void 0)}).then(()=>{if(!u(this,C)&&u(this,x)>=-1&&(u(this,te)[u(this,x)]!==void 0&&u(this,Q)[u(this,x)]===void 0&&u(this,Q).push(!u(this,te)[u(this,x)]),t==="ELSE"&&u(this,ie)<1&&(u(this,Q)[u(this,x)]=!u(this,Q)[u(this,x)])),u(this,Q)[u(this,x)])t&&/^IF (\((.*)\)|(.*)) THEN$/.test(t)&&U(this,ie)._++;else return this.parseLine(t,e);return null}).then(()=>(u(this,x)>-1&&(t==="ENDIF"||t==="END IF")&&(u(this,ie)<1?(U(this,x)._--,u(this,te).pop(),u(this,Q).pop()):U(this,ie)._--),e.length?this.parse(e):u(this,be)))}parseLine(e,t){return new Promise((r,i)=>{if(e=(e||"").replace(/^[ \t]+/g,""),/^ *[#/]+/.test(e)){r(void 0);return}if(/^GOTO +([\w\d]+)$/.test(e)){const s=e.match(/^GOTO +([\w\d]+)$/)||[];this.commandGoto(t,s[1]),e=""}if(/^SUB (.*) STATIC$/.test(e)){const s=e.match(/^SUB (.*) STATIC$/)||[];return this.commandSubStatic(s[1]).then(r)}else{if(e==="END SUB")return this.commandEndSub().then(r);if(u(this,C)){r(void 0);return}}if(/^IF (\((.*)\)|(.*)) THEN$/.test(e)){const s=e.match(/^IF (\((.*)\)|(.*)) THEN$/)||[],n=s[3]||s[2];return this.commandIfThen(n).then(r)}else if(e==="ELSE"||e==="ENDIF"||e==="END IF"){r(void 0);return}if(/^WHILE (.*)$/.test(e)){const s=e.match(/^WHILE (.*)$/)||[];return this.commandWhile(s[1]).then(r)}else if(e==="WEND"){r(void 0);return}if(/^FOR (.*)$/.test(e)){const s=e.match(/^FOR (.*)$/)||[];return this.commandFor(s[1]).then(r)}else if(e.startsWith("NEXT ")){r(void 0);return}if(/^([\w\d]+):$/.test(e)){r(void 0);return}if(/^DIM( SHARED)? +(.*)$/.test(e)){const s=e.match(/^DIM( SHARED)? +(.*)$/)||[];return this.commandDimShared(s[2],!!s[1]).then(r)}if(/^LET +([\w,$%]+)(\((.*)\))? *= *(.*)$/.test(e)){const s=e.match(/^LET +([\w,$%]+)(\((.*)\))? *= *(.*)$/)||[];return this.commandLet(s[1],s[4],s[3]).then(()=>r(void 0))}if(/^READ +([\w, $%]+)$/.test(e)){const s=e.match(/^READ +([\w, $%]+)$/)||[];return this.commandRead(s[1]).then(r)}if(/^END[ ]*$/.test(e))return this.commandEnd().then(r);if(/^(PAUSE|SLEEP) +(.+)/.test(e)){const n=(e.match(/^(PAUSE|SLEEP) +(.+)/)||[])[2];return this.commandPause(n).then(r)}if(/^CALL *(.*)/.test(e)){const s=e.match(/^CALL *(.*)/)||[];return this.commandCall(s[1],t).then(r)}if(/^EXECUTE *(FILE|EVAL) *(.*)/.test(e)){const s=e.match(/^EXECUTE *(FILE|EVAL) *(.*)/)||[];return this.commandExecute(s[1],s[2]).then(r).catch(i)}if(/^PRINT +USING +.*$/.test(e)){const s=e.match(/^PRINT +USING +(.*)$/)||[];return this.commandPrintUsing(s[1]).then(r)}if(/^PRINT +(.*)$/.test(e)){const s=e.match(/^PRINT +(.*)$/)||[];return this.commandPrint(s[1]).then(r)}if(/^DATA +(.*)$/.test(e)){const s=e.match(/^DATA +(.*)$/)||[];return this.commandDataVar(s[1]).then(r)}u(this,M).call(this,e,{show:!0}).then(s=>{s!==void 0&&u(this,be).push(s)}).then(r).catch(i)})}async setReadStack(e,t){let r=await this.parseValue(t,!0);return typeof r=="string"&&H(r)&&(r=parseFloat(r)),u(this,T).set(e,r,!0)}async addDataStack(e){let t=await this.parseValue(e,!0);return typeof t=="string"&&H(t)&&(t=parseFloat(t)),u(this,se).push(t)}async setStack({name:e,value:t,index:r,global:i}){let s=await this.parseValue(t,!0);if(typeof s=="string"&&H(s)&&(s=parseFloat(s)),r!==void 0){r=Number(await this.parseValue(r,!0));const n=u(this,T).get(e);if(typeof n=="object")return n[r-1]=s,s;throw new Error(`Index ${r} out of range`)}else return u(this,T).set(e,s,i)}async setGotoMarkStack(e,t){u(this,_e).set(e,await this.parseValue(t,!0))}async parseValue(e,t=!0,r=!1){if(e===void 0)return e;if(Array.isArray(e))return e;if(typeof e=="boolean")return e;if(typeof e=="number")return Number(e);if(typeof e=="string"){if(/^ *(true|false|TRUE|FALSE) *$/.test(e))return e.toLowerCase()==="true";if(/^[\d]+$/.test(e.trim())||/^ *([\\-]?[\d.]+(e[-+]?\d+)?) *$/.test(e.trim()))return parseFloat(e);if(/^ *@"((.|\n)*)" *$/.test(e.trim()))return e.replace(/^ *@"((.|\n)*)" *$/,'"$1"');if(/^"((\\"|[^"])+)"$/.test(e.trim()))return e.trim().replace(/^"((\\"|[^"])+)"$/,'"$1"');if(/^[^"]?(.+)[^"]? *$/.test(e.replace(/ /g,""))){if(e=e.replace(/^ */g,""),u(this,T).has(e.replace(/ /g,"")))return e=e.replace(/ /g,""),this.parseValue(u(this,T).get(e),!0);if(r)throw new Error(`Value processing continues: ${e.slice(0,20)}â€¦'`);return u(this,M).call(this,e,{message:t?void 0:e})}}}async executeCondition(e,t,r){const i=await this.parseValue(e,!0),s=await this.parseValue(r,!0);return/^[=]?==$/.test(t)?i===s:t==="<>"?i!==s:/^([<>][=]|[<>])?$/.test(t)?Rr(i,t,s):/^!=[=]?$/.test(t)?i!==s:!1}commandIfThen(e){const t=e.match(/([^<>]*) *(<>|<=|>=|<|>|[=!]{2,3}) *([^<>].*)/);return t?this.executeCondition(t[1],t[2],t[3]).then(r=>(u(this,te).push(r),U(this,x)._++,r)):this.parseValue(e[1],!0).then(r=>{let i=r;return r instanceof He&&(i=r.value),u(this,te).push(!!i),U(this,x)._++,i})}commandWhile(e){const t=e.match(/([^<>]*) *(<>|<=|>=|<|>|[=!]{2,3}) *([^<>].*)/);return t?this.executeCondition(t[1],t[2],t[3]).then(r=>{if(r)return u(this,Y).push({count:0,lines:[],condition:()=>this.executeCondition(t[1],t[2],t[3])}),U(this,G)._++,r}):Promise.resolve(void 0)}async commandFor(e){const t=e.match(/(.*) *= *(.*) +TO +(.*) +STEP[ ](.*)/)||e.match(/(.*) *= *(.*) +TO +(.*)/);if(t){const r=await this.parseValue(t[2],!0),i=await this.parseValue(t[3],!0);u(this,T).set(t[1],r),U(this,G)._++;const s=async(n=!0)=>{let l=1;return t[4]&&(l=await this.parseValue(t[4],!0)),n&&u(this,T).set(t[1],Number(u(this,T).get(t[1]))+l),l};return u(this,Y).push({step:s,count:0,lines:[],condition:async()=>{const n=await s(!1);return n===0?!1:this.executeCondition(`(${t[1]}  )`,n<0?">":"<",String(i))}})}}commandSubStatic(e){const t=e.match(/^([\w,$%]+)(\((.*)\))?$/)||[],r=t[1],i=V.resolveValues(V.extractValues(t[3]||"",","));return O(this,C,{name:r,lines:[],args:i}),Promise.resolve(void 0)}commandEndSub(){if(u(this,C)){const e=u(this,C).lines,t=u(this,C).args;u(this,T).addSub(u(this,C).name,async(...r)=>{(await Promise.all(t.map((s,n)=>this.parseValue(r[Number(n)]).then(l=>({arg:s,value:l}))))).forEach(({arg:s,value:n})=>{s&&u(this,T).add(String(s),n)}),await this.parse(Array().concat(e))}),O(this,C,void 0)}else throw new Error("has no active SUB");return Promise.resolve(void 0)}commandGoto(e,t){return e.splice(0,e.length),this.parse(u(this,Z).slice(u(this,Z).indexOf(`${t}:`),u(this,Z).length))}commandDimShared(e,t){return V.resolveValues(V.extractValues(e,",")).reduce((i,s)=>{const n=String(s||"").match(/^([\w, $%]+)?(\((.*)\))?$/)||[];return u(this,T).has(n[1])||(n[3]&&(i=i.then(()=>this.parseValue(n[3],!0))),i=i.then(l=>(this.setStack({name:n[1],value:l?Array(l):void 0,global:t}),l))),i},Promise.resolve(void 0))}commandLet(e,t,r){if(u(this,T).has(e))return this.setStack({name:e,value:t,index:r});throw new Error(`Variable ${e} not defined`)}async commandPrintUsing(e){const t=ae(e,{mergeArgs:!0,mergeArgsBy:/^[+,]$/}).rawArgs,r=ae(t[2],{mergeArgs:!0}).rawArgs.filter(n=>n!==",").map(n=>this.parseValue(n)),i=await Promise.all(r);let s=N(t[0]);for(;s.includes("#");){const n=i.shift(),l=s.match(/(#+\.#+)|(#+)/);if(l&&/(#+\.#+)/.test(l[0])){const[o,c]=l[0].split("."),[m,E]=String(n).split("."),p=Fe(String(m||"").slice(0,o.length),o.length,!0," ")+"."+Fe(String(E||"").slice(0,c.length),c.length,!1,"0");s=s.replace(/(#+\.#+)/,N(String(p)))}else s=s.replace(/(#+|#+\.#+)/,N(String(n)))}return u(this,M).call(this,null,{message:`"${N(s)}"`})}commandDataVar(e){if(u(this,se).length===0)return Promise.all(e.split(",").map(t=>this.addDataStack(t)));throw new Error("DATA has already been declared")}async commandPrint(e){if(/^((".*"|[^"]*);([^;]*))$/.test(e)){const t=e.match(/(.*);(.*)$/)||[],r=await this.parseValue(t[1],!0),{rawArgs:i}=ae(String(t[2]),{mergeArgs:!0});let s=await Promise.all(i.map(l=>this.parseValue(l,!0)));s=s.map(l=>N(l));const n=s.map(l=>`${N(r)}${l}`).join(" ");return u(this,M).call(this,null,{message:Me(n)||H(n)?n:`"${n}"`})}else{let t=await this.parseValue(e);const{rawArgs:r}=ae(String(t),{mergeArgs:!0});let i=await Promise.all(r.map(s=>this.parseValue(s,!0)));return i=i.map(s=>N(s)),i.length>1?t=i.join(""):t=i[0],u(this,M).call(this,null,{message:Me(t)||H(t)?t:`"${t}"`})}}commandEnd(){return Promise.resolve(void 0)}async commandPause(e){const t=Number(await this.parseValue(e));return new Promise(r=>window.setTimeout(()=>{r(void 0)},t))}commandRead(e){const t=e.split(",");return Promise.all(t.map(r=>{const i=u(this,se).shift();return this.setReadStack(r,i),Promise.resolve(void 0)}))}commandCall(e,t){const i=(e.match(/([^(]+)\(.*\)/)||[])[1];if(u(this,T).hasSub(i))return this.parseLine(e,t);throw new Error(`SUB ${i} NOT FOUND`)}async commandExecute(e,t){if(!u(this,M))throw new Error("No callback available for readfile");let r;switch(e){case"FILE":if(r=await u(this,M).call(this,`readfile ${t}`,{show:!1}),r&&typeof r=="object"&&"content"in r)return u(this,M).call(this,r.content,{show:!0});throw new Error("File Content is empty");case"EVAL":return this.parseValue(t,!1)}}},se=new WeakMap,_e=new WeakMap,T=new WeakMap,M=new WeakMap,Z=new WeakMap,Se=new WeakMap,Ie=new WeakMap,C=new WeakMap,be=new WeakMap,ie=new WeakMap,Q=new WeakMap,x=new WeakMap,te=new WeakMap,Y=new WeakMap,G=new WeakMap,ct);function Rr(a,e,t){switch(a=String(a),t=String(t),(e.match(/^([<>][=]|[<>])$/)||[])[1]){case"<":return parseFloat(a)<parseFloat(t);case">":return parseFloat(a)>parseFloat(t);case"<=":return parseFloat(a)<=parseFloat(t);case">=":return parseFloat(a)>=parseFloat(t);default:return null}}var le,ce,Oe,$e;class Tr{constructor(e,t){v(this,le);v(this,ce);v(this,Oe,new Map);v(this,$e,[]);O(this,ce,t),O(this,le,e)}get callback(){return u(this,ce)}get memory(){return u(this,le)}async parse(e,t,r){if(e.length===0)return;e.length>1&&await this.readData(e);const i=[];return new Ar(e,async(n,l)=>{l={...l,...r};const o=await(t||u(this,ce)||(()=>{}))(n,l);return l.show&&o!==void 0&&i.push(o),o},u(this,le),u(this,$e),u(this,Oe)).parse().then(()=>i)}readData(e){const t=e.find(r=>/^[ ]*DATA[ +]/.test(r));if(t){const r=e.splice(e.indexOf(t),1);return this.parse(r)}return Promise.resolve(void 0)}}le=new WeakMap,ce=new WeakMap,Oe=new WeakMap,$e=new WeakMap;function k(...a){if(a.includes(void 0))throw new Error("invalid arguments")}const R={};try{R.brackets=/([^\w$%]?)\(([^\\(\\)]+)\)/,R.brackets_start=/^\((.*)\)$/,R.multiply=new RegExp("[^\\d$\\-\\w]?(?<a>([+-]?[\\w.]+e\\+\\d+)|([+-]?[\\w$%.]+)|(^[+-]?[\\w$%.]+)|([\\w$%.]+)|([$]{3}\\d+))[ ]*(?<operator>[\\^*%\\/]|MOD|XOR|AND|OR|<<|>>|>>>)[ ]*(?<b>([-]?[\\w.]+e\\+\\d+)|([-]?[\\w$%.]+)|(^[+-]?[\\w$%.]+)|([\\w$%.]+)|([$]{3}\\d+))"),R.add_subtract=/([+-]?[\w.]+e\+\d+|[+-]?[\w$%.]+|[$]{3}\d+)[ ]*([+-])[ ]*([+-]?[\w.]+e\+\d+|[+-]?[\w$%.]+|[$]{3}\d+)/,R.function=/([\w]+[a-zA-Z0-9_.]+[$%]?)[ ]*\(([^\\(\\)]*)\)/,R.function_start=/^([\w]+[a-zA-Z0-9_.]+[$%]?)[ ]*\(([^\\(\\)]*)\)/,R.variable=/^([\w]+[a-zA-Z0-9_.]?[$%]?)/,R.number=/^([+-]?[\d.]+e\+\d+|[+-]?[\d.])+($|$)/}catch(a){console.error(a)}class Dr{constructor(e,t){_(this,"debug",!1);_(this,"memory");this.memory=this.createMemory(e),this.debug=t!==void 0?t:this.debug}createMemory(e){const t=e||new Ze;return t.addSub("RND",()=>Promise.resolve(Math.random())),t.addSub("PI",()=>Promise.resolve(Math.PI)),t.addSub("POW",(r,i)=>{if(k(r,i),typeof r=="string")throw new Error("Parameter is not a number");if(typeof i=="string")throw new Error("Parameter is not B number");return Promise.resolve(r**(i||2))}),t.addSub("SQRT",r=>{if(k(r),typeof r=="string")throw new Error("Parameter is not a number");return Promise.resolve(Math.sqrt(r))}),t.addSub("INT",async r=>(k(r),await parseInt(N(String(r))))),t.addSub("SPC",r=>{if(k(r),typeof r=="string")throw new Error("Parameter is not a number");return Promise.resolve(`"${et(r," ")}"`)}),t.addSub("LEN",r=>(k(r),Promise.resolve(N(String(r)).length))),t.addSub("ASC",r=>(k(r),Promise.resolve(String(N(r)).charCodeAt(0)))),t.addSub("CHR$",r=>{if(k(r),typeof r=="string")throw new Error("Parameter is not a number");return Promise.resolve(Re(String.fromCharCode(r)))}),t.addSub("LEFT$",(r,i)=>{if(k(r,i),typeof i=="string")throw new Error("Parameter is not B number");return Promise.resolve(`"${Dt(N(r),i)}"`)}),t.addSub("RIGHT$",(r,i)=>{if(k(r,i),typeof i=="string")throw new Error("Parameter is not B number");return Promise.resolve(Re(Pt(String(N(r)),i)))}),t.addSub("STRING$",(r,i)=>{if(k(r,i),typeof r=="string")throw new Error("Parameter is not a number");return Promise.resolve(Re(et(r,String(N(i)))))}),t.addSub("TIME%",()=>Promise.resolve(Date.now())),t.addSub("HEX_ENC$",r=>(k(r),Promise.resolve(Re(Number(N(r)).toString(16))))),t.addSub("HEX_DEC$",r=>(k(r),r=parseInt(String(N(r)),16),Promise.resolve(r))),t}async parse(e){const r=await new Nr(this).parse(e);return this.debug&&console.debug("Result:",typeof r,r),r}validInput(e){return e&&/[/*\-+^()]?/.test(e)}}const Pr=5e3;class Nr{constructor(e,{debug:t}={}){_(this,"debug",!1);_(this,"parser");_(this,"parsedValues",[]);_(this,"timeout",0);this.parser=e,this.debug=t!==void 0?t:this.debug}async parse(e){if(this.debug&&console.debug("PARSE ".padEnd(20,"-")),this.timeout>Pr)throw new Error(`Can't parse ${e}`);this.timeout++;const{result:t,values:r}=V.extractStrings(String(e));let i=ae(t).rawArgs;this.parsedValues=this.parsedValues.concat(r),i=i.map(o=>/^MOD|XOR|AND|OR$/.test(o)?` ${o} `:o);let s=i.join("");H(s)?s=Number(s):Me(s)&&(s=!!s);const n=s,l=await this.action(s);if(this.debug&&console.debug("action:",typeof l,l),l!==void 0){let o;return typeof l=="string"&&l!==n&&!/^".*"$/.test(String(l))?(o=await this.parse(l),this.debug&&console.debug("parse:",typeof o,o),o):(o=await this.resolveValue(l),this.debug&&console.debug("$v:",typeof o,o),o)}}async action(e){var t,r,i,s,n,l;if(typeof e=="string"){if((t=R.brackets_start)!=null&&t.test(e)){const o=e.match(R.brackets_start);if(o){const[c,m]=o;e=e.replace(c,m)}else throw new Error("Invalid expression")}if((r=R.function)!=null&&r.test(e)){const o=e.match(R.function);if(o){const[c,m,E,p]=o,f=m||p;let h=ae(E||"",{separator:","}).rawArgs;const b=E.includes(",")&&h.join("")!==E;b&&(h=E.split(","));let I=await Promise.all(h.map(y=>this.parse(y)));if(I=b?I:[await this.parse(I.join(""))],this.parser.memory.has(f))return e.replace(c,(i=this.parser.memory.get(f))==null?void 0:i[Number(I[0])-1]);if(this.parser.memory.hasSub(f))return e.replace(c,this.cacheValue(await this.parser.memory.executeSub(f,I)))}}if((s=R.brackets)!=null&&s.test(e)){const o=e.match(R.brackets);if(o){const[c,m,E]=o;return e.replace(c,m+await this.parse(E))}else throw new Error("Invalid expression")}if((n=R.multiply)!=null&&n.test(e))return this.operation(e,R.multiply);if((l=R.add_subtract)!=null&&l.test(e))return this.operation(e,R.add_subtract)}return this.resolveValue(e)}async operation(e,t){const r=e.match(t);if(r){let i,s,n;const l=r[0];"groups"in r&&r.groups?(i=r.groups.a,s=r.groups.b,n=r.groups.operator):(i=r[1],n=r[2],s=r[3]);let o=e,c=await this.parse(i);H(c)||(c=N(c));let m=await this.parse(s);switch(H(m)||(m=N(m)),this.debug&&console.debug({valueA:c,valueB:m}),c=c,m=m,n){case"+":o=c+m;break;case"-":o=c-m;break;case"*":o=c*m;break;case"/":o=c/m;break;case">":o=c>m;break;case"<":o=c<m;break;case"^":o=c^m;break;case"%":o=c%m;break;case"MOD":o=c%m;break;case"AND":o=c&m;break;case"OR":o=c|m;break;case"XOR":o=c^m;break;case"<<":o=c<<m;break;case">>":o=c>>m;break;case">>>":o=c>>>m;break}return H(o)||(o=`"${o}"`),e.replace(l,l.replace(RegExp(`[${i}]{${String(i).length}}[ ]*[${n}]{${String(n).length}}[ ]*[${s}]{${String(s).length}}`),"")+this.cacheValue(o))}else throw new Error("Invalid expression")}async resolveValue(e){var t,r,i;if(typeof e!="function"&&V.valueUnresolved(e))return V.resolveValue(e,this.parsedValues);if(typeof e=="string"){if(e=e.replace(/^[ ]*([^ ].*[^ ])[ ]*$/,"$1"),(t=R.number)!=null&&t.test(e)){if(H(e))return Number(e)}else if((r=R.function_start)!=null&&r.test(String(e))){const s=e.match(R.function_start);if(s){const[,n,l]=s;if(this.parser.memory.hasSub(n))return this.parser.memory.executeSub(n,V.resolveValues(V.extractValues(l,",")));throw new Error(`can't find sub "${n}" in memory`)}else throw new Error("Invalid expression")}else if((i=R.variable)!=null&&i.test(String(e))){const s=e.replace(R.variable,"$1");if(this.parser.memory.hasSub(s))return this.parser.memory.executeSub(s);if(this.parser.memory.has(s))return this.parser.memory.get(s)}}return e}cacheValue(e){return this.parsedValues.push(e),V.resolveKey(this.parsedValues.length-1)}}const Lr=["CLS","READ max","DIM fib%(max)","LET fib(1) = 1","LET fib(2) = 2","FOR i=3 TO max","LET fib(i) = fib(i - 2) + fib(i -1)","NEXT i","FOR i=1 TO max","PRINT fib(i)","NEXT i","DATA 10","END"],Or=["CLS","DIM w%,h%,a%","LET w%=12","LET h%=4","LET a%=w%*h%",'PRINT "With the width " + w%','PRINT " and the height " + h%','PRINT " you have the area " + a%'],$r=["CLS","DIM r,a","LET r=5","READ pi","LET a=r*r*pi",'PRINT USING "With the radius ##.##"; r','PRINT USING "we have the area ##.##"; a',"DATA 3.14","END"],xr=["GuessTheNumber","CLS","READ max%","DIM number%, guess%, guesses%",'PRINT "The number is between 1-1000."',"LET number% = INT(RND * max%) + 1","LET guess% = 1","LET guesses% = 0","WHILE guess%<>number%",'PRINT "Guess the number"',"INPUT guess%","IF (guess%<>number%) THEN","IF (guess%>number%) THEN",'PRINT "Your guess was too high"',"ELSE",'PRINT "Your guess was too low"',"ENDIF","ENDIF","LET guesses% = guesses% + 1","WEND",'PRINT USING "You found the number in # tries"; guesses%',"DATA 1000","END"],Cr=["DIM result",'PRINT "Calculate the factorial of"',"INPUT n","LET result = 1","FOR i = n TO 1 STEP -1","LET result = result * i","NEXT i",'PRINT USING "#! = #"; n, result',"END"],Wr=["CLS","DIM stars$",'PRINT "Enter the height of the pyramid"',"INPUT height",'LET stars$ = ""',"FOR i = 1 TO height",'LET stars$ = ""',"FOR j = 1 TO (i+i-1)",'LET stars$ = stars$ + "*"',"NEXT j","PRINT SPC(height - i) + stars","NEXT i","END"],Vr=['PRINT "Step 1"','PRINT "Step 2"','PRINT "Step 3"',"GOTO ignore",'PRINT "Step 4"',"ignore:",'PRINT "Step 5"'],kr=["DIM A, B","LET A = 2000",'LET B = "Hello World"','PRINT USING "A: #"; A','PRINT USING "B: #"; B'],Fr=["DIM A, B","LET A = 1","LET B = 2","IF A == B THEN",'PRINT "true"',"ELSE",'PRINT "false"',"END","IF (A < B) THEN",'PRINT "true"',"END"],Mr=["DIM i%","FOR i% = 1 TO 5",'PRINT USING "For Number #"; i%',"NEXT i%"],Br=["DIM i%","LET i%=0","WHILE i% < 5",'PRINT USING "While Number #"; i%',"LET i% = i% + 1","WEND"],Ur=["DIM duration","LET duration = 2500",'PRINT USING "Start with Pause #ms"; duration',"PAUSE duration",'PRINT "End Pause"','PRINT USING "Start with Sleep #ms"; duration',"PAUSE duration",'PRINT "End Sleep"'],Yr={Fibonacci:Lr,Area:Or,Circle:$r,"Your Name":["CLS",'PRINT "What is your name?"',"INPUT n$",'PRINT "What is your shoe size?"',"INPUT size",'PRINT "Hello "; n$','PRINT USING "your shoe size is ##.##"; size',"END"],GuessTheNumber:xr,Factorial:Cr,Pyramid:Wr,"Bubble Sort":["CLS","READ max","DIM SHARED numbers(max)","SUB CreateList(max) STATIC","FOR i=1 TO max","LET numbers(i) = INT(RND * 100)","NEXT i","END SUB","SUB PrintList(max) STATIC","FOR i=1 TO max","PRINT numbers(i)","NEXT i","END SUB","SUB SwapValues(i%, j%) STATIC","LET numbers(i%) = numbers(i%) XOR numbers(j%)","LET numbers(j%) = numbers(i%) XOR numbers(j%)","LET numbers(i%) = numbers(i%) XOR numbers(j%)","END SUB","SUB Sort(max) STATIC","FOR i%=1 TO (max - 1)","FOR j%=i% TO max","IF numbers(i%)>numbers(j%) THEN","CALL SwapValues(i%, j%)","END IF","NEXT j%","NEXT i%","END SUB","CreateList(max)","Sort(max)","PrintList(max)","DATA 10","END"],Goto:Vr,Vars:kr,If:Fr,For:Mr,"For Step":["CLS","FOR i% = 0 TO 6 STEP 2",'PRINT "For Step Number #"; i%',"NEXT i%"],While:Br,Pause:Ur},Gr=ye(({module:a,core:e})=>[{name:["basic"],args:[new d({index:0,name:"path",description:"Path to basic script"})],async action({path:t},r){var s;if(!t)throw S.get("bad_args");const i=await((s=e.modules.files)==null?void 0:s.fileSystem.get(t));if(typeof(i==null?void 0:i.data)=="object"){const n=i.data;if(n.type==="basic"&&Array.isArray(n.content))return a.parseBasic(n.content,void 0,{logger:r.logger})}else throw new TypeError(`Can't read file ${t}`)}},{name:["basicExamples"],args:[new d({index:0,name:"name",description:"Name from example"})],action({name:t}){return a.parseBasic(Yr[String(t)])}}]);class Xr extends xe{constructor({core:t}){super({name:"Parser",commands:r=>[...Gr(r)],core:t});_(this,"basicInterpreter");_(this,"memory",L(new Ze));_(this,"mathParser",L(new Dr(this.memory)));_(this,"commandParser",L(new V(this.mathParser)));this.basicInterpreter=L(new Tr(this.memory,t.executeCommand.bind(t)))}parse(t,r,i){return this.basicInterpreter.parse(t,r,i)}parseBasic(t,r,i={}){let s=t;return Array.isArray(t)||(s=t.split(`
`)),this.basicInterpreter.parse(s,r,i)}async parseCommand(t){return this.commandParser.parse(t)}parseMath(t){return this.mathParser.parse(t)}isMathValue(t){return this.mathParser.validInput(t)}}async function zr(a,e,t){const r=await a.executeCommand(`exist "${e}"`);let i=!1;r&&(i=await a.executeCommand('openDialog "File exist, overwrite?" --confirm'));const s=[`makefile "${e}"`];return t&&s.push(`--data="${t}"`),i?s.push("--override"):s.push("--ignore"),a.executeCommand(s.join(" "))}async function Hr(a,e){var i;const t=await((i=a.modules.files)==null?void 0:i.fs.get(e)),r=await a.executeCommand(`readfile "${e}"`);return{fsItem:t,value:r}}const jr=ye(({module:a,core:e})=>{const{fileSystem:t}=a;return[{name:"openPreview",args:[new d({index:0,name:"path",description:"Path to the file"}),new d({name:"maximized",description:"If set, window is maximized."})],async action({path:r,maximized:i}){var c,m;const s=await t.get(r),{type:n,content:l,openMaximized:o}=s.data;if(n==="basic"&&!s.data[Ut.HAS_WINDOW_OUTPUT])await((c=e.modules.parser)==null?void 0:c.parseBasic(l,async(E,p)=>await e.executeCommand(E,p)));else{const E=await g(()=>import("./DURuX0vI.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11]),import.meta.url).then(p=>p.default);(m=e.modules.windows)==null||m.addWindow({component:E,componentData:{type:n,content:l},options:{title:s.name,scaleX:!0,scaleY:!0,scrollX:!0,scrollY:!0},layout:{size:je(420,360)}},{full:o||i||!1})}}},{name:"saveFileDialog",args:[new d({index:0,name:"data",description:"File Content"}),new d({index:1,name:"id",description:"File Id"}),new d({index:2,name:"extension",description:"File Extension"})],async action({data:r,id:i,extension:s}){var o;const n=await g(()=>import("./DKSL1iiK.js"),__vite__mapDeps([12,13,3,14,15,16,17,18,19,20,21,22,23,24,25,26,27,8,28,7,9,10,1,29,30,31,32]),import.meta.url).then(c=>c.default),l=(o=e.modules.windows)==null?void 0:o.addWindow({component:n,componentData:{fsItem:t.root&&L(t.root),id:i},options:{title:"Save File",scaleX:!1,scaleY:!1,scrollX:!1,scrollY:!1}});if(l){const{value:c}=await l.awaitClose();if(c){const m=Lt(c,s),E=await zr(e,m,r);if(E)return L(Wt(E))}}}},{name:"openFileDialog",args:[],async action(){var n;const r=ge({}),i=await g(()=>import("./CQWxZAey.js"),__vite__mapDeps([33,13,3,14,15,16,17,18,19,20,21,22,23,24,25,26,27,8,28,7,9,10,1,29,30,31,5,6,34]),import.meta.url).then(l=>l.default),s=(n=e.modules.windows)==null?void 0:n.addWindow({component:i,componentData:{model:r,fsItem:t.root&&L(t.root)},options:{title:"Open File",scaleX:!1,scaleY:!1,scrollX:!1,scrollY:!1}});if(s){const{value:l}=await s.awaitClose();return l&&Hr(e,l)}}},{name:"fileinfo",description:"Get info from File or Directory",args:[new d({index:0,name:"path",description:"Path to the file"}),new d({index:1,name:"name",description:"Name from the Info"}),new d({index:2,name:["list","ls"],flag:!0,description:"List all Infos"})],async action({path:r,name:i,list:s},n){const l=await t.getItemMetaList(r);if(s){const o=new De;o.addColumns([{value:"Name",align:"left",minWidth:20},{value:"Value",align:"left",minWidth:20}]),o.addRows(l.map(({name:c,value:m})=>{let E=m;return Array.isArray(m)&&(E=m.join(" ")),[c,E]})),n.message([o])}else return l.find(o=>o.name===i)}},{name:["info","i"],args:[new d({index:0,name:"path",description:"Path to the file"})],async action({path:r},i){let s=t.root;r&&(s=await t.get(r)),s!=null&&s.parent&&(s=s.parent);const n=await(s==null?void 0:s.getItems()),l=new De;l.addColumns([{value:"Unit",align:"left",minWidth:8},{value:"Size",align:"right",minWidth:6},{value:"Used",align:"right",minWidth:6},{value:"Free",align:"right",minWidth:6},{value:"Full",minWidth:4},{value:"Errs",align:"center",minWidth:4},{value:"Status",align:"center",minWidth:10},{value:"Name",align:"right",minWidth:14}]);const o=Array.from((n==null?void 0:n.values())||[]).filter(m=>m instanceof Ue);l.addRows(o.map(m=>{let E=0;return(m.size>0||m.maxSize>0)&&(E=m.size/m.maxSize*100),[`${m.id}:`,Ae(m.maxSize),Ae(m.size),Ae(m.maxSize-m.size),`${E}%`,"0",m.locked?"Read":"Read/Write",`${m.name||""}`]}));const c=["","Mounted disks:",l,"","Volumes available:"];o.forEach(m=>{c.push(`${m.name}: [Mounted]`)}),c.push(""),i.message(c)}},{name:["list","ls"],args:[new d({index:0,name:"path",description:"Path to the file"}),new d({name:"dir-size",flag:!0,description:"Show Directory Size."})],async action({path:r,dirSize:i},s){let n=t.currentItem;r&&(n=await t.get(r));const l=Array.from((await(n==null?void 0:n.getItems())||[]).values()),o=new De;o.addColumns([{value:"Name",align:"left",minWidth:26},{value:"Size",align:"right",minWidth:8},{value:"Access",align:"center",minWidth:12},{value:"Date / Time",align:"center",minWidth:18}]),o.addRows(l.reduce((E,p)=>{let f;p instanceof pt&&!i?f="DIR":f=Fe(Ae(p.size),8,!0,"0");const h=p.isLocked()?"Read":"Read/Write";return E.push([`${p.id}:`,f,h,p.createdDate?Nt("D-mm-y H:I:S",p.createdDate):""]),E},[]));const c=l.reduce((E,p)=>(p instanceof Ye&&E++,E),0),m=l.reduce((E,p)=>(E+=p.size,E),0);return s.message([o,`${l.length} files - ${c} directories - ${m} blocks used`]),Promise.resolve()}}]}),Kr=Ke(({core:a})=>{const e=a.modules.symbols||{},t=a.modules.windows||{},r=ge({open:{disabled:!1},edit:{disabled:!1},duplicate:{disabled:!1},container:{disabled:!1},emptyTrashcan:{disabled:!1},discard:{disabled:!1},info:{disabled:!1},webLink:{disabled:!1},webLinkNew:{disabled:!1},webLinkEdit:{disabled:!1}});function i(){const p=e.getSelectedItems()||[],f=e.getPrimaryWrapper();r.info.disabled=p.length<1,r.open.disabled=p.length<1,r.edit.disabled=p.length<1||!!p.find(h=>(h==null?void 0:h.locked)||h instanceof Te),r.duplicate.disabled=p.length<1||!!p.find(({fsItem:h})=>(h==null?void 0:h.locked)||h instanceof Te||h instanceof Ue),r.container.disabled=!r.open.disabled||f instanceof we&&f.fsItem&&(f.fsItem instanceof Mt||f.fsItem.locked)||!f,r.webLinkEdit.disabled=p.length<1||!!p.find(h=>{var b;return!((b=h==null?void 0:h.fsItem)!=null&&b.meta.get(A.WEB_URL))}),r.webLinkNew.disabled=r.container.disabled,r.webLink.disabled=r.webLinkNew.disabled&&r.webLinkEdit.disabled,r.emptyTrashcan.disabled=p.length<1||!!p.find(h=>!((h==null?void 0:h.fsItem)instanceof Te)),r.discard.disabled=p.length<1||!!p.find(({fsItem:h})=>(h==null?void 0:h.locked)||h instanceof Te||h instanceof Ue)}return e.events.subscribe(()=>i()),i(),[{order:1,title:"File",items:[{title:"Open",options:r.open,action:s},{title:"Edit",options:r.edit,action:c},{type:W.SEPARATOR},{title:"Web Link",options:r.webLink,items:[{title:"New",options:r.webLinkNew,action:l},{title:"Edit",options:r.webLinkEdit,action:o}]},{type:W.SEPARATOR},{title:"Duplicate",options:r.duplicate,action(){const p=e.getSelectedItems()||[];return Promise.all(p.filter(f=>f.fsItem).map(async({fsItem:f})=>{const h=await(f==null?void 0:f.getPath());return a.executeCommand(`copy "${h}" "${h}" -ignore`)}))}},{title:"Make Dir",options:r.container,async action(){var f;const p=(f=e.getPrimaryWrapper())==null?void 0:f.fsItem;if(p){const h=Ot(await p.getPath(),"Directory");return console.log(`makedir "${h}" -ignore`),a.executeCommand(`makedir "${h}" -ignore`)}else throw new Error("No item found")}},{type:W.SEPARATOR},{title:"Discard",options:r.discard,action(){const p=e.getSelectedItems()||[];return Promise.all(p.filter(f=>f.fsItem).map(async({fsItem:f})=>{const h=await(f==null?void 0:f.getPath());return a.executeCommand(`remove "${h}" -r`)}))}},{title:"Empty Trashcan",options:r.emptyTrashcan,action(){const p=e.getSelectedItems()||[];return Promise.all(p.filter(f=>f.fsItem).map(async({fsItem:f})=>{const h=await(f==null?void 0:f.getItems())||[];return Promise.all(Array.from(h.values()).map(async b=>{const I=await b.getPath();return a.executeCommand(`remove "${I}" -r -ignore`)}))}))}},{type:W.SEPARATOR},{title:"Info",options:r.info,async action(){const p=e.getSelectedItems()||[];await Promise.all(p.filter(f=>f.fsItem).map(async f=>{if(f.fsItem){const h=await g(()=>import("./Bvjzbiw0.js"),__vite__mapDeps([35,36,37,26,27,25,28,5,6,7,3,8,9,10,38]),import.meta.url).then(b=>b.default);t.addWindow({component:h,componentData:{fsItem:L(f.fsItem)},layout:{size:je(460,280)},options:{title:`Info File ${f.fsItem.name}`,scaleX:!0,scaleY:!0,prompt:!1,scrollX:!0,scrollY:!0}})}else throw new Error(`Item has no fsItem. ${f.id}`)}))}}]}];function s(){(e.getSelectedItems()||[]).filter(f=>f.fsItem).forEach(f=>{if(f.command){const h={showCommand:!1,show:!0};return a.executeCommand(f.command,h)}})}async function n({name:p,url:f,symbol:h},b){if(b||(b=await a.executeCommand(`saveFileDialog --id="${$t(p)}"`)),b){const I=a.addExecution();try{const y=b.getPath();await a.executeCommand(`rename "${y}" "${p}" -n`),await a.executeCommand(`editfilemeta "${y}" "${A.WEB_URL}" "${f}"`),await a.executeCommand(`editfilemeta "${y}" "${A.SYMBOL}" "${h}"`)}catch(y){throw I(),y}return I(),!0}return!1}async function l(){const p=await g(()=>import("./7fvok3Hs.js"),__vite__mapDeps([39,40,7,3,8,9,10,13,14,15,16,17,18,30,31,41,42,43]),import.meta.url).then(h=>h.default);return t.addWindow({component:p,componentData:{model:{actions:{save:n},name:null,url:null,symbol:"default"}},options:{title:"Make Link",prompt:!1,scaleX:!1,scaleY:!1,scrollX:!1,scrollY:!1}}).awaitClose()}async function o(){const p=e.getSelectedItems();await Promise.all(p.filter(f=>f.fsItem).map(async f=>{const h=f.fsItem;if(h){const b=await g(()=>import("./7fvok3Hs.js"),__vite__mapDeps([39,40,7,3,8,9,10,13,14,15,16,17,18,30,31,41,42,43]),import.meta.url).then(I=>I.default);t.addWindow({component:b,componentData:{fsItem:L(h),model:{actions:{save:n},name:h.name,url:h.meta.get(A.WEB_URL),symbol:h.meta.get(A.SYMBOL)}},options:{title:"Edit Link",prompt:!1,scaleX:!1,scaleY:!1,scrollX:!1,scrollY:!1}})}else throw new Error(`Item has no fsItem. ${f.id}`)}))}async function c(){const p=e.getSelectedItems();await Promise.all(p.filter(f=>f.fsItem).map(async f=>{const h=f.fsItem;if(h){const b=ge({actions:{save:E},id:h.id,name:h.name});[A.SYMBOL,A.VISIBLE,A.IGNORE_SYMBOL_REARRANGE,A.WINDOW_SCALE,A.WINDOW_SCROLL_X,A.WINDOW_SCROLL_Y,A.WINDOW_FULL_SIZE,A.WINDOW_SYMBOL_REARRANGE,A.WINDOW_SIDEBAR].forEach(y=>{b[y]=h.meta.has(y)?h.meta.get(y):!1});const I=await g(()=>import("./BkbWwMYx.js"),__vite__mapDeps([44,40,7,3,8,9,10,13,14,15,16,17,18,30,31,41,42,45,46,47,48]),import.meta.url).then(y=>y.default);t.addWindow({component:I,componentData:{fsItem:L(h),model:b},options:{title:`Edit File ${h.name}`,prompt:!1,scaleX:!1,scaleY:!1,scrollX:!1,scrollY:!1}})}else throw new Error(`Item has no fsItem. ${f.id}`)}))}function m(){return[A.SYMBOL,A.VISIBLE,A.IGNORE_SYMBOL_REARRANGE,A.WINDOW_SCALE,A.WINDOW_SCROLL_X,A.WINDOW_SCROLL_Y,A.WINDOW_FULL_SIZE,A.WINDOW_SYMBOL_REARRANGE,A.WINDOW_SIDEBAR]}async function E(p,f){const{id:h,name:b}=p,I=f.getPath();if(!h)throw new Error("Id is emoty!");let y;const B=a.addExecution();try{await Promise.all(m().map(X=>{let z=p[X];return typeof z=="string"&&(z=`"${z}"`),a.executeCommand(`editfilemeta "${I}" "${X}" ${z}`)})),b&&h!==b?await a.executeCommand(`rename "${I}" "${b}" -n`):y=a.executeCommand(`rename "${I}" "${h}" -rn`),y=a.executeCommand(`rename "${I}" "${h}"`)}catch(X){throw B(),X}return B(),y}}),Zr=ye(({module:a})=>{const{fileSystem:e,core:t,disks:r}=a;return[{name:["mountDisk"],description:"Mount Disk",args:[new d({index:0,name:"id",description:"Disk ID"})],async action({id:i},s){const n=t.addExecution();try{const l=await r[i].data(),o=await e.addFloppyDisk(()=>l({core:t}));r[i].hidden||s.message(`Mount Disk <strong>${o.name}</strong> <strong>(${o.id})</strong> successful!`),n()}catch(l){throw console.error(l),S.get("cant_find_disk",i)}}},{name:["changeDirectory","cd"],description:"cd %path%",args:[new d({index:0,name:"path",description:"Directory path"})],async action({path:i}){if(!i)throw S.get("bad_args");try{await e.changeDirectory(i)}catch(s){throw console.error(s),S.get("cant_find",i)}}},{name:["exist"],description:"Check if file exists.",args:[new d({index:0,name:"path",description:"Filename"})],async action({path:i},s){if(!i)throw S.get("bad_args");const n=tt(i),l=await e.exist(i);return l?s.message(`File ${n} exists`):s.message(`File ${n} does not exist`),l}},{name:["makedir","mkdir"],args:[new d({index:0,name:"path",description:"Filename"}),new d({index:1,name:"name",description:"Name"}),new d({name:"ignore",flag:!0,description:"Ignore file exist."})],async action({path:i,name:s,ignore:n},l){if(!i)throw S.get("bad_args");const o=await e.makedir(i,s||tt(i),{override:n});return l.message(`Directory "${o.name}" created`),o}},{name:["remove","rm"],args:[new d({index:0,name:"path",description:"Filename"}),new d({name:["recursive","r"],flag:!0,description:"Remove Directory Items and Directories."}),new d({name:["ignore"],flag:!0,description:"Ignore the specified file is deleted."})],async action({path:i,recursive:s,ignore:n},l){if(!i)throw S.get("bad_args");return(await e.remove(i,s,{ignore:n})||[]).map(c=>{const m=c.type===Ye.TYPE?"Directory":"File";return l.message(`Removed ${m}: ${c.name}`),c})}},{name:["readfile","getfile"],description:"Get file content",args:[new d({index:0,name:"path",description:"Filename"})],async action({path:i}){if(!i)throw S.get("bad_args");return(await e.get(i)).data}},{name:["makefile","mkfile"],description:"Creates a file with the specified attributes.",args:[new d({index:0,name:"path",description:"Filename"}),new d({index:1,name:"name",description:"Name"}),new d({index:3,name:"data",description:"Data"}),new d({name:"override",flag:!0,description:"Deletes existing file and recreates."})],async action({path:i,name:s,data:n,override:l=!1},o){if(!i)throw S.get("bad_args");typeof n=="string"&&(n=rt(n));const c=await e.makefile(i,s,n,{override:l||!1,meta:[]});return o.message(`File "${c.name}" created`),c}},{name:["editfile"],description:"Edits file with specified attributes.",args:[new d({index:0,name:"path",description:"Filename"}),new d({index:1,name:"data",description:"Data"})],async action({path:i,data:s},n){if(!i)throw S.get("bad_args");typeof s=="string"&&(s=rt(s));const l=await e.editfile(i,s);return n.message(`File "${l.name}" edited`),l}},{name:["editfilemeta"],description:"Edits file with specified attributes.",args:[new d({index:0,name:"path",description:"Filename"}),new d({index:1,name:"name",description:"Name"}),new d({index:2,name:"value",description:"Value"})],async action({path:i,name:s,value:n},l){if(!i)throw S.get("bad_args");const o=await e.editfileMeta(i,s,n);return l.message(`File  "${o.name}" Meta edited`),o}},{name:["makelink","mklink"],description:"Creates a link to the specified path.",args:[new d({index:0,name:"ref",description:"Reference path with id (example.ext)."}),new d({index:1,name:"name",description:"Displayed Name"}),new d({index:2,name:"dest",description:"Destination directory."})],async action({ref:i,name:s,dest:n},l){if(!i)throw S.get("bad_args");n=n||".";const o=await e.get(i),c=await e.makelink(o,s);return await e.get(n)!==e.currentItem&&await e.move(c,n,{override:!0}),l.message(`Created link "${s}" with "${await o.getPath()}"`),c}},{name:["editlink"],description:"",args:[new d({index:0,name:"path",description:"Reference filepath with id (example.ext)."}),new d({index:1,name:"ref",description:"Destination directory."})],async action({path:i,ref:s},n){if(!(i&&s))throw S.get("bad_args");const l=await e.get(s),o=await e.editlink(i,l);return n.message(`Edited link "${name}" with "${await l.getPath()}"`),o}},{name:"rename",description:"Renamed a file",args:[new d({index:0,name:"path",description:"Filepath with id (example.ext)."}),new d({index:1,name:"value",description:"Value for id or displayed name."}),new d({name:["name","n"],flag:!0,description:"When set, changes the display name."}),new d({name:["removeName","rn"],flag:!0,description:"When set, removes the display name."})],async action({path:i,value:s,name:n,removeName:l},o){if(!l&&(!i||!s))throw S.get("bad_args");const c=await e.get(i),m=n?c.name:c.id;return await e.rename(i,s,{name:n,removeName:l}),o.message(`Renamed from "${m}" to "${s}"`),c}},{name:["cp","copy"],args:[new d({index:0,name:"from",description:"Source Filepath with id (example.ext)."}),new d({index:1,name:"dest",description:"Destination Filepath with id (example.ext)."}),new d({name:["ignore","i"],flag:!0,description:"When sets, creates a new file if exists."})],async action({from:i,dest:s,ignore:n},l){let o=s;if(!o&&n&&(o=i),!o||!i)throw S.get("bad_args");const c=await e.copy(i,o,{ignore:n});return l.message(`Copied from "${i}" to "${o}"`),c}},{name:["mv","move"],description:"move %from% %to%",args:[new d({index:0,name:"from",description:"From path"}),new d({index:1,name:"to",description:"To path"}),new d({index:2,name:"item-position",description:"Sets the position in the Icon view. (x,y)"})],async action({from:i,to:s,itemPosition:n},l){if(!s||!i)throw S.get("bad_args");const o=await e.move(i,s);n&&o.meta.set(A.POSITION,[0,0].map((m,E)=>{const p=n.split(",");return parseInt(p[Number(E)]||"0")})),o.save();let c;return o instanceof Ye?c="Directory":c="File",l.message(`${c} moved ${o.name}`),o}},{name:["executeFile"],description:"Execute file.",args:[new d({index:0,name:"path",description:"Path to the file"})],async action({path:i}){if(!i)throw S.get("bad_args");const s=await e.get(i);if(typeof s.action=="function")return s.action(t);throw S.get("cant_find_action",i)}}]});S.add("cant_find_action","Can't find action %1");S.add("cant_find_disk","Can't find disk %1");const Qr=new class{constructor(){_(this,"firebase",null)}get(){return this.firebase||(this.firebase=this.getImports())}getImports(){return Promise.all([g(()=>import("./PS5SoCZn.js"),__vite__mapDeps([49,50]),import.meta.url).then(e=>e.default||e),g(()=>import("./CfrwDXeG.js"),__vite__mapDeps([51,50,25]),import.meta.url).then(e=>e.default||e),g(()=>import("./AyGIKDDV.js"),__vite__mapDeps([52,50]),import.meta.url).then(e=>e.default||e)]).then(([e,t,r])=>({app:e,auth:t,database:r}))}},ke=new Map;class qr extends xt{constructor(){super(...arguments);_(this,"modules");_(this,"services");_(this,"app")}get name(){var t;return(t=this.app)==null?void 0:t.name}async connect(t,{apiKey:r,url:i}){if(this.modules=await Qr.get(),this.app)ke.has(t)&&(this.app=ke.get(t));else{const s=this.modules.app.initializeApp({apiKey:r,databaseURL:i},t);ke.set(s.name,s),this.app=s}return this.app}async disconnect(){var t;if(!this.app)throw S.get("FirebaseWrapper_noApp");me(this),await this.logout(),await((t=this.modules)==null?void 0:t.app.deleteApp(this.app)),this.app=void 0}get locked(){return!!this.app&&!this.isLogged()}get currentUser(){var t;if((t=this.modules)!=null&&t.auth){const{getAuth:r}=this.modules.auth;return r(this.app).currentUser}}isLogged(){return!!this.app&&!!this.currentUser}login(t,r){var i;if((i=this.modules)!=null&&i.auth){const{getAuth:s,signInWithEmailAndPassword:n}=this.modules.auth,l=s(this.app);return me(this),n(l,t,r)}}logout(){var t;if(this.app&&((t=this.modules)!=null&&t.auth)){const{getAuth:r,signOut:i}=this.modules.auth,s=r(this.app);return i(s)}else throw S.get("FirebaseWrapper_notConnected")}remove(t){var r;if(me(this),(r=this.modules)!=null&&r.database){const{remove:i,ref:s,getDatabase:n}=this.modules.database,l=n(this.app),o=s(l,t);return i(o)}}get(t){var r;if(me(this),(r=this.modules)!=null&&r.database){const{ref:i,onValue:s,getDatabase:n}=this.modules.database,l=n(this.app),o=i(l,t);return new Promise(c=>{s(o,m=>c(m.val()))})}}async set(t,r){var i;if(me(this),(i=this.modules)!=null&&i.database){const{ref:s,set:n,getDatabase:l}=this.modules.database,o=l(this.app),c=s(o,t);return await n(c,r),r}}}function me(a){if(!a.app)throw S.get("FirebaseWrapper_notConnected")}S.add([["FirebaseWrapper_notConnected",["Not connected","Not connected"]],["FirebaseWrapper_noApp",["No app available","No app available"]],["FirebaseWrapper_hasApp",["App already available",'App "%1" already available']]]);class Jr extends Ct{constructor(e){super({...e,storage:new qr})}async mount(e){if(e.onDisconnect=()=>{this.unmount()},this.storage)return await this.storage.connect(e.id,{apiKey:e.apiKey,url:e.url}),this;throw new Error("no storage")}async unmount(){if(this.storage)return await this.storage.disconnect(),this;throw new Error("no storage")}async load(){if(this.storage){let e=await this.storage.get(this.name);return e||(e={},this.storage.locked||await this.storage.set(this.name,e)),this.data=e,e}else throw new Error("no storage")}async save(e){if(this.storage)return e=St(e),this.data=e||this.data,await this.storage.set(this.name,e),this.data;throw new Error("no storage")}get locked(){var e;return((e=this.storage)==null?void 0:e.locked)||!1}}function St(a){return Object.fromEntries(Object.entries(a).filter(([,e])=>e).map(([e,t])=>(t&&typeof t=="object"&&(t=St(t)),[e,t])))}const de=new Map,ea=ye(({module:a,core:e})=>{const{fileSystem:t}=a;return[{name:"cloudList",args:[new d({name:"json",flag:!0,description:"Get JSON Export"})],action({json:r},i){const s=Array.from(de.values());if(r)return Promise.resolve(s);{const n=new De;return n.addColumns([{value:"Storage (Id)",align:"left",minWidth:15},{value:"Name",align:"left",minWidth:15},{value:"Logged In",align:"center",minWidth:9}]),n.addRows(s.reduce((l,o)=>(l.push([o.id,o.name,o.storage.storage.isLogged()?"yes":"no"]),l),[])),i.message([n]),Promise.resolve()}}},{name:"cloudMountFirebase",args:[new d({index:0,name:"id",flag:!0,description:"Id from Storage."}),new d({index:1,name:"apiKey",description:"Firebase Api-Key."}),new d({index:2,name:"url",description:"Firebase Database-Url."})],async action({id:r,apiKey:i,url:s},n){if(!i||!s)throw S.get("bad_args");const l=e.addExecution(),o=await t.connect(Jr,{id:r,apiKey:i,url:s});return de.set(o.id,o),n.message(`Mount <strong>${o.name}</strong> <strong>(${o.id})</strong> successful!`),l(),o}},{name:"cloudUnmount",args:[new d({index:0,name:"id",flag:!0,description:"Id from Storage."})],async action({id:r},i){if(!r)throw S.get("bad_args");const s=e.addExecution();try{const n=de.get(r);await t.disconnect(n),de.delete(n.id),i.message(`Unmount "${n.name}" successful!`),s()}catch(n){throw s(),n}}},{name:"cloudAuth",args:[new d({name:"login",flag:!0,description:"Storage Login"}),new d({name:"logout",flag:!0,description:"Logout from Storage."}),new d({name:"email",description:"Email for Login."}),new d({name:"password",description:"Password for Login."}),new d({name:"storage",description:"Specifies which drive is logged on."})],async action({email:r,password:i,storage:s,login:n,logout:l},o){const c=s;if(!c)throw S.get("bad_args");const m=e.addExecution(),E=de.get(c);let p;if(E)try{if(n){if(!r||!i)throw S.get("bad_args");p=await E.storage.storage.login(r,i),o.message(`Login with ${E.id} (${E.id}) successful!`)}else l&&(p=await E.storage.storage.logout(),o.message(`Logout from ${E.id} (${E.id}) successful!`))}catch(f){if(m(),f instanceof Error&&"code"in f){switch(f.code){case"auth/user-not-found":case"auth/wrong-password":return f}throw f}}else throw new Error(`${c} is not mounted.`);return m(),p}}]}),lt=L(new Bt("web_workbench_FS"));class It extends xe{constructor({core:t}){super({name:"Files",commands:({module:r,core:i})=>[...jr({module:r,core:i}),...Zr({module:r}),...ea({module:r,core:i})],contextMenu:Kr,core:t});_(this,"fileSystem",lt);_(this,"fs",lt);_(this,"disks",{})}async addDisks(t){[...t].sort((r,i)=>r.order>i.order?1:r.order<i.order?-1:0).forEach(r=>{this.disks[r.name]=r})}}_(It,"NAME","Files");class ta{constructor(e){_(this,"defaultItems",new Xe);_(this,"activeItems");_(this,"core");this.core=e,this.activeItems=this.defaultItems}addDefaultItems(e){this.defaultItems.add(e)}getActiveItems(){return this.activeItems}setActiveItems(e){return this.activeItems=e||this.defaultItems}}const ra=Ke(({core:a})=>{const{windows:e}=a.modules;return[{order:0,title:"Web-Workbench",items:[{title:"Settings",action(){return a.executeCommand("openSettings")}},{type:W.SEPARATOR},{hotKey:"I",keyCode:73,title:"Info",async action(){const t=await g(()=>import("./DHvoSegL.js"),__vite__mapDeps([53,2,3,4,5,6,7,8,9,10,54]),import.meta.url).then(r=>r.default);e==null||e.addWindow({component:t,componentData:{},options:{title:"Info",prompt:!1,scaleX:!1,scaleY:!1,scrollX:!1,scrollY:!1}})}},{type:W.SEPARATOR},{title:"Imprint",action(){return a.executeCommand('execute "Imprint.md"')}},{title:"Disclaimer",action(){return a.executeCommand('execute "Disclaimer.md"')}}]}]}),aa={xmlns:"http://www.w3.org/2000/svg",width:"6",height:"10",viewBox:"0.5 50.5 6 10"};function sa(a,e){return q(),ne("svg",aa,e[0]||(e[0]=[J("path",{fill:"#020203",d:"M.5 50.5h6v2h-4v2h2v2h-2v4h-2z"},null,-1)]))}const ia={render:sa},na={xmlns:"http://www.w3.org/2000/svg",width:"6",height:"10"};function oa(a,e){return q(),ne("svg",na,e[0]||(e[0]=[J("path",{d:"M0 10h6V8H2V6h2V4H2V2h4V0H0z"},null,-1)]))}const la={render:oa},ca={class:"icon full"},ua={class:"icon empty"},ma=mt({__name:"StorageBar",props:{visible:{type:Boolean,default:!0},value:{type:Number,default:.8}},setup(a){const e=a,t=Be(()=>({"--bar-height":Math.min(e.value,1)}));return(r,i)=>a.visible?(q(),ne("div",{key:0,class:"wb-env-atom-storage-bar",style:Vt(t.value)},[J("div",null,[J("div",ca,[Le(at(ia))]),i[0]||(i[0]=J("span",{class:"size"},[J("span",{class:"helper"})],-1)),J("div",ua,[Le(at(la))])])],4)):pe("",!0)}}),da=dt(ma,[["__scopeId","data-v-3d4c6ce7"]]),pa={class:"wb-env-molecule-dialog-content"},fa=["innerHTML"],ha={key:1,class:"input"},ga=mt({__name:"DialogContent",props:{message:{type:String,default(){return"Dialog Message"}},confirm:{type:Boolean,default:!1},prompt:{type:Boolean,default:!1},promptType:{type:String,default:"text"},promptStep:{type:Number,default:void 0},promptValue:{type:String,default:""},password:{type:Boolean,default:!1},apply:{type:Function,default(){return null}},abort:{type:Function,default(){return null}},applyLabel:{type:String,default(){return"Continue"}},abortLabel:{type:String,default(){return"Cancel"}},yesLabel:{type:String,default(){return"Yes"}},noLabel:{type:String,default(){return"No"}}},emits:["apply","abort"],setup(a,{emit:e}){const t=a,r=e,i=kt(t.promptValue),s=Be(()=>t.password?"password":t.promptType),n=Be(()=>t.message.replace(/\\n|\n/g,"<br>")),l=()=>{const c=i.value||!0;typeof t.apply=="function"?t.apply(c):r("apply",c)},o=()=>{typeof t.abort=="function"?t.abort():r("abort")};return(c,m)=>(q(),ne("div",pa,[J("div",null,[a.message?(q(),ne("p",{key:0,innerHTML:n.value},null,8,fa)):pe("",!0),a.prompt?(q(),ne("div",ha,[Le(Xt,{ref:"dialogInput",modelValue:i.value,"onUpdate:modelValue":m[0]||(m[0]=E=>i.value=E),step:a.promptStep,type:s.value,label:null},null,8,["modelValue","step","type"])])):pe("",!0),Le(zt,{align:a.abortLabel?"outer":"center",class:"buttons"},{default:Ft(()=>[a.applyLabel||a.confirm&&a.yesLabel?(q(),st(nt,{key:0,"style-type":"dialog",label:a.confirm?a.yesLabel:a.applyLabel,onClick:l},null,8,["label"])):pe("",!0),a.abortLabel||a.confirm&&a.noLabel?(q(),st(nt,{key:1,"style-type":"dialog",label:a.confirm?a.noLabel:a.abortLabel,onClick:o},null,8,["label"])):pe("",!0)]),_:1},8,["align"])])]))}}),wa=dt(ga,[["__scopeId","data-v-302c1124"]]),Ea=ye(({module:a,core:e})=>{var s;const t=(s=e.modules.files)==null?void 0:s.fs,r=e.modules.symbols,i=e.modules.windows;return[{name:["openDirectory","openDir"],description:"Opens the specified directory.",args:[new d({index:0,name:"path",description:"Path to the directory."}),new d({name:"sortSymbols",description:"Sort Symbols",flag:!0}),new d({name:"windowSize",description:"Window Size"}),new d({name:"windowPosition",description:"Window Position"}),new d({name:"windowScale",description:"Window Scale"}),new d({name:"windowScrollX",description:"Window Scroll-X"}),new d({name:"windowScrollY",description:"Window Scroll-Y"}),new d({name:"windowSidebar",description:"Window Sidebar"}),new d({name:"windowFullSize",description:"Window Full-Size"})],async action(n){const{path:l,sortSymbols:o,windowSize:c,windowPosition:m,windowScale:E,windowScrollX:p,windowScrollY:f,windowSidebar:h,windowFullSize:b}=n;if(!l)throw S.get("bad_args");const I=await(t==null?void 0:t.get(l));if(!I)throw S.get("FileSystemItem_itemNotFound",l);if(!(I instanceof pt))throw S.get("FileSystemItem_itemNotContainer",l);const y=await(r==null?void 0:r.addFileSystemWrapper(I)),B=r==null?void 0:r.getWrapper(String(y)),X=ge({value:I.size/I.maxSize}),z=Ce=>{const[ve,ue]=Ce.split(",");return je(Number(ve),Number(ue))},j=i==null?void 0:i.addWindow({layout:{size:z(c||"400,200"),position:z(m||"0,0")},sidebarComponent:da,sidebarComponentData:X,component:Tt,componentData:{wrapperId:y,parentScrollable:p||f},options:{title:I.name,sidebar:h!==void 0?h:!0,scale:E!==void 0?E:!0,scrollX:p!==void 0?p:!0,scrollY:f!==void 0?f:!0,center:!m}},{active:!0,full:b}),Qe=()=>{X.value=I.size/I.maxSize},yt=[B==null?void 0:B.events.subscribe(Qe)];return new Promise(Ce=>{j==null||j.events.subscribe(({name:ve})=>{ve==="ready"&&o?window.requestAnimationFrame(()=>{B==null||B.rearrangeIcons()}):ve==="close"?(yt.forEach(ue=>ue==null?void 0:ue.unsubscribe()),y&&(r==null||r.removeWrapper(y)),Ce(!0)):Qe()})})}},{name:["openDialog"],description:"Open a Dialog.",args:[new d({index:0,name:["message"],description:"Message from Dialog."}),new d({index:1,name:["title"],description:"Title from Dialog."}),new d({name:["apply"],description:"Title from apply button."}),new d({name:["abort"],description:"Title from abort button."}),new d({name:["confirm"],flag:!0,description:"Defines the confirm dialog"}),new d({name:["prompt"],flag:!0,description:"Defines the prompt dialog"}),new d({name:["promptType"],description:"Type from prompt dialog (e.g. text, number, email). (Default: text)"}),new d({name:["promptStep"],description:"Step from prompt dialog (e.g. 1, 0.1, 0.01). (Default: 1)"}),new d({name:["promptValue"],description:"Default value from prompt dialog."}),new d({name:["secret"],flag:!1,description:"Input is illegible."})],action:n=>{const{title:l,message:o=null,apply:c=null,abort:m=null,confirm:E=!1,prompt:p=!1,promptType:f="text",promptStep:h=void 0,promptValue:b=null,secret:I=!1}=n;let y;const B=j=>{y(j)},X=()=>{y(!1)},z=a.addWindow(new Ge({component:wa,componentData:{title:l,message:o,secret:I,confirm:E,prompt:p,promptType:f,promptStep:Number(h),promptValue:b,applyLabel:c||"Continue",abortLabel:m,apply:B,abort:X},options:{scaleX:!1,scaleY:!1,scrollX:!1,scrollY:!1,close:!1}}));return z.awaitClose().then(()=>X()),new Promise(j=>{y=j}).then(j=>(z.close(),j))}}]});class _a extends xe{constructor(t){super({config:Yt,commands:Ea,...t,name:"Windows"});_(this,"wrappers",L(new Map));_(this,"contentWrapper");_(this,"globalWrapper");_(this,"contextMenu");this.contextMenu=ge(new ta(this.core)),this.contentWrapper=this.getWrapper(this.addWrapper(new it(this.core))),this.globalWrapper=this.getWrapper(this.addWrapper(new it(this.core))),or({contentWrapper:this.contentWrapper.events,globalWrapper:this.globalWrapper.events}).subscribe(r=>{console.log("event",r)})}addWindow(t,r={}){let i;return t instanceof Ge?i=t:i=new Ge(t),i.componentData&&(i.componentData.core=L(this.core)),r={global:!1,...r},r.global?i=this.globalWrapper.add(i,r):i=this.contentWrapper.add(i,r),i}getWrapper(t){return this.wrappers.get(t)}getFocusedWrapper(){return Array.from(this.wrappers.values()).map(({models:t})=>t.value).flat().find(t=>t.options.focused)}addWrapper(t){return this.wrappers.set(t.id,t),t.id}removeWrapper(t){typeof t!="string"&&(t=t.id),this.wrappers.delete(t)}isContextMenu(t){return t.id===this.getActiveContextMenu().id}setup(){this.contextMenu.addDefaultItems(new Xe(ra,{core:this.core})),this.contextMenu.addDefaultItems(new Xe(Gt,{core:this.core}))}clear(){this.contentWrapper.clear(),this.globalWrapper.clear()}getActiveContextMenu(){return this.contextMenu.getActiveItems()}setActiveContextMenu(t){return this.contextMenu.setActiveItems(t)}}const Sa={[w.DEFAULT]:()=>g(()=>import("./_JMdGGz8.js"),__vite__mapDeps([55,3]),import.meta.url).then(a=>a.default),[w.DIRECTORY]:()=>g(()=>import("./DL6-OeHf.js"),__vite__mapDeps([56,3]),import.meta.url).then(a=>a.default),[w.DIRECTORY_PREFS]:()=>g(()=>import("./Da08gh79.js"),__vite__mapDeps([57,3]),import.meta.url).then(a=>a.default),[w.CLOUD_DISK]:()=>g(()=>import("./DAg-IR-e.js"),__vite__mapDeps([58,3]),import.meta.url).then(a=>a.default),[w.HARD_DISK]:()=>g(()=>import("./DYZJdah4.js"),__vite__mapDeps([59,3]),import.meta.url).then(a=>a.default),[w.RAM_DISK]:()=>g(()=>import("./DQOUG96d.js"),__vite__mapDeps([60,3]),import.meta.url).then(a=>a.default),[w.TMP_DISK]:()=>g(()=>import("./BRod885_.js"),__vite__mapDeps([61,3]),import.meta.url).then(a=>a.default),[w.DISK_1]:()=>g(()=>import("./DCegKuwx.js").then(a=>a.d),__vite__mapDeps([62,63,40,64,6,7,3,8,9,10,23,22,24,25,26,27,28,1,65,66,67,68,69,36,37,70]),import.meta.url).then(a=>a.default),[w.DISK_2]:()=>g(()=>import("./Bcq-nyF3.js"),__vite__mapDeps([71,3]),import.meta.url).then(a=>a.default),[w.DISK_WORKBENCH13]:()=>g(()=>import("./BrnYFkyh.js"),__vite__mapDeps([72,3]),import.meta.url).then(a=>a.default),[w.DISK_MARKDOWN]:()=>g(()=>import("./eBXRN4wu.js"),__vite__mapDeps([73,3]),import.meta.url).then(a=>a.default),[w.DISK_BASIC]:()=>g(()=>import("./IkWbOj4M.js"),__vite__mapDeps([74,3]),import.meta.url).then(a=>a.default),[w.WORK]:()=>g(()=>import("./DbsAJ1wc.js"),__vite__mapDeps([75,3]),import.meta.url).then(a=>a.default),[w.CONSOLE]:()=>g(()=>import("./fq_v9z0v.js"),__vite__mapDeps([76,3]),import.meta.url).then(a=>a.default),[w.SETTINGS]:()=>g(()=>import("./4DDNh6tc.js"),__vite__mapDeps([77,3]),import.meta.url).then(a=>a.default),[w.TRASHCAN]:()=>g(()=>import("./DtBDrrlO.js"),__vite__mapDeps([78,3]),import.meta.url).then(a=>a.default),[w.COMPUTER_1]:()=>g(()=>import("./Ca_RXg2H.js"),__vite__mapDeps([79,3]),import.meta.url).then(a=>a.default),[w.TELEPHONE]:()=>g(()=>import("./D54PQ1Ai.js"),__vite__mapDeps([80,3]),import.meta.url).then(a=>a.default),[w.CURSOR]:()=>g(()=>import("./aR-c4dp6.js"),__vite__mapDeps([81,3]),import.meta.url).then(a=>a.default),[w.PREFERENCE]:()=>g(()=>import("./BSJz-noo.js"),__vite__mapDeps([82,3]),import.meta.url).then(a=>a.default),[w.WEB_BASIC]:()=>g(()=>import("./9goD9h78.js"),__vite__mapDeps([83,3]),import.meta.url).then(a=>a.default),[w.WEB_PAINTING]:()=>g(()=>import("./To25sE6P.js"),__vite__mapDeps([84,3]),import.meta.url).then(a=>a.default),[w.COLORS]:()=>g(()=>import("./C-kUqqHQ.js"),__vite__mapDeps([85,3]),import.meta.url).then(a=>a.default),[w.PRINT_1]:()=>g(()=>import("./xaBB-X9e.js"),__vite__mapDeps([86,3]),import.meta.url).then(a=>a.default),[w.PRINT_2]:()=>g(()=>import("./CYbhhVTB.js"),__vite__mapDeps([87,3]),import.meta.url).then(a=>a.default),[w.NOTEPAD]:()=>g(()=>import("./BuCB7tGk.js"),__vite__mapDeps([88,3]),import.meta.url).then(a=>a.default),[w.BASIC]:()=>g(()=>import("./CztbXIR3.js"),__vite__mapDeps([89,3]),import.meta.url).then(a=>a.default),[w.IMAGE]:()=>g(()=>import("./DIn2FXiD.js"),__vite__mapDeps([90,3]),import.meta.url).then(a=>a.default),[w.NOTE]:()=>g(()=>import("./BtrkvE0t.js"),__vite__mapDeps([91,3]),import.meta.url).then(a=>a.default),[w.NOTE_BLANK]:()=>g(()=>import("./CsyPOYyp.js"),__vite__mapDeps([92,3]),import.meta.url).then(a=>a.default),[w.LARGE_NOTE]:()=>g(()=>import("./BntSCJuW.js"),__vite__mapDeps([93,3]),import.meta.url).then(a=>a.default),[w.LARGE_NOTE_RICH]:()=>g(()=>import("./C257ATGS.js"),__vite__mapDeps([94,3]),import.meta.url).then(a=>a.default),[w.FULLSCREEN]:()=>g(()=>import("./BjPn19nA.js"),__vite__mapDeps([95,3]),import.meta.url).then(a=>a.default),[w.CALCULATOR]:()=>g(()=>import("./92a_xlrI.js"),__vite__mapDeps([96,3]),import.meta.url).then(a=>a.default),[w.CLOCK]:()=>g(()=>import("./Bvm3nXRb.js"),__vite__mapDeps([97,3]),import.meta.url).then(a=>a.default),[w.KEYBOARD_QUESTION]:()=>g(()=>import("./B2cSGNdA.js"),__vite__mapDeps([98,3]),import.meta.url).then(a=>a.default),[w.LARGE_NOTEPAD]:()=>g(()=>import("./BkTYNy84.js"),__vite__mapDeps([99,3]),import.meta.url).then(a=>a.default),[w.LARGE_NOTEPAD_HELP]:()=>g(()=>import("./Bt3gnWuQ.js"),__vite__mapDeps([100,3]),import.meta.url).then(a=>a.default),[w.RABBIT]:()=>g(()=>import("./UZYWONdB.js"),__vite__mapDeps([101,3]),import.meta.url).then(a=>a.default),[w.MORE]:()=>g(()=>import("./At0wDPo9.js"),__vite__mapDeps([102,3]),import.meta.url).then(a=>a.default),[w.SAY]:()=>g(()=>import("./BumnFGeb.js"),__vite__mapDeps([103,3]),import.meta.url).then(a=>a.default),[w.GITHUB]:()=>g(()=>import("./he4oskg3.js"),__vite__mapDeps([104,3]),import.meta.url).then(a=>a.default),[w.LAMMPEE]:()=>g(()=>import("./BUotbKXJ.js"),__vite__mapDeps([105,3]),import.meta.url).then(a=>a.default),[w.CUBY]:()=>g(()=>import("./E8FB1OjU.js"),__vite__mapDeps([106,3]),import.meta.url).then(a=>a.default),[w.NUXT]:()=>g(()=>import("./Xqi6U2Zu.js"),__vite__mapDeps([107,3]),import.meta.url).then(a=>a.default),[w.CLOWN]:()=>g(()=>import("./dCDVMCRi.js"),__vite__mapDeps([108,3]),import.meta.url).then(a=>a.default),[w.DISALLOW_1]:()=>g(()=>import("./DYcmhopS.js"),__vite__mapDeps([109,3]),import.meta.url).then(a=>a.default),[w.COPY_1]:()=>g(()=>import("./Y1zWTHV-.js"),__vite__mapDeps([110,3]),import.meta.url).then(a=>a.default),[w.COPY_2]:()=>g(()=>import("./Cbi2UzLH.js"),__vite__mapDeps([111,3]),import.meta.url).then(a=>a.default),[w.DISPLAY_KEYBOARD]:()=>g(()=>import("./DjU8GORk.js"),__vite__mapDeps([112,3]),import.meta.url).then(a=>a.default),[w.PALETTE]:()=>g(()=>import("./GNnvmWBb.js"),__vite__mapDeps([113,3]),import.meta.url).then(a=>a.default),[w.SIGN_1]:()=>g(()=>import("./D_-ZfEZH.js"),__vite__mapDeps([114,3]),import.meta.url).then(a=>a.default),[w.DOCUMENT_EDITOR]:()=>g(()=>import("./DUKXdUn1.js"),__vite__mapDeps([115,3]),import.meta.url).then(a=>a.default),[w.DOCUMENT_READER]:()=>g(()=>import("./BOp0u3Oj.js"),__vite__mapDeps([116,3]),import.meta.url).then(a=>a.default),[w.SYNTHESIZER]:()=>g(()=>import("./D6ImQKfV.js"),__vite__mapDeps([117,3]),import.meta.url).then(a=>a.default),[w.VUE_SEMANTIC_STRUCTURE]:()=>g(()=>import("./40MWhL9K.js"),__vite__mapDeps([118,3]),import.meta.url).then(a=>a.default),[w.NUXT_BOOSTER]:()=>g(()=>import("./DuVZGx5L.js"),__vite__mapDeps([119,3]),import.meta.url).then(a=>a.default)},Ia=Ke(({module:a,core:e})=>[{order:30,title:"Symbol",items:[{type:W.CHECKBOX,title:"Show Invisible Symbols",model:e.config.observable,name:D.SHOW_INVISIBLE_SYMBOLS,action(t){return e.config.set(D.SHOW_INVISIBLE_SYMBOLS,t)}},{title:"Rearrange Symbols",hotKey:"R",keyCode:82,action(){const t=a.getDefaultWrapper(),r=a.getPrimaryWrapper();if(r instanceof we&&(r==null?void 0:r.id)!==(t==null?void 0:t.id)){if(r==null||r.rearrangeIcons(),r!=null&&r.fsItem)return Ne(r==null?void 0:r.fsItem);throw new Error("No fsItem found")}else if(t instanceof we){if(t==null||t.rearrangeIcons({root:!0}),t!=null&&t.fsItem)return Ne(t==null?void 0:t.fsItem);throw new Error("No fsItem found")}}},{title:"Order Type",items:[{model:e.config.observable,type:W.RADIO,name:D.ORDER_TYPE,value:K.NAME,title:"Name",action(){return e.config.set(D.ORDER_TYPE,K.NAME)}},{model:e.config.observable,type:W.RADIO,name:D.ORDER_TYPE,value:K.TYPE,title:"Type",action(){return e.config.set(D.ORDER_TYPE,K.TYPE)}},{model:e.config.observable,type:W.RADIO,name:D.ORDER_TYPE,value:K.CREATED_DATE,title:"Created Date",action(){return e.config.set(D.ORDER_TYPE,K.CREATED_DATE)}},{model:e.config.observable,type:W.RADIO,name:D.ORDER_TYPE,value:K.EDITED_DATE,title:"Edited Date",action(){return e.config.set(D.ORDER_TYPE,K.EDITED_DATE)}}]},{title:"Order Direction",items:[{model:e.config.observable,type:W.RADIO,name:D.ORDER_DIRECTION,value:fe.ASCENDING,title:"Ascending",action(){return e.config.set(D.ORDER_DIRECTION,fe.ASCENDING)}},{model:e.config.observable,type:W.RADIO,name:D.ORDER_DIRECTION,value:fe.DESCENDING,title:"Descending",action(){return e.config.set(D.ORDER_DIRECTION,fe.DESCENDING)}}]}]}]),ba=({module:a})=>[{name:["rearrangeIcons"],description:"Rearrange Icons",args:[new d({name:"id",description:"Wraper id"}),new d({name:"root",description:"Use root wrapper",flag:!0})],async action({id:e,root:t}){const r=a.getDefaultWrapper(),i=a.getPrimaryWrapper();if(await new Promise(s=>window.requestAnimationFrame(s)),t){if(r.fsItem)return r==null||r.rearrangeIcons({root:!0}),Ne(r.fsItem);throw new Error("No fsItem found")}else{let s=i;if(e&&(s=a.get(e),s instanceof we&&s.fsItem))return s.rearrangeIcons(),Ne(s.fsItem)}}}];function ya(){return{[D.SHOW_INVISIBLE_SYMBOLS]:!1,[D.ORDER_TYPE]:K.NAME,[D.ORDER_DIRECTION]:fe.ASCENDING}}class va extends Pe{}class bt extends xe{constructor(t){const{core:r}=Object.assign({core:null},t);super({name:"Symbols",config:ya(),commands:ba,contextMenu:Ia,core:r});_(this,"events",L(new Jt));_(this,"symbols",L(new Map));_(this,"wrappers",L(new Map));_(this,"wrappersObservable",{});_(this,"hasSelectedItems",!1);_(this,"_activeWrapper");_(this,"_defaultWrapper");_(this,"activeWrapper");_(this,"defaultWrapper");_(this,"primaryWrapper");_(this,"secondaryWrapper")}addWrapper(t){return t=L(t),this.wrappers.set(t.id,t),this.wrappersObservable[t.id]=t,t.events.subscribe(this.onEventWrapper.bind(this)),t.id}onEventWrapper({name:t,value:r}){var i;r!=null&&r.wrapper&&(t==="selectItem"||t==="unselectItem")&&(this.hasSelectedItems=((i=r==null?void 0:r.wrapper.selectedItems.value)==null?void 0:i.length)>0,this.events.next(new va({name:"hasSelectedItems",value:this.hasSelectedItems})))}getWrapper(t){return typeof t!="string"&&(t=t.id),this.wrappers.get(t)}removeWrapper(t){typeof t!="string"&&(t=t.id),this.wrappers.delete(t),Reflect.deleteProperty(this.wrappersObservable,t)}getActiveWrapper(t=!1){var i;const r=(i=this.core.modules.windows)==null?void 0:i.contentWrapper.getActiveWindow();return r&&r.symbolWrapper?r.symbolWrapper:t?null:this.activeWrapper}getSelectedItems(){return Array.from(this.wrappers.values()).reduce((t,r)=>(r.selectedItems.value.forEach(s=>{const n=r.get(s);n&&t.push(n)}),t),[])}clearSelectedItems(){return Array.from(this.wrappers.values()).forEach(t=>{t.clearSelectedItems()})}async addFileSystemWrapper(t,r=!1){const i=new we(this.core,void 0,r);return await i.setup(t),this.addWrapper(i)}async setup(){var r;const t=(r=this.core.modules.files)==null?void 0:r.fs.root;t&&(await this.loadCoreSymbols(),this.setDefaultWrapper(await this.addFileSystemWrapper(t,!0)))}loadCoreSymbols(){return Promise.all(Object.values(w).map(async t=>this.symbols.set(t,await Sa[t]())))}get(t){return this.wrappers.get(t)}setDefaultWrapper(t){this._defaultWrapper=t;const r=this.wrappers.get(t);r&&(this.primaryWrapper=r,this.secondaryWrapper=r,this.activeWrapper=r,this.defaultWrapper=r)}getDefaultWrapper(){return this.defaultWrapper}getPrimaryWrapper(){return this.primaryWrapper||this.defaultWrapper}getSecondaryWrapper(){return this.secondaryWrapper||this.defaultWrapper}setPrimaryWrapper(t){if(t){let r;t instanceof We?r=t.id:r=t,this.primaryWrapper=this.wrappers.get(r)}else this.primaryWrapper=void 0;this.events.next(new Pe({name:"setPrimaryWrapper",value:this.getPrimaryWrapper()}))}setSecondaryWrapper(t){if(t){let r;t instanceof We?r=t.id:r=t,this.secondaryWrapper=this.wrappers.get(r)}else this.primaryWrapper=void 0;this.events.next(new Pe({name:"setSecondaryWrapper",value:this.secondaryWrapper}))}setActiveWrapper(t){let r;t instanceof We?r=t.id:r=t;let i=this.wrappers.get(this._activeWrapper||"");return r!==this._activeWrapper&&(this._activeWrapper=r,this.activeWrapper=this.wrappers.get(this._activeWrapper),i=this.activeWrapper||this.wrappers.get(this._defaultWrapper||""),this.events.next(new Pe({name:"setActiveWrapper",value:i}))),i}addSymbol(t,r){this.symbols.set(t,r)}removeSymbol(t){this.symbols.delete(t)}}_(bt,"NAME","Symbols");function Aa(){const a=new Rt;return a.addModule(Xr),a.addModule(It),a.addModule(_a),a.addModule(bt),a}const ds=Aa();export{ds as default};
