var y=Object.defineProperty;var m=e=>{throw TypeError(e)};var O=(e,t,r)=>t in e?y(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r;var n=(e,t,r)=>O(e,typeof t!="symbol"?t+"":t,r),_=(e,t,r)=>t.has(e)||m("Cannot "+r);var o=(e,t,r)=>(_(e,t,"read from private field"),r?r.call(e):t.get(e)),h=(e,t,r)=>t.has(e)?m("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(e):t.set(e,r);class c{constructor(t){n(this,"id");n(this,"_locked",!1);n(this,"storage");n(this,"name");n(this,"_data",[]);this.id=t.id,this._locked=t.locked||this._locked,this.storage=t.storage,this.name=t.name}get locked(){return this._locked}get data(){return this._data}set data(t){this._data=t}async mount(...t){return this}async unmount(...t){return this}getItem(t){throw new Error("not implemented")}setItem(t,r){throw new Error("not implemented")}async load(){if(!this.storage)throw new Error("no storage");return this._data}async save(t){if(!this.storage)throw new Error("no storage");return this._data=t||this._data,this._data}}class i{isLogged(){throw new Error("Method not implemented.")}getItem(t){throw new Error("Method not implemented.")}setItem(t,r){throw new Error("Method not implemented.")}removeItem(t){throw new Error("Method not implemented.")}clear(){throw new Error("Method not implemented.")}}var a;class A extends i{constructor(){super(...arguments);h(this,a,new Map)}isLogged(){return!0}getItem(r){return o(this,a).get(r)||null}setItem(r,s){o(this,a).set(r,s)}removeItem(r){o(this,a).delete(r)}clear(){o(this,a).clear()}}a=new WeakMap;class f extends c{constructor(t){super({...t,storage:new A})}}class $ extends i{isLogged(){return!0}getItem(t){return localStorage.getItem(t)}setItem(t,r){localStorage.setItem(t,JSON.stringify(r))}removeItem(t){localStorage.removeItem(t)}clear(){localStorage.clear()}}class I extends c{async mount(){let t;if(this.storage instanceof c){const r=this.storage;try{if(t=r.getItem(this.name),t){if(t=JSON.parse(t),!t||!(t instanceof Object))throw new Error("json invalid")}else throw new Error("json invalid")}catch(s){console.error(s),t={}}this.storage.setItem(this.name,t)}return this}async load(){return this.storage&&this.storage instanceof i&&(this.data=JSON.parse(this.storage.getItem(this.name)||"[]")),this.data}async save(t){return this.storage&&this.storage instanceof i&&(this.data=t||this.data,this.storage.setItem(this.name,this.data)),this.data}}class N extends I{constructor(t){super({...t,storage:new $})}}class E extends i{isLogged(){return!0}getItem(t){return sessionStorage.getItem(t)}setItem(t,r){sessionStorage.setItem(t,JSON.stringify(r))}removeItem(t){sessionStorage.removeItem(t)}clear(){sessionStorage.clear()}}class L extends I{constructor(t){super({...t,storage:new E})}}class b extends c{constructor(t){super({...t})}isLogged(){throw new Error("Not implemented")}}var k=(e=>(e[e.NONE=0]="NONE",e[e.AUTO=1]="AUTO",e[e.TEMP=3]="TEMP",e[e.LOCAL=4]="LOCAL",e[e.SESSION=5]="SESSION",e[e.CLOUD=6]="CLOUD",e))(k||{});function R(e){switch(e){case 3:return f;case 4:return N;case 5:return L;case 6:return b;default:return f}}function F(e){return typeof e=="string"&&u(e.trim())}const x=['"',"'"];function B(e,t='"'){return u(e)?e:(e=e.replace(/"/g,'\\"'),`${t}${e}${t}`)}function J(e){return e.length===2&&e[0]===e[e.length-1]&&u(e)}function u(e){return e[0]===e[e.length-1]&&x.includes(e[0])}function T(e){if(typeof e=="string"){const t=e.trim();if(u(t))return t.slice(1,e.length-1)}return e}function z(e){return typeof e=="boolean"||e==="true"||e==="false"}function W(e){return!isNaN(e)&&!isNaN(parseFloat(e))}function V(e){return decodeURIComponent(globalThis.atob(e))}function Z(e){return globalThis.btoa(encodeURIComponent(e))}class C{constructor(){n(this,"items",new Map)}add(t,r){Array.isArray(t)?t.forEach(([s,g])=>{this.add(s,g)}):r&&(Array.isArray(r)||(r=[r]),this.items.set(t,r))}get(...t){var s;const r=t.shift()||"";return(s=this.items.get(r))==null?void 0:s.map(g=>t.reduce((w,S)=>w.replace(/%\d+/,S),g))}}const d=new C;d.add("bad_args","Bad args");d.add("cant_find","Can't find %1");const q="/",H="ROOT",K="CLOUD";function G(e){return typeof e=="object"&&"id"in e?e.id:e.replace(/.*[\\/:]{1,1}([^:\\/]+)$/,"$1")}function P(e){return/^[a-zA-Z0-9_-]+:/.test(e)}function Q(...e){return e.reduce((t,r)=>(t.push(...r.replace(/[\\/]+/,"/").replace(/^\//,"").replace(/\/$/,"").split("/")),t),[]).join("/").replace(/:\//,":").replace(/\/$/,"")}function X(e){return e.replace(/(.*)[:/]([^\\/:]+)/,"$1")}function v(e){return e.replace(/^(.*)[\\/:]([^\\/:]+)$/,"$2")}function Y(e){return e.replace(/(.*[\\/:]{1,1})[^:\\/]+$/,"$1")}function M(e){return e.length&&/^[\w .\\/:-]+$/.test(e)}function ee(e){return M(e)&&!!(e.includes("/")||e.match(/^([^:]+):.*/))}function te(e){return e*1e3}function j(e){return e.replace(/^(.*)\.[^.]+$/,"$1")}function re(e){const t=e.match(/^.*\.([^.]*)$/);return t?t[1]:""}function se(e){return e.replace(/[^.a-zA-Z0-9_-]/g,"_")}function p(e,t){return t?`${j(e)}.${t}`:e}function D(e,t,r){let s=e;return t.hasItem(p(s,r))?(s=`copy_${e}`,t.hasItem(p(s,r))?D(s,t,r):s):s}async function ne(e){var t;if(e.locked)throw new Error((t=d.get("FileSystemItem_itemLocked",await e.getPath()))==null?void 0:t.join(" "));return e}function ae(e){var r;const t=l(e);if(t){if(t!=null&&t.locked)throw new Error((r=d.get("FileSystem_permissionsNeeded"))==null?void 0:r.join(" "));return e}return e}async function oe(e,t){return t=t||l(e),t&&(await e.save(),await t.save()),e}async function ie(e,t){const r=await t.remove({recursive:e});return Array.isArray(r)?r:[r]}function l(e){if(e.storage)return e;if(e.parent)return l(e.parent)}export{P as A,ne as B,b as C,ie as D,J as E,F,q as P,H as R,i as S,k as T,W as a,p as b,V as c,l as d,d as e,se as f,G as g,Z as h,z as i,re as j,te as k,D as l,M as m,Y as n,f as o,Q as p,R as q,j as r,oe as s,K as t,T as u,ee as v,B as w,ae as x,X as y,v as z};
