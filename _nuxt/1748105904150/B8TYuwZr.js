import{d as $,r as b,k as R,a2 as A,o as Y,Y as j,v as d,x as p,$ as z,y as i,G as E,a0 as M,E as r,a5 as P,ae as O,R as W,_ as J}from"./CFj-hhFp.js";import{e as c}from"./DG6QdPnO.js";import{d as k}from"./B3mcEltb.js";import{a as H,c as Q}from"./DXnSAPcy.js";import{o as X,S as U}from"./6C4StZv5.js";import{c as Z,f as ee}from"./CSlkdJUE.js";import{f as K}from"./Cdv5LwuB.js";import{a as ne}from"./WL2z-xAH.js";function le(f,m){return m===void 0&&(m=ne),X(function(S,u){var l=null,o=null,v=null,L=function(){if(l){l.unsubscribe(),l=null;var a=o;o=null,u.next(a)}};function t(){var a=v+f,y=m.now();if(y<a){l=this.schedule(void 0,a-y),u.add(l);return}L()}S.subscribe(Z(u,function(a){o=a,v=m.now(),l||(l=m.schedule(t,f),u.add(l))},function(){L(),u.complete()},void 0,function(){o=l=null}))})}const te={class:"result"},ae=["innerHTML"],se=["innerHTML"],ue=["innerHTML"],oe=["innerHTML"],ie=["innerHTML"],re=["innerHTML"],ce=["innerHTML"],ve=["innerHTML"],de={key:1,class:"selected"},pe=["innerHTML"],fe=["innerHTML"],me={class:"input"},ye=["readonly"],_e=["readonly"],Te=$({__name:"InputText",props:{rootElement:{type:HTMLElement,default(){return null}},overrideFocused:{type:Boolean,default:!1},readonly:{type:Boolean,required:!1,default:!1},multiline:{type:Boolean,required:!1,default:!0},name:{type:String,default:"value"},modelValue:{type:String,default:void 0},model:{type:Object,required:!1,default(){return{value:"Input Value"}}}},emits:["blur","refresh","input","update:model-value","enter","keydown","keyup"],setup(f,{expose:m,emit:S}){const u=f,l=S,o=b(null),v=b(u.overrideFocused),L=b(0),t=b(0),a=b(0),y=b(!1),g=b(!1);let _=new U;const n=R({get(){return u.modelValue||""},set(e){l("update:model-value",e)}}),q=R(()=>({readonly:u.readonly,multiline:u.multiline,"selection-empty":!L.value,focused:v.value,"shift-active":y.value,"caps-lock-active":g.value}));A(()=>u.overrideFocused,e=>{v.value=e}),A(()=>v.value,e=>{e?F():I()}),Y(()=>{var e;(e=o.value)==null||e.setSelectionRange(n.value.length,n.value.length),T(),v.value&&F()}),j(()=>{_.unsubscribe()});function F(){var e;_.add(k.pointerDown.pipe(ee(({target:s})=>{var D;const h=W(),N=u.rootElement||((D=h==null?void 0:h.parent)==null?void 0:D.vnode.el);return!Q(s,N)}),K()).subscribe(I)),_.add(k.keyPress.subscribe(()=>{var s;(s=o.value)==null||s.focus()})),_.add(k.keyDown.subscribe(({code:s})=>{switch(s){case H.SHIFT_LEFT:case H.SHIFT_RIGHT:y.value=!0;break;case H.CAPS_LOCK:g.value=!g.value;break}})),_.add(k.keyUp.subscribe(s=>{switch(s.code){case H.SHIFT_LEFT:case H.SHIFT_RIGHT:y.value=!1;break}l("keyup",s)})),(e=o.value)==null||e.focus()}function I(){var e;_.unsubscribe(),_=new U,(e=o.value)==null||e.blur(),l("blur")}function T(){const e=o.value;e&&(t.value=e.selectionStart||0,a.value=e.selectionEnd||0,L.value=a.value-t.value,l("refresh"))}function G(e){v.value=e}function x(){const e=k.pointerMove.pipe(le(128)).subscribe(()=>{T()});k.pointerUp.pipe(K()).subscribe(()=>{e.unsubscribe()})}function C(){T(),l("input")}function w(){v.value?T():G(!0)}function B(e){!u.multiline&&e.code===H.ENTER?(e.preventDefault(),e.stopPropagation(),l("enter",n.value),T()):(l("keydown",e),T())}function V(e){l("keyup",e),T()}return m({resetSelection:()=>{var e;(e=o.value)==null||e.setSelectionRange(0,0)},controlShiftActive:y,controlCapsLockActive:g}),(e,s)=>(p(),d("div",{class:z(["wb-env-atom-input-text",q.value])},[i("div",null,[i("div",te,[n.value.length>0&&a.value>0?(p(),d(M,{key:0},[t.value>=0&&a.value===n.value.length?(p(),d(M,{key:0},[i("span",{innerHTML:r(c)(n.value.slice(0,t.value))},null,8,ae),i("span",{class:"selected",innerHTML:r(c)(n.value.slice(t.value,a.value+1))||" "},null,8,se)],64)):t.value&&t.value===a.value?(p(),d(M,{key:1},[i("span",{innerHTML:r(c)(n.value.slice(0,t.value))},null,8,ue),i("span",{class:"selected",innerHTML:r(c)(n.value.slice(t.value,t.value+1))||" "},null,8,oe),i("span",{innerHTML:r(c)(n.value.slice(t.value+1,n.value.length))},null,8,ie)],64)):(p(),d(M,{key:2},[i("span",{innerHTML:r(c)(n.value.slice(0,t.value))},null,8,re),i("span",{class:"selected",innerHTML:r(c)(n.value.slice(t.value,a.value))},null,8,ce),i("span",{innerHTML:r(c)(n.value.slice(a.value,n.value.length))},null,8,ve)],64))],64)):E("",!0),!t.value&&n.value===""?(p(),d("span",de," ")):n.value.length>0&&!t.value&&t.value===a.value?(p(),d(M,{key:2},[i("span",{class:"selected",innerHTML:r(c)(n.value.slice(0,1))},null,8,pe),i("span",{innerHTML:r(c)(n.value.slice(1,n.value.length))},null,8,fe)],64)):E("",!0)]),i("div",me,[f.multiline?P((p(),d("textarea",{key:0,ref_key:"inputEl",ref:o,"onUpdate:modelValue":s[0]||(s[0]=h=>n.value=h),readonly:f.readonly,onPointerdown:x,onInput:C,onClick:w,onKeydown:B,onKeyup:V,onFocus:w},null,40,ye)),[[O,n.value]]):E("",!0),f.multiline?E("",!0):P((p(),d("input",{key:1,ref_key:"inputEl",ref:o,"onUpdate:modelValue":s[1]||(s[1]=h=>n.value=h),type:"text",readonly:f.readonly,onPointerdown:x,onInput:C,onClick:w,onKeydown:B,onKeyup:V,onFocus:w},null,40,_e)),[[O,n.value]])])])],2))}}),Ee=J(Te,[["__scopeId","data-v-68ef80a7"]]);export{Ee as A};
