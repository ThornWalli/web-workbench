import{A as S}from"./B8TYuwZr.js";import{z as T,u as B}from"./DUL3j0kc.js";import{A}from"./Cex6JBLo.js";import{d as h,r as O,v as W,x as g,A as x,_ as y,M as R,k as N,a2 as C,o as K,a3 as I,E as P}from"./CFj-hhFp.js";import{C as M}from"./CxKYomUj.js";import{b as E,c as m}from"./CCMDJ0Cx.js";import{d as V,a as s,b,u as k}from"./udq3idvc.js";import{S as D}from"./DgH9W2OI.js";import{u as F}from"./DOQHPoIb.js";import"./DG6QdPnO.js";import"./B3mcEltb.js";import"./DXnSAPcy.js";import"./BGIFtisS.js";import"./DN3eHOnZ.js";import"./D4lI5vpz.js";import"./Ce6njBYG.js";import"./6C4StZv5.js";import"./DdQrQ7-5.js";import"./CSlkdJUE.js";import"./nufkX4jA.js";import"./RAasLaaH.js";import"./Cdv5LwuB.js";import"./CGDfseBP.js";import"./WL2z-xAH.js";import"./Lxd48n3n.js";import"./DwXabkis.js";import"./BVsX1iIx.js";import"./CVMiNqhH.js";import"./C6SzTwG0.js";import"./CJLX7oOC.js";import"./WGsTKhbz.js";import"./BbB_XbY8.js";import"./9V19AFUE.js";import"./CaAbksje.js";import"./nRhUiaEk.js";import"./BhtCLcUc.js";const H={class:"wb-disks-extras13-web-basic-info"},$=h({__name:"Info",setup(n){const o=O(["# WebBasic",`Version: **1.0**  
Created by **Thorn-Welf Walli**`].join(`
`));return(p,l)=>(g(),W("div",H,[x(A,{content:o.value},null,8,["content"])]))}}),U=y($,[["__scopeId","data-v-89a6d845"]]),X=V(({core:n,model:o})=>{return[new s({order:0,title:"Editor",items:[new s({title:"New",hotKey:{alt:!0,code:"KeyN",title:"N"},action:p}),new s({title:"Open…",hotKey:{alt:!0,code:"KeyO",title:"O"},action:d}),new s({title:"Save",hotKey:{alt:!0,code:"KeyS",title:"S"},action:l}),new s({title:"Save As…",action:i}),new D,new s({hotKey:{alt:!0,code:"KeyI",title:"I"},title:"Info",action:_}),new s({title:"Close",action:w})]}),new s({order:1,title:"Document Settings",items:[new s({title:"Has Window Output",type:b.CHECKBOX,name:M.HAS_WINDOW_OUTPUT,model:o.value})]}),new s({order:1,title:"Run",hotKey:{code:"KeyR",title:"R"},action:v}),new s({order:2,title:"Preview",type:b.CHECKBOX,name:E.WEB_BASIC_SHOW_PREVIEW,model:n.config.observable,action(e){return n.config.set(E.WEB_BASIC_SHOW_PREVIEW,e)}})];function p(){var e;(e=o.actions)==null||e.reset()}function l(){return f()}function i(){return f(!0)}async function f(e=!1){const r={...o.value,content:o.value[m.CONTENT].split(/\n/g)},c=await T(JSON.stringify(r));let a;if(!e&&o.fsItem)return a=await n.executeCommand(`editfile "${o.fsItem.getPath()}" --data="${c}"`),a?n.executeCommand('openDialog "File saved."'):n.executeCommand('openDialog "File could not be saved."');{const t=await n.executeCommand(`saveFileDialog --data="${c}" --extension="bs"`);return t?(o.fsItem=R(t),o.fsItem):null}}async function d(){const e=await n.executeCommand("openFileDialog");if(e)if(m.CONTENT in e.value){const r={...e.value,[m.CONTENT]:[].concat(e.value[m.CONTENT]).join(`
`)};o.fsItem=e.fsItem,o.value=r}else throw new Error("Can't read file content")}async function v(){var r;const e=[];await((r=n.modules.parser)==null?void 0:r.parseBasic(o.value[m.CONTENT].split(/\n/),async(c,a)=>{const t=await n.executeCommand(c,a);return a.message&&(Array.isArray(a.message)?e.push(...a.message):e.push(a.message)),t})),o.output=e.map(c=>B(c))}function w(){var e;return(e=o.actions)==null?void 0:e.close()}function _(){var e;(e=n.modules.windows)==null||e.addWindow({component:U,componentData:{model:o},options:{title:"Info",scaleX:!1,scaleY:!1,scrollX:!1,scrollY:!1}},{group:"extras13WebBasic"})}}),Y={class:"wb-disks-extras13-web-basic"},j=h({__name:"WebBasic",props:{model:{}},emits:["refresh","update:value"],setup(n,{emit:o}){const p=O(null),l=o,i=n,{core:f}=k(),{setContextMenu:d,preserveContextMenu:v,parentFocused:w}=F();d(X,{model:i.model}),v();const _=N(()=>i.model.value.content),e=N(()=>{var t;return!!((t=f.value)!=null&&t.config.observable[E.WEB_BASIC_SHOW_PREVIEW])});C(()=>i.model.value,()=>{a()}),C(()=>_.value,t=>{t&&(l("update:value",{...i.model.value,content:t}),I(()=>{var u;(u=p.value)==null||u.resetSelection(),l("refresh",{scroll:!0})}))}),C(()=>e.value,t=>{var u;(u=i.model.actions)==null||u.togglePreview(t)}),K(()=>{e.value&&I(()=>{var t;(t=i.model.actions)==null||t.togglePreview()})});function r(t){l("update:value",{...i.model.value,content:t})}function c(){a()}function a(){I(()=>{l("refresh",{scroll:!0})})}return(t,u)=>(g(),W("div",Y,[x(S,{ref:"input","override-focused":P(w)||!1,"model-value":t.model.value.content,"onUpdate:modelValue":r,onRefresh:c},null,8,["override-focused","model-value"])]))}}),Se=y(j,[["__scopeId","data-v-86da7c15"]]);export{Se as default};
