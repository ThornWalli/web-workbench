import{W as E}from"./BPnw8H1C.js";import{W as b}from"./D9PjJnFw.js";import{W as J}from"./DpGpKT4E.js";import{W as V}from"./BrM1ohlr.js";import{W as k}from"./Cnp2dj6X.js";import{W as g}from"./CcXWfcLA.js";import{_ as T}from"./D3SuBBef.js";import{I as $}from"./ClLpnmyR.js";import{u as z}from"./JsFOm8c5.js";import{d as L,r as y,k as p,y as _,z as d,C as n,D as U,A as i,X as P,Y as G,F as f,G as X,P as W,_ as Y}from"./BkRx7U8b.js";import"./eRs2tlcG.js";import"./OlYXjGCK.js";import"./uxCSd1pF.js";import"./Db7xYFkh.js";import"./BoZA8JgY.js";import"./BTMT_sH9.js";const q={class:"wb-module-files-edit"},H={class:"table-wrapper"},K={class:"items"},Q={class:"name"},R={class:"value"},Z={class:"type"},ee={class:"navigation style-filled"},le={class:"create"},ae=L({__name:"ItemMeta",props:{fsItem:{},model:{}},emits:["close"],setup(N,{emit:C}){const{core:F}=z(),v=y([]),m=N,h=C,t=y(Array.from(m.fsItem.meta.entries()).map(([a,l])=>({name:a,value:l,valid:!0,type:typeof l}))),r=y(),s=p(()=>m.fsItem.locked),S=p(()=>{const a=Array.from(Object.values($)).filter(l=>!w(l)).map(l=>({title:l,value:l}));return a.unshift({title:"Select Item Meta",value:""}),{label:"Item Meta",modelValue:r.value,options:a,"onUpdate:modelValue":l=>{r.value=l}}}),M=p(()=>({hideLabel:!0,label:"Value Format",options:[{title:"String",value:"string"},{title:"Number",value:"number"},{title:"Boolean",value:"boolean"},{title:"JSON",value:"object"}]}));function w(a){return t.value.some(l=>l.name===a)}function B(a){return t.value.find(l=>l.name===a)}function c(a,l){const e=B(a);if(e.type==="boolean")e.value=l==="true",e.valid=typeof e.value=="boolean"&&e.value!==null&&e.value!==void 0;else if(e.type==="number")e.value=Number(l),e.valid=!isNaN(e.value)&&e.value!==null&&e.value!==void 0;else if(e.type==="string")e.value=String(l),e.valid=e.value!==null&&e.value!==void 0;else try{e.value=JSON.parse(l),e.valid=e.value!==null&&e.value!==void 0}catch(u){e.valid=!1,console.warn(u)}}function x(a,l){const e=t.value.find(u=>u.name===a);if(e){if(e.valid=!0,l==="string")e.value=String(e?.value||""),e.valid=e.value!==null&&e.value!==void 0;else if(l==="number")e.value=Number(e?.value||""),e.valid=!isNaN(e.value)&&e.value!==null&&e.value!==void 0;else if(l==="boolean")e.value=!!e?.value,e.valid=typeof e.value=="boolean"&&e.value!==null&&e.value!==void 0;else if(l==="object")try{e.value=JSON.parse(String(e?.value||""))}catch(u){e.valid=!1,console.warn(u)}}}const I=p(()=>t.value.some(a=>!a.valid));function A(){h("close")}async function O(){if(!m.fsItem.locked&&!I.value){const a=Object.fromEntries(t.value.map(l=>[l.name,l.value]));await m.model.actions.saveItemMeta(m.fsItem,a,!0),h("close")}}function j(){r.value&&t.value.push({name:r.value||"",value:"",valid:!0,type:"string"}),r.value=""}function D(){t.value=t.value.filter(a=>!v.value.includes(a.name))}return(a,l)=>(d(),_("div",q,[n(E,{class:"form",onSubmit:O},{default:U(()=>[i("div",H,[i("div",K,[(d(!0),_(P,null,G(t.value,(e,u)=>(d(),_("div",{key:u,class:"item"},[i("div",Q,[n(k,{modelValue:v.value,"onUpdate:modelValue":l[0]||(l[0]=o=>v.value=o),disabled:s.value,label:e.name,value:e.name},null,8,["modelValue","disabled","label","value"])]),i("div",R,[e.name==="symbol"?(d(),f(T,{key:0,disabled:s.value,core:X(F),"hide-label":"",label:e.name,"model-value":e.value,"onUpdate:modelValue":o=>c(e.name,o)},null,8,["disabled","core","label","model-value","onUpdate:modelValue"])):typeof e.value=="boolean"?(d(),f(k,{key:1,disabled:s.value,"hide-label":"",label:e.name,"model-value":e.value,"onUpdate:modelValue":o=>c(e.name,o)},null,8,["disabled","label","model-value","onUpdate:modelValue"])):typeof e.value=="string"?(d(),f(V,{key:2,disabled:s.value,fluid:"",resize:"vertical","hide-label":"",label:e.name,"model-value":e.value,"onUpdate:modelValue":o=>c(e.name,o)},null,8,["disabled","label","model-value","onUpdate:modelValue"])):(d(),f(V,{key:3,disabled:s.value,fluid:"",resize:"vertical","hide-label":"",label:e.name,"model-value":JSON.stringify(e.value)||"","onUpdate:modelValue":o=>c(e.name,o)},null,8,["disabled","label","model-value","onUpdate:modelValue"]))]),i("div",Z,[n(g,W({disabled:s.value,"model-value":e.type},{ref_for:!0},M.value,{"onUpdate:modelValue":o=>x(e.name,o)}),null,16,["disabled","model-value","onUpdate:modelValue"])])]))),128))])]),i("div",ee,[i("div",le,[n(g,W({disabled:s.value,"hide-label":""},S.value),null,16,["disabled"]),n(b,{disabled:!r.value,label:"Add","style-type":"secondary",onClick:j},null,8,["disabled"]),n(b,{disabled:v.value.length<1,label:`DeleteÂ (${v.value.length})`,"style-type":"secondary",onClick:D},null,8,["disabled","label"])]),n(J,{align:"outer",full:""},{default:U(()=>[n(b,{label:"Cancel","style-type":"secondary",onClick:A}),n(b,{disabled:s.value||I.value,label:"Save","style-type":"secondary",type:"submit"},null,8,["disabled"])]),_:1})])]),_:1})]))}}),he=Y(ae,[["__scopeId","data-v-9bbc55a0"]]);export{he as default};
