const __vite__fileDeps=["./iR7RlvsB.js","./DX0JcNNQ.js","./C5mdboMC.js","./BuOCOTVg.js","./BYo4aVUG.js","./M8GEtR2b.js","./C6Atypec.js","./D5YWn_G_.js","./DYpn9OZY.js","./CX07HlZO.js","./Du-wqy0K.js","./D9mEQk3-.js","./CvYFf7ro.js","./DG0AGynt.js","./CQevHdkW.js","./CDEnbuoY.js","./BOjWWVT9.js","./BAfAdOZN.js","./PX9liy6B.js","./D5f2kSBt.js","./CGQYWxZI.js","./BPYBmYvS.js","./BRkJV5VI.js","./CaPctdXg.js","./Bm9KeftK.js","./Cl5zsZzH.js","./DAxX-T3A.js","./DRZbjGCy.js","./-aSK4457.js","./CUqERPoj.js","./KvhaOfvu.js","./CdTrGCMS.js","./DNYj7zwz.js","./CH1IE1qC.js","./Brip0eHB.js","./C9UENgWi.js","./C6hlHM7V.js","./QOQ04Ux-.js","./CSnpy7qV.js","./C9ZDYCkk.js","./BWrSqntS.js","./D4Q0FgGI.js","./BPMq7uNv.js","./C5vEFwsC.js","./DfmW4uh2.js","./DvEgEVc3.js","./Cac8DBbn.js","./BKvtO_EN.js","./COJ2Xz6X.js","./Cyw6IrO5.js","./XduFV6HS.js","./4i7cASd3.js","./DdKCA4zR.js","./B7r5w4l0.js","./DHuRhKTd.js","./CpZ9W7Al.js","./C4wAheY-.js","./DgXMpUPi.js","./rPQHpP1j.js","./Bqxd0YcR.js","./CLdSl3R5.js","./BxYi5TQO.js"],__vite__mapDeps=i=>i.map(i=>__vite__fileDeps[i]);
var Il=Object.defineProperty;var Ol=(n,e,t)=>e in n?Il(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t;var p=(n,e,t)=>(Ol(n,typeof e!="symbol"?e+"":e,t),t),Gs=(n,e,t)=>{if(!e.has(n))throw TypeError("Cannot "+t)};var u=(n,e,t)=>(Gs(n,e,"read from private field"),t?t.call(n):e.get(n)),g=(n,e,t)=>{if(e.has(n))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(n):e.set(n,t)},v=(n,e,t,r)=>(Gs(n,e,"write to private field"),r?r.call(n,t):e.set(n,t),t);var Ae=(n,e,t,r)=>({set _(i){v(n,e,i,t)},get _(){return u(n,e,r)}}),ls=(n,e,t)=>(Gs(n,e,"access private method"),t);import{a7 as Ne,K as M,r as Et,a6 as Zo,a8 as Vn,a9 as Al,c as Qo,S as ho,o as kl,aa as Tl,ab as Rl,F as fo,_ as V,t as x,v as T,J as Dn,B as Jo,E as z,A as G,y as Ce,I as W,Y as at,M as ii,a1 as Zt,ac as ea,x as E,Z as Cn,C as Pi,D as Mi,i as k,z as R,O as F,$ as vt,a0 as St,ad as Dl,N as tr,ae as ta,af as Cl,ag as $i,l as Nl,L as O,m as Ll}from"./DX0JcNNQ.js";import{c as tn,k as Pl,a as na}from"./C5mdboMC.js";function Ml(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var ra={exports:{}},K=ra.exports={},We,Fe;function oi(){throw new Error("setTimeout has not been defined")}function ai(){throw new Error("clearTimeout has not been defined")}(function(){try{typeof setTimeout=="function"?We=setTimeout:We=oi}catch{We=oi}try{typeof clearTimeout=="function"?Fe=clearTimeout:Fe=ai}catch{Fe=ai}})();function sa(n){if(We===setTimeout)return setTimeout(n,0);if((We===oi||!We)&&setTimeout)return We=setTimeout,setTimeout(n,0);try{return We(n,0)}catch{try{return We.call(null,n,0)}catch{return We.call(this,n,0)}}}function $l(n){if(Fe===clearTimeout)return clearTimeout(n);if((Fe===ai||!Fe)&&clearTimeout)return Fe=clearTimeout,clearTimeout(n);try{return Fe(n)}catch{try{return Fe.call(null,n)}catch{return Fe.call(this,n)}}}var tt=[],an=!1,Nt,ps=-1;function Wl(){!an||!Nt||(an=!1,Nt.length?tt=Nt.concat(tt):ps=-1,tt.length&&ia())}function ia(){if(!an){var n=sa(Wl);an=!0;for(var e=tt.length;e;){for(Nt=tt,tt=[];++ps<e;)Nt&&Nt[ps].run();ps=-1,e=tt.length}Nt=null,an=!1,$l(n)}}K.nextTick=function(n){var e=new Array(arguments.length-1);if(arguments.length>1)for(var t=1;t<arguments.length;t++)e[t-1]=arguments[t];tt.push(new oa(n,e)),tt.length===1&&!an&&sa(ia)};function oa(n,e){this.fun=n,this.array=e}oa.prototype.run=function(){this.fun.apply(null,this.array)};K.title="browser";K.browser=!0;K.env={};K.argv=[];K.version="";K.versions={};function ct(){}K.on=ct;K.addListener=ct;K.once=ct;K.off=ct;K.removeListener=ct;K.removeAllListeners=ct;K.emit=ct;K.prependListener=ct;K.prependOnceListener=ct;K.listeners=function(n){return[]};K.binding=function(n){throw new Error("process.binding is not supported")};K.cwd=function(){return"/"};K.chdir=function(n){throw new Error("process.chdir is not supported")};K.umask=function(){return 0};var Fl=ra.exports;const zl=Ml(Fl);var li=function(n,e){return li=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(t[i]=r[i])},li(n,e)};function Mn(n,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");li(n,e);function t(){this.constructor=n}n.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}function xg(n,e){var t={};for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&e.indexOf(r)<0&&(t[r]=n[r]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(n);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(n,r[i])&&(t[r[i]]=n[r[i]]);return t}function Eg(n,e,t,r){var i=arguments.length,s=i<3?e:r===null?r=Object.getOwnPropertyDescriptor(e,t):r,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(n,e,t,r);else for(var a=n.length-1;a>=0;a--)(o=n[a])&&(s=(i<3?o(s):i>3?o(e,t,s):o(e,t))||s);return i>3&&s&&Object.defineProperty(e,t,s),s}function Bl(n,e,t,r){function i(s){return s instanceof t?s:new t(function(o){o(s)})}return new(t||(t=Promise))(function(s,o){function a(d){try{c(r.next(d))}catch(f){o(f)}}function l(d){try{c(r.throw(d))}catch(f){o(f)}}function c(d){d.done?s(d.value):i(d.value).then(a,l)}c((r=r.apply(n,e||[])).next())})}function aa(n,e){var t={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},r,i,s,o;return o={next:a(0),throw:a(1),return:a(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function a(c){return function(d){return l([c,d])}}function l(c){if(r)throw new TypeError("Generator is already executing.");for(;o&&(o=0,c[0]&&(t=0)),t;)try{if(r=1,i&&(s=c[0]&2?i.return:c[0]?i.throw||((s=i.return)&&s.call(i),0):i.next)&&!(s=s.call(i,c[1])).done)return s;switch(i=0,s&&(c=[c[0]&2,s.value]),c[0]){case 0:case 1:s=c;break;case 4:return t.label++,{value:c[1],done:!1};case 5:t.label++,i=c[1],c=[0];continue;case 7:c=t.ops.pop(),t.trys.pop();continue;default:if(s=t.trys,!(s=s.length>0&&s[s.length-1])&&(c[0]===6||c[0]===2)){t=0;continue}if(c[0]===3&&(!s||c[1]>s[0]&&c[1]<s[3])){t.label=c[1];break}if(c[0]===6&&t.label<s[1]){t.label=s[1],s=c;break}if(s&&t.label<s[2]){t.label=s[2],t.ops.push(c);break}s[2]&&t.ops.pop(),t.trys.pop();continue}c=e.call(n,t)}catch(d){c=[6,d],i=0}finally{r=s=0}if(c[0]&5)throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}}function Nn(n){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&n[e],r=0;if(t)return t.call(n);if(n&&typeof n.length=="number")return{next:function(){return n&&r>=n.length&&(n=void 0),{value:n&&n[r++],done:!n}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function Ln(n,e){var t=typeof Symbol=="function"&&n[Symbol.iterator];if(!t)return n;var r=t.call(n),i,s=[],o;try{for(;(e===void 0||e-- >0)&&!(i=r.next()).done;)s.push(i.value)}catch(a){o={error:a}}finally{try{i&&!i.done&&(t=r.return)&&t.call(r)}finally{if(o)throw o.error}}return s}function lr(n,e,t){if(t||arguments.length===2)for(var r=0,i=e.length,s;r<i;r++)(s||!(r in e))&&(s||(s=Array.prototype.slice.call(e,0,r)),s[r]=e[r]);return n.concat(s||Array.prototype.slice.call(e))}function ln(n){return this instanceof ln?(this.v=n,this):new ln(n)}function Vl(n,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r=t.apply(n,e||[]),i,s=[];return i={},o("next"),o("throw"),o("return"),i[Symbol.asyncIterator]=function(){return this},i;function o(h){r[h]&&(i[h]=function(m){return new Promise(function(I,b){s.push([h,m,I,b])>1||a(h,m)})})}function a(h,m){try{l(r[h](m))}catch(I){f(s[0][3],I)}}function l(h){h.value instanceof ln?Promise.resolve(h.value.v).then(c,d):f(s[0][2],h)}function c(h){a("next",h)}function d(h){a("throw",h)}function f(h,m){h(m),s.shift(),s.length&&a(s[0][0],s[0][1])}}function jl(n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=n[Symbol.asyncIterator],t;return e?e.call(n):(n=typeof Nn=="function"?Nn(n):n[Symbol.iterator](),t={},r("next"),r("throw"),r("return"),t[Symbol.asyncIterator]=function(){return this},t);function r(s){t[s]=n[s]&&function(o){return new Promise(function(a,l){o=n[s](o),i(a,l,o.done,o.value)})}}function i(s,o,a,l){Promise.resolve(l).then(function(c){s({value:c,done:a})},o)}}function H(n){return typeof n=="function"}function Wi(n){var e=function(r){Error.call(r),r.stack=new Error().stack},t=n(e);return t.prototype=Object.create(Error.prototype),t.prototype.constructor=t,t}var Hs=Wi(function(n){return function(t){n(this),this.message=t?t.length+` errors occurred during unsubscription:
`+t.map(function(r,i){return i+1+") "+r.toString()}).join(`
  `):"",this.name="UnsubscriptionError",this.errors=t}});function ci(n,e){if(n){var t=n.indexOf(e);0<=t&&n.splice(t,1)}}var Zr=function(){function n(e){this.initialTeardown=e,this.closed=!1,this._parentage=null,this._finalizers=null}return n.prototype.unsubscribe=function(){var e,t,r,i,s;if(!this.closed){this.closed=!0;var o=this._parentage;if(o)if(this._parentage=null,Array.isArray(o))try{for(var a=Nn(o),l=a.next();!l.done;l=a.next()){var c=l.value;c.remove(this)}}catch(b){e={error:b}}finally{try{l&&!l.done&&(t=a.return)&&t.call(a)}finally{if(e)throw e.error}}else o.remove(this);var d=this.initialTeardown;if(H(d))try{d()}catch(b){s=b instanceof Hs?b.errors:[b]}var f=this._finalizers;if(f){this._finalizers=null;try{for(var h=Nn(f),m=h.next();!m.done;m=h.next()){var I=m.value;try{mo(I)}catch(b){s=s??[],b instanceof Hs?s=lr(lr([],Ln(s)),Ln(b.errors)):s.push(b)}}}catch(b){r={error:b}}finally{try{m&&!m.done&&(i=h.return)&&i.call(h)}finally{if(r)throw r.error}}}if(s)throw new Hs(s)}},n.prototype.add=function(e){var t;if(e&&e!==this)if(this.closed)mo(e);else{if(e instanceof n){if(e.closed||e._hasParent(this))return;e._addParent(this)}(this._finalizers=(t=this._finalizers)!==null&&t!==void 0?t:[]).push(e)}},n.prototype._hasParent=function(e){var t=this._parentage;return t===e||Array.isArray(t)&&t.includes(e)},n.prototype._addParent=function(e){var t=this._parentage;this._parentage=Array.isArray(t)?(t.push(e),t):t?[t,e]:e},n.prototype._removeParent=function(e){var t=this._parentage;t===e?this._parentage=null:Array.isArray(t)&&ci(t,e)},n.prototype.remove=function(e){var t=this._finalizers;t&&ci(t,e),e instanceof n&&e._removeParent(this)},n.EMPTY=function(){var e=new n;return e.closed=!0,e}(),n}(),la=Zr.EMPTY;function ca(n){return n instanceof Zr||n&&"closed"in n&&H(n.remove)&&H(n.add)&&H(n.unsubscribe)}function mo(n){H(n)?n():n.unsubscribe()}var ua={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1},da={setTimeout:function(n,e){for(var t=[],r=2;r<arguments.length;r++)t[r-2]=arguments[r];return setTimeout.apply(void 0,lr([n,e],Ln(t)))},clearTimeout:function(n){var e=da.delegate;return((e==null?void 0:e.clearTimeout)||clearTimeout)(n)},delegate:void 0};function ha(n){da.setTimeout(function(){throw n})}function po(){}function gs(n){n()}var Fi=function(n){Mn(e,n);function e(t){var r=n.call(this)||this;return r.isStopped=!1,t?(r.destination=t,ca(t)&&t.add(r)):r.destination=Yl,r}return e.create=function(t,r,i){return new cr(t,r,i)},e.prototype.next=function(t){this.isStopped||this._next(t)},e.prototype.error=function(t){this.isStopped||(this.isStopped=!0,this._error(t))},e.prototype.complete=function(){this.isStopped||(this.isStopped=!0,this._complete())},e.prototype.unsubscribe=function(){this.closed||(this.isStopped=!0,n.prototype.unsubscribe.call(this),this.destination=null)},e.prototype._next=function(t){this.destination.next(t)},e.prototype._error=function(t){try{this.destination.error(t)}finally{this.unsubscribe()}},e.prototype._complete=function(){try{this.destination.complete()}finally{this.unsubscribe()}},e}(Zr),Ul=Function.prototype.bind;function Ys(n,e){return Ul.call(n,e)}var Gl=function(){function n(e){this.partialObserver=e}return n.prototype.next=function(e){var t=this.partialObserver;if(t.next)try{t.next(e)}catch(r){cs(r)}},n.prototype.error=function(e){var t=this.partialObserver;if(t.error)try{t.error(e)}catch(r){cs(r)}else cs(e)},n.prototype.complete=function(){var e=this.partialObserver;if(e.complete)try{e.complete()}catch(t){cs(t)}},n}(),cr=function(n){Mn(e,n);function e(t,r,i){var s=n.call(this)||this,o;if(H(t)||!t)o={next:t??void 0,error:r??void 0,complete:i??void 0};else{var a;s&&ua.useDeprecatedNextContext?(a=Object.create(t),a.unsubscribe=function(){return s.unsubscribe()},o={next:t.next&&Ys(t.next,a),error:t.error&&Ys(t.error,a),complete:t.complete&&Ys(t.complete,a)}):o=t}return s.destination=new Gl(o),s}return e}(Fi);function cs(n){ha(n)}function Hl(n){throw n}var Yl={closed:!0,next:po,error:Hl,complete:po},zi=function(){return typeof Symbol=="function"&&Symbol.observable||"@@observable"}();function fa(n){return n}function Xl(n){return n.length===0?fa:n.length===1?n[0]:function(t){return n.reduce(function(r,i){return i(r)},t)}}var Ge=function(){function n(e){e&&(this._subscribe=e)}return n.prototype.lift=function(e){var t=new n;return t.source=this,t.operator=e,t},n.prototype.subscribe=function(e,t,r){var i=this,s=Kl(e)?e:new cr(e,t,r);return gs(function(){var o=i,a=o.operator,l=o.source;s.add(a?a.call(s,l):l?i._subscribe(s):i._trySubscribe(s))}),s},n.prototype._trySubscribe=function(e){try{return this._subscribe(e)}catch(t){e.error(t)}},n.prototype.forEach=function(e,t){var r=this;return t=go(t),new t(function(i,s){var o=new cr({next:function(a){try{e(a)}catch(l){s(l),o.unsubscribe()}},error:s,complete:i});r.subscribe(o)})},n.prototype._subscribe=function(e){var t;return(t=this.source)===null||t===void 0?void 0:t.subscribe(e)},n.prototype[zi]=function(){return this},n.prototype.pipe=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return Xl(e)(this)},n.prototype.toPromise=function(e){var t=this;return e=go(e),new e(function(r,i){var s;t.subscribe(function(o){return s=o},function(o){return i(o)},function(){return r(s)})})},n.create=function(e){return new n(e)},n}();function go(n){var e;return(e=n??ua.Promise)!==null&&e!==void 0?e:Promise}function ql(n){return n&&H(n.next)&&H(n.error)&&H(n.complete)}function Kl(n){return n&&n instanceof Fi||ql(n)&&ca(n)}function Zl(n){return H(n==null?void 0:n.lift)}function Qt(n){return function(e){if(Zl(e))return e.lift(function(t){try{return n(t,this)}catch(r){this.error(r)}});throw new TypeError("Unable to lift unknown Observable type")}}function Xt(n,e,t,r,i){return new Ql(n,e,t,r,i)}var Ql=function(n){Mn(e,n);function e(t,r,i,s,o,a){var l=n.call(this,t)||this;return l.onFinalize=o,l.shouldUnsubscribe=a,l._next=r?function(c){try{r(c)}catch(d){t.error(d)}}:n.prototype._next,l._error=s?function(c){try{s(c)}catch(d){t.error(d)}finally{this.unsubscribe()}}:n.prototype._error,l._complete=i?function(){try{i()}catch(c){t.error(c)}finally{this.unsubscribe()}}:n.prototype._complete,l}return e.prototype.unsubscribe=function(){var t;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){var r=this.closed;n.prototype.unsubscribe.call(this),!r&&((t=this.onFinalize)===null||t===void 0||t.call(this))}},e}(Fi),Jl=Wi(function(n){return function(){n(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"}}),Me=function(n){Mn(e,n);function e(){var t=n.call(this)||this;return t.closed=!1,t.currentObservers=null,t.observers=[],t.isStopped=!1,t.hasError=!1,t.thrownError=null,t}return e.prototype.lift=function(t){var r=new bo(this,this);return r.operator=t,r},e.prototype._throwIfClosed=function(){if(this.closed)throw new Jl},e.prototype.next=function(t){var r=this;gs(function(){var i,s;if(r._throwIfClosed(),!r.isStopped){r.currentObservers||(r.currentObservers=Array.from(r.observers));try{for(var o=Nn(r.currentObservers),a=o.next();!a.done;a=o.next()){var l=a.value;l.next(t)}}catch(c){i={error:c}}finally{try{a&&!a.done&&(s=o.return)&&s.call(o)}finally{if(i)throw i.error}}}})},e.prototype.error=function(t){var r=this;gs(function(){if(r._throwIfClosed(),!r.isStopped){r.hasError=r.isStopped=!0,r.thrownError=t;for(var i=r.observers;i.length;)i.shift().error(t)}})},e.prototype.complete=function(){var t=this;gs(function(){if(t._throwIfClosed(),!t.isStopped){t.isStopped=!0;for(var r=t.observers;r.length;)r.shift().complete()}})},e.prototype.unsubscribe=function(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null},Object.defineProperty(e.prototype,"observed",{get:function(){var t;return((t=this.observers)===null||t===void 0?void 0:t.length)>0},enumerable:!1,configurable:!0}),e.prototype._trySubscribe=function(t){return this._throwIfClosed(),n.prototype._trySubscribe.call(this,t)},e.prototype._subscribe=function(t){return this._throwIfClosed(),this._checkFinalizedStatuses(t),this._innerSubscribe(t)},e.prototype._innerSubscribe=function(t){var r=this,i=this,s=i.hasError,o=i.isStopped,a=i.observers;return s||o?la:(this.currentObservers=null,a.push(t),new Zr(function(){r.currentObservers=null,ci(a,t)}))},e.prototype._checkFinalizedStatuses=function(t){var r=this,i=r.hasError,s=r.thrownError,o=r.isStopped;i?t.error(s):o&&t.complete()},e.prototype.asObservable=function(){var t=new Ge;return t.source=this,t},e.create=function(t,r){return new bo(t,r)},e}(Ge),bo=function(n){Mn(e,n);function e(t,r){var i=n.call(this)||this;return i.destination=t,i.source=r,i}return e.prototype.next=function(t){var r,i;(i=(r=this.destination)===null||r===void 0?void 0:r.next)===null||i===void 0||i.call(r,t)},e.prototype.error=function(t){var r,i;(i=(r=this.destination)===null||r===void 0?void 0:r.error)===null||i===void 0||i.call(r,t)},e.prototype.complete=function(){var t,r;(r=(t=this.destination)===null||t===void 0?void 0:t.complete)===null||r===void 0||r.call(t)},e.prototype._subscribe=function(t){var r,i;return(i=(r=this.source)===null||r===void 0?void 0:r.subscribe(t))!==null&&i!==void 0?i:la},e}(Me),ma={now:function(){return(ma.delegate||Date).now()},delegate:void 0},ec=function(n){Mn(e,n);function e(t,r,i){t===void 0&&(t=1/0),r===void 0&&(r=1/0),i===void 0&&(i=ma);var s=n.call(this)||this;return s._bufferSize=t,s._windowTime=r,s._timestampProvider=i,s._buffer=[],s._infiniteTimeWindow=!0,s._infiniteTimeWindow=r===1/0,s._bufferSize=Math.max(1,t),s._windowTime=Math.max(1,r),s}return e.prototype.next=function(t){var r=this,i=r.isStopped,s=r._buffer,o=r._infiniteTimeWindow,a=r._timestampProvider,l=r._windowTime;i||(s.push(t),!o&&s.push(a.now()+l)),this._trimBuffer(),n.prototype.next.call(this,t)},e.prototype._subscribe=function(t){this._throwIfClosed(),this._trimBuffer();for(var r=this._innerSubscribe(t),i=this,s=i._infiniteTimeWindow,o=i._buffer,a=o.slice(),l=0;l<a.length&&!t.closed;l+=s?1:2)t.next(a[l]);return this._checkFinalizedStatuses(t),r},e.prototype._trimBuffer=function(){var t=this,r=t._bufferSize,i=t._timestampProvider,s=t._buffer,o=t._infiniteTimeWindow,a=(o?1:2)*r;if(r<1/0&&a<s.length&&s.splice(0,s.length-a),!o){for(var l=i.now(),c=0,d=1;d<s.length&&s[d]<=l;d+=2)c=d;c&&s.splice(0,c+1)}},e}(Me),tc=new Ge(function(n){return n.complete()}),pa=function(n){return n&&typeof n.length=="number"&&typeof n!="function"};function nc(n){return H(n==null?void 0:n.then)}function rc(n){return H(n[zi])}function sc(n){return Symbol.asyncIterator&&H(n==null?void 0:n[Symbol.asyncIterator])}function ic(n){return new TypeError("You provided "+(n!==null&&typeof n=="object"?"an invalid object":"'"+n+"'")+" where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.")}function oc(){return typeof Symbol!="function"||!Symbol.iterator?"@@iterator":Symbol.iterator}var ac=oc();function lc(n){return H(n==null?void 0:n[ac])}function cc(n){return Vl(this,arguments,function(){var t,r,i,s;return aa(this,function(o){switch(o.label){case 0:t=n.getReader(),o.label=1;case 1:o.trys.push([1,,9,10]),o.label=2;case 2:return[4,ln(t.read())];case 3:return r=o.sent(),i=r.value,s=r.done,s?[4,ln(void 0)]:[3,5];case 4:return[2,o.sent()];case 5:return[4,ln(i)];case 6:return[4,o.sent()];case 7:return o.sent(),[3,2];case 8:return[3,10];case 9:return t.releaseLock(),[7];case 10:return[2]}})})}function uc(n){return H(n==null?void 0:n.getReader)}function Qr(n){if(n instanceof Ge)return n;if(n!=null){if(rc(n))return dc(n);if(pa(n))return hc(n);if(nc(n))return fc(n);if(sc(n))return ga(n);if(lc(n))return mc(n);if(uc(n))return pc(n)}throw ic(n)}function dc(n){return new Ge(function(e){var t=n[zi]();if(H(t.subscribe))return t.subscribe(e);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}function hc(n){return new Ge(function(e){for(var t=0;t<n.length&&!e.closed;t++)e.next(n[t]);e.complete()})}function fc(n){return new Ge(function(e){n.then(function(t){e.closed||(e.next(t),e.complete())},function(t){return e.error(t)}).then(null,ha)})}function mc(n){return new Ge(function(e){var t,r;try{for(var i=Nn(n),s=i.next();!s.done;s=i.next()){var o=s.value;if(e.next(o),e.closed)return}}catch(a){t={error:a}}finally{try{s&&!s.done&&(r=i.return)&&r.call(i)}finally{if(t)throw t.error}}e.complete()})}function ga(n){return new Ge(function(e){gc(n,e).catch(function(t){return e.error(t)})})}function pc(n){return ga(cc(n))}function gc(n,e){var t,r,i,s;return Bl(this,void 0,void 0,function(){var o,a;return aa(this,function(l){switch(l.label){case 0:l.trys.push([0,5,6,11]),t=jl(n),l.label=1;case 1:return[4,t.next()];case 2:if(r=l.sent(),!!r.done)return[3,4];if(o=r.value,e.next(o),e.closed)return[2];l.label=3;case 3:return[3,1];case 4:return[3,11];case 5:return a=l.sent(),i={error:a},[3,11];case 6:return l.trys.push([6,,9,10]),r&&!r.done&&(s=t.return)?[4,s.call(t)]:[3,8];case 7:l.sent(),l.label=8;case 8:return[3,10];case 9:if(i)throw i.error;return[7];case 10:return[7];case 11:return e.complete(),[2]}})})}var ba=Wi(function(n){return function(){n(this),this.name="EmptyError",this.message="no elements in sequence"}});function nr(n,e){return Qt(function(t,r){var i=0;t.subscribe(Xt(r,function(s){r.next(n.call(e,s,i++))}))})}var bc=Array.isArray;function yc(n,e){return bc(e)?n.apply(void 0,lr([],Ln(e))):n(e)}function wc(n){return nr(function(e){return yc(n,e)})}function _c(n,e,t,r,i,s,o,a){var l=[],c=0,d=0,f=!1,h=function(){f&&!l.length&&!c&&e.complete()},m=function(b){return c<r?I(b):l.push(b)},I=function(b){c++;var A=!1;Qr(t(b,d++)).subscribe(Xt(e,function($){e.next($)},function(){A=!0},void 0,function(){if(A)try{c--;for(var $=function(){var D=l.shift();o||I(D)};l.length&&c<r;)$();h()}catch(D){e.error(D)}}))};return n.subscribe(Xt(e,m,function(){f=!0,h()})),function(){}}function ya(n,e,t){return t===void 0&&(t=1/0),H(e)?ya(function(r,i){return nr(function(s,o){return e(r,s,i,o)})(Qr(n(r,i)))},t):(typeof e=="number"&&(t=e),Qt(function(r,i){return _c(r,i,n,t)}))}var xc=["addListener","removeListener"],Ec=["addEventListener","removeEventListener"],vc=["on","off"];function ui(n,e,t,r){if(H(t)&&(r=t,t=void 0),r)return ui(n,e,t).pipe(wc(r));var i=Ln(Oc(n)?Ec.map(function(a){return function(l){return n[a](e,l,t)}}):Sc(n)?xc.map(yo(n,e)):Ic(n)?vc.map(yo(n,e)):[],2),s=i[0],o=i[1];if(!s&&pa(n))return ya(function(a){return ui(a,e,t)})(Qr(n));if(!s)throw new TypeError("Invalid event target");return new Ge(function(a){var l=function(){for(var c=[],d=0;d<arguments.length;d++)c[d]=arguments[d];return a.next(1<c.length?c:c[0])};return s(l),function(){return o(l)}})}function yo(n,e){return function(t){return function(r){return n[t](e,r)}}}function Sc(n){return H(n.addListener)&&H(n.removeListener)}function Ic(n){return H(n.on)&&H(n.off)}function Oc(n){return H(n.addEventListener)&&H(n.removeEventListener)}function wo(n,e){return Qt(function(t,r){var i=0;t.subscribe(Xt(r,function(s){return n.call(e,s,i++)&&r.next(s)}))})}function Ac(n){return Qt(function(e,t){var r=!1;e.subscribe(Xt(t,function(i){r=!0,t.next(i)},function(){r||t.next(n),t.complete()}))})}function kc(n){return n<=0?function(){return tc}:Qt(function(e,t){var r=0;e.subscribe(Xt(t,function(i){++r<=n&&(t.next(i),n<=r&&t.complete())}))})}function Tc(n){return n===void 0&&(n=Rc),Qt(function(e,t){var r=!1;e.subscribe(Xt(t,function(i){r=!0,t.next(i)},function(){return r?t.complete():t.error(n())}))})}function Rc(){return new ba}function Dc(n,e){var t=arguments.length>=2;return function(r){return r.pipe(fa,kc(1),t?Ac(e):Tc(function(){return new ba}))}}function Rt(n){n===void 0&&(n={});var e=n.connector,t=e===void 0?function(){return new Me}:e,r=n.resetOnError,i=r===void 0?!0:r,s=n.resetOnComplete,o=s===void 0?!0:s,a=n.resetOnRefCountZero,l=a===void 0?!0:a;return function(c){var d,f,h,m=0,I=!1,b=!1,A=function(){f==null||f.unsubscribe(),f=void 0},$=function(){A(),d=h=void 0,I=b=!1},D=function(){var P=d;$(),P==null||P.unsubscribe()};return Qt(function(P,me){m++,!b&&!I&&A();var Z=h=h??t();me.add(function(){m--,m===0&&!b&&!I&&(f=Xs(D,l))}),Z.subscribe(me),!d&&m>0&&(d=new cr({next:function(pe){return Z.next(pe)},error:function(pe){b=!0,A(),f=Xs($,i,pe),Z.error(pe)},complete:function(){I=!0,A(),f=Xs($,o),Z.complete()}}),Qr(P).subscribe(d))})(c)}}function Xs(n,e){for(var t=[],r=2;r<arguments.length;r++)t[r-2]=arguments[r];if(e===!0){n();return}if(e!==!1){var i=new cr({next:function(){i.unsubscribe(),n()}});return Qr(e.apply(void 0,lr([],Ln(t)))).subscribe(i)}}function Fs(n){return Array.isArray(n)||ArrayBuffer.isView(n)}function wa(n,e){let{x:t,y:r,z:i}=e,{x:s,y:o,z:a,w:l}=n,c=l*t+o*i-a*r,d=l*r+a*t-s*i,f=l*i+s*r-o*t,h=-s*t-o*r-a*i,m=c*l+h*-s+d*-a-f*-o,I=d*l+h*-o+f*-s-c*-a,b=f*l+h*-a+c*-o-d*-s;return new e.constructor(m,I,b)}var di=Math.PI,qs=Math.PI*2;function Jr(n){let e=n%qs;return e<-di?e+=qs:e>di&&(e-=qs),e}function Cc(n){return n>-1?n<1?Math.acos(n):0:di}function Nc(n,[e,t,r]){let[i,s,o]=n;return new n.constructor(new i.constructor(i.x*e.x+s.x*e.y+o.x*e.z,i.y*e.x+s.y*e.y+o.y*e.z,i.z*e.x+s.z*e.y+o.z*e.z),new i.constructor(i.x*t.x+s.x*t.y+o.x*t.z,i.y*t.x+s.y*t.y+o.y*t.z,i.z*t.x+s.z*t.y+o.z*t.z),new i.constructor(i.x*r.x+s.x*r.y+o.x*r.z,i.y*r.x+s.y*r.y+o.y*r.z,i.z*r.x+s.z*r.y+o.z*r.z))}function Lc(n,{x:e,y:t,z:r}){let[i,s,o]=n;return new i.constructor(i.x*e+s.x*t+o.x*r,i.y*e+s.y*t+o.y*r,i.z*e+s.z*t+o.z*r)}function Pc(n,[e,t,r]){return new n.constructor(n.dot(e),n.dot(t),n.dot(r))}function Ot(n){return typeof n=="number"||(n==null?void 0:n.constructor)===Number}var Mc=n=>{try{$n(n),ts(n,4)}catch(e){console.error("error while hijackDOMPoint"),console.error(e)}},es=0,Bi=1,Vi=2,ji=3,ws=9999999999999,_s=void 0,_a=Symbol("vector length"),zs=Symbol("get source"),_o=Symbol("checked"),De=_s,pt,Pn,$c=[0,1,2,6,24,120,720,5760,51840,518400,5702400,68428800,889574400,12454041600,186810624e3],hi=[],Zn=-1,Ks=!1,xo=[];function Zs(n,e,t){De=n,Zn=-1,Pn=1;let r=e(t);if(!Ot(r))throw new Error(`
      your assigned progress did not not return a primitive!
      calc() does not support logical operators (|| && ==) directly

      instead of calc(() => v1 || v2);
      use        calc(() => +v1 || +v2);

      instead of calc(() => v1);
      use        calc(v1);
      `);return r}function xs(n){let e=n[zs];return e?e(n).length:n[_a]||3}function Wc(n,e){return xs(n)>xs(e)?n:e}function Fc(n,e){if(Pn+=1,e===ws)return Pn;if(e>=xs(n))return 0;let t=n[zs];if(t)return 1*t(n)[e];if(e===es)return 1*n.x;if(e===Bi)return 1*n.y;if(e===Vi)return 1*n.z;if(e===ji)return 1*n.w}function Eo(n,e,t){let r=n[zs];if(r){r(n)[e]=t;return}if(e===es){n.x=t;return}if(e===Bi){n.y=t;return}e===Vi&&(n.z=t),e===ji&&(n.w=t)}function Se(n,e){if(typeof n!="function")throw new Error("no function assigned");if(De!==_s)throw new Error("something wrong, do you use calc() inside calc?");try{let t=typeof e>"u",r=typeof e=="function",i=!r&&!t?e:void 0,s=Zs(es,n,i);if(t&&typeof pt>"u")return s;let o=pt?xs(pt):0;if(o===ws){if(!n[_o]){let d=Zs(ws,n),f=$c[Pn];if(Math.abs(d-f)>Number.EPSILON)throw new Error(`
            algebraic multiplication works only in calls with *

            calc(() => v * m);
            calc(() => m * v);
            calc(() => m * m);
            calc(() => m * m * v);

            `);n[_o]=!0}let c=hi[0];for(let d=1;d<Pn-1;d+=1){let f=hi[d];if(!c.multiply)throw new Error(`cannot find method multiply() on ${c}`);c=c.multiply(f)}return c}let a=r?e.length:o;if(a||(a=o),a<o)throw new Error("Your assigned result Vector cant use higher space Operands than it has");let l=new Array(a);l[0]=s,i&&Eo(i,De,l[0]);for(let c=1;c<a;c+=1){let d=Zs(c,n,i);l[c]=d,i&&Eo(i,De,d)}return t?new pt.constructor(...l):r?e(...l):i}finally{De=_s,pt=void 0}}function $n(n,e){let t=n.prototype;t[zs]=e;let r=t[Symbol.toPrimitive]||function(i){return i==="string"?this.toString():this.valueOf()};t[Symbol.toPrimitive]=function(i){return De===es&&(pt=pt?Wc(pt,this):this,hi[Pn-1]=this),De===_s?r.call(this,i):Fc(this,De)}}function Ui(n){return function(...e){if(De===es){if(Ks)return n.apply(this,e);try{Ks=!0,Zn+=1;let t=n.apply(this,e);return xo[Zn]=t,t}finally{Ks=!1}}return De===Bi||De===Vi||De===ji?(Zn+=1,xo[Zn]):n.apply(this,e)}}function we(n,e){let t=n.prototype,r=t[e];t[e]=Ui(r)}function Bs(n,e){let t=n.prototype,r=Object.getOwnPropertyDescriptor(t,e);Object.defineProperty(t,e,{get:Ui(function(){return r.get.call(this)})})}function ts(n,e){let t=n.prototype;Object.defineProperty(t,_a,{value:e})}function xa(n){ts(n,ws)}function Vs(n){return Ui(n)}typeof DOMPoint<"u"&&Mc(DOMPoint);function zc(n){let e="";return n&&(e=`${n}-`),e}function ns(n,e,t={}){let r=zc(n);return Object.entries(e).forEach(([i,s])=>{t[`--${r}${i}`]=s}),t}var fi=0,mi=1,Pe=Symbol("axes");function Bc(n,e,t,r){let i=Math.atan2(n,e),s=Math.atan2(t,r);return Jr(i-s)}function vo(n){return n*n}var $e=class{constructor(n,e){typeof n=="function"?Se(n,(t,r)=>{this[Pe]=[t,r]}):Fs(n)?this[Pe]=[...n]:n&&Ot(n.x)?this[Pe]=[n.x||0,n.y||0]:this[Pe]=[n||0,e||0]}valueOf(){throw new Error("valueOf() not implemented, looks like you try to calculate outside of calc")}normalize(){let{length:n}=this;return new this.constructor(this.x/n,this.y/n)}norm(){return this.normalize()}dot(n){return this.x*n.x+this.y*n.y}getRad(){return Jr(Math.atan2(this.y,this.x))}angleTo(n){return Bc(this.y,this.x,n.y,n.x)}rotate(n){let e=Math.sin(n),t=Math.cos(n),r=this.x*t-this.y*e,i=this.x*e+this.y*t;return new this.constructor(r,i)}distance(n){return Math.sqrt(vo(this.x-n.x)+vo(this.y-n.y))}dist(n){return this.distance(n)}toArray(){return[this.x,this.y]}calc(n){throw new Error("calc() not implemented")}clone(){throw new Error("clone() not implemented")}equals(n){return this.x===n.x&&this.y===n.y}toJSON(){return{x:this.x,y:this.y}}toString(){return JSON.stringify(this.toJSON())}toCSSVars(n,e){return ns(n,this.toJSON(),e)}get lengthSq(){return this.dot(this)}get length(){return Math.sqrt(this.lengthSq)}get lensq(){return this.lengthSq}get len(){return this.length}get x(){return this[Pe][fi]}set x(n){throw new Error("set x() not implemented")}get y(){return this[Pe][mi]}set y(n){throw new Error("set y() not implemented")}get z(){throw new Error("get z() not implemented")}set z(n){throw new Error("set z() not implemented")}[Symbol.iterator](){return this[Pe].values()}};$n($e);ts($e,2);we($e,"dot");we($e,"angleTo");we($e,"distance");we($e,"toArray");we($e,"getRad");Bs($e,"length");Bs($e,"lengthSq");var Ea=class va extends $e{set x(e){this[Pe][fi]=e}set y(e){this[Pe][mi]=e}get x(){return this[Pe][fi]}get y(){return this[Pe][mi]}calc(e){return Se(e,this)}clone(){return new va(this.x,this.y)}},nn=class extends $e{toPoint(){return new Ea(this.x,this.y)}},Vc=Vs((n,e)=>new Ea(n,e)),Sa=(n,e)=>Vc(n,e),jc=Vs((n,e)=>new nn(n,e)),S=(n,e)=>jc(n,e);S(0,0);S(0,-1);S(-1,0);var rn=0,sn=1,on=2,Y=Symbol("axes");function Qs(n){return n*n}var _e=class{constructor(n,e,t){typeof n=="function"?Se(n,(r,i,s)=>{this[Y]=[r,i,s]}):Fs(n)?this[Y]=[...n]:n&&Ot(n.x)?this[Y]=[n.x||0,n.y||0,n.z||0]:this[Y]=[n||0,e||0,t||0]}valueOf(){throw new Error("valueOf() not implemented, looks like you try to calculate outside of calc")}normalize(){let{length:n}=this;return new this.constructor(this.x/n,this.y/n,this.z/n)}norm(){return this.normalize()}dot(n){return this.x*n.x+this.y*n.y+this.z*n.z}cross(n){return new this.constructor(this.y*n.z-this.z*n.y,this.z*n.x-this.x*n.z,this.x*n.y-this.y*n.x)}crossNormalize(n){let e=this.cross(n),{length:t}=e;return e[Y][rn]/=t,e[Y][sn]/=t,e[Y][on]/=t,e}cn(n){return this.crossNormalize(n)}toAngles(){return{theta:Math.atan2(this.z,this.x),phi:Math.asin(this.y/this.length)}}angleTo(n){return Jr(Cc(this.dot(n)/(this.length*n.length)))}multiply(n){return n.x===void 0?this.multiplyMat3(n):n.w===void 0?this.multiplyVec3(n):wa(n,this)}multiplyMat3(n){return Pc(this,n)}multiplyVec3({x:n,y:e,z:t}){return new this.constructor(this.x*n,this.y*e,this.z*t)}distance(n){return Math.sqrt(Qs(this.x-n.x)+Qs(this.y-n.y)+Qs(this.z-n.z))}dist(n){return this.distance(n)}toArray(){return[this.x,this.y,this.z]}swizzle(n){let e=n.split("").map(t=>this[t]);return e.length===2?new nn(e[0],e[1]):new this.constructor(e[0],e[1],e[2])}calc(n){throw new Error("calc() not implemented")}clone(){throw new Error("clone() not implemented")}equals(n){return this.x===n.x&&this.y===n.y&&this.z===n.z}toJSON(){return{x:this.x,y:this.y,z:this.z}}toString(){return JSON.stringify(this.toJSON())}toCSSVars(n,e){return ns(n,this.toJSON(),e)}get lengthSq(){return this.dot(this)}set lengthSq(n){throw new Error("set lengthSq() not implemented")}get length(){return Math.sqrt(this.lengthSq)}set length(n){throw new Error("set length() not implemented")}get lensq(){return this.lengthSq}set lensq(n){throw new Error("set lensq() not implemented")}get len(){return this.length}set len(n){throw new Error("set len() not implemented")}get x(){return this[Y][rn]}set x(n){throw new Error("set x() not implemented")}get y(){return this[Y][sn]}set y(n){throw new Error("set y() not implemented")}get z(){return this[Y][on]}set z(n){throw new Error("set z() not implemented")}get xy(){return new nn(this[Y][rn],this[Y][sn])}set xy(n){throw new Error("set xz() not implemented")}get xz(){return new nn(this[Y][rn],this[Y][on])}set xz(n){throw new Error("set xz() not implemented")}get yz(){return new nn(this[Y][sn],this[Y][on])}set yz(n){throw new Error("set yz() not implemented")}[Symbol.iterator](){return this[Y].values()}};$n(_e);ts(_e,3);we(_e,"dot");we(_e,"cross");we(_e,"crossNormalize");we(_e,"toAngles");we(_e,"angleTo");we(_e,"rotate");we(_e,"distance");we(_e,"toArray");Bs(_e,"length");Bs(_e,"lengthSq");var Uc=class Ia extends _e{set x(e){this[Y][rn]=e}set y(e){this[Y][sn]=e}set z(e){this[Y][on]=e}get x(){return this[Y][rn]}get y(){return this[Y][sn]}get z(){return this[Y][on]}calc(e){return Se(e,this)}clone(){return new Ia(this.x,this.y,this.z)}},Gc=class extends _e{toVector(){return new Uc(this.x,this.y,this.z)}clone(){return this}},Hc=Vs((n,e,t)=>new Gc(n,e,t)),At=(n,e,t)=>Hc(n,e,t);At(0,0,0);var Oa=At(0,0,-1);At(0,0,1);var Gi=At(-1,0,0);At(1,0,0);var Aa=At(0,1,0);At(0,-1,0);At(1,1,1);var et=Symbol("angle rad"),ka=Math.PI/180,Es=class Ta{constructor(e){e instanceof Ta?this[et]=e[et]:this[et]=Jr(e*ka)}valueOf(){return this[et]}toJSON(){return{angle:this[et]}}toString(){return JSON.stringify(this.toJSON())}toCSSVars(e,t){return ns(e,this.toJSON(),t)}},Ra=class extends Es{set(n){n instanceof Es?this[et]=n[et]:this[et]=Jr((n||0)*ka)}},Yc=class extends Es{toDegree(){return new Ra(this[et])}};new Yc(0);function Xc(n){return new Ra(n)}function qc(n){return Ot(n)||n instanceof Es}var nt=0,rt=1,st=2,it=3,oe=Symbol("axes"),Kc=Symbol("forward cache"),Zc=Symbol("left cache"),Qc=Symbol("up cache"),Jc=Symbol("inverse cache");function eu([n,e,t,r]){return Math.sqrt(n*n+e*e+t*t+r*r)}function Da(n){let e=eu(n);n[nt]/=e,n[rt]/=e,n[st]/=e,n[it]/=e}function tu(n,e){let t=n.normalize(),r=e.crossNormalize(t),i=t.crossNormalize(r),s=r.x,o=r.y,a=r.z,l=i.x,c=i.y,d=i.z,f=t.x,h=t.y,m=t.z,I=s+c+m,b=new Array(4);if(I>0){let D=Math.sqrt(I+1);return b[it]=D*.5,D=.5/D,b[nt]=(d-h)*D,b[rt]=(f-a)*D,b[st]=(o-l)*D,b}if(s>=c&&s>=m){let D=Math.sqrt(1+s-c-m),P=.5/D;return b[nt]=.5*D,b[rt]=(o+l)*P,b[st]=(a+f)*P,b[it]=(d-h)*P,b}if(c>m){let D=Math.sqrt(1+c-s-m),P=.5/D;return b[nt]=(l+o)*P,b[rt]=.5*D,b[st]=(h+d)*P,b[it]=(f-a)*P,b}let A=Math.sqrt(1+m-s-c),$=.5/A;return b[nt]=(f+a)*$,b[rt]=(h+d)*$,b[st]=.5*A,b[it]=(o-l)*$,b}function nu(n,e){let t=new Array(4),r=e*.5,i=Math.sin(r),s=Math.cos(r);return t[nt]=i*n.x,t[rt]=i*n.y,t[st]=i*n.z,t[it]=s,t}function pi(n,e,t,r){if(Ot(n))return[n,e,t,r];if(Fs(n))return[...n];if(qc(e))return nu(n,e);if(n&&e)return tu(n,e)}function Ca(n,e,t,r){return n&&Ot(n.w)?pi(n.x,n.y,n.z,n.w):pi(n,e,t,r)||[0,0,0,1]}var ur=class{constructor(n,e,t,r){this[oe]=Ca(n,e,t,r),Da(this[oe])}set(n,e,t,r){throw new Error("set x() not implemented")}multiply(n,e,t,r){if(Ot(n.w))return this.multiplyQuaternion(n);let i=pi(n,e,t,r);return i?this.multiplyQuaternion(new this.constructor(i)):this.multiplyVector(n)}multiplyVector(n){return wa(this,n)}multiplyQuaternion(n){let e=this.x,t=this.y,r=this.z,i=this.w,s=n.x,o=n.y,a=n.z,l=n.w,c=i*s+e*l+t*a-r*o,d=i*o+t*l+r*s-e*a,f=i*a+r*l+e*o-t*s,h=i*l-e*s-t*o-r*a;return new this.constructor(c,d,f,h)}mul(n,e,t,r){return this.multiply(n,e,t,r)}get inverse(){let{x:n,y:e,z:t,w:r}=this;return this.constructor(n*-1,e*-1,t*-1,r)}get inv(){return this.inverse}equals(n){return this.x===n.x&&this.y===n.y&&this.z===n.z&&this.w===n.w}get left(){return this.multiplyVector(Gi)}get dir(){return this.multiplyVector(Oa)}get up(){return this.multiplyVector(Aa)}get 0(){return this.left}get 1(){return this.dir}get 2(){return this.up}get x(){return this[oe][nt]}set x(n){throw new Error("set x() not implemented")}get y(){return this[oe][rt]}set y(n){throw new Error("set y() not implemented")}get z(){return this[oe][st]}set z(n){throw new Error("set z() not implemented")}get w(){return this[oe][it]}set w(n){throw new Error("set w() not implemented")}toJSON(){let{x:n,y:e,z:t,w:r}=this;return{x:n,y:e,z:t,w:r,a1:1-e*e*2-t*t*2,a2:n*e*2-t*r*2,a3:n*t*2+e*r*2,b1:n*e*2+t*r*2,b2:1-n*n*2-t*t*2,b3:e*t*2-n*r*2,c1:n*t*2-e*r*2,c2:e*t*2+n*r*2,c3:1-n*n*2-e*e*2}}toString(){return JSON.stringify(this.toJSON())}toCSSVars(n,e){return ns(n,this.toJSON(),e)}};$n(ur);xa(ur);var ru=class extends ur{set(n,e,t,r){n instanceof ur?this[oe]=[...n[oe]]:(this[oe]=Ca(n,e,t,r),Da(this[oe]))}set x(n){this[oe][nt]=n}set y(n){this[oe][rt]=n}set z(n){this[oe][st]=n}set w(n){this[oe][it]=n}get x(){return this[oe][nt]}get y(){return this[oe][rt]}get z(){return this[oe][st]}get w(){return this[oe][it]}};function us(n,e,t){let r=n[e];return r||(r=t(),n[e]=r),r}var Na=class extends ur{get left(){return us(this,Zc,()=>this.multiplyVector(Gi))}get dir(){return us(this,Kc,()=>this.multiplyVector(Oa))}get up(){return us(this,Qc,()=>this.multiplyVector(Aa))}get inverse(){return us(this,Jc,()=>{let{x:n,y:e,z:t,w:r}=this;return this.constructor(n*-1,e*-1,t*-1,r)})}};new ru;var su=Vs((n,e,t,r)=>new Na(n,e,t,r)),iu=(n,e,t,r)=>su(n,e,t,r);new Na(Gi,Xc(90));iu(0,0,0,1);var ou=0,au=1,lu=2,cu=3,He=Symbol("axes"),Hi=class{constructor(n,e,t,r){typeof n=="function"?Se(n,(i,s,o,a)=>{this[He]=[i,s,o,a]}):Fs(n)?this[He]=[...n]:n&&Ot(n.x)?this[He]=[n.x||0,n.y||0,n.z||0,n.w||0]:this[He]=[n||0,e||0,t||0,r||0]}dot(n){return this.x*n.x+this.y*n.y+this.z*n.z+this.w*n.w}valueOf(){throw new Error("valueOf() not implemented, looks like you try to calculate outside of calc")}toArray(){return[this.x,this.y,this.z,this.w]}calc(n){throw new Error("calc() not implemented")}clone(){throw new Error("clone() not implemented")}equals(n){return this.x===n.x&&this.y===n.y&&this.z===n.z&&this.w===n.w}toJSON(){return{x:this.x,y:this.y,z:this.z,w:this.w}}toString(){return JSON.stringify(this.toJSON())}toCSSVars(n,e){return ns(n,this.toJSON(),e)}get x(){return this[He][ou]}set x(n){throw new Error("set x() not implemented")}get y(){return this[He][au]}set y(n){throw new Error("set y() not implemented")}get z(){return this[He][lu]}set z(n){throw new Error("set z() not implemented")}get w(){return this[He][cu]}set w(n){throw new Error("set w() not implemented")}[Symbol.iterator](){return this[He].values()}};$n(Hi);ts(Hi,4);we(Hi,"toArray");var jn=Symbol("data"),La=class Pa{constructor(...e){this[jn]=e}get 0(){return this[jn][0]}set 0(e){throw new Error("set [0] not implemented")}get 1(){return this[jn][1]}set 1(e){throw new Error("set [1] not implemented")}get 2(){return this[jn][2]}set 2(e){throw new Error("set [2] not implemented")}multiplyMat(e){return Nc(this,e)}multiplyVec(e){return Lc(this,e)}multiply(e){if(e instanceof Pa)return this.multiplyMat(e);let{x:t,y:r,z:i}=e;if(t===void 0||r===void 0||i===void 0)throw new Error(`multiply only works with mat3 and vec3, not supported ${e}`);return this.multiplyVec(e)}[Symbol.iterator](){return this[jn].values()}};$n(La);xa(La);class uu{constructor(e){p(this,"items",[]);p(this,"itemsMapping",new Map);p(this,"key");this.key=e}add(e){e.forEach(t=>{[].concat(t[this.key]).forEach(r=>{this.itemsMapping.set(r,t)})}),this.items.push(...e)}remove(e){e.forEach(t=>{this.items.splice(this.items.indexOf(t),1)})}has(e){return this.itemsMapping.has(e)}get(e){return this.itemsMapping.get(e)}}class du extends uu{constructor(){super("name")}}const Dt=new du;var pr,gr,un,br;class hu{constructor({name:e,description:t,args:r,action:i}){g(this,pr,void 0);g(this,gr,void 0);g(this,un,[]);g(this,br,void 0);v(this,pr,[].concat(e)),v(this,gr,t),v(this,un,r||u(this,un)),v(this,br,i)}action(...e){return u(this,br).call(this,...e)}get description(){return u(this,gr)}get name(){return u(this,pr)}get args(){return u(this,un)}}pr=new WeakMap,gr=new WeakMap,un=new WeakMap,br=new WeakMap;function Ma(n){return n.map(e=>new hu(e))}function fu(n,e){return n.args.reduce((t,r)=>{const i=[].concat(r.name);i.length<1&&(i.push=`argument-${r.index}`);const s=tn(r.name[0]);if("index"in r&&r.index!==void 0&&Number(r.index)in e.args){const o=r.index;let a=e.args[Number(o)];a=a===void 0?!0:a,t[Number(o)]=a,t.unresolved[Number(o)]=e.unresolved.args[Number(o)],t[String(s)]=a,t.unresolved[String(s)]=e.unresolved.args[Number(o)]}return i.forEach(o=>{if(o in e.kwargs){const a=e.kwargs[String(o)];t[String(s)]=a===void 0?!0:a,t.unresolved[String(s)]=e.kwargs[String(o)]===void 0?!0:a}}),t},{unresolved:{}})}var yr,wr,_r,xr;class y{constructor({name:e,index:t,flag:r,description:i}){g(this,yr,void 0);g(this,wr,void 0);g(this,_r,void 0);g(this,xr,void 0);v(this,yr,[].concat(e)),v(this,wr,t),v(this,_r,r),v(this,xr,i)}get name(){return u(this,yr)}get index(){return u(this,wr)}get flag(){return u(this,_r)}get description(){return u(this,xr)}}yr=new WeakMap,wr=new WeakMap,_r=new WeakMap,xr=new WeakMap;let ds;const mu=new Uint8Array(16);function pu(){if(!ds&&(ds=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!ds))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return ds(mu)}const ae=[];for(let n=0;n<256;++n)ae.push((n+256).toString(16).slice(1));function gu(n,e=0){return ae[n[e+0]]+ae[n[e+1]]+ae[n[e+2]]+ae[n[e+3]]+"-"+ae[n[e+4]]+ae[n[e+5]]+"-"+ae[n[e+6]]+ae[n[e+7]]+"-"+ae[n[e+8]]+ae[n[e+9]]+"-"+ae[n[e+10]]+ae[n[e+11]]+ae[n[e+12]]+ae[n[e+13]]+ae[n[e+14]]+ae[n[e+15]]}const bu=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),So={randomUUID:bu};function Wn(n,e,t){if(So.randomUUID&&!e&&!n)return So.randomUUID();n=n||{};const r=n.random||(n.rng||pu)();return r[6]=r[6]&15|64,r[8]=r[8]&63|128,gu(r)}const ee={DEFAULT:0,SEPARATOR:1,SPACER:2,TEXT:3,CHECKBOX:4,RADIO:5,UPLOAD:6};class Io{constructor({type:e=ee.DEFAULT,model:t,options:r,action:i,command:s,url:o,order:a=-1,title:l=null,text:c=null,items:d=[],name:f=null,value:h=null,hotKey:m,keyCode:I,onInit:b}){p(this,"options",{disabled:!1,checked:!1});this.id=Wn(),this.type=e,this.model=t,this.options=Object.assign(r||{},this.options,Object.assign({},r)),e===ee.RADIO&&(this.options.checked=this.options.checked=this.options.checked?h:!1),this.action=i,this.command=s,this.url=o,this.name=f,this.value=h,this.order=a,this.title=l,this.text=c,this.items=$a(d),this.hotKey=m,this.keyCode=I,b&&b(this)}}function $a(n){return n.map(e=>e instanceof Io?e:new Io(e))}class qt{constructor(e,t){p(this,"id",Wn());p(this,"items",[]);e&&(this.items=$a(e(t)))}add(e){e instanceof qt&&this.items.push(...e.items)}}class js{constructor({config:e={},commands:t,contextMenu:r=null,core:i}){p(this,"commands",[]);p(this,"contextMenu",[]);p(this,"config",{});p(this,"core");this.core=i,this.config=e,this.commands=t,this.contextMenu=r}beforeSetup(){const e=this.core;e.config.setDefaults(this.config),typeof this.commands=="function"&&(this.commands=Ma(this.commands({core:e,module:this})),Dt.add(this.commands)),typeof this.contextMenu=="function"&&(this.contextMenu=new qt(this.contextMenu,{core:e,module:this}),this.core.modules.windows.contextMenu.addDefaultItems(this.contextMenu))}setup(){this.log(this.name)}destroy(){this.core.removeCommands(this.commands)}log(e){this.core.logger.add(e,{namespace:this.constructor.NAME})}get name(){return this.constructor.NAME}}const Wa="default",Qn={default:{title:"Theme Default",colors:["#FFFFFF","#000","#FFAA55","#0055AA"],filter:"invert(100%)"},theme1:{title:"Theme 1",colors:["#000000","#FFFFFF","#4466aa","#919191"],filter:"invert(100%)"},theme2:{title:"Theme 2",colors:["#FFFFFF","#000000","#dd99aa","#8080a0"],filter:"invert(100%)"},theme3:{title:"Theme 3",colors:["#FFFFFF","#000000","#a8a0a0","#406080"],filter:"invert(100%)"},theme4:{title:"Theme 4",colors:["#FFFFFF","#50473f","#a08070","#b0a090"],filter:"invert(100%)"},themeAmber:{title:"Theme Amber",colors:["#FFB000","#805800","#805800","#000000"],filter:"brightness(50%)"},themeGreen:{title:"Theme Green",colors:["#00f900","#008f11","#00Bb00","#000000"],filter:"brightness(50%)"},themeRed:{title:"Theme Red",colors:["#ee0000","#660000","#990000","#330000"],filter:"brightness(50%)"}};function Fa(n){return n=n||["#FFF","#000","#FFAA55","#0055AA"],{boot:{sequence_error:"#000",sequence_ready:n[3],sequence_no_disk:"#fff",sequence_0:"#000",sequence_1:"#ccc",sequence_2:"#fff",sequence_3:n[3]},symbol:{primary:n[0],secondary:n[1],tertiary:n[2],quaternary:n[3]},screen:{background:n[3]},header:{background:n[0],coverBackground:n[0],coverTitle:n[3],title:n[3]},windowHeader:{background:n[0],stripes:n[3],title:n[3],buttonBackground:n[3],buttonPrimary:n[0],buttonSecondary:n[1]},contextMenu:{border:n[3]},contextMenuItem:{background:n[0],label:n[3],indicatorContext:n[3],hotkey:n[3]},contextMenuSeparator:{background:n[3]},window:{text:n[0],background:n[3],border:n[0],borderScaling:n[2],helper__scaleBackground:n[0],helper__scaleIcon:n[3],helper__scaleIconActive:n[1]},storageBar:{background:n[1],border:n[0],sizeHelper:n[2],icon:n[0]},scrollContent:{scrollbarCorner:n[0],scrollbarSpacer:n[0],scrollbarBackground:n[3],scrollbarHelperBackground:n[0],scrollbarHelper:n[3],scrollbarHelperActive:n[1],scrollbarRange:n[0]},symbolWrapperItem:{text:n[0]},button:{label:n[0],primary:{label:n[3],background:n[0],border:n[0],outline:n[3]},secondary:{label:n[0],background:n[3],border:n[0]},dialog:{label:n[3],background:n[0],border:n[2],outline:n[3]}},checkboxGroupItem:{disabled:{icon:n[0],background:n[0]},background:n[3],checkbox:{icon:n[0]},radio:{icon:n[0]}},rangeSlider:{background:n[3],border:n[0],thumbBackground:n[0]},textbox:{text:n[0],background:n[3],border:n[3],outline:n[0],dialog:{text:n[3],background:n[0],border:n[0],outline:n[3]},disabledReadonlyText:n[3],disabledReadonlyBackground:n[0]},textarea:{text:n[0],background:n[3],border:n[3],outline:n[0],resizeBackground:n[3],resizeIcon:n[0]},dropdown:{disabled:{text:n[3],background:n[0]},text:n[0],background:n[3],border:n[3],outline:n[0],scrollbarPrimary:n[0],scrollbarSecondary:n[3],expander:{icon:n[3],border:n[3],background:n[0]}},itemSelect:{border:n[0]},itemSelectItem:{border:n[0],background:n[3],disabledLabelText:n[0],disabledLabelbackground:n[1]},inputText:{selected:n[3],pointer:n[2]},markdown:{typo:{selection:n[1],headlinePrimary:n[0],headlineSecondary:n[2],strong:n[2],strongEm:n[0],link:n[2],linkHover:n[0],del:n[1],line:n[0],blockquoteBackground:n[2],blockquoteText:n[1],codeBackground:n[0],codeText:n[1],codeSelection:n[2]}},dialogContent:{backgroundPrimary:n[0],backgroundSecondary:n[0],text:n[3]},form:{fieldsetBorder:n[2]},console:{text:n[0],typo:{fieldsetBorder:n[2],line:n[0],strong:n[2],strongEm:n[0]}},core:{text:n[0]},workbench13:{calculator:{background:n[1],button:{text:n[0],border:n[0]},result:{border:n[0]}}}}}function za(n){return{default:n||"invert(100%)"}}class yu{constructor(e,t){p(this,"name","wb13");const{colors:r,filters:i}=Object.assign({colors:{},filters:{}},t);this.name=e||this.name,this.colors=Object.assign(Fa(),r),this.filters=Object.assign(za(),i)}toCSSVars(){return Object.assign({},gi(Object.assign({color:this.colors,filter:this.filters})),gi())}}const wu="-";function gi(n,e="",t={}){return typeof n=="object"?(Object.keys(n).map(r=>gi(n[String(r)],(e?e+wu:"")+r,t)),t):(t[`--${Pl(e)}`]=n,t)}class _u extends yu{constructor(e,t){const{colors:r,filter:i}=Object.assign({colors:null,filter:null},t);super(e,{colors:Fa(r),filters:za(i)})}}const vg=2e3,Sg={NO_DISK:"no-disk",ERROR:"error",READY:"ready",SEQUENCE_1:0,SEQUENCE_2:1,SEQUENCE_3:2},N={SCREEN_1084_FRAME:"core_screen1084Frame",SCREEN_REAL_LOOK:"core_screenRealLook",SCREEN_SCAN_LINES:"core_screenScanlines",SCREEN_ACTIVE_ANIMATION:"core_screenActiveAnimation",BOOT_WITH_SEQUENCE:"core_bootWithSequence",BOOT_WITH_WEBDOS:"core_bootWithWebDos",THEME:"core_theme",FILE_EXTENSION_ASSIGNMENT:"core_fileExtensionAssignment",SCREEN_CONFIG:"core_screenConfig"},Oo={[N.SCREEN_1084_FRAME]:!0,[N.SCREEN_REAL_LOOK]:!0,[N.SCREEN_SCAN_LINES]:!0,[N.SCREEN_ACTIVE_ANIMATION]:!0,[N.BOOT_WITH_SEQUENCE]:!0,[N.BOOT_WITH_WEBDOS]:!0,[N.THEME]:Qn[String(Wa)],[N.FILE_EXTENSION_ASSIGNMENT]:[["md","DF0:DocumentReader.app"],["bas","DF1:WebBasic.app"],["basic","DF1:WebBasic.app"]],[N.SCREEN_CONFIG]:{contrast:.5,brightness:.5,color:.5,sharpness:0,horizontalCentering:.5,soundVolume:.5}},xu="web_workbench_CONFIG",Ig=new Promise(n=>{/complete|interactive|loaded/.test(document.readyState)?n():document.addEventListener("DOMContentLoaded",n,!1)});var Er;class Eu{constructor(){g(this,Er,void 0);window.requestAnimationFrame(()=>{document.documentElement.style.overflowY="scroll",v(this,Er,window.innerWidth-document.body.offsetWidth),document.documentElement.style.overflowY=null})}get size(){return u(this,Er)}}Er=new WeakMap;const Og=new Eu;function vu(n,e){return n===e?!0:n.parentElement?n.parentElement!==e?vu(n.parentElement,e):!0:!1}window.requestAnimationFrame(()=>{document.documentElement.style.overflowY="scroll",window.innerWidth-document.body.offsetWidth,document.documentElement.style.overflowY=null});function bs(n){if(n.touches&&n.touches.length>0){const e=n.touches[0];n.clientX=e.clientX,n.clientY=e.clientY}return"x"in n||(n.x=n.clientX,n.y=n.clientY),n}class j{constructor(e,t){this.name=e,this.value=t}}const Su=S(0,0);class dr{constructor({title:e,sidebarComponent:t,sidebarComponentData:r,component:i,componentData:s,options:o,symbolWrapper:a,wrapper:l,layout:c}){p(this,"events",new Me);p(this,"id",Wn());p(this,"component");p(this,"componentData");p(this,"sidebarComponent");p(this,"sidebarComponentData");p(this,"options",Ne({title:"Unnamed",scaleX:!0,scaleY:!0,scrollX:!0,scrollY:!0,clampX:!0,clampY:!1,freeze:!1,focused:!1,center:!0,close:!0,overlay:!0,embed:!1,borderless:!1,hideRootHeader:!1,sidebar:!0}));p(this,"symbolWrapper",null);p(this,"group",null);p(this,"wrapper",null);p(this,"layout",Ne({focused:!1,position:S(0,0),size:Su,scrollOffset:S(0,0)}));this.options.title=e,t&&(this.sidebarComponent=M(t)),r&&(this.sidebarComponentData=M(r)),this.component=M(i),this.componentData={...s,window:this},a&&(this.symbolWrapper=M(a)),l&&(this.wrapper=M(l)),this.options=Object.assign(this.options,o),this.layout=Object.assign(this.layout,c)}ready(){this.options.ready=!0,this.events.next(new j("ready"))}focus(){this.options.focused=!0,this.events.next(new j("focus"))}unfocus(){this.options.focused=!1,this.events.next(new j("unfocus"))}close(e){this.wrapper&&(this.events.next(new j("close",e)),this.wrapper.remove(this.id),this.wrapper=null)}setWrapper(e){this.wrapper=M(e)}setGroup(e){this.group=e}awaitClose(){return new Promise(e=>{const t=this.events.pipe(wo(({name:r})=>r==="close")).subscribe((...r)=>{t.unsubscribe(),e(...r)})})}awaitReady(){return new Promise(e=>{if(this.options.ready)e();else{const t=this.events.pipe(wo(({name:r})=>r==="ready")).subscribe((...r)=>{t.unsubscribe(),e(...r)})}})}}var dn;class Iu{constructor(){g(this,dn,new Map)}get items(){return u(this,dn)}add(e,t){Array.isArray(e)?e.forEach(r=>{this.add(...r)}):u(this,dn).set(e,[].concat(t))}get(...e){const t=e.shift();return u(this,dn).get(t).map(r=>e.reduce((i,s)=>i.replace(/%\d+/,s),r))}}dn=new WeakMap;const C=new Iu;C.add("bad_args","Bad args");C.add("cant_find","Can't find %1");const Ou="/",Js="ROOT",Au="CLOUD";function Te(n){return typeof n=="object"&&"id"in n?n.id:n.replace(/.*[\\/:]{1,1}([^:\\/]+)$/,"$1")}function ku(n){return/^[a-zA-Z0-9_-]+:/.test(n)}function Yi(...n){return n.reduce((e,t)=>(e.push(...t.replace(/[\\/]+/,"/").replace(/^\//,"").replace(/\/$/,"").split("/")),e),[]).join("/").replace(/\/$/,"")}function Tu(n){return n.replace(/(.*)[:/]([^\\/:]+)/,"$1")}function Ru(n){return n.replace(/(.*)\/([^\\/]+)/,"$2")}function Un(n){return n.replace(/(.*[\\/:]{1,1})[^:\\/]+$/,"$1")}function ys(n){return n.length&&/^[\w .\\/:-]+$/.test(n)}function Du(n){return ys(n)&&!!(n.includes("/")||n.match(/^([^:]+):.*/))}function Cu(n){return n*1e3}function Xi(n){return n.replace(/^(.*)\.[^.]+$/,"$1")}function hr(n){const e=n.match(/^.*\.([^.]*)$/);return e?e[1]:""}function Ba(n){return n.replace(/[^.a-zA-Z0-9_-]/g,"_")}function vs(n,e){return e?`${Xi(n)}.${e}`:n}function Va(n,e,t){let r=n;return e.hasItem(vs(r,t))?(r=`copy_${n}`,e.hasItem(vs(r,t))?Va(r,e,t):r):r}function Ye(n){if(n.getStorageItem()){if(n.getStorageItem().locked)throw C.get("FileSystem_permissionsNeeded");return n}return n}async function ye(n,e){return n.getStorageItem()&&(await n.save(),await n.getStorageItem().save()),n}async function Nu(n,e){const t=await e.remove(n);return Array.isArray(t)?t:[t]}const _={DEFAULT:"default",DIRECTORY:"directory",DIRECTORY_PREFS:"directory_prefs",CLOUD_DISK:"cloud_disk",HARD_DISK:"hard_disk",RAM_DISK:"ram_disk",TMP_DISK:"tmp_disk",DISK_1:"disk_1",DISK_2:"disk_2",DISK_WORKBENCH13:"disk_workbench13",DISK_MARKDOWN:"disk_markdown",DISK_BASIC:"disk_basic",WORK:"work",CONSOLE:"console",SETTINGS:"settings",TRASHCAN:"trashcan",COMPUTER_1:"computer_1",TELEPHONE:"telephone",CURSOR:"cursor",PREFERENCE:"preference",WEB_BASIC:"web_basic",WEB_PAINTING:"web_painting",COLORS:"colors",PRINT_1:"print_1",PRINT_2:"print_2",NOTEPAD:"notepad",BASIC:"basic",IMAGE:"image",NOTE:"note",NOTE_BLANK:"note_blank",LARGE_NOTE:"large_note",LARGE_NOTE_RICH:"large_note_rich",FULLSCREEN:"fullscreen",CALCULATOR:"calculator",CLOCK:"clock",KEYBOARD_QUESTION:"keyboard_question",LARGE_NOTEPAD:"large_notepad",LARGE_NOTEPAD_HELP:"large_notepad_help",RABBIT:"rabbit",MORE:"more",SAY:"say",GITHUB:"github",LAMMPEE:"lammpee",CUBY:"cuby",NUXT:"nuxt",CLOWN:"clown",DISALLOW_1:"disallow_1",COPY_1:"copy_1",COPY_2:"copy_2",DISPLAY_KEYBOARD:"display_keyboard",PALETTE:"palette",SIGN_1:"sign_1",DOCUMENT_EDITOR:"document_editor",DOCUMENT_READER:"document_reader",SYNTHESIZER:"synthesizer"};function ja(n){return/^"([^"]*)"$/.test(n)}function Lu(n){return ja(n)?n:(n=X(n),`"${n}"`)}function Ao(n){return n.replace(/[ ]*(.+)[ ]+/)}function X(n){return typeof n!="string"?n:n.replace(/^[ ]*"(.*)"[ ]*$/,"$1").replace(/\\"/g,'"')}function Jn(n){return!isNaN(n)}let qi;qi=Promise.resolve({atob:n=>window.decodeURIComponent(window.atob(n)),btoa:n=>window.btoa(window.encodeURIComponent(n))});async function bi(n){const{atob:e}=await qi;return e(n)}async function Pu(n){const{btoa:e}=await qi;return e(n)}const w={SYMBOL:"symbol",VISIBLE:"visible",POSITION:"position",WINDOW_SYMBOL_REARRANGE:"window_symbol_rearrange",WINDOW_SIZE:"window_size",WINDOW_POSITION:"window_position",WINDOW_SCALE:"window_scale",WINDOW_SCROLL_X:"window_scroll_x",WINDOW_SCROLL_Y:"window_scroll_y",WINDOW_FULL_SIZE:"window_full_size",WINDOW_SIDEBAR:"window_sidebar",WEB_URL:"web_url",IGNORE_SYMBOL_REARRANGE:"ignore_symbol_rearrange"},Mu={basic:_.BASIC,bas:_.BASIC,markdown:_.DISK_MARKDOWN,md:_.DISK_MARKDOWN,image:_.IMAGE,img:_.IMAGE};function $u(n,e=_.NOTE_BLANK){const t=hr(n).toLowerCase();return Mu[String(t)]||e}var vr,hn,Pt,fn,mn,ze,Mt,pn,Be,Sr;const or=class or{constructor({locked:e=!1,id:t=null,name:r=null,meta:i=[],data:s=null,action:o=null,createdDate:a=Date.now(),editedDate:l=null}){g(this,vr,void 0);g(this,hn,!1);g(this,Pt,null);g(this,fn,void 0);g(this,mn,void 0);g(this,ze,void 0);g(this,Mt,void 0);g(this,pn,void 0);g(this,Be,void 0);g(this,Sr,void 0);if(v(this,vr,new Me),v(this,fn,a),v(this,mn,l||a),v(this,hn,e),v(this,ze,t),v(this,Mt,r),v(this,pn,new Map([[w.SYMBOL,$u(t||"",this.constructor.SYMBOL)],[w.VISIBLE,!0]].concat(i||[]))),typeof s=="string")try{s=JSON.parse(s)}catch(c){throw console.log(s),new Error(c)}v(this,Sr,o),this.data=s||{}}async remove(e){const{silent:t}=Object.assign({silent:!1},e);let r;const i=this.isLocked();if(!i)r={type:this.constructor.NAME,id:this.id,name:this.name,path:await this.getPath(),size:this.size,storage:this.getStorageItem()};else if(!t)return C.get("FileSystemItem_itemLocked",await this.getPath());return(t||!i)&&(this.events.next(new j("remove",this)),this.events.unsubscribe(),this.parent.removeItem(this)),r}isLocked(e){return e?!1:this.parent&&this.parent.locked&&this.parent.id!==Js?!0:u(this,hn)}getStorageItem(){return"storage"in this?this:this.parent?this.parent.getStorageItem():null}async copy(){const e=this.constructor;let t=await this.export({encodeData:!1});return t=new e(t),Promise.resolve(t)}rename(e,t){const{name:r=!1,ignore:i=!1}=Object.assign({name:!1,ignore:!1},t);if(!this.isLocked(i)){if(r)return this.name=e,this;{const s=this.id;v(this,ze,Ba(e)),this.parent&&s!==this.id&&this.parent.changeItemId(this,s,this.id)}this.events.next(new j("rename",{name:r,id:e}))}return this}save(){this.events.next(new j("save",this))}get type(){return this.constructor.NAME}async export(e){const{encodeData:t}=Object.assign({encodeData:!0},e),r=new Map(u(this,pn));return Array.from(r.keys()).forEach(i=>{r.get(i)instanceof nn&&r.set(i,r.get(i).toJSON())}),{type:this.type,id:u(this,ze),name:u(this,Mt),createdDate:u(this,fn),editedDate:u(this,mn),data:t?await Pu(u(this,Be)):u(this,Be),meta:Array.from(r)}}get createdDate(){return u(this,fn)}get editedDate(){return u(this,mn)}get data(){if(typeof u(this,Be)=="string")try{return JSON.parse(u(this,Be))}catch(e){return console.error(e),{data:u(this,Be)}}return u(this,Be)}set data(e){typeof e=="object"&&(e=JSON.stringify(e)),v(this,Be,e)}get action(){return u(this,Sr)}get events(){return u(this,vr)}get parent(){return u(this,Pt)}setId(e){v(this,ze,e)}setParent(e){v(this,Pt,e)}get locked(){return u(this,Pt)?u(this,Pt).locked:u(this,hn)}get id(){return u(this,ze)}get name(){return u(this,Mt)||u(this,ze)}set name(e){v(this,Mt,e)}get extension(){return hr(u(this,ze))}get meta(){return u(this,pn)}get size(){return new Blob([Object.values(this.data)]).size}get maxSize(){return new Blob([Object.values(this.data)]).size}getBase(){return or.getBaseRecursive({item:this},!1)}getPath(){return or.getBaseRecursive({item:this})}static getBaseRecursive({item:e,path:t=[]},r=!0){if(r&&t.push(e.id),e.parent)return or.getBaseRecursive({item:e.parent,path:t});if(t=t.reverse(),t[0]===Js&&t.shift(),t.length>0){let i=t[0];return/\./.test(i)||(i+=":"),`${i}${t.slice(1,t.length).join(Ou)}`}else return Js}};vr=new WeakMap,hn=new WeakMap,Pt=new WeakMap,fn=new WeakMap,mn=new WeakMap,ze=new WeakMap,Mt=new WeakMap,pn=new WeakMap,Be=new WeakMap,Sr=new WeakMap;let fe=or;C.add([["FileSystemItem_itemLocked",["Item Locked","Item is locked, can't be edit… %1"]]]);const ft={CENTER:0,ORDER_HORIZONTAL:1,ORDER_VERTICAL:2,ORDER_DIAGONAL_LEFT:3,ORDER_DIAGONAL_RIGHT:4,SPLIT_HORIZONTAL:5,SPLIT_VERTICAL:6,FULL:7};class ko{constructor(e,t=[]){p(this,"events",new Me);p(this,"id",Wn());p(this,"core");p(this,"layout",{size:S(0,0),position:S(0,0)});p(this,"groups",new Map);p(this,"modelMap",new Map);p(this,"models",Et([]));this.core=e,t.forEach(r=>this.add(r))}getActiveWindow(){return this.models.value.find(e=>e.options.focused)}setActiveWindow(e){this.models.value.forEach(t=>{t.options.focused=e===t.id,e===t.id&&this.events.next(new j("setActiveWindow",t))})}hasEmbbedWindow(){return!!this.models.value.find(e=>e.options.embed)}isHeaderVsible(){return!this.models.value.find(e=>e.options.embed&&e.options.hideRootHeader)}add(e,t){const{full:r,active:i,group:s}={full:!1,active:!0,group:null,...t};if(e instanceof dr||(e=new dr(e)),e.setWrapper(this),r&&(e.layout.size=this.layout.size),s){let o;this.groups.has(s)?(o=this.groups.get(s),o.windows.push(e)):(o={primary:e,windows:[],name:s},this.groups.set(s,o)),e.setGroup(o)}return e.layout.zIndex=this.models.value.length,this.models.value.push(e),this.events.next(new j("add",e)),this.modelMap.set(e.id,e),i&&this.setActiveWindow(e.id),e}remove(e){typeof e=="string"&&(e=this.get(e)),e.group&&(e.group.primary===e?(e.group.windows.forEach(t=>t.close()),this.groups.delete(e.group.name)):e.group.primary.focus()),this.models.value.splice(this.models.value.indexOf(e),1),this.modelMap.delete(e.id)}get(e){return this.modelMap.get(e)}clear(){this.models=Et([].splice(0,this.models.value.length)),this.modelMap.clear()}setWindowUpDown(e,t){const r=this.models.value,i=Array.from(r).filter(l=>!l.options.embed).sort((l,c)=>l.layout.zIndex-c.layout.zIndex).map(Zo),s=this.get(e),o=i.indexOf(s),a=i[t?o-1:o+1];if(a){const l=s.layout.zIndex;s.layout.zIndex=a.layout.zIndex,a.layout.zIndex=l}}centerWindow(e){typeof e=="string"&&(e=this.get(e)),yi(e,this.layout)}setWindowPositions(e,t=[],r){const{embed:i}={embed:!1,...r};switch(t.length<1&&t.push(...this.models.value),i||(t=t.filter(s=>!s.options.embed)),e){case ft.FULL:t.forEach(s=>{Wu(s,this.layout)});break;case ft.CENTER:t.forEach(s=>{yi(s,this.layout)});break;case ft.ORDER_DIAGONAL_LEFT:case ft.ORDER_DIAGONAL_RIGHT:Fu(t,this.layout,ft.ORDER_DIAGONAL_RIGHT===e);break;case ft.SPLIT_HORIZONTAL:case ft.SPLIT_VERTICAL:zu(t,this.layout,ft.SPLIT_VERTICAL===e);break}}saveSize(e,t){if(this.get(e).symbolWrapper&&this.get(e).symbolWrapper.fsItem){const r=this.get(e).symbolWrapper.fsItem;r.meta.set(w.WINDOW_SIZE,t),this.core.modules.files.fs.saveItem(r)}}savePosition(e,t){if(this.get(e).symbolWrapper&&this.get(e).symbolWrapper.fsItem){const r=this.get(e).symbolWrapper.fsItem;r.meta.set(w.WINDOW_POSITION,t),this.core.modules.files.fs.saveItem(r)}}}function Wu(n,e){n.layout.size=e.size}function yi(n,e){n.layout.position=S(()=>(e.size-n.layout.size)/2)}function Fu(n,e,t){const r=1/n.length;n.forEach((i,s)=>{yi(i,e),s=-Math.floor(n.length/2)+s;const o=S(i.layout.position.x+(t?-1:1)*(r*i.layout.size.x)*s,i.layout.position.y+r*i.layout.size.y*s),a=S(()=>e.size-i.layout.size);i.layout.position=S(()=>Math.max(Math.min(o,a),0))})}function zu(n,e,t){let r;const i=n.length;t?(r=S(e.size.x,e.size.y/i),n.forEach((s,o)=>{s.layout.position=S(0,o*r.y),s.layout.size=r})):(r=S(e.size.x/i,e.size.y),n.forEach((s,o)=>{s.layout.position=S(o*r.x,0),s.layout.size=r}))}var gt;class Bu{constructor(){g(this,gt,new Map);p(this,"capsLockActive",!1);p(this,"shiftLeftActive",!1);p(this,"shiftRightActive",!1);p(this,"cmdLeftActive",!1);p(this,"cmdRightActive",!1);p(this,"altLeftActive",!1);p(this,"altRightActive",!1);p(this,"pointerDown",null);p(this,"pointerUp",null);p(this,"pointerMove",null);p(this,"keyDown",null);p(this,"keyUp",null);this.resize=this.get("resize",window).pipe(Rt()),this.pointerDown=this.getPointerDown(),this.pointerUp=this.getPointerUp(),this.pointerMove=this.getPointerMove(),this.keypress=this.get("keypress").pipe(Rt()),this.keydown=this.keyDown=this.get("keydown").pipe(Rt()),this.keyup=this.keyUp=this.get("keyup").pipe(Rt()),this.keyDown.subscribe(({keyCode:e,location:t})=>{switch(e){case 91:this.cmdLeftActive=!0;break;case 93:this.cmdRightActive=!0;break;case 16:t===2?this.shiftRightActive=!0:this.shiftLeftActive=!0;break;case 18:t===2?this.altRightActive=!0:this.altLeftActive=!0;break;case 20:this.capsLockActive=!this.capsLockActive;break}}),this.keyUp.subscribe(({keyCode:e,location:t})=>{switch(e){case 91:this.cmdLeftActive=!1;break;case 93:this.cmdRightActive=!1;break;case 16:t===2?this.shiftRightActive=!1:this.shiftLeftActive=!1;break;case 18:t===2?this.altRightActive=!1:this.altLeftActive=!1;break}})}getPointerDown(e){return this.get("pointerdown",e).pipe(nr(t=>bs(t))).pipe(Rt())}getPointerUp(e){return this.get("pointerup",e).pipe(nr(t=>bs(t))).pipe(Rt())}getPointerMove(e){return this.get("pointermove",e).pipe(nr(t=>bs(t))).pipe(Rt())}get(e,t){t=t||document,u(this,gt).has(t)||u(this,gt).set(t,new Map);const r=u(this,gt).get(t);if(!r.has(e)){const i={passive:!0,capture:!1};r.set(e,ui(t,e,i))}return r.get(e)}reset(){Array.from(u(this,gt).values).forEach(e=>e.unsubscribe()),u(this,gt).reset()}get cmdActive(){return this.cmdLeftActive||this.cmdRightActive}get altActive(){return this.altLeftActive||this.altRightActive}get shiftActive(){return this.shiftLeftActive||this.shiftRightActive}}gt=new WeakMap;let To;const ei=To||(To=new Bu);var Ag=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Vu(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var ju=({onlyFirst:n=!1}={})=>{const e=["[\\u001B\\u009B][[\\]()#;?]*(?:(?:(?:(?:;[-a-zA-Z\\d\\/#&.:=?%@~_]+)*|[a-zA-Z\\d]+(?:;[-a-zA-Z\\d\\/#&.:=?%@~_]*)*)?\\u0007)","(?:(?:\\d{1,4}(?:;\\d{0,4})*)?[\\dA-PR-TZcf-ntqry=><~]))"].join("|");return new RegExp(e,n?void 0:"g")};const Uu=ju;var Gu=n=>typeof n=="string"?n.replace(Uu(),""):n,Ki={exports:{}},Ua={exports:{}};(function(n){var e=function(){function t(l,c,d,f){typeof c=="object"&&(d=c.depth,f=c.prototype,c.filter,c=c.circular);var h=[],m=[],I=typeof Vn<"u";typeof c>"u"&&(c=!0),typeof d>"u"&&(d=1/0);function b(A,$){if(A===null)return null;if($==0)return A;var D,P;if(typeof A!="object")return A;if(t.__isArray(A))D=[];else if(t.__isRegExp(A))D=new RegExp(A.source,a(A)),A.lastIndex&&(D.lastIndex=A.lastIndex);else if(t.__isDate(A))D=new Date(A.getTime());else{if(I&&Vn.isBuffer(A))return Vn.allocUnsafe?D=Vn.allocUnsafe(A.length):D=new Vn(A.length),A.copy(D),D;typeof f>"u"?(P=Object.getPrototypeOf(A),D=Object.create(P)):(D=Object.create(f),P=f)}if(c){var me=h.indexOf(A);if(me!=-1)return m[me];h.push(A),m.push(D)}for(var Z in A){var pe;P&&(pe=Object.getOwnPropertyDescriptor(P,Z)),!(pe&&pe.set==null)&&(D[Z]=b(A[Z],$-1))}return D}return b(l,d)}t.clonePrototype=function(c){if(c===null)return null;var d=function(){};return d.prototype=c,new d};function r(l){return Object.prototype.toString.call(l)}t.__objToStr=r;function i(l){return typeof l=="object"&&r(l)==="[object Date]"}t.__isDate=i;function s(l){return typeof l=="object"&&r(l)==="[object Array]"}t.__isArray=s;function o(l){return typeof l=="object"&&r(l)==="[object RegExp]"}t.__isRegExp=o;function a(l){var c="";return l.global&&(c+="g"),l.ignoreCase&&(c+="i"),l.multiline&&(c+="m"),c}return t.__getRegExpFlags=a,t}();n.exports&&(n.exports=e)})(Ua);var Hu=Ua.exports,Yu=Hu,Xu=function(n,e){return n=n||{},Object.keys(e).forEach(function(t){typeof n[t]>"u"&&(n[t]=Yu(e[t]))}),n},qu=[[768,879],[1155,1158],[1160,1161],[1425,1469],[1471,1471],[1473,1474],[1476,1477],[1479,1479],[1536,1539],[1552,1557],[1611,1630],[1648,1648],[1750,1764],[1767,1768],[1770,1773],[1807,1807],[1809,1809],[1840,1866],[1958,1968],[2027,2035],[2305,2306],[2364,2364],[2369,2376],[2381,2381],[2385,2388],[2402,2403],[2433,2433],[2492,2492],[2497,2500],[2509,2509],[2530,2531],[2561,2562],[2620,2620],[2625,2626],[2631,2632],[2635,2637],[2672,2673],[2689,2690],[2748,2748],[2753,2757],[2759,2760],[2765,2765],[2786,2787],[2817,2817],[2876,2876],[2879,2879],[2881,2883],[2893,2893],[2902,2902],[2946,2946],[3008,3008],[3021,3021],[3134,3136],[3142,3144],[3146,3149],[3157,3158],[3260,3260],[3263,3263],[3270,3270],[3276,3277],[3298,3299],[3393,3395],[3405,3405],[3530,3530],[3538,3540],[3542,3542],[3633,3633],[3636,3642],[3655,3662],[3761,3761],[3764,3769],[3771,3772],[3784,3789],[3864,3865],[3893,3893],[3895,3895],[3897,3897],[3953,3966],[3968,3972],[3974,3975],[3984,3991],[3993,4028],[4038,4038],[4141,4144],[4146,4146],[4150,4151],[4153,4153],[4184,4185],[4448,4607],[4959,4959],[5906,5908],[5938,5940],[5970,5971],[6002,6003],[6068,6069],[6071,6077],[6086,6086],[6089,6099],[6109,6109],[6155,6157],[6313,6313],[6432,6434],[6439,6440],[6450,6450],[6457,6459],[6679,6680],[6912,6915],[6964,6964],[6966,6970],[6972,6972],[6978,6978],[7019,7027],[7616,7626],[7678,7679],[8203,8207],[8234,8238],[8288,8291],[8298,8303],[8400,8431],[12330,12335],[12441,12442],[43014,43014],[43019,43019],[43045,43046],[64286,64286],[65024,65039],[65056,65059],[65279,65279],[65529,65531],[68097,68099],[68101,68102],[68108,68111],[68152,68154],[68159,68159],[119143,119145],[119155,119170],[119173,119179],[119210,119213],[119362,119364],[917505,917505],[917536,917631],[917760,917999]],Ku=Xu,Gn=qu,Ga={nul:0,control:0};Ki.exports=function(e){return Ha(e,Ga)};Ki.exports.config=function(n){return n=Ku(n||{},Ga),function(t){return Ha(t,n)}};function Ha(n,e){if(typeof n!="string")return Ro(n,e);for(var t=0,r=0;r<n.length;r++){var i=Ro(n.charCodeAt(r),e);if(i<0)return-1;t+=i}return t}function Ro(n,e){return n===0?e.nul:n<32||n>=127&&n<160?e.control:Zu(n)?0:1+(n>=4352&&(n<=4447||n==9001||n==9002||n>=11904&&n<=42191&&n!=12351||n>=44032&&n<=55203||n>=63744&&n<=64255||n>=65040&&n<=65049||n>=65072&&n<=65135||n>=65280&&n<=65376||n>=65504&&n<=65510||n>=131072&&n<=196605||n>=196608&&n<=262141))}function Zu(n){var e=0,t=Gn.length-1,r;if(n<Gn[0][0]||n>Gn[t][1])return!1;for(;t>=e;)if(r=Math.floor((e+t)/2),n>Gn[r][1])e=r+1;else if(n<Gn[r][0])t=r-1;else return!0;return!1}var Qu=Ki.exports,Ju=Gu,ed=Qu,Ya=function(n){return ed(Ju(n))},Jt={},ot=Ya;function Ss(n,e){return Array.apply(null,{length:e+1}).join(n).slice(0,e)}function td(n,e,t){n=n??"",n=String(n);var r=e-ot(n);return r<=0?n:n+Ss(t||" ",r)}function nd(n,e,t){n=n??"",n=String(n);var r=e-ot(n);if(r<=0)return n;var i=Math.floor(r/2),s=r-i;return Ss(t||" ",i)+n+Ss(t||" ",s)}function rd(n,e,t){n=n??"",n=String(n);var r=e-ot(n);return r<=0?n:Ss(t||" ",r)+n}function sd(n,e){function t(r,i){return r.trim().split(" ").reduce(function(s,o){var a=s[s.length-1];return a&&ot(a.join(" "))+ot(o)<i?s[s.length-1].push(o):s.push([o]),s},[]).map(function(s){return s.join(" ")})}return n.split(`
`).map(function(r){return t(r,e)}).reduce(function(r,i){return r.concat(i)},[])}function id(n,e,t){n=n.trim();for(var r=[],i=n.split(" "),s="",o=ot(t);s||i.length;){if(s){var a=s;s=""}else var a=i.shift();if(ot(a)>e){for(var l=0,c=0,d=e-o;l<a.length;){var f=ot(a.charAt(l));if(f+c>d)break;c+=f,++l}s=a.slice(l),a=a.slice(0,l),a+=t}r.push(a)}return r.join(" ")}function od(n,e){if(n=n??"",n=String(n),e==1/0)return n;for(var t=0,r=0;t<n.length;){var i=ot(n.charAt(t));if(i+r>e)break;r+=i,++t}return n.slice(0,t)}Jt.padRight=td;Jt.padCenter=nd;Jt.padLeft=rd;Jt.splitIntoLines=sd;Jt.splitLongWords=id;Jt.truncateString=od;var ti=Ya,Fn=Jt,ad=Fn.padRight,ld=Fn.padCenter,cd=Fn.padLeft,Do=Fn.splitIntoLines,ud=Fn.splitLongWords,dd=Fn.truncateString,Xa=function(e){return e.toUpperCase()},hd=function(e,t,r){return e},fd=Object.freeze({maxWidth:1/0,minWidth:0,columnSplitter:" ",truncate:!1,truncateMarker:"…",preserveNewLines:!1,paddingChr:" ",showHeaders:!0,headingTransform:Xa,dataTransform:hd}),md=function(n){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},t=e.config||{};delete e.config;var r=e.maxLineWidth||1/0;r==="auto"&&(r=zl.stdout.columns||1/0),delete e.maxLineWidth,e=Co({},fd,e),e.config=e.config||Object.create(null),e.spacing=e.spacing||`
`,e.preserveNewLines=!!e.preserveNewLines,e.showHeaders=!!e.showHeaders,e.columns=e.columns||e.include;var i=e.columns||[];n=yd(n,i),i.length||n.forEach(function(l){for(var c in l)i.indexOf(c)===-1&&i.push(c)});var s=i.reduce(function(l,c){var d=Object.create(e);return l[c]=Co(d,t[c]),l},Object.create(null));i.forEach(function(l){var c=s[l];c.name=l,c.maxWidth=Math.ceil(c.maxWidth),c.minWidth=Math.ceil(c.minWidth),c.truncate=!!c.truncate,c.align=c.align||"left"}),n=n.map(function(l){var c=Object.create(null);return i.forEach(function(d){c[d]=l[d]!=null?l[d]:"",c[d]=""+c[d],s[d].preserveNewLines?c[d]=c[d].replace(/[^\S\n]/gmi," "):c[d]=c[d].replace(/\s/gmi," ")}),c}),i.forEach(function(l){var c=s[l];n=n.map(function(d,f){var h=Object.create(c);d[l]=c.dataTransform(d[l],h,f);var m=Object.keys(h);if(m.indexOf("name")!==-1){if(c.headingTransform!==Xa)return;c.headingTransform=function(I){return I}}return m.forEach(function(I){return c[I]=h[I]}),d})});var o={};e.showHeaders&&(i.forEach(function(l){var c=s[l];if(!c.showHeaders){o[l]="";return}o[l]=c.headingTransform(c.name)}),n.unshift(o)),i.forEach(function(l){var c=s[l];c.width=n.map(function(d){return d[l]}).reduce(function(d,f){return d>=c.maxWidth?d:Math.max(d,Math.min(c.maxWidth,Math.max(c.minWidth,ti(f))))},0)}),i.forEach(function(l){var c=s[l];n=n.map(function(d){return d[l]=ud(d[l],c.width,c.truncateMarker),d})}),i.forEach(function(l){var c=s[l];n=n.map(function(d,f){var h=d[l];if(d[l]=Do(h,c.width),c.truncate&&d[l].length>1){d[l]=Do(h,c.width-ti(c.truncateMarker));var m=d[l][0];bd(m,c.truncateMarker)||(d[l][0]+=c.truncateMarker),d[l]=d[l].slice(0,1)}return d})}),i.forEach(function(l){var c=s[l];c.width=n.map(function(d){return d[l].reduce(function(f,h){return f>=c.maxWidth?f:Math.max(f,Math.min(c.maxWidth,Math.max(c.minWidth,ti(h))))},0)}).reduce(function(d,f){return d>=c.maxWidth?d:Math.max(d,Math.min(c.maxWidth,Math.max(c.minWidth,f)))},0)});var a=pd(n,s,i,e.paddingChr);return a.reduce(function(l,c){return l.concat(c.reduce(function(d,f){return d.concat(f.join(e.columnSplitter))},[]))},[]).map(function(l){return dd(l,r)}).join(e.spacing)};function pd(n,e,t,r){return n.map(function(i){var s=[],o=0;t.forEach(function(c){o=Math.max(o,i[c].length)});for(var a=function(d){s[d]=s[d]||[],t.forEach(function(f){var h=e[f],m=i[f][d]||"";h.align==="right"?s[d].push(cd(m,h.width,r)):h.align==="center"||h.align==="centre"?s[d].push(ld(m,h.width,r)):s[d].push(ad(m,h.width,r))})},l=0;l<o;l++)a(l);return s})}function Co(){return Object.assign?Object.assign.apply(Object,arguments):gd.apply(void 0,arguments)}function gd(n,e){if(n==null)throw new TypeError("Cannot convert first argument to object");for(var t=Object(n),r=!1,i,s=1;s<arguments.length;s++){var o=arguments[s];if(o!=null){for(var a=Object.keys(Object(o)),l=0,c=a.length;l<c;l++){var d=a[l];try{var f=Object.getOwnPropertyDescriptor(o,d);f!==void 0&&f.enumerable&&(t[d]=o[d])}catch(h){r||(r=!0,i=h)}}if(r)throw i}}return t}function bd(n,e,t){t=t||n.length,t=t-e.length;var r=n.lastIndexOf(e);return r!==-1&&r===t}function yd(n,e){if(Array.isArray(n))return n;var t=[];for(var r in n){var i={};i[e[0]||"key"]=r,i[e[1]||"value"]=n[r],t.push(i)}return t}const wi=Vu(md);var Ir,Or,Ar,gn;class Ht{constructor(e){g(this,Ir,0);g(this,Or,!0);g(this,Ar,[]);g(this,gn,[]);const{showHeader:t,headerPadding:r,columns:i}=Object.assign({showHeader:!0,headerPadding:0,columns:[]},e);v(this,Or,t),v(this,Ir,r),this.addColumn(i)}addColumn(e){Array.isArray(e)?u(this,gn).push(...[].concat(e)):u(this,gn).push(Object.assign({value:null,align:"left",minWidth:0,maxWidth:0,spacerChar:" "},e))}addRow(e){u(this,Ar).push(...[].concat(e))}static createSpacer(e,t,r){if(e.length<t){t=t-e.length;for(let i=0;i<t;i++)e+=r}return e}get columns(){return u(this,gn)}get rows(){return u(this,Ar)}get showHeader(){return u(this,Or)}get headerPadding(){return u(this,Ir)}toColumnify(){const e=this.columns.map(i=>i.value),t=this.rows.reduce((i,s,o)=>(o<1&&this.showHeader&&this.headerPadding&&i.push(...Array(this.headerPadding).fill("")),i.push(this.columns.reduce((a,l,c)=>(a[l.value]=s[Number(c)],a),{})),i),[]),r=this.columns.reduce((i,s)=>(i[s.value]={},s.align&&(i[s.value].align=s.align),s.minWidth&&(i[s.value].minWidth=s.minWidth),s.maxWidth&&(i[s.value].maxWidth=s.maxWidth),i[s.value].headingTransform=o=>o,i),{});return wi(t,{showHeaders:this.showHeader,preserveNewLines:!0,config:r,columns:e}).replace(/\xC2/g," ")}}Ir=new WeakMap,Or=new WeakMap,Ar=new WeakMap,gn=new WeakMap;class wd{constructor(e){p(this,"core");p(this,"debug",!1);p(this,"consoleInterface");const{core:t,debug:r,consoleInterface:i}=Object.assign({core:null,debug:!1,consoleInterface:null},e);this.core=t,this.debug=r,this.consoleInterface=i}add(e,t){}}const ar=class ar extends wd{constructor(t){const{silent:r,color:i}=t=Object.assign({silent:!1,color:!1},t);super(t);p(this,"silent");p(this,"entries",[]);p(this,"color",!1);this.silent=r,this.color=i}add(t,r){const{namespace:i,type:s}=Object.assign({namespace:null,type:ar.TYPE.INFO},r);this.entries.push(t),!this.silent&&s!==ar.TYPE.DEBUG&&(i?this.color?console.log("%c[ %s ]%c[ %s ]","background: #000; color: #008000",s,"background: #000; color: #90ee90",i,t):console.log(`[ ${s.toUpperCase()} ][ ${i} ]`,t):t instanceof Ht?this.consoleInterface.table(t):this.consoleInterface.log(t))}};p(ar,"TYPE",{DEBUG:"debug",INFO:"info",OUTPUT:"output"});let fr=ar;var bn,$t,kr,Xe,Xo;let Zi=(Xo=class{constructor(e){g(this,bn,!1);g(this,$t,void 0);g(this,kr,void 0);g(this,Xe,{});e=Object.assign({locked:u(this,bn),storage:void 0,name:void 0},e),v(this,bn,e.locked),v(this,$t,e.storage),v(this,kr,e.name)}get locked(){return u(this,bn)}get name(){return u(this,kr)}get storage(){return u(this,$t)}get data(){return u(this,Xe)}set data(e){v(this,Xe,e)}mount(){return new Promise(e=>{e(this)})}unmount(){return new Promise(e=>{e(this)})}load(){if(!u(this,$t))throw new Error("no storage");return Promise.resolve(u(this,Xe))}save(e){if(!u(this,$t))throw new Error("no storage");return v(this,Xe,e||u(this,Xe)),Promise.resolve(u(this,Xe))}},bn=new WeakMap,$t=new WeakMap,kr=new WeakMap,Xe=new WeakMap,Xo);var Wt;class qa{constructor(){g(this,Wt,new Map)}getItem(e){return u(this,Wt).get(e)}setItem(e,t){u(this,Wt).set(e,t)}removeItem(e){u(this,Wt).delete(e)}clear(){u(this,Wt).clear()}}Wt=new WeakMap;class _d extends Zi{constructor(e){e=Object.assign({storage:new qa},e),super(e)}}class Ka extends Zi{mount(){return new Promise(e=>{try{let t;try{if(t=this.storage.getItem(this.name),t){if(t=JSON.parse(t),!t||!(t instanceof Object))throw new Error("json invalid")}else throw new Error("json invalid")}catch(r){console.error(r),t={}}this.storage.setItem(this.name,JSON.stringify(t)),e(this)}catch(t){throw new Error(t)}})}load(){return new Promise(e=>{if(this.storage)try{this.data=JSON.parse(this.storage.getItem(this.name)),e(this.data)}catch(t){throw new Error(t)}})}save(e){return new Promise(t=>{if(this.storage)try{this.data=e||this.data,this.storage.setItem(this.name,JSON.stringify(this.data)),t(this.data)}catch(r){throw new Error(r)}})}}class xd extends Ka{constructor(e){e=Object.assign({storage:window.localStorage},e),super(e)}}class Ed extends Ka{constructor(e){e=Object.assign({storage:window.sessionStorage||new qa},e),super(e)}}class Za extends Zi{}const ce={NONE:0,AUTO:1,TEMP:3,LOCAL:4,SESSION:5,CLOUD:6};function Qa(n){switch(n){case ce.TEMP:return _d;case ce.LOCAL:return xd;case ce.SESSION:return Ed;case ce.CLOUD:return Za;default:return Storage}}var Le,Ft,yn,Tr;class vd{constructor(e,t){g(this,Le,new Map);g(this,Ft,Ne({}));g(this,yn,void 0);g(this,Tr,void 0);v(this,yn,new(Qa(t||ce.NONE))({name:e})),v(this,Tr,u(this,yn).load().then(r=>(v(this,Le,new Map(r)),Object.assign(u(this,Ft),Object.fromEntries(u(this,Le))),this)).catch(r=>{throw r}))}setDefaults(e){Object.keys(e).forEach(t=>{this.has(t)||this.set(t,e[String(t)])})}get(e){return u(this,Le).get(e)}has(e){return u(this,Le).has(e)}set(e,t){return typeof e=="object"&&!(e instanceof Map)?Object.keys(e).forEach(r=>{t=e[String(r)],u(this,Le).set(r,t),u(this,Ft)[String(r)]=t}):(u(this,Le).set(e,t),u(this,Ft)[String(e)]=t),u(this,yn).save(Array.from(u(this,Le)))}get observable(){return u(this,Ft)}get entries(){return u(this,Le)}get ready(){return u(this,Tr)}}Le=new WeakMap,Ft=new WeakMap,yn=new WeakMap,Tr=new WeakMap;class Sd{constructor(e){p(this,"core");this.core=e}ready(){}prompt(e){}log(...e){console.log(...e)}clear(...e){}destroy(){}}class Id extends Sd{prompt(e){const t=["openDialog","--prompt"];return e&&t.push(`--message="${X(e)}"`),this.core.executeCommand(t.join(" "))}}var Rr,Dr;class Od{constructor(e){g(this,Rr,void 0);g(this,Dr,[]);v(this,Rr,e)}command(e,t){u(this,Dr).push({value:e,targetValue:t})}run(){return Promise.all(u(this,Dr).map(({value:e,targetValue:t})=>u(this,Rr).executeCommand(e).then(r=>{const i=r===t;return i||console.warn(`[ ${e} ]; ${r} === ${t}`),{value:e,targetValue:t,result:r,success:i}})))}async start(){const e=await this.run();return[[e.length,"Tests processed"],[e.filter(t=>t.success).length,"Tests success"],[e.filter(t=>!t.success).length,"Tests failed"]]}}Rr=new WeakMap,Dr=new WeakMap;function ut(n,e={}){const t=Al(n),{id:r,parentFocused:i,core:s,window:o,parentWindow:a}=t,l=Et(),c=Et(),d=Qo(()=>o.value.options.embedded),f=(b,A={})=>{c.value=new qt(b,{core:s.value,mainWindow:fo(o),parentWindow:fo(a),preserveContextMenu:m,...A})},h=Et(!1),m=(b=!0)=>{h.value=b},I=b=>{c.value&&(b?l.value=s.value.modules.windows.setActiveContextMenu(c.value):!h.value&&s.value.modules.windows.getActiveContextMenu()===l.value&&!d.value&&s.value.modules.windows.setActiveContextMenu(null))};return ho(i,b=>I(b)),ho(c,b=>{l.value=s.value.modules.windows.setActiveContextMenu(b)}),kl(()=>{Tl(()=>{e.emit("ready"),I(!0)})}),Rl(()=>{c.value&&s.value.modules.windows.isContextMenu(l.value)&&s.value.modules.windows.setActiveContextMenu(null)}),{id:r,parentFocused:i,core:s,window:o,setContextMenu:f,preserveContextMenu:m,contextMenu:c,currentContextMenu:l}}const dt={id:{type:String,default:""},parentFocused:{type:Boolean,default:!1},core:{type:Object,required:!0},window:{type:Object,required:!0},parentWindow:{type:Object,required:!1}},ht=["ready","refresh"];function Ad(n,e,t){return"#"+((1<<24)+(n<<16)+(e<<8)+t).toString(16).slice(1)}function No(n){return n=n.replace(/ /g,""),n.length===7?["0x"+n[1]+n[2]|0,"0x"+n[3]+n[4]|0,"0x"+n[5]+n[6]|0]:["0x"+n[1]+n[1]|0,"0x"+n[2]+n[2]|0,"0x"+n[3]+n[3]|0]}function Tg(n){if(n=n.replace(/^#/,""),n.length===3)return"#"+n.split("").map(e=>{const t=String(parseInt(e,16));return t.length===1?`0${t}`:t}).join("");if(n.length===6)return"#"+n}const kd={__name:"Form",emits:["submit"],setup(n,{emit:e}){const t=e,r=i=>{i.preventDefault(),t("submit",i)};return(i,s)=>(x(),T("form",{class:"wb-env-molecule-form",onSubmit:r},[Dn(i.$slots,"default",{},()=>[Jo("Form Content")],!0)],32))}},zn=V(kd,[["__scopeId","data-v-f27f0d40"]]),Td={props:{labelTop:{type:Boolean,default:!1},tag:{type:String,default:"div"},label:{type:String,default:"FormField Label"}},computed:{styleClasses(){return{"label-top":this.labelTop}}}},Rd={key:0,class:"label"};function Dd(n,e,t,r,i,s){return x(),z(ii(t.tag),{class:at(["wb-env-atom-form-field",s.styleClasses])},{default:G(()=>[t.label?(x(),T("span",Rd,[Dn(n.$slots,"label",{},()=>[Jo(Ce(t.label),1)],!0)])):W("",!0),Dn(n.$slots,"default",{},void 0,!0)]),_:3},8,["class"])}const Bn=V(Td,[["render",Dd],["__scopeId","data-v-b7502b89"]]),Cd={props:{model:{type:[Array,Object],default(){return{value:0}}},min:{type:Number,default(){return 0}},max:{type:Number,default(){return 1}},step:{type:Number,default(){return .1}},name:{type:String,default:"value"},handleSize:{type:Number,default(){return .2}},styleType:{type:String,default:"window"},directionVertical:{type:Boolean,default:!1}},data(){return{positions:{start:S(),move:S(),current:S()}}},computed:{style(){const n={"--value":this.model[this.name]/this.max,"--direction":this.directionVertical?1:0};return n["--size"]=this.handleSize*100+"%",n},styleClasses(){return{"direction-x":!this.directionVertical,"direction-y":this.directionVertical,[`type-${this.styleType}`]:this.styleType}}}},Nd=n=>(Pi("data-v-d4cc5e75"),n=n(),Mi(),n),Ld=["orient","min","max","step"],Pd=Nd(()=>E("i",null,null,-1));function Md(n,e,t,r,i,s){return x(),T("div",{class:at(["wb-env-atom-range-slider",s.styleClasses]),style:Cn(s.style)},[Zt(E("input",{"onUpdate:modelValue":e[0]||(e[0]=o=>t.model[t.name]=o),orient:t.directionVertical?"vertical":"horizontal",type:"range",min:t.min,max:t.max,step:t.step},null,8,Ld),[[ea,t.model[t.name]]]),Pd],6)}const $d=V(Cd,[["render",Md],["__scopeId","data-v-d4cc5e75"]]),Wd={components:{WbEnvAtomFormField:Bn,WbEnvAtomRangeSlider:$d},props:{model:{type:[Array,Object],default(){return{}}},id:{type:String,default:null},name:{type:String,default:null},readonly:{type:Boolean,default:!1},min:{type:Number,default:null},max:{type:Number,default:null},step:{type:Number,default:null},handleSize:{type:Number,default:null},disabled:{type:Boolean,default:!1},directionVertical:{type:Boolean,default:!1}},computed:{currentModel:{get(){return this.name?this.model[this.name]:this.model.value},set(n){this.name?this.model[this.name]=n:this.model.value=n}},rangeSlider(){return{name:this.name,min:this.min,max:this.max,step:this.step,handleSize:this.handleSize,readonly:this.readonly,disabled:this.disabled,directionVertical:this.directionVertical}}}};function Fd(n,e,t,r,i,s){const o=k("wb-env-atom-range-slider"),a=k("wb-env-atom-form-field");return x(),z(a,F({tag:"div",class:"wb-env-atom-form-range-slider"},n.$attrs),{default:G(()=>[Dn(n.$slots,"before"),R(o,F(s.rangeSlider,{model:t.model,"style-type":"form-field"}),null,16,["model"]),Dn(n.$slots,"after")]),_:3},16)}const zd=V(Wd,[["render",Fd]]),Bd={xmlns:"http://www.w3.org/2000/svg",width:"10",height:"6"},Vd=E("g",{class:"primary"},[E("path",{d:"M0 0h2v2H0zM2 2h2v2H2zM8 0h2v2H8zM4 4h2v2H4zM6 2h2v2H6z"})],-1),jd=[Vd];function Ud(n,e){return x(),T("svg",Bd,[...jd])}const Gd={render:Ud},Hd={components:{SvgControlTinyArrayDown:Gd,WbEnvAtomFormField:Bn},props:{model:{type:Object,default(){return{value:"option-1"}}},label:{type:String,default:"Select Label"},id:{type:String,default:null},name:{type:String,default:null},size:{type:Number,default:null},multiple:{type:Boolean,default:!1},readonly:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},options:{type:Array,default(){return[{title:"Option 1.",value:"option-1"},{title:"Option 2.",value:"option-2"},{title:"Option 3.",value:"option-3"},{title:"Option 4.",value:"option-4"},{title:"Option 5.",value:"option-5"}]}}},computed:{currentModel:{get(){return this.name?this.model[this.name]:this.model.value},set(n){this.name?this.model[this.name]=n:this.model.value=n}},input(){return{id:this.id,size:this.size>1?this.size:null,multiple:this.multiple,readonly:this.readonly,disabled:this.disabled}}}},Yd={class:"wrapper"},Xd=["value"],qd={key:0,class:"select-expander"};function Kd(n,e,t,r,i,s){const o=k("svg-control-tiny-array-down"),a=k("wb-env-atom-form-field");return x(),z(a,{tag:"label",class:"wb-env-atom-form-field-dropdown",label:t.label},{default:G(()=>[E("div",Yd,[Zt(E("select",F({"onUpdate:modelValue":e[0]||(e[0]=l=>s.currentModel=l)},s.input),[(x(!0),T(vt,null,St(t.options,(l,c)=>(x(),T("option",{key:c,value:l.value},Ce(l.title),9,Xd))),128))],16),[[Dl,s.currentModel]]),!t.disabled&&!t.readonly?(x(),T("span",qd,[R(o)])):W("",!0)])]),_:1},8,["label"])}const Qi=V(Hd,[["render",Kd],["__scopeId","data-v-34f9d189"]]),Zd={props:{disabled:{type:Boolean,default:!1},accept:{type:String,default:"application/json"},type:{type:String,default(){return"button"}},styleType:{type:String,default(){return"primary"}},id:{type:String,required:!1,default:null},name:{type:String,required:!1,default:null},label:{type:String,required:!1,default:"Primary Button"}},emits:["upload","click"],computed:{upload(){return this.type==="upload"},styleClasses(){return{disabled:this.disabled,upload:this.upload,["type-"+this.styleType]:this.styleType}}},methods:{onInput(n){this.$emit("upload",n.target.files)},onClick(){this.$emit("click")}}},Qd={class:"label"},Jd=["id","name","accept","disabled"],eh=["type","disabled"],th={class:"label"};function nh(n,e,t,r,i,s){return s.upload?(x(),T("label",{key:0,class:at(["wb-env-atom-button",s.styleClasses])},[E("span",Qd,Ce(t.label),1),E("input",{id:t.id,name:t.name,type:"file",accept:t.accept,disabled:t.disabled,onInput:e[0]||(e[0]=(...o)=>s.onInput&&s.onInput(...o))},null,40,Jd)],2)):(x(),T("button",{key:1,type:t.type,class:at(["wb-env-atom-button",s.styleClasses]),disabled:t.disabled,onClick:e[1]||(e[1]=(...o)=>s.onClick&&s.onClick(...o))},[E("span",th,Ce(t.label),1)],10,eh))}const kt=V(Zd,[["render",nh],["__scopeId","data-v-d0dc09a9"]]),rh={props:{full:{type:Boolean,required:!1,default:!1},align:{type:String,required:!1,validate:n=>["center","left","right","outer"].includes(n),default:"left"},direction:{type:String,required:!1,validate:n=>["horizontal","vertical"].includes(n),default:"horizontal"}},computed:{styleClasses(){return{[`direction-${this.direction}`]:!0,[`align-${this.align}`]:!0,full:this.full}}}};function sh(n,e,t,r,i,s){return x(),T("div",{class:at(["wb-env-molecule-button-wrapper",s.styleClasses])},[E("div",null,[Dn(n.$slots,"default",{},void 0,!0)])],2)}const Tt=V(rh,[["render",sh],["__scopeId","data-v-13c4bed6"]]),ih={components:{WbForm:zn,WbFormField:Bn,WbFormFieldRangeSlider:zd,WbFormFieldDropdown:Qi,WbButton:kt,WbButtonWrapper:Tt},props:{...dt},emits:[...ht,"close"],setup(n,e){return ut(n,e)},data(){const n=this.core.config.get(N.THEME)||Qn[String(Wa)];return{screenModule:this.core.modules.screen,selectedColor:n.colors[1],colors:No(n.colors[1]),saveLabel:"Save",resetLabel:"Reset",model:n,preset:"",fields:{presets:{name:"preset",model:this,label:"Presets",options:[{title:"Select Theme",value:""},...Object.keys(Qn).map(e=>({title:Qn[String(e)].title,value:e}))]},colorPrimary:{name:"0",type:"color",label:"Primary"},colorSecondary:{name:"1",type:"color",label:"Secondary"},colorTertiary:{name:"2",type:"color",label:"Tertiary"},colorQuaternary:{name:"3",type:"color",label:"Quaternary"},filter:{name:"filter",label:"Filter",options:[{title:"Invert",value:"invert(100%)"},{title:"Brightness",value:"brightness(50%)"}]}}}},watch:{preset(n){const e=Qn[String(n)];this.model={name:e.name,colors:e.colors,filter:e.filter},this.selectedColor=this.model.colors[0]},selectedColor(n){this.colors=No(n)},colors:{deep:!0,handler(n){this.selectedColor=this.model.colors[this.model.colors.indexOf(this.selectedColor)]=Ad(...Object.values(n).map(e=>Number(e)))}}},methods:{onSubmit(){const n=this.model;this.core.config.set(N.THEME,n),this.core.modules.screen.setTheme(new _u("custom",n)),this.$emit("close")}}},oh={class:"wb-module-core-color-settings"},ah={class:"col-1"},lh=["value"],ch={class:"col-1 colors"},uh={class:"color-controls"},dh={class:"color-preview"};function hh(n,e,t,r,i,s){const o=k("wb-form-field-dropdown"),a=k("wb-form-field"),l=k("wb-form-field-range-slider"),c=k("wb-button"),d=k("wb-button-wrapper"),f=k("wb-form");return x(),T("div",oh,[R(f,{class:"form",onSubmit:s.onSubmit},{default:G(()=>[E("div",null,[E("div",ah,[R(o,tr(ta(i.fields.presets)),null,16),R(a,{label:"Colors",class:"color-select"},{default:G(()=>[(x(!0),T(vt,null,St(i.model.colors,(h,m)=>(x(),T("label",{key:m,style:Cn({"--color":h})},[Zt(E("input",{"onUpdate:modelValue":e[0]||(e[0]=I=>i.selectedColor=I),type:"radio",name:"color",value:h},null,8,lh),[[Cl,i.selectedColor]])],4))),128))]),_:1}),R(o,F(i.fields.filter,{model:i.model}),null,16,["model"])]),E("div",ch,[E("div",uh,[E("div",dh,[E("i",{style:Cn(`background-color: rgb(${i.colors.join(", ")});`)},null,4)]),E("div",null,[E("div",null,[R(l,{"style-type":"color-select",label:"Red",class:"color-slider",model:i.colors,name:"0",max:255,min:0,step:1,"handle-size":.2},{after:G(()=>[E("span",null,Ce(i.colors[0].toString(16).toUpperCase()),1)]),_:1},8,["model"])]),E("div",null,[R(l,{"style-type":"color-select",label:"Green",class:"color-slider",model:i.colors,name:"1",max:255,min:0,step:1,"handle-size":.2},{after:G(()=>[E("span",null,Ce(i.colors[1].toString(16).toUpperCase()),1)]),_:1},8,["model"])]),E("div",null,[R(l,{"style-type":"color-select",label:"Blue",class:"color-slider",model:i.colors,name:"2",max:255,min:0,step:1,"handle-size":.2},{after:G(()=>[E("span",null,Ce(i.colors[2].toString(16).toUpperCase()),1)]),_:1},8,["model"])])])])])]),R(d,{align:"outer",full:""},{default:G(()=>[i.saveLabel?(x(),z(c,{key:0,"style-type":"primary",label:i.saveLabel,type:"submit"},null,8,["label"])):W("",!0)]),_:1})]),_:1},8,["onSubmit"])])}const fh=V(ih,[["render",hh],["__scopeId","data-v-b437c922"]]),mh={xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16"},ph=E("path",{d:"M0 0v16h16V0zm14 14H2V2h12z",class:"svg-primary"},null,-1),gh=E("path",{d:"M4 6v4h2v2h2v-2h2V8h2V4h-2v2H8v2H6V6z",class:"svg-secondary"},null,-1),bh=[ph,gh];function yh(n,e){return x(),T("svg",mh,[...bh])}const wh={render:yh},_h={xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16"},xh=E("path",{d:"M0 0v16h16V0zm14 14H2V2h12z",class:"svg-primary"},null,-1),Eh=E("path",{d:"M4 4h8v8H4z",class:"svg-secondary"},null,-1),vh=[xh,Eh];function Sh(n,e){return x(),T("svg",_h,[...vh])}const Ih={render:Sh},Oh={components:{SvgControlInputCheckbox:wh,SvgControlInputRadio:Ih},props:{label:{type:String,default:"Item Label"},model:{type:Object,default(){return{value:null}}},name:{type:String,default:null},value:{type:[String,Number],default:null},radio:{type:Boolean,default:!1},readonly:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1}},computed:{currentModel:{get(){return this.name?this.model[this.name]:this.model.value},set(n){this.name?this.model[this.name]=n:this.model.value=n}},styleClasses(){return{radio:this.radio,checkbox:!this.radio}},input(){return{name:this.name,readonly:this.readonly,disabled:this.disabled,type:this.radio?"radio":"checkbox"}}}},Ah=["value"],kh={key:2,class:"label"};function Th(n,e,t,r,i,s){const o=k("svg-control-input-checkbox"),a=k("svg-control-input-radio");return x(),T("label",{class:at(["wb-env-atom-form-field-checkbox-group-item",s.styleClasses])},[Zt(E("input",F({"onUpdate:modelValue":e[0]||(e[0]=l=>s.currentModel=l)},s.input,{value:t.value}),null,16,Ah),[[$i,s.currentModel]]),t.radio?W("",!0):(x(),z(o,{key:0})),t.radio?(x(),z(a,{key:1})):W("",!0),t.label?(x(),T("span",kh,Ce(t.label),1)):W("",!0)],2)}const Rh=V(Oh,[["render",Th],["__scopeId","data-v-2466babe"]]),Dh={components:{WbEnvAtomFormField:Bn,WbEnvAtomFormFieldCheckboxGroupItem:Rh},props:{label:{type:String,default:"Checkbox Group Title"},name:{type:String,default:"value"},radio:{type:Boolean,default:!1},readonly:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},read:{type:Boolean,default:!1},model:{type:Object,default(){return{item1:!1,item2:!1}}},items:{type:Array,default(){return[{label:"Item 1",name:"item1"},{label:"Item 2",name:"item2"}]}}}};function Ch(n,e,t,r,i,s){const o=k("wb-env-atom-form-field-checkbox-group-item"),a=k("wb-env-atom-form-field");return x(),z(a,{class:"wb-env-atom-form-field-checkbox-group",label:t.label,"label-top":""},{default:G(()=>[E("ul",null,[(x(!0),T(vt,null,St(t.items,(l,c)=>(x(),T("li",{key:c},[R(o,F({radio:t.radio,name:l.name||t.name,model:t.model,readonly:l.readonly||t.readonly,disabled:l.disabled||t.disabled,ref_for:!0},l),null,16,["radio","name","model","readonly","disabled"])]))),128))])]),_:1},8,["label"])}const Ja=V(Dh,[["render",Ch],["__scopeId","data-v-33c1f318"]]),Nh={xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16"},Lh=E("path",{d:"M2 14v2h14V2h-2v12",class:"svg-primary"},null,-1),Ph=E("path",{d:"M6 10v2h6V6h-2v4",class:"svg-primary"},null,-1),Mh=[Lh,Ph];function $h(n,e){return x(),T("svg",Nh,[...Mh])}const Wh={render:$h},Fh={components:{SvgControlTextareaResize:Wh,WbEnvAtomFormField:Bn},props:{labelTop:{type:Boolean,default:!1},model:{type:Object,default(){return{}}},label:{type:String,default:"Textarea Label"},id:{type:String,default:null},name:{type:String,default:null},placeholder:{type:String,default:"Textarea Placeholder…"},rows:{type:Number,default:null},wrap:{type:Boolean,default:!0},resize:{type:String,validate:n=>["both","horizontal","vertical",null].includes(n),default:"both"},readonly:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},autocomplete:{type:Boolean,default:!1}},computed:{currentModel:{get(){return this.name?this.model[this.name]:this.model.value},set(n){this.name?this.model[this.name]=n:this.model.value=n}},styleClasses(){return{resize:this.resize,[`resize-${this.resize}`]:this.resize}},input(){return{id:this.id,name:this.name,placeholder:this.placeholder,rows:this.rows,wrap:this.wrap?"on":"off",resize:this.resize,readonly:this.readonly,disabled:this.disabled,autocomplete:this.autocomplete?"on":"off"}}}},zh={class:"wrapper"},Bh={class:"helper resize"};function Vh(n,e,t,r,i,s){const o=k("svg-control-textarea-resize"),a=k("wb-env-atom-form-field");return x(),z(a,{tag:"label",class:at(["wb-env-atom-form-field-textarea",s.styleClasses]),label:t.label,"label-top":t.labelTop},{default:G(()=>[E("span",zh,[E("span",null,[Zt(E("textarea",F({"onUpdate:modelValue":e[0]||(e[0]=l=>s.currentModel=l)},s.input),null,16),[[ea,s.currentModel]]),E("span",Bh,[R(o)])])])]),_:1},8,["label","class","label-top"])}const jh=V(Fh,[["render",Vh],["__scopeId","data-v-80092c4b"]]),Uh={components:{WbForm:zn,WbButton:kt,WbButtonWrapper:Tt,WbFormFieldCheckboxGroup:Ja,WbFormFieldTextarea:jh},props:{...dt},emits:[...ht,"close"],setup(n,e){return ut(n,e)},data(){return{saveLabel:"Save",model:{[N.SCREEN_1084_FRAME]:this.core.config.get(N.SCREEN_1084_FRAME)||!1,[N.SCREEN_REAL_LOOK]:this.core.config.get(N.SCREEN_REAL_LOOK)||!1,[N.SCREEN_SCAN_LINES]:this.core.config.get(N.SCREEN_SCAN_LINES)||!1,[N.SCREEN_ACTIVE_ANIMATION]:this.core.config.get(N.SCREEN_ACTIVE_ANIMATION)||!1,[N.BOOT_WITH_SEQUENCE]:this.core.config.get(N.BOOT_WITH_SEQUENCE)||!1,[N.BOOT_WITH_WEBDOS]:this.core.config.get(N.BOOT_WITH_WEBDOS)||!1,[N.FILE_EXTENSION_ASSIGNMENT]:(this.core.config.get(N.FILE_EXTENSION_ASSIGNMENT)||[]).map(e=>e.join(" ")).join(`
`)}}},computed:{fileTypeAssignment(){return{model:this.model,name:N.FILE_EXTENSION_ASSIGNMENT,label:"File Extension assignment to Application",placeholder:"e.g. md openPreview…"}},generalSettings(){return{model:this.model,label:null,items:[]}},screenSettings(){return{model:this.model,label:"Screen - Settings",items:[{label:"Use 1084 Frame with 640x480",name:N.SCREEN_1084_FRAME},{label:"Screen with Real-Look",name:N.SCREEN_REAL_LOOK},{label:"Screen with Scan-Lines",name:N.SCREEN_SCAN_LINES},{label:"Screen with On/Off Animation",name:N.SCREEN_ACTIVE_ANIMATION}]}},bootSettings(){return{model:this.model,label:"BOOT - Settings",items:[{label:"Boot with Sequence?",name:N.BOOT_WITH_SEQUENCE},{label:"Boot with WebDos?",name:N.BOOT_WITH_WEBDOS}]}}},methods:{onSubmit(){this.model[String(N.FILE_EXTENSION_ASSIGNMENT)]=this.model[String(N.FILE_EXTENSION_ASSIGNMENT)].split(`
`).map(n=>n.match(/^([^ ]+) +(.*)$/).slice(1,3)),this.core.config.set(this.model),this.$emit("close")}}},Gh={class:"wb-module-core-settings"},Hh={class:"cols"},Yh={class:"col-2"},Xh={class:"col-2"};function qh(n,e,t,r,i,s){const o=k("wb-form-field-checkbox-group"),a=k("wb-form-field-textarea"),l=k("wb-button"),c=k("wb-button-wrapper"),d=k("wb-form");return x(),T("div",Gh,[R(d,{onSubmit:s.onSubmit},{default:G(()=>[E("div",Hh,[E("div",Yh,[s.generalSettings.items.length>0?(x(),z(o,tr(F({key:0},s.generalSettings)),null,16)):W("",!0),s.screenSettings.items.length>0?(x(),z(o,tr(F({key:1},s.screenSettings)),null,16)):W("",!0),s.bootSettings.items.length>0?(x(),z(o,tr(F({key:2},s.bootSettings)),null,16)):W("",!0)]),E("div",Xh,[R(a,F(s.fileTypeAssignment,{"label-top":"",rows:10,resize:null}),null,16)])]),R(c,{align:"outer",full:""},{default:G(()=>[i.saveLabel?(x(),z(l,{key:0,"style-type":"primary",label:i.saveLabel,type:"submit"},null,8,["label"])):W("",!0)]),_:1})]),_:1},8,["onSubmit"])])}const Kh=V(Uh,[["render",qh],["__scopeId","data-v-49eb6d0c"]]),Zh=({core:n})=>[{name:["execute"],description:"Execute file.",args:[new y({index:0,name:"path",description:"Path to the file"})],async action({path:e}){const t=new Map(n.config.get(N.FILE_EXTENSION_ASSIGNMENT));if(!e)throw C.get("bad_args");let r;if(t.has(hr(e))?r=await n.modules.files.fs.get(t.get(hr(e))):(r=await n.modules.files.fs.get(e),e=null),typeof r.action=="function")return r.action(n,e);if("type"in r.data){const i=[`openPreview "${r.getPath()}"`];return r.data.openMaximized&&i.push("-maximized"),n.executeCommand(i.join(" "))}}},{name:["openColorSettings"],action(){n.modules.windows.addWindow({title:"Color Settings",component:fh,componentData:{},options:{prompt:!1,scaleX:!1,scaleY:!1,scrollX:!1,scrollY:!1}})}},{name:["openSettings"],action(){n.modules.windows.addWindow({title:"Settings",component:Kh,componentData:{},options:{prompt:!1,scaleX:!1,scaleY:!1,scrollX:!1,scrollY:!1}})}},{name:["echo","print"],args:[new y({name:["newline","n"],flag:!0})],async action({newline:e},t){const r=i=>X(i).replace(/\\"/g,'"').replace(/\\n/g,`
`);if(e)t.message(t.commandArgs.map(i=>r(i)));else{let i=await t.core.executeCommand(t.commandValue);typeof i=="object"&&(i=JSON.stringify(i)),t.message(`${X(r(i))}`)}}},{name:"commands",action(e,t){const r=new Ht({headerPadding:1});return r.addColumn([{value:"Command(s)",align:"left",maxWidth:20},{value:"Description/Arguments",align:"left",maxWidth:60}]),r.addRow(Dt.items.reduce((i,s)=>{const o=s.args||[],a=[];s.description&&(a.push(s.description),a.push("")),o.length&&(a.push("Arguments:"),a.push(""));const{flagNames:l,kwargNames:c}=o.reduce((f,h)=>{const m=h.name.join(", ");return h.flag?f.flagNames.push({name:`-${m}`,description:h.description}):f.kwargNames.push({name:`--${m}`,description:h.description}),f},{flagNames:[],kwargNames:[]}),d={paddingChr:"Â",showHeaders:!1,config:{name:{minWidth:15},description:{minWidth:10,maxWidth:30}}};return a.push(wi(l,Object.assign({},d))),l.length>0&&c.length>0&&a.push(""),a.push(wi(c,Object.assign({},d))),i.push([s.name.join(", "),a.join(`
`)]),i},[])),t.message(["Commands:",r]),Promise.resolve()}},{name:["CLS","CLEAR"],action(){n.consoleInterface.clear()}},{name:["prompt","input","PROMPT","INPUT"],args:[new y({index:0,name:"text",description:"Text from prompt."}),new y({index:1,name:"variable",description:"Variable"})],action:({text:e,variable:t,unresolved:r},i)=>(r.text&&!r.variable?(t=r.text,e=null):t=r.variable,n.consoleInterface.prompt(e).then(s=>(Jn(s)&&(s=Number(s)),t&&n.modules.parser.memory.set(t,s),s)))},{name:["confirm","CONFIRM"],args:[new y({index:0,name:"text",description:"Text from confirm."})],action({text:e}){return n.consoleInterface.confirm(e)}},{name:["selfCheck"],async action(e,t){const r=new Ht;r.addColumn([{value:"Count",align:"left",minWidth:8},{value:"Description",align:"left",minWidth:15}]),r.addRow(await Qh(n)),t.message(["Command Tests:",r])}}];function Qh(n){const e=new Od(n);return e.command('"foo" +"bar"','"foobar"'),e.command("(-3+-6)+1",-8),e.command("(-3-+6)+1",-8),e.command("(-3*-6)+1",-3*-6+1),e.command("(-3/-6)+1",-3/-6+1),e.command("(-3+6)+1",4),e.command("(-3-6)+1",-8),e.command("(-3*6) + 1",-3*6+1),e.command("(-3/6)+1",-3/6+1),e.command("INT(PI)",3),e.command("(POW(2,2)+1)",5),e.command('ASC("D")',68),e.command("CHR$(68)",'"D"'),e.command('LEN("ABC")',3),e.command('"a" + "b"','"ab"'),e.command("STRING$(3,0)",'"000"'),e.command("SQRT(2,2)",Math.sqrt(2,2)),e.command("128 >> (256 + 5)",4),e.command("-2+4+SQRT(2,2)",2+Math.sqrt(2,2)),e.command("-2- 2 * 2",-2-2*2),e.command("(1+1)",2),e.command("2*2",2*2),e.command("1+2+3+(POW(2,2)+1)+5*8-(50/2)",6+(2**2+1)+5*8-50/2),e.start()}const{version:Jh}=Nl().public;var Cs,Cr,Nr,Lr,zt,Pr,Mr,$r;const Ct=class Ct{constructor(){g(this,Cs,new Me);g(this,Cr,new Me);g(this,Nr,!1);g(this,Lr,new ec(0));g(this,zt,{});g(this,Pr,new Id(this));g(this,Mr,new fr({core:this,debug:!1,consoleInterface:u(this,Pr)}));p(this,"executionCounter",Et(0));g(this,$r,new vd(xu,ce.SESSION,Oo));this.log(`${Ct.NAME}; ${Ct.VERSION}`)}get version(){return Ct.VERSION}addExecution(){return this.executionCounter.value++,()=>{this.executionCounter.value--}}get events(){return u(this,Cs)}async setup(){if(u(this,Nr))return console.warn("Setup is complete!"),this;v(this,Nr,!0),Dt.add(Ma(Zh({core:this}))),await u(this,$r).ready,this.config.setDefaults(Oo);const e=Object.values(u(this,zt));return await Promise.all(e.map(t=>Promise.resolve(t.beforeSetup()))),await Promise.all(e.map(t=>Promise.resolve(t.setup()))),await ef(this.modules.files.fs),u(this,Lr).next(this),this}destroy(){Dt.clear()}addModule(e,t){const r=new e(Object.assign({core:this},t));u(this,zt)[tn(r.constructor.NAME)]=r}async removeModule(e){await e.destroy(),delete u(this,zt)[e.constructor.NAME]}executeCommands(e){if(e.length>0){const t=e.shift();return this.executeCommand(t).then(()=>this.executeCommands(e))}}async executeCommand(e,t){typeof e=="string"&&(e=e.replace(/(.*[^\\])\n(\S*)/gm,"$1\\n$2")),t=Object.assign({show:!1,commandBucket:Dt,core:this,logger:this.logger},t);const r=[];t.message&&r.push(...r.concat(t.message));const i=t.show;t.message=o=>{i&&r.push(...[].concat(o))};let s;try{if(e){const o=await this.modules.parser.parseCommand(e);t.commandBucket.has(o.command)?s=await Lo(e,o,t.commandBucket,t):Dt.has(o.command)?s=await Lo(e,o,Dt,t):this.modules.parser.isMathValue(e)?s=await this.modules.parser.parseMath(e):/^\w+$/.test(e)&&console.warn(`can\\'t use variable or method "${e}"`)}}catch(o){let a=o;Array.isArray(o)&&(a=new Error(o[o.length-1])),u(this,Cr).next(a)}return s!==void 0&&s!=="undefined"&&typeof s=="string"&&t.show&&r.length<1&&r.push(s),r.forEach(o=>t.logger.add(o,{type:fr.TYPE.OUTPUT})),s}log(e){u(this,Mr).add(e,{namespace:"Core"})}get consoleInterface(){return u(this,Pr)}get errorObserver(){return u(this,Cr)}get ready(){return u(this,Lr)}get config(){return u(this,$r)}get logger(){return u(this,Mr)}get modules(){return u(this,zt)}};Cs=new WeakMap,Cr=new WeakMap,Nr=new WeakMap,Lr=new WeakMap,zt=new WeakMap,Pr=new WeakMap,Mr=new WeakMap,$r=new WeakMap,p(Ct,"VERSION",Jh||"0.0.0"),p(Ct,"NAME","web-workbench");let _i=Ct;async function Lo(n,e,t,r){const i=t.get(e.command),s=r.show,o=await i.action(fu(i,e),Object.assign({command:e.command,commandValue:e.commandValue,commandArgs:e.args},r));return s&&r.showCommand&&r.logger.add("> "+n,{type:fr.TYPE.OUTPUT}),o}async function ef(n){const{FONT_FAMILES:e,DEFAULT_FONT_SIZE:t}=await O(()=>import("./iR7RlvsB.js"),__vite__mapDeps([0,1,2]),import.meta.url),[r,i,s]=(await Promise.all([O(()=>import("./Br7NzK0j.js"),[],import.meta.url),O(()=>import("./DYb_MdBR.js"),[],import.meta.url),O(()=>import("./C1rnC5hf.js"),[],import.meta.url)])).map(l=>l.default||l);await n.createRootFile("Cuby_Generator.link","Cuby Generator",null,{meta:[[w.POSITION,{x:236,y:394}],[w.IGNORE_SYMBOL_REARRANGE,!0],[w.WEB_URL,"https://cuby.lammpee.de"],[w.SYMBOL,_.CUBY]]}),await n.createRootFile("Github.link","Github",null,{meta:[[w.POSITION,{x:159,y:386}],[w.IGNORE_SYMBOL_REARRANGE,!0],[w.WEB_URL,"https://github.com/ThornWalli/web-workbench"],[w.SYMBOL,_.GITHUB]]});const o=[{id:"Imprint.md",name:"Imprint",content:i,position:{x:0,y:390},fontFamily:e.Monospace["Courier New"],fontSize:14},{id:"Disclaimer.md",name:"Disclaimer",content:s,position:{x:80,y:390},fontFamily:e.Monospace["Courier New"],fontSize:14},{id:"Changelog.md",name:"Changelog",content:r,position:{x:0,y:305},fontFamily:e.Monospace["Courier New"],fontSize:14}];return(await n.createRootDir("Press","Press",{meta:[[w.WINDOW_SIDEBAR,!1],[w.WINDOW_SCALE,!1],[w.WINDOW_SCROLL_X,!1],[w.WINDOW_SCROLL_Y,!1],[w.POSITION,{x:80,y:320}],[w.WINDOW_SIZE,{x:100,y:120}],[w.IGNORE_SYMBOL_REARRANGE,!0]]})).addItems([{id:"Amiga-News.link",name:"Amiga-News.de",meta:[[w.WEB_URL,"https://www.amiga-news.de/de/news/AN-2022-07-00094-DE.html"],[w.SYMBOL,_.LARGE_NOTE_RICH],[w.POSITION,{x:10,y:10}]]}]),Promise.all(o.map(({id:l,name:c,content:d,position:f,fontFamily:h,fontSize:m})=>n.createRootFile(l,c,{openMaximized:!0,type:"markdown",content:d,fontFamily:h||e.SansSerif.Arial,fontSize:m||t},{meta:[[w.POSITION,f],[w.IGNORE_SYMBOL_REARRANGE,!0],[w.SYMBOL,_.LARGE_NOTE_RICH]]}))).catch(l=>{throw new Error(l)})}function Rg(n){const e={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#039;","\n":`&nbsp;
`," ":"&nbsp;"};return n.replace(/[&<>"'\n ]/g,function(t){return e[String(t)]})}function xi(n,e,t,r=" "){if(n.length<e)for(let i=n.length;i<=e-1;i++)t?n=r+n:n=n+r;return n}function er(n){return n>2e3?(n=parseInt(n/1e3),n>1e3?(n=parseInt(n/1e3),n>1e3?(n=parseInt(n/1e3),`${n}g`):`${n}m`):`${n}k`):`${n}b`}function Ei(n,e){const t=new Date(e),r=[[/y/g,`${t.getFullYear()}`.slice(2)],[/Y/g,t.getFullYear()],[/dd/g,Po(t.getDate())],[/d/g,t.getDate()],[/DD/g,Po(t.getDate())],[/D/g,Hn(t.getDate())],[/mm/g,Mo(t.getMonth(),!0)],[/m/g,t.getMonth()+1],[/MM/g,Mo(t.getMonth()+1,!1)],[/M/g,Hn(t.getMonth()+1)],[/h/g,t.getHours()],[/H/g,Hn(t.getHours())],[/i/g,t.getMinutes()],[/I/g,Hn(t.getMinutes())],[/s/g,t.getSeconds()],[/S/g,Hn(t.getSeconds())]];return r.forEach((i,s)=>{n=n.replace(i[0],`%${s}%`)}),r.forEach((i,s)=>{n=n.replace(`%${s}%`,i[1])}),n}const tf=[["Sunday","Sun"],["Monday","Mon"],["Tuesday","Tue"],["Wednesday","Wed"],["Thursday","Thu"],["Friday","Fri"],["Saturday","Sat"]];function Po(n){return tf[String(n)]}const nf=[["Januar","Jan"],["February","Feb"],["March","Mar"],["April","Apr"],["May"],["June"],["July"],["August","Aug"],["September","Sept"],["October","Oct"],["November","Nov"],["December","Dec"]];function Mo(n,e){return n=nf[n-1],n.length>1?e?n[1]:n[0]:n}function Hn(n){return n=String(n),n.length<2?`0${n}`:n}function el(n,e){return e<=0?"":e>String(n).length?n:String(n).substring(0,e)}function rf(n,e){if(e<=0)return"";if(e>String(n).length)return n;{const t=String(n).length;return String(n).substring(t,t-e)}}function $o(n,e=" "){return Array(parseInt(n)).fill(e).join("")}const ue=class ue{static parse(e,t=[],r=0){let i=e;const s=af();let o=!1,a=0;for(;e.length>=a;){const l=e[Number(a-1)],c=e[Number(a+1)],d=e[Number(a)];if(d==="("&&s.clamp!==!1&&s.clamp++,/(^[$]{6}\d+\$)/.test(e.slice(a,e.length))&&!mt(s)){const[f]=e.slice(a,e.length).match(/(^[$]{6}\d+\$)/);a+=f.length-1}else if(/(^[$]{3}\d+)/.test(e.slice(a,e.length))&&!mt(s)){const[f]=e.slice(a,e.length).match(/(^[$]{3}\d+)/);s.startRecord=a,a+=f.length,s.stopRecord=a}else d==="-"&&(c==="-"||ue.REGEX_CHAR_WORD_NON_DIGIT.test(c))&&!mt(s)?(s.parameter=!0,s.startRecord=a):d==="("&&!mt(s)?(s.clamp=0,s.startRecord=a):ue.REGEX_NUMERIC.test(d)&&!mt(s)?(s.numeric=!0,s.startRecord=a):ue.REGEX_CHAR_WORD_NON_DIGIT.test(d)&&!mt(s)?(s.char=!0,s.startRecord=a):d==='"'&&!mt(s)?(s.doubleQuote=!0,s.startRecord=a):d==="'"&&!mt(s)?(s.singleQuote=!0,s.startRecord=a):s.startRecord!==!1&&(s.parameter?(d==="="||!ue.REGEX_CHAR_WORD_NON_DIGIT.test(c))&&(d==="="?(s.parameter=!1,s.char=!1,s.startOverride=s.startRecord):c!=="="&&!ue.REGEX_CHAR_WORD_NON_DIGIT.test(c)&&c!=="-"&&(s.stopRecord=a+1)):s.clamp!==!1?d===")"&&(s.clamp===0?s.stopRecord=a+1:s.clamp--):s.numeric?ue.REGEX_NUMERIC.test(l)&&!ue.REGEX_NUMERIC.test(d)&&(s.stopRecord=a):s.char?ue.REGEX_CHAR_WORD_NON_DIGIT.test(l)&&!(ue.REGEX_CHAR_WORD_NON_DIGIT.test(d)&&!/[$%]/.test(d))&&(/[ ]*\(/.test(e.slice(a,e.length))?(s.char=!1,s.clamp=0):s.stopRecord=a+1):s.doubleQuote?l!=="\\"&&d==='"'&&(s.stopRecord=a+1):s.singleQuote&&l!=="\\"&&d==="'"&&(s.stopRecord=a+1));if(!s.stopRecord&&a+1>e.length&&(s.stopRecord=a+1,o=!0),s.stopRecord&&s.startRecord===!1&&a+1!==e.length)o=!0;else if(s.stopRecord){let f=s.startRecord;s.startOverride!==void 0&&(f=s.startOverride),i=i.slice(0,f)+of(t,i.slice(f,s.stopRecord))+i.slice(s.stopRecord,i.length),ue.DEBUG&&console.log("result",i),o||(this.parse(i,t,r),o=!0)}if(o)break;a++}return t.length>0?t.filter(l=>l.length>0):[e]}};p(ue,"REGEX_CHAR_WORD_NON_DIGIT",/^[^\d\W$%]|[.].$/),p(ue,"REGEX_NUMERIC",/^[\d+\-*\\/.<>]$/),p(ue,"DEBUG",!1);let mr=ue;function sf(n){return`$$$$$$${n}$`}function of(n,e){return n.push(e),sf(n.length-1)}function mt(n){return n.singleQuote||n.doubleQuote||n.clamp!==!1||n.char||n.numeric||n.parameter}function af(){return{dollarCount:0,startRecord:!1,stopRecord:!1,char:!1,numeric:!1,singleQuote:!1,doubleQuote:!1,clamp:!1,parameter:!1}}var Wr;const te=class te{constructor(e){g(this,Wr,void 0);v(this,Wr,e)}async parse(e){const t=e;let r=e;const i=e.match(te.REGEX_COMMAND_REPLACE);i&&(r=i[1],e=i[2]);const s=e;let o=[],a={},l;if(r!==e){const c=this.parseParameter(e);l=c.unresolved,o=await Promise.all(c.args),a=c.kwargs,await Promise.all(Object.keys(a).map(d=>a[String(d)].then(f=>a[String(d)]=f)))}return{origin:t,unresolved:l,args:o,kwargs:a,command:r,commandValue:s}}parseParameter(e){return mr.parse(e).reduce((r,i)=>{if(te.REGEX_PARAM_KWARG.test(i)){const[,s,o]=i.match(te.REGEX_PARAM_KWARG);r.kwargs[tn(String(s))]=this.parseValue(o),r.unresolved.kwargs[tn(String(s))]=Ao(o)}else te.REGEX_PARAM_ARG.test(i)?(r.kwargs[tn(String(i.replace(te.REGEX_PARAM_ARG,"$1")))]=Promise.resolve(!0),r.unresolved.kwargs[tn(String(i.replace(te.REGEX_PARAM_ARG,"$1")))]=Promise.resolve(!0)):(r.args.push(this.parseValue(i)),r.unresolved.args.push(Ao(i)));return r},{unresolved:{kwargs:{},args:[]},kwargs:{},args:[]})}parseValue(e){return/.*(true|false).*/.test(e)?Promise.resolve(e.replace(/.*(true|false).*/,"$1")==="true"):/^".*"$/.test(e)?Promise.resolve(X(e)):/^\d+$/.test(e)?Promise.resolve(Number(e)):typeof e=="string"&&/ *([a-zA-Z_-]+) */.test(e)?u(this,Wr).parse(e.replace(/ *([a-zA-Z_-]+) */,"$1")):Promise.resolve(e)}static extractStrings(e){let t=!1,r;const i=[];let s=!1;for(let a=e.length-1;a>=0;a--){const l=e[Number(a)],c=e[a-1];!s&&l==='"'&&c!=="\\"?t?(t=!1,i.push(e.slice(a,r+1))):(s=!1,t=!0,r=a):(!t&&s||s)&&l==="'"&&c!=="\\"&&(t?(s=!1,t=!1,i.push(e.slice(a,r+1))):(s=!0,t=!0,r=a))}if(t)throw new Error("can't extract values; "+e);return{result:i.reduce((a,l,c)=>a.replace(l,te.resolveKey(c)),e),values:i}}static extractValues(e,t=" "){let r=!1,i;const s=[];let o=!1;for(let l=e.length-1;l>=0;l--){const c=e[Number(l)],d=e[l-1];!o&&c==='"'&&d!=="\\"?r?(r=!1,s.push(e.slice(l,i+1))):(o=!1,r=!0,i=l):(!r&&o||o)&&c==="'"&&d!=="\\"&&(r?(o=!1,r=!1,s.push(e.slice(l,i+1))):(o=!0,r=!0,i=l))}if(r)throw new Error("can't extract values; "+e);return s.forEach((l,c)=>{e=e.replace(l,te.resolveKey(c))}),{params:e.split(t).filter(l=>l),values:s}}static resolveKey(e){return`$$$$$$${e}`}static resolveValues({params:e,values:t}){return e.map(r=>te.resolveValue(r,t))}static valueUnresolved(e){return te.REGEX_VALUE_RESOLVE.test(e)}static resolveValue(e,t){if(te.valueUnresolved(e)){if(e=e.match(/[$]{3}(\d+)/g).reduce((r,i)=>r.replace(i,t[Number(i.replace(te.REGEX_VALUE_RESOLVE,"$1"))]),e),/[\w]+[$%]?[ ]*\(/.test(e))return e;if(typeof e=="string"){if(e==="undefined")return;if(cf(e))return e;if(lf(e))return Number(e);if(!e.startsWith('"'))return Lu(e)}}return e}};Wr=new WeakMap,p(te,"REGEX_VALUE_RESOLVE",/[$]{3}(\d+)/),p(te,"REGEX_COMMAND_REPLACE",/^([a-zA-Z]+[a-zA-Z0-9_]+) (.*)$/),p(te,"REGEX_PARAM_KWARG",/^[-]{0,2}([\\-\w]+)=(.*)$/),p(te,"REGEX_PARAM_ARG",/^[-]{1,2}([\\-\w]+)$/);let J=te;function lf(n){return!isNaN(n)}function cf(n){return!isNaN(parseInt(n))}var Fr,wn,_n,xn;class tl{constructor(e,t,r,i){g(this,Fr,void 0);g(this,wn,void 0);g(this,_n,!1);g(this,xn,!1);v(this,Fr,e),v(this,wn,t),v(this,_n,r||u(this,_n)),v(this,xn,i||u(this,xn))}get name(){return u(this,Fr)}get value(){return u(this,wn)}set value(e){this.readonly||v(this,wn,e)}get global(){return u(this,_n)}get readonly(){return u(this,xn)}}Fr=new WeakMap,wn=new WeakMap,_n=new WeakMap,xn=new WeakMap;class uf extends tl{constructor(e,t,r){super(e,t,r,!0)}execute(e){return this.value.apply(this,e)}}class Wo extends tl{}var le,bt,ge;class Ji{constructor(){g(this,le,new Map);g(this,bt,new Map);g(this,ge,[])}reset(){this.resetPrefixStack(),u(this,le).clear(),u(this,bt).clear()}resetPrefixStack(){v(this,ge,[])}get prefixStack(){return u(this,ge)}get currentPrefixStack(){return u(this,ge)[u(this,ge).length-1]}has(e){return e=e.replace(/(.*[^ ])[ ]+$/,"$1"),e=e.replace(/[$%]$/,""),(!u(this,le).get(e)||u(this,le).get(e)&&!u(this,le).get(e).global)&&(e=this.prepareName(e)),u(this,le).has(e)}add(e,t,r=!1,i=!1){e=e.replace(/(.*[^ ])[ ]+$/,"$1"),/\$$/.test(e)?t===void 0&&(t=""):/\\%$/.test(e)&&t===void 0&&(t=0),e=e.replace(/[$%]$/,""),e=this.prepareName(e),this.has(e)||u(this,le).set(e,new Wo(e,t,r,i))}get(e){e=e.replace(/(.*[^ ])[ ]+$/,"$1");const t=e;e=e.replace(/[$%]$/,""),(!u(this,le).get(e)||u(this,le).get(e)&&!u(this,le).get(e).global)&&(e=this.prepareName(e));let r=u(this,le).get(e);return r?(r=r.value,/\$$/.test(t)?r=String(r):/\\%$/.test(t)||/^\d+$/.test(r)?r=parseInt(r):/^[\d.]+$/.test(r)&&(r=parseFloat(r)),r):null}set(e,t,r=!1,i=!1){if(e=e.replace(/(.*[^ ])[ ]+$/,"$1"),typeof t!="object"&&(/[$]$/.test(e)?t===void 0?t="":t=String(t):/[%]$/.test(e)&&(t===void 0?t=0:t=parseInt(t))),e=e.replace(/[$%]$/,""),e=this.prepareName(e),this.has(e)){const s=u(this,le).get(e);s instanceof Wo&&s&&(s.value=t)}else this.add(e,t,r,i)}addSub(e,t){e=this.prepareName(e,!1),this.has(e)||u(this,bt).set(e,new uf(e,t))}executeSub(e,t,r=!1){return e=this.prepareName(e,!1),u(this,ge).push({name:`${parseInt(Math.random()*1e4)}`,global:r}),u(this,bt).get(e).execute(t).then(i=>(u(this,le).forEach(s=>{RegExp(`[$]{3}${u(this,ge)[u(this,ge).length-1].name}$`).test(s.name)&&u(this,le).delete(s.name)}),u(this,ge).pop(),i))}hasSub(e){return e=this.prepareName(e,!1),u(this,bt).has(e)}prepareName(e,t=!0){return typeof e=="string"&&(e=e.replace(/ /g,"")),t&&u(this,ge).length&&!/[$]{3}/.test(e)&&(e=`${e}$$$${u(this,ge)[u(this,ge).length-1].name}`),e}get dims(){return u(this,le)}get subs(){return u(this,bt)}}le=new WeakMap,bt=new WeakMap,ge=new WeakMap;var Bt,zr,re,xe,qe,Br,Vr,Ee,jr,Vt,Ke,be,yt,se,ie,qo;let df=(qo=class{constructor(e,t,r,i=null,s=null){g(this,Bt,void 0);g(this,zr,void 0);g(this,re,void 0);g(this,xe,void 0);g(this,qe,void 0);g(this,Br,9999999999);g(this,Vr,0);g(this,Ee,null);g(this,jr,[]);g(this,Vt,0);g(this,Ke,[]);g(this,be,-1);g(this,yt,[]);g(this,se,[]);g(this,ie,-1);v(this,qe,e),v(this,xe,t),v(this,re,r||new Ji),v(this,Bt,i),v(this,zr,s)}get memory(){return u(this,re)}get lines(){return u(this,qe)}parse(e){e=e||[].concat(u(this,qe));const t=e.shift().trim();return new Promise(r=>{if(u(this,Ee)&&t!=="END SUB"){u(this,Ee).lines.push(t),r();return}if(u(this,Br)>0&&u(this,Vr)>u(this,Br))throw new Error("BASIC INTERPRETER OVERFLOW");if(Ae(this,Vr)._++,u(this,ie)>=0){if(u(this,se).forEach(i=>{u(this,se)[u(this,ie)].count===0&&i.count===0&&i.lines.push(t)}),t==="WEND"||/NEXT /.test(t))return u(this,se)[u(this,ie)].condition().then(async i=>{if(u(this,se)[u(this,ie)].tmpLines=u(this,se)[u(this,ie)].tmpLines||e,i){const s=u(this,se)[u(this,ie)].lines;return u(this,se)[u(this,ie)].count++,"step"in u(this,se)[u(this,ie)]&&await u(this,se)[u(this,ie)].step(),s.length>0?this.parse([].concat(s)):(u(this,se)[u(this,ie)]=!1,Ae(this,ie)._--,u(this,se).pop(),null)}else return u(this,se)[u(this,ie)]=!1,Ae(this,ie)._--,u(this,se).pop(),null}).then(r);r()}else r()}).then(()=>{if(!u(this,Ee)&&u(this,be)>=-1&&(u(this,yt)[u(this,be)]!==void 0&&u(this,Ke)[u(this,be)]===void 0&&u(this,Ke).push(!u(this,yt)[u(this,be)]),t==="ELSE"&&u(this,Vt)<1&&(u(this,Ke)[u(this,be)]=!u(this,Ke)[u(this,be)])),u(this,Ke)[u(this,be)])/^IF (\((.*)\)|(.*)) THEN$/.test(t)&&Ae(this,Vt)._++;else return this.parseLine(t,e);return null}).then(()=>(u(this,be)>-1&&(t==="ENDIF"||t==="END IF")&&(u(this,Vt)<1?(Ae(this,be)._--,u(this,yt).pop(),u(this,Ke).pop()):Ae(this,Vt)._--),e.length?this.parse(e):u(this,jr)))}parseLine(e,t){return new Promise((r,i)=>{if(e=(e||"").replace(/^[ \t]+/g,""),/^ *[#/]+/.test(e)){r();return}if(/^SUB (.*) STATIC$/.test(e)){const s=e.match(/^SUB (.*) STATIC$/);return this.commandSubStatic(s[1]).then(r)}else{if(e==="END SUB")return this.commandEndSub().then(r);if(u(this,Ee)){r();return}}if(/^IF (\((.*)\)|(.*)) THEN$/.test(e)){const s=e.match(/^IF (\((.*)\)|(.*)) THEN$/),o=s[3]||s[2];return this.commandIfThen(o).then(r)}else if(e==="ELSE"||e==="ENDIF"||e==="END IF"){r();return}if(/^WHILE (.*)$/.test(e)){const s=e.match(/^WHILE (.*)$/);return this.commandWhile(s[1]).then(r)}else if(e==="WEND"){r();return}if(/^FOR (.*)$/.test(e)){const s=e.match(/^FOR (.*)$/);return this.commandFor(s[1]).then(r)}else if(e.startsWith("NEXT ")){r();return}if(/^([\w\d]+):$/.test(e)){r();return}if(/^GOTO +([\w\d]+)$/.test(e)){const s=e.match(/^GOTO +([\w\d]+)$/);this.commandGoto(t,s[1])}if(/^DIM( SHARED)? +(.*)$/.test(e)){const s=e.match(/^DIM( SHARED)? +(.*)$/);return this.commandDimShared(s[2],!!s[1]).then(r)}if(/^LET +([\w,$%]+)(\((.*)\))? *= *(.*)$/.test(e)){const s=e.match(/^LET +([\w,$%]+)(\((.*)\))? *= *(.*)$/);return this.commandLet(s[1],s[4],s[3]).then(()=>r())}if(/^READ +([\w, $%]+)$/.test(e)){const s=e.match(/^READ +([\w, $%]+)$/);return this.commandRead(s[1]).then(r)}if(/^END[ ]*$/.test(e))return this.commandEnd().then(r);if(/^(PAUSE|SLEEP) +(.+)/.test(e)){const o=e.match(/^(PAUSE|SLEEP) +(.+)/)[2];return this.commandPause(o).then(r)}if(/^CALL *(.*)/.test(e)){const s=e.match(/^CALL *(.*)/);return this.commandCall(s[1],t).then(r)}if(/^EXECUTE *(FILE|EVAL) *(.*)/.test(e)){const s=e.match(/^EXECUTE *(FILE|EVAL) *(.*)/);return this.commandExecute(s[1],s[2]).then(r).catch(i)}if(/^PRINT +USING +(.*);(.*)$/.test(e)){const s=e.match(/^PRINT +USING +(.*);(.*)$/);return this.commandPrintUsing(s[1],s[2]).then(r)}if(/^PRINT +(.*)$/.test(e)){const s=e.match(/^PRINT +(.*)$/);return this.commandPrint(s[1]).then(r)}if(/^DATA +(.*)$/.test(e)){const s=e.match(/^DATA +(.*)$/);return this.commandDataVar(s[1]).then(r)}u(this,xe)?u(this,xe).call(this,e,{show:!0}).then(s=>{s&&u(this,jr).push(s)}).then(r).catch(i):r()})}async setReadStack(e,t){let r=await this.parseValue(t,!0);return hs(r)&&(r=parseFloat(r)),u(this,re).set(e,r,!0)}async addDataStack(e){let t=await this.parseValue(e,!0);return hs(t)&&(t=parseFloat(t)),u(this,Bt).push(t)}async setStack({name:e,value:t,index:r,global:i}){let s=await this.parseValue(t,!0);return hs(s)&&(s=parseFloat(s)),r!==void 0?(r=await this.parseValue(r,!0),u(this,re).get(e)[r-1]=s):u(this,re).set(e,s,i)}async setGotoMarkStack(e,t){u(this,zr).set(e,await this.parseValue(t,!0))}parseValue(e,t=!0,r=!1){if(e===void 0)return Promise.resolve(e);if(ja(e))return Promise.resolve(e);if(Array.isArray(e))return Promise.resolve(e);if(typeof e=="boolean"||/^ *(true|false|TRUE|FALSE) *$/.test(e))return typeof e!="boolean"&&(e=e.toLowerCase()==="true"),Promise.resolve(e);if(/^ *@"((.|\n)*)" *$/.test(e))return Promise.resolve(e.replace(/^ *@"((.|\n)*)" *$/,'"$1"'));if(/^ *"((\\"|[^"])*)" *$/.test(e))return Promise.resolve(e.replace(/^ *"((\\"|[^"])*)" *$/,'"$1"'));if(/^ *[\d]+ *$/.test(e))return Promise.resolve(parseFloat(e));if(/^ *([\\-]?[\d.]+(e[-+]?\d+)?) *$/.test(e))return Promise.resolve(parseFloat(e));if(e&&/^[^"]?(.*)[^"]? *$/.test(e.replace(/ /g,""))){if(e=e.replace(/^ */g,""),u(this,re).has(e.replace(/ /g,"")))return e=e.replace(/ /g,""),this.parseValue(u(this,re).get(e),!0);if(r)throw new Error("test");return u(this,xe).call(this,e,{message:t?void 0:e}).then(i=>i)}return Promise.resolve(null)}async executeCondition(e,t,r){return e=await this.parseValue(e,!0),r=await this.parseValue(r,!0),/^[=]?==$/.test(t)?e===r:t==="<>"?e!==r:/^([<>][=]|[<>])?$/.test(t)?hf(e,t,r):/^!=[=]?$/.test(t)?e!==r:null}commandIfThen(e){const t=e.match(/([^<>]*) *(<>|<=|>=|<|>|[=!]{2,3}) *([^<>].*)/);return t?this.executeCondition(t[1],t[2],t[3]).then(r=>(u(this,yt).push(r),Ae(this,be)._++,r)):this.parseValue(e[1],!0).then(r=>(u(this,yt).push("value"in r?r.value:r),Ae(this,be)._++,r))}commandWhile(e){const t=e.match(/([^<>]*) *(<>|<=|>=|<|>|[=!]{2,3}) *([^<>].*)/);return t?this.executeCondition(t[1],t[2],t[3]).then(r=>{if(r)return u(this,se).push({count:0,lines:[],condition:()=>this.executeCondition(t[1],t[2],t[3])}),Ae(this,ie)._++,r}):Promise.resolve()}async commandFor(e){const t=e.match(/(.*) *= *(.*) +TO +(.*) +STEP[ ](.*)/)||e.match(/(.*) *= *(.*) +TO +(.*)/);if(t){const r=await this.parseValue(t[2],!0),i=await this.parseValue(t[3],!0);u(this,re).set(t[1],r),Ae(this,ie)._++;const s=async(o=!0)=>{let a=1;return t[4]&&(a=await this.parseValue(t[4],!0)),o&&u(this,re).set(t[1],u(this,re).get(t[1])+a),a};return u(this,se).push({step:s,count:0,lines:[],condition:async()=>{const o=await s(!1);return o===0?!1:this.executeCondition(`(${t[1]}  )`,o<0?">":"<",i)}})}}commandSubStatic(e){const t=e.match(/^([\w,$%]+)(\((.*)\))?$/),r=t[1],i=J.resolveValues(J.extractValues(t[3]||"",","));return v(this,Ee,{name:r,lines:[],args:i}),Promise.resolve()}commandEndSub(){if(u(this,Ee)){const e=u(this,Ee).lines,t=u(this,Ee).args;u(this,re).addSub(u(this,Ee).name,async(...r)=>{(await Promise.all(t.map((s,o)=>this.parseValue(r[Number(o)]).then(a=>({arg:s,value:a}))))).forEach(({arg:s,value:o})=>{u(this,re).add(s,o)}),await this.parse([].concat(e))}),v(this,Ee,null)}else throw new Error("has no active SUB");return Promise.resolve()}commandGoto(e,t){return e.splice(0,e.length),this.parse(u(this,qe).slice(u(this,qe).indexOf(`${t}:`),u(this,qe).length))}commandDimShared(e,t){return J.resolveValues(J.extractValues(e,",")).reduce((i,s)=>(s=s.match(/^([\w, $%]+)?(\((.*)\))?$/),u(this,re).has(s[1])||(s[3]&&(i=i.then(()=>this.parseValue(s[3],!0))),i=i.then(o=>this.setStack({name:s[1],value:o?Array(o):void 0,global:t}))),i),Promise.resolve())}commandLet(e,t,r){if(u(this,re).has(e))return this.setStack({name:e,value:t,index:r});throw new Error(`Variable ${e} not defined`)}async commandPrintUsing(e,t){const r=await this.parseValue(e,!0);try{t=await Promise.all(J.resolveValues(J.extractValues(t.trim(),",")).map(s=>this.parseValue(s,!0,!0)))}catch(s){console.error(s),t=[await this.parseValue(t,!0)]}const i=t.reduce((s,o)=>{const a=r.match(/((#+)(\.(#+))?)/);return o=String(o),/[\d.]+/.test(o)&&(o=o.split(/\./),a[4]&&o.length>1?o[1]=el(xi(String(o[1]),a[4].length,!1,"0"),a[4].length):o.splice(1,1),o[0]=xi(String(o[0]),a[2].length,!0," "),o=o.join(".")),s.replace(/(#+(\.#+)?)/,X(o))},r);return u(this,xe).call(this,null,{message:`"${X(i)}"`})}commandDataVar(e){if(u(this,Bt).length===0)return Promise.all(e.split(",").map(t=>this.addDataStack(t)));throw new Error("DATA has already been declared")}async commandPrint(e){if(/^((".*"|[^"]*);([^;]*))$/.test(e)){const t=e.match(/(.*);(.*)$/),r=await this.parseValue(t[1],!0);let i=await Promise.all(J.resolveValues(J.extractValues(t[2]," ")).reduce((s,o)=>(s.push(this.parseValue(o,!0)),s),[]));return i=i.map(s=>`${X(r)}${X(s)}`).join(" "),u(this,xe).call(this,null,{message:`"${i}"`})}else{let t=await this.parseValue(e);return t=await Promise.all(J.resolveValues(J.extractValues(String(t)," ")).map(r=>this.parseValue(r,!0))),t=t.map(r=>X(r)),t=t.join(""),u(this,xe).call(this,null,{message:hs(t)?t:`"${t}"`})}}commandEnd(){return Promise.resolve()}async commandPause(e){const t=await this.parseValue(e);return new Promise(r=>window.setTimeout(()=>{r()},t))}commandRead(e){const t=e.split(",");return Promise.all(t.map(r=>{const i=u(this,Bt).shift();return this.setReadStack(r,i),Promise.resolve()}))}commandCall(e,t){const i=e.match(/([^(]+)\(.*\)/)[1];if(u(this,re).hasSub(i))return this.parseLine(e,t);throw new Error(`SUB ${i} NOT FOUND`)}async commandExecute(e,t){if(!u(this,xe))throw new Error("No callback available for readfile");console.log("READFILE",e,t);let r;switch(e){case"FILE":try{r=await u(this,xe).call(this,`READFILE ${t}`,{show:!1})}catch(i){throw new Error(i)}if(console.log("READFILE",r),r!==void 0)try{return u(this,xe).call(this,r.value,{show:!0})}catch(i){throw new Error(i)}else throw new Error("File Content is empty");case"EVAL":try{return this.parseValue(t,{show:!0})}catch(i){throw new Error(i)}}}},Bt=new WeakMap,zr=new WeakMap,re=new WeakMap,xe=new WeakMap,qe=new WeakMap,Br=new WeakMap,Vr=new WeakMap,Ee=new WeakMap,jr=new WeakMap,Vt=new WeakMap,Ke=new WeakMap,be=new WeakMap,yt=new WeakMap,se=new WeakMap,ie=new WeakMap,qo);function hf(n,e,t){switch(e.match(/^([<>][=]|[<>])$/)[1]){case"<":return parseFloat(n)<parseFloat(t);case">":return parseFloat(n)>parseFloat(t);case"<=":return parseFloat(n)<=parseFloat(t);case">=":return parseFloat(n)>=parseFloat(t);default:return null}}function hs(n){return!isNaN(parseFloat(n))&&isFinite(n)}var En,Ns,Ls,vn;class ff{constructor(e,t){g(this,En,new Map);g(this,Ns,new Map);g(this,Ls,[]);g(this,vn,void 0);v(this,vn,t),v(this,En,e)}get callback(){return u(this,vn)}get memory(){return u(this,En)}async parse(e,t,r){if(e.length===0)return;e.length>1&&await this.readData(e);const i=[];return new df(e,async(o,a)=>{a=Object.assign({},a,r);const l=await(t||u(this,vn))(o,a);return a.show&&typeof l=="string"&&l!=="undefined"&&i.push(l),l},u(this,En),u(this,Ls),u(this,Ns)).parse().then(()=>i)}readData(e){let t=e.find(r=>/^[ ]*DATA[ +]/.test(r));return t?(t=e.splice(e.indexOf(t),1),this.parse(t)):Promise.resolve()}}En=new WeakMap,Ns=new WeakMap,Ls=new WeakMap,vn=new WeakMap;function ke(...n){if(n.includes(void 0))throw new Error("invalid arguments")}let vi,Si,Ii,Oi,Ai,ki,Ti,nl;try{vi=/([^\w$%]?)\(([^\\(\\)]+)\)/,Si=/^\((.*)\)$/,Ii=new RegExp("[^\\d$\\-\\w]?(?<a>([+-]?[\\w.]+e\\+\\d+)|([+-]?[\\w$%.]+)|(^[+-]?[\\w$%.]+)|([\\w$%.]+)|([$]{3}\\d+))[ ]*(?<operator>[\\^*%\\/]|MOD|XOR|AND|OR|<<|>>|>>>)[ ]*(?<b>([-]?[\\w.]+e\\+\\d+)|([-]?[\\w$%.]+)|(^[+-]?[\\w$%.]+)|([\\w$%.]+)|([$]{3}\\d+))"),Oi=/([+-]?[\w.]+e\+\d+|[+-]?[\w$%.]+|[$]{3}\d+)[ ]*([+-])[ ]*([+-]?[\w.]+e\+\d+|[+-]?[\w$%.]+|[$]{3}\d+)/,Ai=/([\w]+[a-zA-Z0-9_.]+[$%]?)[ ]*\(([^\\(\\)]*)\)/,ki=/^([\w]+[a-zA-Z0-9_.]+[$%]?)[ ]*\(([^\\(\\)]*)\)/,Ti=/^([\w]+[a-zA-Z0-9_.]?[$%]?)/,nl=/^([+-]?[\d.]+e\+\d+|[+-]?[\d.])+($|$)/}catch(n){console.error(n)}var Q;class mf{constructor(e){g(this,Q,void 0);this.createMemory(e)}createMemory(e){v(this,Q,e||new Ji),u(this,Q).addSub("RND",()=>Promise.resolve(Math.random())),u(this,Q).addSub("PI",()=>Promise.resolve(Math.PI)),u(this,Q).addSub("POW",(t,r)=>(ke(t,r),Promise.resolve(t**(r||2)))),u(this,Q).addSub("SQRT",(t,r)=>(ke(t,r),Promise.resolve(Math.sqrt(t,r||2)))),u(this,Q).addSub("INT",t=>(ke(t),this.parse(X(t)).then(r=>parseInt(r)))),u(this,Q).addSub("SPC",t=>(ke(t),Promise.resolve(`"${$o(t)}"`))),u(this,Q).addSub("LEN",t=>(ke(t),Promise.resolve(X(String(t)).length))),u(this,Q).addSub("ASC",t=>(ke(t),Promise.resolve(X(t).charCodeAt(0)))),u(this,Q).addSub("CHR$",t=>(ke(t),Promise.resolve(String.fromCharCode(t)))),u(this,Q).addSub("LEFT$",(t,r)=>(ke(t,r),Promise.resolve(`"${el(X(t),parseInt(r))}"`))),u(this,Q).addSub("RIGHT$",(t,r)=>(ke(t,r),Promise.resolve(`"${rf(X(t),parseInt(r))}"`))),u(this,Q).addSub("STRING$",(t,r)=>(ke(t,r),Promise.resolve(`"${$o(X(t),X(r))}"`))),u(this,Q).addSub("TIME%",()=>Promise.resolve(Date.now())),u(this,Q).addSub("HEX_ENC$",t=>(ke(t),t=Number(X(t)).toString(16),Promise.resolve(t))),u(this,Q).addSub("HEX_DEC$",t=>(ke(t),t=parseInt(X(t),16),Promise.resolve(t)))}parse(e){return new gf(this).parse(e)}validInput(e){return/[/*\-+^()]?/.test(e)}get memory(){return u(this,Q)}}Q=new WeakMap;const pf=5e3;var de,Ze,Ur;class gf{constructor(e){g(this,de,void 0);g(this,Ze,[]);g(this,Ur,0);v(this,de,e)}get parser(){return u(this,de)}get parsedValues(){return u(this,Ze)}async parse(e){if(u(this,Ur)>pf)throw new Error(`Can't parse ${e}`);Ae(this,Ur)._++;const{result:t,values:r}=J.extractStrings(String(e));let i=mr.parse(t);v(this,Ze,u(this,Ze).concat(r)),i=i.map(a=>/^MOD|XOR|AND|OR$/.test(a)?` ${a} `:a);let s=i.join("");Jn(s)&&(s=Number(s));const o=s;return s=await this.action(s),s!==o&&!/^".*"$/.test(s)?this.parse(s):this.$v(s)}async action(e){if(Si.test(e)){const[t,r]=e.match(Si);e=e.replace(t,r)}if(Ai.test(e)){const[t,r,i,s]=e.match(Ai),o=r||s;let a=mr.parse(i||"");const l=i.includes(",")&&a.join("")!==i;if(l&&(a=i.split(",")),a=await Promise.all(a.map(c=>this.parse(c))),a=l?a:[await this.parse(a.join(""))],u(this,de).memory.has(o))return e.replace(t,u(this,de).memory.get(o)[Number(a[0])-1]);if(u(this,de).memory.hasSub(o))return e.replace(t,this.cacheValue(await u(this,de).memory.executeSub(o,a)))}if(vi.test(e)){const[t,r,i]=e.match(vi);return e.replace(t,r+await this.parse(i))}return Ii.test(e)?this.operation(e,Ii):Oi.test(e)?this.operation(e,Oi):this.$v(e)}async operation(e,t){const r=e.match(t);let i,s,o;const a=r[0];"groups"in r&&r.groups?(i=r.groups.a,s=r.groups.b,o=r.groups.operator):(i=r[1],o=r[2],s=r[3]);let l=e,c=await this.parse(i);Jn(c)||(c=X(c));let d=await this.parse(s);switch(Jn(d)||(d=X(d)),o){case"+":l=c+d;break;case"-":l=c-d;break;case"*":l=c*d;break;case"/":l=c/d;break;case">":l=c>d;break;case"<":l=c<d;break;case"^":l=c^d;break;case"%":l=c%d;break;case"MOD":l=c%d;break;case"AND":l=c&d;break;case"OR":l=c|d;break;case"XOR":l=c^d;break;case"<<":l=c<<d;break;case">>":l=c>>d;break;case">>>":l=c>>>d;break}return Jn(l)||(l=`"${l}"`),e.replace(a,a.replace(RegExp(`[${i}]{${String(i).length}}[ ]*[${o}]{${String(o).length}}[ ]*[${s}]{${String(s).length}}`),"")+this.cacheValue(l))}$v(e){if(J.valueUnresolved(e))return e=J.resolveValue(e,u(this,Ze)),Promise.resolve(e);if(typeof e=="string"&&(e=e.replace(/^[ ]*([^ ].*[^ ])[ ]*$/,"$1")),nl.test(e))return Promise.resolve(Number(e));if(ki.test(String(e))){const[,t,r]=e.match(ki);if(u(this,de).memory.hasSub(t))return u(this,de).memory.executeSub(t,J.resolveValues(J.extractValues(r,",")));throw new Error(`can't find sub "${t}" in memory`)}else if(Ti.test(String(e))){const t=e.replace(Ti,"$1");if(u(this,de).memory.hasSub(t))return u(this,de).memory.executeSub(t);if(u(this,de).memory.has(t))return Promise.resolve(u(this,de).memory.get(t))}return Promise.resolve(e)}cacheValue(e){return u(this,Ze).push(e),J.resolveKey(u(this,Ze).length-1)}}de=new WeakMap,Ze=new WeakMap,Ur=new WeakMap;const bf=["CLS","READ max","DIM fib%(max)","LET fib(1) = 1","LET fib(2) = 2","FOR i=3 TO max","LET fib(i) = fib(i - 2) + fib(i -1)","NEXT i","FOR i=1 TO max","PRINT fib(i)","NEXT i","DATA 10","END"],yf=["CLS","DIM w%,h%,a%","LET w%=12","LET h%=4","LET a%=w%*h%",'PRINT "With the width " + w%','PRINT " and the height " + h%','PRINT " you have the area " + a%'],wf=["CLS","DIM r,a","LET r=5","READ pi","LET a=r*r*pi",'PRINT USING "With the radius ##.##"; r','PRINT USING "we have the area ##.##"; a',"DATA 3.14","END"],_f=["GuessTheNumber","CLS","READ max%","DIM number%, guess%, guesses%",'PRINT "The number is between 1-1000."',"LET number% = INT(RND * max%) + 1","LET guess% = 1","LET guesses% = 0","WHILE guess%<>number%",'PRINT "Guess the number"',"INPUT guess%","IF (guess%<>number%) THEN","IF (guess%>number%) THEN",'PRINT "Your guess was too high"',"ELSE",'PRINT "Your guess was too low"',"ENDIF","ENDIF","LET guesses% = guesses% + 1","WEND",'PRINT USING "You found the number in # tries"; guesses%',"DATA 1000","END"],xf=["DIM result",'PRINT "Calculate the factorial of"',"INPUT n","LET result = 1","FOR i = n TO 1 STEP -1","LET result = result * i","NEXT i",'PRINT USING "#! = #"; n, result',"END"],Ef=["CLS","DIM stars$",'PRINT "Enter the height of the pyramid"',"INPUT height",'LET stars$ = ""',"FOR i = 1 TO height",'LET stars$ = ""',"FOR j = 1 TO (i+i-1)",'LET stars$ = stars$ + "*"',"NEXT j","PRINT SPC(height - i) + stars","NEXT i","END"],vf=['PRINT "Step 1"','PRINT "Step 2"','PRINT "Step 3"',"GOTO ignore",'PRINT "Step 4"',"ignore:",'PRINT "Step 5"'],Sf=["DIM A, B","LET A = 2000",'LET B = "Hello World"','PRINT USING "A: #"; A','PRINT USING "B: #"; B'],If=["DIM A, B","LET A = 1","LET B = 2","IF A == B THEN",'PRINT "true"',"ELSE",'PRINT "false"',"END","IF (A < B) THEN",'PRINT "true"',"END"],Of=["DIM i%","FOR i% = 1 TO 5",'PRINT USING "For Number #"; i%',"NEXT i%"],Af=["DIM i%","LET i%=0","WHILE i% < 5",'PRINT USING "While Number #"; i%',"LET i% = i% + 1","WEND"],kf=["DIM duration","LET duration = 2500",'PRINT USING "Start with Pause #ms"; duration',"PAUSE duration",'PRINT "End Pause"','PRINT USING "Start with Sleep #ms"; duration',"PAUSE duration",'PRINT "End Sleep"'],Tf={Fibonacci:bf,Area:yf,Circle:wf,"Your Name":["CLS",'PRINT "What is your name?"',"INPUT n$",'PRINT "What is your shoe size?"',"INPUT size",'PRINT "Hello "; n$','PRINT USING "your shoe size is ##.##"; size',"END"],GuessTheNumber:_f,Factorial:xf,Pyramid:Ef,"Bubble Sort":["CLS","READ max","DIM SHARED numbers(max)","SUB CreateList(max) STATIC","FOR i=1 TO max","LET numbers(i) = INT(RND * 100)","NEXT i","END SUB","SUB PrintList(max) STATIC","FOR i=1 TO max","PRINT numbers(i)","NEXT i","END SUB","SUB SwapValues(i%, j%) STATIC","LET numbers(i%) = numbers(i%) XOR numbers(j%)","LET numbers(j%) = numbers(i%) XOR numbers(j%)","LET numbers(i%) = numbers(i%) XOR numbers(j%)","END SUB","SUB Sort(max) STATIC","FOR i%=1 TO (max - 1)","FOR j%=i% TO max","IF numbers(i%)>numbers(j%) THEN","CALL SwapValues(i%, j%)","END IF","NEXT j%","NEXT i%","END SUB","CreateList(max)","Sort(max)","PrintList(max)","DATA 10","END"],Goto:vf,Vars:Sf,If,For:Of,"For Step":["CLS","FOR i% = 0 TO 6 STEP 2",'PRINT "For Step Number #"; i%',"NEXT i%"],While:Af,Pause:kf},Rf=({module:n,core:e})=>{const{fileSystem:t}=e.modules.files;return[{name:["basic"],args:[new y({index:0,name:"path",description:"Path to basic script"})],async action({path:r},i){if(!r)throw C.get("bad_args");const s=await t.get(r);if("type"in s.data&&s.data.type==="basic"&&Array.isArray(s.data.content))return n.parseBasic(s.data.content,null,{logger:i.logger});throw new TypeError(`Can't read file ${r}`)}},{name:["basicExamples"],args:[new y({index:0,name:"name",description:"Name from example"})],action({name:r}){return n.parseBasic(Tf[String(r)])}}]};var Sn,In,On,Ps;class rl extends js{constructor({core:t}){super({commands:(...r)=>[...Rf(...r)],core:t});g(this,Sn,void 0);g(this,In,new Ji);g(this,On,new mf(u(this,In)));g(this,Ps,new J(u(this,On)));v(this,Sn,new ff(u(this,In),t.executeCommand.bind(t)))}get memory(){return u(this,In)}parse(...t){return u(this,Sn).parse(...t)}parseBasic(...t){return u(this,Sn).parse(...t)}parseCommand(...t){return u(this,Ps).parse(...t)}parseMath(...t){return u(this,On).parse(...t)}isMathValue(...t){return u(this,On).validInput(...t)}}Sn=new WeakMap,In=new WeakMap,On=new WeakMap,Ps=new WeakMap,p(rl,"NAME","Parser");var he,jt;const Ms=class Ms extends fe{constructor(t){t=Object.assign({},t);super(t);g(this,he,new Map);g(this,jt,Cu(1));this.addItems(t.items||u(this,he)),v(this,jt,t.maxSize||u(this,jt))}async export(...t){const r=await fe.prototype.export.apply(this,...t);return delete r.data,r.items=await Promise.all(Array.from(u(this,he).values()).map(i=>i.export())),r}async addItems(t,r=!1){return t instanceof Map&&(t=Array.from(t.values())),t=await Promise.all(t.map(async i=>(typeof i.data=="string"&&(i.data=await bi(i.data)),i))),t=this.parseItems(t),Promise.all(t.map(i=>this.addItem(i,r)))}static normalizeItemData(t){return"info"in t&&(t.meta=[t.info],delete t.info),"items"in t&&(t.items instanceof Map||(t.items=new Map(t.items.map(r=>[r.id,r])))),"extension"in t&&(t.id+="."+t.extension,delete t.extension),"createTime"in t&&(t.createdDate=t.createTime,delete t.createTime),"editTime"in t&&(t.editedDate=t.editTime,delete t.editTime),"icon"in t&&delete t.icon,t}parseItems(t){return t.map(r=>{r=Ms.normalizeItemData(r);let i;return r.type?i=ni(r.type):r.items?i=ni("Directory"):i=ni(),new i(r)})}async addItem(t,r=!1){const i=t.parent;if(!r&&this.hasItem(t.id))throw new Error(`File ${t.id} exists`);if(i&&await i.removeItem(t),r){const s=hr(t.id),o=Xi(t.id);t.setId(vs(Va(o,this,s),s))}return u(this,he).set(t.id,t),t.setParent(this),t.events.next(new j("move",{item:t,lastParent:i})),this.events.next(new j("addItem",t)),t}removeItem(t){return t.setParent(null),u(this,he).delete(t.id),this.events.next(new j("removeItem",t)),Promise.resolve()}async remove(t){const{recursive:r}=Object.assign({recursive:!1},t);if(r){let i=await this.getItems();return i=await Promise.all(Array.from(i.values()).map(s=>s.remove(t))),i=i.reduce((s,o)=>s.concat(o),[]),i.push(await fe.prototype.remove.apply(this,[t])),i}else{if((await this.getItems()).size>0)throw new Error(C.get("FileSystemItem_itemContainerNotEmpty",await this.getPath()));return[await fe.prototype.remove.apply(this,arguments)]}}changeItemId(t,r,i){u(this,he).delete(r),u(this,he).set(i,t),this.parent&&console.log("changeItemId by parent",r,i,u(this.parent,he))}getItems(){return Promise.resolve(u(this,he))}getItem(t){return u(this,he).get(t)}hasItem(t){return u(this,he).has(t)}get items(){return u(this,he)}get size(){return Array.from(u(this,he).values()).reduce(function(t,r){return r instanceof Ms||(t+=r.size),t},0)}get maxSize(){return t(this);function t(r){return r.parent&&u(r,jt)?t(r.parent):u(r,jt)}}};he=new WeakMap,jt=new WeakMap;let U=Ms;C.add([["FileSystemItem_itemContainerNotEmpty",["ItemWrapp Not Empty","ItemContainer not empty… %1"]]]);class eo extends U{constructor(e){e=Object.assign({},e,{locked:!0,id:"ROOT"}),super(e)}}p(eo,"NAME","Root");var si,Qe;let lt=(si=class extends U{constructor(t){t=Object.assign({storage:null},t,{locked:!0});super(t);g(this,Qe,void 0);v(this,Qe,t.storage)}get storage(){return u(this,Qe)}get locked(){return u(this,Qe).locked}mount(...t){return u(this,Qe).mount(...t)}unmount(...t){return u(this,Qe).unmount(...t)}async save(){return u(this,Qe).save(await this.export())}},Qe=new WeakMap,p(si,"NAME","Storage"),si);class Is extends lt{constructor(...e){super(...e),this.meta.set(w.VISIBLE,!1)}}p(Is,"NAME","TmpDisk"),p(Is,"SYMBOL",_.TMP_DISK);class Os extends lt{}p(Os,"NAME","RamDisk"),p(Os,"SYMBOL",_.RAM_DISK);class to extends U{}p(to,"NAME","FloppyDisk");class As extends lt{}p(As,"NAME","HardDisk"),p(As,"SYMBOL",_.HARD_DISK);class ks extends lt{isLogged(){return this.storage.storage.isLogged()}}p(ks,"NAME","CloudDisk"),p(ks,"SYMBOL",_.CLOUD_DISK);class It extends U{constructor(...e){super(...e),[w.WINDOW_SCALE,w.WINDOW_SCROLL_X,w.WINDOW_SCROLL_Y].forEach(t=>{this.meta.has(t,!0)||this.meta.set(t,!0)})}}p(It,"NAME","Directory"),p(It,"SYMBOL",_.DIRECTORY);class Re extends U{}p(Re,"NAME","Trashcan"),p(Re,"SYMBOL",_.TRASHCAN);class rs extends fe{}p(rs,"NAME","File");var An;class no extends fe{constructor(t){t=Object.assign({refPath:null},t);super(t);g(this,An,void 0);v(this,An,t.refPath)}get refPath(){return u(this,An)}set refPath(t){v(this,An,t)}}An=new WeakMap,p(no,"NAME","Link");var Gr,Ve,ve,Hr,kn;const ne=class ne{constructor(e){g(this,Gr,void 0);g(this,Ve,void 0);g(this,ve,void 0);g(this,Hr,new Map);g(this,kn,new Me);v(this,Gr,e),this.setup()}get root(){return u(this,Ve)}setup(){v(this,Ve,new eo),v(this,ve,u(this,Ve));const e=[this.addStorage(ne.RAM_DISK_TITLE,ce.SESSION,{id:ne.RAM_DISK_NAME}),this.addStorage(ne.HARD_DISK_NAME,ce.LOCAL,{trashcan:!0}),this.addStorage(ne.TMP_DISK_TITLE,ce.TEMP,{id:ne.TMP_DISK_NAME,trashcan:!1})];return Promise.all(e).catch(t=>{throw t})}createTmpFile(e,t,r,i){return this.createRootFile(`TMP:${e}`,t,r,i)}createRootDir(e,t,r){const i=`${e}`;return this.makedir(i,t,Object.assign({},r,{override:!0}))}createRootFile(e,t,r,i){typeof t=="object"&&(r=t,t=null);const s=`${e}`;return this.makefile(s,t,r,Object.assign({},i,{override:!0}))}async get(e,t){if(e instanceof fe)return e;if(ys(e))try{return await this.parsePath(e)}catch(r){if(t)return new fe({name:Te(e)});throw r}else throw C.get("FileSystem_pathInvalid",Te(e),Un(e))}async parsePath(e){let t=e,r=u(this,ve);const i=e.match(/^([^:\\/]+):(.*)$/);if(i?(r=u(this,Ve).getItem(i[1]),t=i[2]):t[0]==="/"?(t=t.slice(1),r=u(this,ve).getStorageItem()):t==="ROOT"&&(r=u(this,Ve),t=""),t&&t.length>0&&(r=Di(t.split("/"),r)),r)return r;throw C.get("FileSystem_pathInvalid",e,await u(this,ve).getBase())}async addFloppyDisk(e){typeof e=="function"&&(e=e());const t=await e;return this.addStorage(t)}async removeFloppyDisk(e){await e.remove(!0)}async addStorage(e,t=ce.NONE,r){r=Object.assign({id:null},r);let i;typeof t=="function"&&(i=t,t=ce.CLOUD);const s={id:this.getFreeSlot(ne.PREFIX.FLOPPY_DISK),itemClass:to};let o={};if(typeof e=="object"){const a=e;s.name=a.name,s.items=a.items,s.meta=Array.from(new Map([[w.SYMBOL,_.DISK_1]].concat(a.meta||[])))}else{switch(t){case ce.SESSION:s.id=ne.PREFIX.RAM,s.itemClass=Os;break;case ce.TEMP:s.id=ne.PREFIX.TMP,s.itemClass=Is;break;case ce.LOCAL:s.id=this.getFreeSlot(ne.PREFIX.HARD_DISK),s.itemClass=As;break;case ce.CLOUD:s.id=this.getFreeSlot(ne.PREFIX.CLOUD_DISK),s.itemClass=ks;break}s.id=r.id||s.id,i=await this.registerStorage(s.id,i||t).mount(r);const a=await i.load();o=U.normalizeItemData(a),s.storage=i,ce.NONE!==t&&(s.name=o.name||e)}return(s.meta=s.meta||[]).push(...o.meta||[]),this.addDisk(Object.assign(o,s),r)}removeStorage(e){return e.unmount().then(()=>(u(this,kn).next(new j("removeStorage",{itemStorage:e})),e))}registerStorage(e,t){let r;typeof t=="function"?r=t:r=Qa(t);const i=`${u(this,Gr)}_${e}`,s=new r({id:e,name:i});return u(this,Hr).set(i,s),s}connect(e,t){return this.addStorage(Au,e,t).then(r=>r).catch(r=>{throw r})}async disconnect(e){return e=await this.removeStorage(e),e.remove({silent:!0,recursive:!0}),e}addDisk({id:e,name:t,meta:r,items:i,itemClass:s,storage:o},a){a=Object.assign({trashcan:!1},a),a.trashcan&&(!i||i&&!i.has(Re.NAME))&&(i=i||new Map,i.set(Re.NAME,{type:Re.NAME,id:Re.NAME,name:Re.NAME}));const l=s;if(!l)throw new Error("ItemClass is empty!");const c=new l({id:e,name:t,meta:r,items:i,storage:o});return u(this,Ve).addItem(c),u(this,kn).next(new j("addDisk",{id:e,item:c})),c}get currentItem(){return u(this,ve)}get events(){return u(this,kn)}get storages(){return u(this,Hr)}getFreeSlot(e){let t=0;for(;u(this,Ve).hasItem(`${e}${t}`);)t++;return`${e}${t}`}async exist(e){try{return!!await this.get(e)}catch(t){return console.error(t),!1}}async changeDirectory(e){const t=await this.get(e);return v(this,ve,t),this.events.next(new j("changeDirectory",t)),t}async makedir(e,t,r){const{ignore:i,meta:s}=Object.assign({ignore:!1,override:!1,meta:[]},r);let o;e&&Du(e)&&e!==t?o=await this.get(Un(e)):o=u(this,ve);const a=new It({id:Te(e),name:t||"",createdDate:Date.now(),meta:s});if(await Ye(o),i||!o.getItem(a.id))o.addItem(a,i),this.events.next(new j("writeItem",a));else throw C.get("FileSystem_fileExist",a.id);return await ye(o),a}async makefile(e,t,r,i){const{override:s,meta:o}=Object.assign({override:!1,meta:[]},i),a=new rs({id:Te(e),name:t,data:r,meta:o,createdDate:Date.now()});if(!ys(e))throw C.get("FileSystem_invalidPath",e);let l=Tu(e);const c=Ru(e);l===c&&(l=".");let d;if(ku(l)?d=await this.get(l):u(this,ve).id!=="ROOT"?d=await this.get(Yi(await u(this,ve).getPath(),l)):d=await this.get(l),d.hasItem(c))if(s)await d.getItem(c).remove(),d.addItem(a);else throw C.get("FileSystem_fileExist",a.id);else d.addItem(a),this.events.next(new j("writeItem",a));return await ye(d),a}async editfile(e,t){const r=await this.get(e).then(Ye);return await Ye(r),r.data=t,ye(r)}async editfileMeta(e,t,r){const i=await this.get(e);return Array.isArray(t)?t.map(s=>({name:s[0],value:s[1]})):i.meta.set(t,r),ye(i)}async saveItem(e){const t=await this.get(e);return ye(t)}async makelink(e,t=null){const r=await this.get(e);await Ye(r);const i=u(this,ve),s=new no({id:Xi(r.id)+".ref",name:`${t||r.name}`,refPath:await r.getPath(),createdDate:Date.now()});return await i.addItem(s),await ye(r),s}async editlink(e,t){const r=await this.get(e);await Ye(r);const i=await this.get(t);return r.refPath=await i.getPath(),ye(r)}async rename(e,t,{name:r=!1,removeName:i=!1}){let s;if(e instanceof fe)s=e;else if(ys(e)||typeof e=="string")s=await this.get(e);else throw C.get("FileSystem_pathInvalid",Un(e),e);return await Ye(s),i&&(r=!0,t=null),await s.rename(t,{ignore:!0,name:r}),ye(s)}async copy(e,t,r){const{ignore:i}=Object.assign({ignore:!1},r);let s,o,a;if(e instanceof fe?(o=e,s=e.id):(o=await this.get(e),s=Te(e)),t instanceof fe)t instanceof U||(t=t.parent),a=t;else{s=Te(t);const c=await this.get(t,!0);if(c instanceof U?s=Te(e):c.parent?a=c.parent:a=await this.get(Un(t)),!(a instanceof U))throw new TypeError("no ItemContainer")}await Ye(o);const l=await o.copy();if(i||!a.getItem(s))l.rename(s),a.addItem(l,i),this.events.next(new j("copyItem",l));else throw C.get("FileSystem_fileExist",s);return ye(l)}async move(e,t,{override:r=!1}){let i,s,o;if(e instanceof fe)s=e,i=e.id;else{if(s=await this.get(e),s instanceof lt)throw C.get("FileSystem_cantMoveStorage",s.displayName);i=Te(e)}if(t instanceof fe)t instanceof U||(t=t.parent),o=t;else{if(i=Te(t),o=await this.get(t),o instanceof U)i=Te(e);else return this.get(Un(t));if(!(o instanceof U))throw new TypeError("no ItemContainer")}let a;if(await Ye(s),r||!await o.getItem(i))a=s.getStorageItem(),await s.rename(i),await o.addItem(s,r),this.events.next(new j("moveItem",s));else throw C.get("FileSystem_fileExist",s.id,i);return await ye(s),a?a.save().then(()=>s):s}async remove(e,t,r){const{ignore:i}=Object.assign({ignore:!1},r),s=await this.get(e);await Ye(s);try{const o=await Nu(t,s);return o[o.length-1].storage&&await o[o.length-1].storage.save(),o}catch(o){if(!i)throw new Error(o)}}};Gr=new WeakMap,Ve=new WeakMap,ve=new WeakMap,Hr=new WeakMap,kn=new WeakMap,p(ne,"PREFIX",{FLOPPY_DISK:"DF",TMP:"TMP",RAM:"RAM",HARD_DISK:"HD",CLOUD_DISK:"CD"}),p(ne,"TMP_DISK_NAME","TMP"),p(ne,"TMP_DISK_TITLE","TMP DISK"),p(ne,"RAM_DISK_NAME","RAM"),p(ne,"RAM_DISK_TITLE","RAM DISK"),p(ne,"HARD_DISK_NAME","HARD DISK");let Ri=ne;function Di(n,e){const t=n.shift();if(t===void 0)return e;if(t===".."){if(e.parent)return e.parent}else if(t==="."||t==="")return Di(n,e);if(e){const r=e.getItem(t);return n.length>0&&r instanceof U?Di(n,r):r}}const Df=[It,Re,lt,Is,Os,As,to,ks,no,rs].reduce((n,e)=>(n[e.NAME]=e,n),{});function ni(n){return Df[String(n)]||rs}C.add([["FileSystem_invalidPath",["Invalid File",'Invalid path "%1"']],["FileSystem_invalidFile",["Invalid File",'Invalid file… "%1"']],["FileSystem_fileExist",["File Ready",'File already exists… "%1"']],["FileSystem_pathInvalid",["Path Invalid",'Path invalid… "%1"; base: "%2"']],["FileSystem_itemInvalid",["Item Invalid",'Item id invalid… "%1" from "%2"']],["FileSystem_cantMoveStorage",["Can't Move",`Can't move Storage "%1"`]],["FileSystem_permissionsNeeded",["Permissions needed","Permissions needed"]]]);const Cf={props:{label:{type:String,default:"Item Label"},model:{type:Object,default(){return{value:null}}},name:{type:String,default:null},value:{type:[String,Number],default:null},multiple:{type:Boolean,default:!1},readonly:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1}},computed:{currentModel:{get(){return this.name?this.model[this.name]:this.model.value},set(n){this.name?this.model[this.name]=n:this.model.value=n}},input(){return{name:this.name,readonly:this.readonly,disabled:this.disabled,type:this.multiple?"checkbox":"radio"}}}},Nf={class:"wb-env-atom-form-field-item-select-item"},Lf=["value"],Pf=["innerHTML"];function Mf(n,e,t,r,i,s){return x(),T("label",Nf,[Zt(E("input",F({"onUpdate:modelValue":e[0]||(e[0]=o=>s.currentModel=o)},s.input,{value:t.value}),null,16,Lf),[[$i,s.currentModel]]),E("span",{class:"label",innerHTML:t.label||" "},null,8,Pf)])}const $f=V(Cf,[["render",Mf],["__scopeId","data-v-f600844e"]]),Wf={components:{WbEnvAtomFormFieldFieldItemSelectItem:$f},props:{title:{type:String,default:"Item Select Title"},multiple:{type:Boolean,default:!1},name:{type:String,default:"value"},readonly:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},model:{type:Object,default(){return{value:{}}}},items:{type:Array,required:!1,default(){return[{label:"Item 1",value:"item-1"},{label:"Item 2",value:"item-2"}]}}}},Ff={class:"wb-env-atom-form-field-item-select"},zf={key:0,class:"title"};function Bf(n,e,t,r,i,s){const o=k("wb-env-atom-form-field-field-item-select-item");return x(),T("div",Ff,[t.title?(x(),T("div",zf,Ce(t.title),1)):W("",!0),E("ul",null,[(x(!0),T(vt,null,St(t.items,(a,l)=>(x(),T("li",{key:l},[R(o,F({ref_for:!0},a,{name:a.name||t.name,model:t.model,multiple:t.multiple,readonly:a.readonly||t.readonly,disabled:a.disabled||t.disabled}),null,16,["name","model","multiple","readonly","disabled"])]))),128))])])}const Vf=V(Wf,[["render",Bf],["__scopeId","data-v-393e2da0"]]),jf={components:{WbButton:kt,WbButtonWrapper:Tt,WbItemSelect:Vf},props:{fileSystem:{type:Object,default(){return null}},fsItem:{type:Object,default(){return null}},name:{type:String,default(){return"fsItem"}},model:{type:Object,default(){return{fsItem:null}}},backLabel:{type:String,default(){return"../"}},upLabel:{type:String,default(){return"Up"}},downLabel:{type:String,default(){return"Down"}},maxVisibleItems:{type:Number,default(){return 5}}},emits:["select","refresh"],data(){return{currentFsItem:this.fsItem||M(this.fileSystem.root),fsItems:[],currentIndex:0}},computed:{disableds(){return{back:!this.currentFsItem.parent,up:this.currentIndex-1<0,down:this.currentIndex+1>this.fsItems.length-this.maxVisibleItems}},currentPath(){return this.model[this.name]},items(){const n=this.fsItems.slice(this.currentIndex,this.currentIndex+this.maxVisibleItems).map(e=>({label:e.id,value:e.getPath()})).concat(Array(Math.max(this.maxVisibleItems-this.fsItems.length,0)).fill({label:"&nbsp;",disabled:!0}));return this.fsItems.length<1&&(n[Math.floor(n.length/2)]={label:"Empty",disabled:!0}),n}},watch:{async currentPath(){this.currentFsItem=M(await this.fileSystem.get(this.model[this.name])),this.currentFsItem instanceof U&&(this.fsItems=Array.from((await this.currentFsItem.getItems()).values()).map(M),this.currentIndex=0),this.$emit("select",this.currentFsItem)}},async mounted(){this.fsItems=Array.from((await this.currentFsItem.getItems()).values()).map(M),this.$nextTick(()=>{this.$emit("refresh",{reset:!0,resize:!1,scroll:!1})})},methods:{onClicBack(){this.currentFsItem instanceof U?this.model[this.name]=this.currentFsItem.parent.getPath():this.model[this.name]=this.currentFsItem.parent.parent.getPath()},onClickUp(){this.currentIndex=Math.max(this.currentIndex-1,0)},onClickDown(){this.currentIndex=Math.min(this.currentIndex+1,this.fsItems.length-this.maxVisibleItems)}}},Uf={class:"wb-module-files-atoms-file-select"};function Gf(n,e,t,r,i,s){const o=k("wb-item-select"),a=k("wb-button"),l=k("wb-button-wrapper");return x(),T("div",Uf,[E("div",null,[R(o,{title:null,items:s.items,name:t.name,model:t.model},null,8,["items","name","model"])]),E("div",null,[R(l,{align:"outer",full:"",direction:"vertical"},{default:G(()=>[R(a,{"style-type":"secondary",label:t.backLabel,disabled:s.disableds.back,onClick:s.onClicBack},null,8,["label","disabled","onClick"]),R(a,{"style-type":"secondary",label:t.upLabel,disabled:s.disableds.up,onClick:s.onClickUp},null,8,["label","disabled","onClick"]),t.downLabel?(x(),z(a,{key:0,"style-type":"secondary",label:t.downLabel,disabled:s.disableds.down,onClick:s.onClickDown},null,8,["label","disabled","onClick"])):W("",!0)]),_:1})])])}const sl=V(jf,[["render",Gf],["__scopeId","data-v-456ecefa"]]),Hf={components:{WbEnvAtomFormField:Bn},props:{model:{type:[Array,Object],default(){return{}}},type:{type:String,default:"text"},id:{type:String,default:null},name:{type:String,default:null},placeholder:{type:String,default:"Placeholder"},pattern:{type:String,default:null},readonly:{type:Boolean,default:!1},min:{type:Number,default:null},max:{type:Number,default:null},step:{type:Number,default:null},disabled:{type:Boolean,default:!1},autocomplete:{type:Boolean,default:!1},size:{type:[String,Number],default:void 0}},computed:{currentModel:{get(){return this.name?this.model[this.name]:this.model.value},set(n){this.name?this.model[this.name]=n:this.model.value=n}},styleClasses(){return{["type-"+this.type]:!0}},input(){return{name:this.name,type:this.type,placeholder:this.placeholder,pattern:this.pattern,min:this.min,max:this.max,step:this.step,readonly:this.readonly,disabled:this.disabled,autocomplete:this.autocomplete?"on":"off"}}}};function Yf(n,e,t,r,i,s){const o=k("wb-env-atom-form-field");return x(),z(o,F({tag:"div",class:"wb-env-atom-form-textbox"},n.$attrs,{class:s.styleClasses}),{default:G(()=>[Zt(E("input",F({ref:"input","onUpdate:modelValue":e[0]||(e[0]=a=>s.currentModel=a),class:"input"},s.input),null,16),[[$i,s.currentModel]])]),_:1},16,["class"])}const ss=V(Hf,[["render",Yf],["__scopeId","data-v-64796933"]]),Xf={components:{WbForm:zn,WbButton:kt,WbButtonWrapper:Tt,WbFormFieldTextbox:ss,WbFileSelect:sl},props:{...dt,fsItem:{type:Object,default(){return null}},id:{type:String,default(){return null}},model:{type:Object,default(){return Ne({path:null,filename:null,file:null})}}},emits:[...ht,"close"],setup(n,e){return ut(n,e)},data(){return{filesModule:M(this.core.modules.files),cancelLabel:"Cancel",saveLabel:"Save",fields:{path:{name:"path",label:null,placeholder:"Path…"},filesSelect:{title:null,name:"item"},filename:{name:"filename",label:null,placeholder:"Filename…"}},currentFsItem:this.fsItem||M(this.core.modules.files.fs.root)}},computed:{fileSelectFsItem(){return this.fsItem||M(this.core.modules.files.fs.root)},isLocked(){return this.currentFsItem?this.currentFsItem.locked:!1},saveDisabled(){return!this.model.filename}},mounted(){this.id&&(this.model.filename=this.id)},methods:{onSelect(n){this.currentFsItem=n,n instanceof U?this.model.path=n.getPath():(this.model.path=n.getBase(),this.model.filename=n.id)},onClickCancel(){this.$emit("close")},onSubmit(){const n=Yi(this.model.path,this.model.filename);this.$emit("close",n)}}},qf={class:"wb-module-files-save"};function Kf(n,e,t,r,i,s){const o=k("wb-form-field-textbox"),a=k("wb-file-select"),l=k("wb-button"),c=k("wb-button-wrapper"),d=k("wb-form");return x(),T("div",qf,[R(d,{onSubmit:s.onSubmit},{default:G(()=>[R(o,F(i.fields.path,{model:t.model,readonly:""}),null,16,["model"]),R(a,{"file-system":i.filesModule.fileSystem,"fs-item":s.fileSelectFsItem,model:t.model,name:"file",onSelect:s.onSelect},null,8,["file-system","fs-item","model","onSelect"]),R(o,F(i.fields.filename,{model:t.model}),null,16,["model"]),R(c,{align:"outer",full:""},{default:G(()=>[i.cancelLabel?(x(),z(l,{key:0,"style-type":"secondary",label:i.cancelLabel,onClick:s.onClickCancel},null,8,["label","onClick"])):W("",!0),i.saveLabel?(x(),z(l,{key:1,"style-type":"primary",label:i.saveLabel,type:"submit",disabled:s.isLocked||s.saveDisabled},null,8,["label","disabled"])):W("",!0)]),_:1})]),_:1},8,["onSubmit"])])}const Zf=V(Xf,[["render",Kf],["__scopeId","data-v-fe5bc441"]]),Qf={components:{WbForm:zn,WbButton:kt,WbButtonWrapper:Tt,WbFormFieldTextbox:ss,WbFileSelect:sl},props:{...dt,fsItem:{type:Object,default(){return null}},model:{type:Object,default(){return Ne({path:null})}}},emits:[...ht,"close"],setup(n,e){return ut(n,e)},data(){return{filesModule:M(this.core.modules.files),cancelLabel:"Cancel",openLabel:"Open",fields:{path:{name:"path",label:null,placeholder:"Path…"},fileSelect:{name:"path"},filename:{name:"filename",label:null,placeholder:"Filename…"}},currentFsItem:this.fsItem||M(this.core.modules.files.fs.root)}},computed:{isItemContainer(){return this.currentFsItem instanceof U},fileSelectFsItem(){return this.fsItem||M(this.core.modules.files.fs.root)}},methods:{onSelect(n){this.currentFsItem=M(n),n instanceof U&&(this.model.path=n.getPath())},onClickCancel(){this.$emit("close")},onSubmit(){this.$emit("close",this.model.path)}}},Jf={class:"wb-module-files-open"};function em(n,e,t,r,i,s){const o=k("wb-form-field-textbox"),a=k("wb-file-select"),l=k("wb-button"),c=k("wb-button-wrapper"),d=k("wb-form");return x(),T("div",Jf,[R(d,{onSubmit:s.onSubmit},{default:G(()=>[R(o,F(i.fields.path,{model:t.model,readonly:""}),null,16,["model"]),R(a,F(i.fields.fileSelect,{"file-system":i.filesModule.fileSystem,"fs-item":s.fileSelectFsItem,model:t.model,onSelect:s.onSelect}),null,16,["file-system","fs-item","model","onSelect"]),R(c,{align:"outer",full:""},{default:G(()=>[i.cancelLabel?(x(),z(l,{key:0,"style-type":"secondary",label:i.cancelLabel,onClick:s.onClickCancel},null,8,["label","onClick"])):W("",!0),i.openLabel?(x(),z(l,{key:1,"style-type":"primary",label:i.openLabel,type:"submit",disabled:s.isItemContainer},null,8,["label","disabled"])):W("",!0)]),_:1})]),_:1},8,["onSubmit"])])}const tm=V(Qf,[["render",em],["__scopeId","data-v-d62b4bd4"]]);function ro(){return{async:!1,breaks:!1,extensions:null,gfm:!0,hooks:null,pedantic:!1,renderer:null,silent:!1,tokenizer:null,walkTokens:null}}let en=ro();function il(n){en=n}const ol=/[&<>"']/,nm=new RegExp(ol.source,"g"),al=/[<>"']|&(?!(#\d{1,7}|#[Xx][a-fA-F0-9]{1,6}|\w+);)/,rm=new RegExp(al.source,"g"),sm={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},Fo=n=>sm[n];function Oe(n,e){if(e){if(ol.test(n))return n.replace(nm,Fo)}else if(al.test(n))return n.replace(rm,Fo);return n}const im=/&(#(?:\d+)|(?:#x[0-9A-Fa-f]+)|(?:\w+));?/ig;function om(n){return n.replace(im,(e,t)=>(t=t.toLowerCase(),t==="colon"?":":t.charAt(0)==="#"?t.charAt(1)==="x"?String.fromCharCode(parseInt(t.substring(2),16)):String.fromCharCode(+t.substring(1)):""))}const am=/(^|[^\[])\^/g;function B(n,e){let t=typeof n=="string"?n:n.source;e=e||"";const r={replace:(i,s)=>{let o=typeof s=="string"?s:s.source;return o=o.replace(am,"$1"),t=t.replace(i,o),r},getRegex:()=>new RegExp(t,e)};return r}function zo(n){try{n=encodeURI(n).replace(/%25/g,"%")}catch{return null}return n}const rr={exec:()=>null};function Bo(n,e){const t=n.replace(/\|/g,(s,o,a)=>{let l=!1,c=o;for(;--c>=0&&a[c]==="\\";)l=!l;return l?"|":" |"}),r=t.split(/ \|/);let i=0;if(r[0].trim()||r.shift(),r.length>0&&!r[r.length-1].trim()&&r.pop(),e)if(r.length>e)r.splice(e);else for(;r.length<e;)r.push("");for(;i<r.length;i++)r[i]=r[i].trim().replace(/\\\|/g,"|");return r}function fs(n,e,t){const r=n.length;if(r===0)return"";let i=0;for(;i<r;){const s=n.charAt(r-i-1);if(s===e&&!t)i++;else if(s!==e&&t)i++;else break}return n.slice(0,r-i)}function lm(n,e){if(n.indexOf(e[1])===-1)return-1;let t=0;for(let r=0;r<n.length;r++)if(n[r]==="\\")r++;else if(n[r]===e[0])t++;else if(n[r]===e[1]&&(t--,t<0))return r;return-1}function Vo(n,e,t,r){const i=e.href,s=e.title?Oe(e.title):null,o=n[1].replace(/\\([\[\]])/g,"$1");if(n[0].charAt(0)!=="!"){r.state.inLink=!0;const a={type:"link",raw:t,href:i,title:s,text:o,tokens:r.inlineTokens(o)};return r.state.inLink=!1,a}return{type:"image",raw:t,href:i,title:s,text:Oe(o)}}function cm(n,e){const t=n.match(/^(\s+)(?:```)/);if(t===null)return e;const r=t[1];return e.split(`
`).map(i=>{const s=i.match(/^\s+/);if(s===null)return i;const[o]=s;return o.length>=r.length?i.slice(r.length):i}).join(`
`)}class Ts{constructor(e){p(this,"options");p(this,"rules");p(this,"lexer");this.options=e||en}space(e){const t=this.rules.block.newline.exec(e);if(t&&t[0].length>0)return{type:"space",raw:t[0]}}code(e){const t=this.rules.block.code.exec(e);if(t){const r=t[0].replace(/^ {1,4}/gm,"");return{type:"code",raw:t[0],codeBlockStyle:"indented",text:this.options.pedantic?r:fs(r,`
`)}}}fences(e){const t=this.rules.block.fences.exec(e);if(t){const r=t[0],i=cm(r,t[3]||"");return{type:"code",raw:r,lang:t[2]?t[2].trim().replace(this.rules.inline.anyPunctuation,"$1"):t[2],text:i}}}heading(e){const t=this.rules.block.heading.exec(e);if(t){let r=t[2].trim();if(/#$/.test(r)){const i=fs(r,"#");(this.options.pedantic||!i||/ $/.test(i))&&(r=i.trim())}return{type:"heading",raw:t[0],depth:t[1].length,text:r,tokens:this.lexer.inline(r)}}}hr(e){const t=this.rules.block.hr.exec(e);if(t)return{type:"hr",raw:t[0]}}blockquote(e){const t=this.rules.block.blockquote.exec(e);if(t){let r=t[0].replace(/\n {0,3}((?:=+|-+) *)(?=\n|$)/g,`
    $1`);r=fs(r.replace(/^ *>[ \t]?/gm,""),`
`);const i=this.lexer.state.top;this.lexer.state.top=!0;const s=this.lexer.blockTokens(r);return this.lexer.state.top=i,{type:"blockquote",raw:t[0],tokens:s,text:r}}}list(e){let t=this.rules.block.list.exec(e);if(t){let r=t[1].trim();const i=r.length>1,s={type:"list",raw:"",ordered:i,start:i?+r.slice(0,-1):"",loose:!1,items:[]};r=i?`\\d{1,9}\\${r.slice(-1)}`:`\\${r}`,this.options.pedantic&&(r=i?r:"[*+-]");const o=new RegExp(`^( {0,3}${r})((?:[	 ][^\\n]*)?(?:\\n|$))`);let a="",l="",c=!1;for(;e;){let d=!1;if(!(t=o.exec(e))||this.rules.block.hr.test(e))break;a=t[0],e=e.substring(a.length);let f=t[2].split(`
`,1)[0].replace(/^\t+/,$=>" ".repeat(3*$.length)),h=e.split(`
`,1)[0],m=0;this.options.pedantic?(m=2,l=f.trimStart()):(m=t[2].search(/[^ ]/),m=m>4?1:m,l=f.slice(m),m+=t[1].length);let I=!1;if(!f&&/^ *$/.test(h)&&(a+=h+`
`,e=e.substring(h.length+1),d=!0),!d){const $=new RegExp(`^ {0,${Math.min(3,m-1)}}(?:[*+-]|\\d{1,9}[.)])((?:[ 	][^\\n]*)?(?:\\n|$))`),D=new RegExp(`^ {0,${Math.min(3,m-1)}}((?:- *){3,}|(?:_ *){3,}|(?:\\* *){3,})(?:\\n+|$)`),P=new RegExp(`^ {0,${Math.min(3,m-1)}}(?:\`\`\`|~~~)`),me=new RegExp(`^ {0,${Math.min(3,m-1)}}#`);for(;e;){const Z=e.split(`
`,1)[0];if(h=Z,this.options.pedantic&&(h=h.replace(/^ {1,4}(?=( {4})*[^ ])/g,"  ")),P.test(h)||me.test(h)||$.test(h)||D.test(e))break;if(h.search(/[^ ]/)>=m||!h.trim())l+=`
`+h.slice(m);else{if(I||f.search(/[^ ]/)>=4||P.test(f)||me.test(f)||D.test(f))break;l+=`
`+h}!I&&!h.trim()&&(I=!0),a+=Z+`
`,e=e.substring(Z.length+1),f=h.slice(m)}}s.loose||(c?s.loose=!0:/\n *\n *$/.test(a)&&(c=!0));let b=null,A;this.options.gfm&&(b=/^\[[ xX]\] /.exec(l),b&&(A=b[0]!=="[ ] ",l=l.replace(/^\[[ xX]\] +/,""))),s.items.push({type:"list_item",raw:a,task:!!b,checked:A,loose:!1,text:l,tokens:[]}),s.raw+=a}s.items[s.items.length-1].raw=a.trimEnd(),s.items[s.items.length-1].text=l.trimEnd(),s.raw=s.raw.trimEnd();for(let d=0;d<s.items.length;d++)if(this.lexer.state.top=!1,s.items[d].tokens=this.lexer.blockTokens(s.items[d].text,[]),!s.loose){const f=s.items[d].tokens.filter(m=>m.type==="space"),h=f.length>0&&f.some(m=>/\n.*\n/.test(m.raw));s.loose=h}if(s.loose)for(let d=0;d<s.items.length;d++)s.items[d].loose=!0;return s}}html(e){const t=this.rules.block.html.exec(e);if(t)return{type:"html",block:!0,raw:t[0],pre:t[1]==="pre"||t[1]==="script"||t[1]==="style",text:t[0]}}def(e){const t=this.rules.block.def.exec(e);if(t){const r=t[1].toLowerCase().replace(/\s+/g," "),i=t[2]?t[2].replace(/^<(.*)>$/,"$1").replace(this.rules.inline.anyPunctuation,"$1"):"",s=t[3]?t[3].substring(1,t[3].length-1).replace(this.rules.inline.anyPunctuation,"$1"):t[3];return{type:"def",tag:r,raw:t[0],href:i,title:s}}}table(e){const t=this.rules.block.table.exec(e);if(!t||!/[:|]/.test(t[2]))return;const r=Bo(t[1]),i=t[2].replace(/^\||\| *$/g,"").split("|"),s=t[3]&&t[3].trim()?t[3].replace(/\n[ \t]*$/,"").split(`
`):[],o={type:"table",raw:t[0],header:[],align:[],rows:[]};if(r.length===i.length){for(const a of i)/^ *-+: *$/.test(a)?o.align.push("right"):/^ *:-+: *$/.test(a)?o.align.push("center"):/^ *:-+ *$/.test(a)?o.align.push("left"):o.align.push(null);for(const a of r)o.header.push({text:a,tokens:this.lexer.inline(a)});for(const a of s)o.rows.push(Bo(a,o.header.length).map(l=>({text:l,tokens:this.lexer.inline(l)})));return o}}lheading(e){const t=this.rules.block.lheading.exec(e);if(t)return{type:"heading",raw:t[0],depth:t[2].charAt(0)==="="?1:2,text:t[1],tokens:this.lexer.inline(t[1])}}paragraph(e){const t=this.rules.block.paragraph.exec(e);if(t){const r=t[1].charAt(t[1].length-1)===`
`?t[1].slice(0,-1):t[1];return{type:"paragraph",raw:t[0],text:r,tokens:this.lexer.inline(r)}}}text(e){const t=this.rules.block.text.exec(e);if(t)return{type:"text",raw:t[0],text:t[0],tokens:this.lexer.inline(t[0])}}escape(e){const t=this.rules.inline.escape.exec(e);if(t)return{type:"escape",raw:t[0],text:Oe(t[1])}}tag(e){const t=this.rules.inline.tag.exec(e);if(t)return!this.lexer.state.inLink&&/^<a /i.test(t[0])?this.lexer.state.inLink=!0:this.lexer.state.inLink&&/^<\/a>/i.test(t[0])&&(this.lexer.state.inLink=!1),!this.lexer.state.inRawBlock&&/^<(pre|code|kbd|script)(\s|>)/i.test(t[0])?this.lexer.state.inRawBlock=!0:this.lexer.state.inRawBlock&&/^<\/(pre|code|kbd|script)(\s|>)/i.test(t[0])&&(this.lexer.state.inRawBlock=!1),{type:"html",raw:t[0],inLink:this.lexer.state.inLink,inRawBlock:this.lexer.state.inRawBlock,block:!1,text:t[0]}}link(e){const t=this.rules.inline.link.exec(e);if(t){const r=t[2].trim();if(!this.options.pedantic&&/^</.test(r)){if(!/>$/.test(r))return;const o=fs(r.slice(0,-1),"\\");if((r.length-o.length)%2===0)return}else{const o=lm(t[2],"()");if(o>-1){const l=(t[0].indexOf("!")===0?5:4)+t[1].length+o;t[2]=t[2].substring(0,o),t[0]=t[0].substring(0,l).trim(),t[3]=""}}let i=t[2],s="";if(this.options.pedantic){const o=/^([^'"]*[^\s])\s+(['"])(.*)\2/.exec(i);o&&(i=o[1],s=o[3])}else s=t[3]?t[3].slice(1,-1):"";return i=i.trim(),/^</.test(i)&&(this.options.pedantic&&!/>$/.test(r)?i=i.slice(1):i=i.slice(1,-1)),Vo(t,{href:i&&i.replace(this.rules.inline.anyPunctuation,"$1"),title:s&&s.replace(this.rules.inline.anyPunctuation,"$1")},t[0],this.lexer)}}reflink(e,t){let r;if((r=this.rules.inline.reflink.exec(e))||(r=this.rules.inline.nolink.exec(e))){const i=(r[2]||r[1]).replace(/\s+/g," "),s=t[i.toLowerCase()];if(!s){const o=r[0].charAt(0);return{type:"text",raw:o,text:o}}return Vo(r,s,r[0],this.lexer)}}emStrong(e,t,r=""){let i=this.rules.inline.emStrongLDelim.exec(e);if(!i||i[3]&&r.match(/[\p{L}\p{N}]/u))return;if(!(i[1]||i[2]||"")||!r||this.rules.inline.punctuation.exec(r)){const o=[...i[0]].length-1;let a,l,c=o,d=0;const f=i[0][0]==="*"?this.rules.inline.emStrongRDelimAst:this.rules.inline.emStrongRDelimUnd;for(f.lastIndex=0,t=t.slice(-1*e.length+o);(i=f.exec(t))!=null;){if(a=i[1]||i[2]||i[3]||i[4]||i[5]||i[6],!a)continue;if(l=[...a].length,i[3]||i[4]){c+=l;continue}else if((i[5]||i[6])&&o%3&&!((o+l)%3)){d+=l;continue}if(c-=l,c>0)continue;l=Math.min(l,l+c+d);const h=[...i[0]][0].length,m=e.slice(0,o+i.index+h+l);if(Math.min(o,l)%2){const b=m.slice(1,-1);return{type:"em",raw:m,text:b,tokens:this.lexer.inlineTokens(b)}}const I=m.slice(2,-2);return{type:"strong",raw:m,text:I,tokens:this.lexer.inlineTokens(I)}}}}codespan(e){const t=this.rules.inline.code.exec(e);if(t){let r=t[2].replace(/\n/g," ");const i=/[^ ]/.test(r),s=/^ /.test(r)&&/ $/.test(r);return i&&s&&(r=r.substring(1,r.length-1)),r=Oe(r,!0),{type:"codespan",raw:t[0],text:r}}}br(e){const t=this.rules.inline.br.exec(e);if(t)return{type:"br",raw:t[0]}}del(e){const t=this.rules.inline.del.exec(e);if(t)return{type:"del",raw:t[0],text:t[2],tokens:this.lexer.inlineTokens(t[2])}}autolink(e){const t=this.rules.inline.autolink.exec(e);if(t){let r,i;return t[2]==="@"?(r=Oe(t[1]),i="mailto:"+r):(r=Oe(t[1]),i=r),{type:"link",raw:t[0],text:r,href:i,tokens:[{type:"text",raw:r,text:r}]}}}url(e){var r;let t;if(t=this.rules.inline.url.exec(e)){let i,s;if(t[2]==="@")i=Oe(t[0]),s="mailto:"+i;else{let o;do o=t[0],t[0]=((r=this.rules.inline._backpedal.exec(t[0]))==null?void 0:r[0])??"";while(o!==t[0]);i=Oe(t[0]),t[1]==="www."?s="http://"+t[0]:s=t[0]}return{type:"link",raw:t[0],text:i,href:s,tokens:[{type:"text",raw:i,text:i}]}}}inlineText(e){const t=this.rules.inline.text.exec(e);if(t){let r;return this.lexer.state.inRawBlock?r=t[0]:r=Oe(t[0]),{type:"text",raw:t[0],text:r}}}}const um=/^(?: *(?:\n|$))+/,dm=/^( {4}[^\n]+(?:\n(?: *(?:\n|$))*)?)+/,hm=/^ {0,3}(`{3,}(?=[^`\n]*(?:\n|$))|~{3,})([^\n]*)(?:\n|$)(?:|([\s\S]*?)(?:\n|$))(?: {0,3}\1[~`]* *(?=\n|$)|$)/,is=/^ {0,3}((?:-[\t ]*){3,}|(?:_[ \t]*){3,}|(?:\*[ \t]*){3,})(?:\n+|$)/,fm=/^ {0,3}(#{1,6})(?=\s|$)(.*)(?:\n+|$)/,ll=/(?:[*+-]|\d{1,9}[.)])/,cl=B(/^(?!bull |blockCode|fences|blockquote|heading|html)((?:.|\n(?!\s*?\n|bull |blockCode|fences|blockquote|heading|html))+?)\n {0,3}(=+|-+) *(?:\n+|$)/).replace(/bull/g,ll).replace(/blockCode/g,/ {4}/).replace(/fences/g,/ {0,3}(?:`{3,}|~{3,})/).replace(/blockquote/g,/ {0,3}>/).replace(/heading/g,/ {0,3}#{1,6}/).replace(/html/g,/ {0,3}<[^\n>]+>\n/).getRegex(),so=/^([^\n]+(?:\n(?!hr|heading|lheading|blockquote|fences|list|html|table| +\n)[^\n]+)*)/,mm=/^[^\n]+/,io=/(?!\s*\])(?:\\.|[^\[\]\\])+/,pm=B(/^ {0,3}\[(label)\]: *(?:\n *)?([^<\s][^\s]*|<.*?>)(?:(?: +(?:\n *)?| *\n *)(title))? *(?:\n+|$)/).replace("label",io).replace("title",/(?:"(?:\\"?|[^"\\])*"|'[^'\n]*(?:\n[^'\n]+)*\n?'|\([^()]*\))/).getRegex(),gm=B(/^( {0,3}bull)([ \t][^\n]+?)?(?:\n|$)/).replace(/bull/g,ll).getRegex(),Us="address|article|aside|base|basefont|blockquote|body|caption|center|col|colgroup|dd|details|dialog|dir|div|dl|dt|fieldset|figcaption|figure|footer|form|frame|frameset|h[1-6]|head|header|hr|html|iframe|legend|li|link|main|menu|menuitem|meta|nav|noframes|ol|optgroup|option|p|param|search|section|summary|table|tbody|td|tfoot|th|thead|title|tr|track|ul",oo=/<!--(?:-?>|[\s\S]*?(?:-->|$))/,bm=B("^ {0,3}(?:<(script|pre|style|textarea)[\\s>][\\s\\S]*?(?:</\\1>[^\\n]*\\n+|$)|comment[^\\n]*(\\n+|$)|<\\?[\\s\\S]*?(?:\\?>\\n*|$)|<![A-Z][\\s\\S]*?(?:>\\n*|$)|<!\\[CDATA\\[[\\s\\S]*?(?:\\]\\]>\\n*|$)|</?(tag)(?: +|\\n|/?>)[\\s\\S]*?(?:(?:\\n *)+\\n|$)|<(?!script|pre|style|textarea)([a-z][\\w-]*)(?:attribute)*? */?>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n *)+\\n|$)|</(?!script|pre|style|textarea)[a-z][\\w-]*\\s*>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n *)+\\n|$))","i").replace("comment",oo).replace("tag",Us).replace("attribute",/ +[a-zA-Z:_][\w.:-]*(?: *= *"[^"\n]*"| *= *'[^'\n]*'| *= *[^\s"'=<>`]+)?/).getRegex(),ul=B(so).replace("hr",is).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("|table","").replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",Us).getRegex(),ym=B(/^( {0,3}> ?(paragraph|[^\n]*)(?:\n|$))+/).replace("paragraph",ul).getRegex(),ao={blockquote:ym,code:dm,def:pm,fences:hm,heading:fm,hr:is,html:bm,lheading:cl,list:gm,newline:um,paragraph:ul,table:rr,text:mm},jo=B("^ *([^\\n ].*)\\n {0,3}((?:\\| *)?:?-+:? *(?:\\| *:?-+:? *)*(?:\\| *)?)(?:\\n((?:(?! *\\n|hr|heading|blockquote|code|fences|list|html).*(?:\\n|$))*)\\n*|$)").replace("hr",is).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("blockquote"," {0,3}>").replace("code"," {4}[^\\n]").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",Us).getRegex(),wm={...ao,table:jo,paragraph:B(so).replace("hr",is).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("table",jo).replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",Us).getRegex()},_m={...ao,html:B(`^ *(?:comment *(?:\\n|\\s*$)|<(tag)[\\s\\S]+?</\\1> *(?:\\n{2,}|\\s*$)|<tag(?:"[^"]*"|'[^']*'|\\s[^'"/>\\s]*)*?/?> *(?:\\n{2,}|\\s*$))`).replace("comment",oo).replace(/tag/g,"(?!(?:a|em|strong|small|s|cite|q|dfn|abbr|data|time|code|var|samp|kbd|sub|sup|i|b|u|mark|ruby|rt|rp|bdi|bdo|span|br|wbr|ins|del|img)\\b)\\w+(?!:|[^\\w\\s@]*@)\\b").getRegex(),def:/^ *\[([^\]]+)\]: *<?([^\s>]+)>?(?: +(["(][^\n]+[")]))? *(?:\n+|$)/,heading:/^(#{1,6})(.*)(?:\n+|$)/,fences:rr,lheading:/^(.+?)\n {0,3}(=+|-+) *(?:\n+|$)/,paragraph:B(so).replace("hr",is).replace("heading",` *#{1,6} *[^
]`).replace("lheading",cl).replace("|table","").replace("blockquote"," {0,3}>").replace("|fences","").replace("|list","").replace("|html","").replace("|tag","").getRegex()},dl=/^\\([!"#$%&'()*+,\-./:;<=>?@\[\]\\^_`{|}~])/,xm=/^(`+)([^`]|[^`][\s\S]*?[^`])\1(?!`)/,hl=/^( {2,}|\\)\n(?!\s*$)/,Em=/^(`+|[^`])(?:(?= {2,}\n)|[\s\S]*?(?:(?=[\\<!\[`*_]|\b_|$)|[^ ](?= {2,}\n)))/,os="\\p{P}\\p{S}",vm=B(/^((?![*_])[\spunctuation])/,"u").replace(/punctuation/g,os).getRegex(),Sm=/\[[^[\]]*?\]\([^\(\)]*?\)|`[^`]*?`|<[^<>]*?>/g,Im=B(/^(?:\*+(?:((?!\*)[punct])|[^\s*]))|^_+(?:((?!_)[punct])|([^\s_]))/,"u").replace(/punct/g,os).getRegex(),Om=B("^[^_*]*?__[^_*]*?\\*[^_*]*?(?=__)|[^*]+(?=[^*])|(?!\\*)[punct](\\*+)(?=[\\s]|$)|[^punct\\s](\\*+)(?!\\*)(?=[punct\\s]|$)|(?!\\*)[punct\\s](\\*+)(?=[^punct\\s])|[\\s](\\*+)(?!\\*)(?=[punct])|(?!\\*)[punct](\\*+)(?!\\*)(?=[punct])|[^punct\\s](\\*+)(?=[^punct\\s])","gu").replace(/punct/g,os).getRegex(),Am=B("^[^_*]*?\\*\\*[^_*]*?_[^_*]*?(?=\\*\\*)|[^_]+(?=[^_])|(?!_)[punct](_+)(?=[\\s]|$)|[^punct\\s](_+)(?!_)(?=[punct\\s]|$)|(?!_)[punct\\s](_+)(?=[^punct\\s])|[\\s](_+)(?!_)(?=[punct])|(?!_)[punct](_+)(?!_)(?=[punct])","gu").replace(/punct/g,os).getRegex(),km=B(/\\([punct])/,"gu").replace(/punct/g,os).getRegex(),Tm=B(/^<(scheme:[^\s\x00-\x1f<>]*|email)>/).replace("scheme",/[a-zA-Z][a-zA-Z0-9+.-]{1,31}/).replace("email",/[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+(@)[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)+(?![-_])/).getRegex(),Rm=B(oo).replace("(?:-->|$)","-->").getRegex(),Dm=B("^comment|^</[a-zA-Z][\\w:-]*\\s*>|^<[a-zA-Z][\\w-]*(?:attribute)*?\\s*/?>|^<\\?[\\s\\S]*?\\?>|^<![a-zA-Z]+\\s[\\s\\S]*?>|^<!\\[CDATA\\[[\\s\\S]*?\\]\\]>").replace("comment",Rm).replace("attribute",/\s+[a-zA-Z:_][\w.:-]*(?:\s*=\s*"[^"]*"|\s*=\s*'[^']*'|\s*=\s*[^\s"'=<>`]+)?/).getRegex(),Rs=/(?:\[(?:\\.|[^\[\]\\])*\]|\\.|`[^`]*`|[^\[\]\\`])*?/,Cm=B(/^!?\[(label)\]\(\s*(href)(?:\s+(title))?\s*\)/).replace("label",Rs).replace("href",/<(?:\\.|[^\n<>\\])+>|[^\s\x00-\x1f]*/).replace("title",/"(?:\\"?|[^"\\])*"|'(?:\\'?|[^'\\])*'|\((?:\\\)?|[^)\\])*\)/).getRegex(),fl=B(/^!?\[(label)\]\[(ref)\]/).replace("label",Rs).replace("ref",io).getRegex(),ml=B(/^!?\[(ref)\](?:\[\])?/).replace("ref",io).getRegex(),Nm=B("reflink|nolink(?!\\()","g").replace("reflink",fl).replace("nolink",ml).getRegex(),lo={_backpedal:rr,anyPunctuation:km,autolink:Tm,blockSkip:Sm,br:hl,code:xm,del:rr,emStrongLDelim:Im,emStrongRDelimAst:Om,emStrongRDelimUnd:Am,escape:dl,link:Cm,nolink:ml,punctuation:vm,reflink:fl,reflinkSearch:Nm,tag:Dm,text:Em,url:rr},Lm={...lo,link:B(/^!?\[(label)\]\((.*?)\)/).replace("label",Rs).getRegex(),reflink:B(/^!?\[(label)\]\s*\[([^\]]*)\]/).replace("label",Rs).getRegex()},Ci={...lo,escape:B(dl).replace("])","~|])").getRegex(),url:B(/^((?:ftp|https?):\/\/|www\.)(?:[a-zA-Z0-9\-]+\.?)+[^\s<]*|^email/,"i").replace("email",/[A-Za-z0-9._+-]+(@)[a-zA-Z0-9-_]+(?:\.[a-zA-Z0-9-_]*[a-zA-Z0-9])+(?![-_])/).getRegex(),_backpedal:/(?:[^?!.,:;*_'"~()&]+|\([^)]*\)|&(?![a-zA-Z0-9]+;$)|[?!.,:;*_'"~)]+(?!$))+/,del:/^(~~?)(?=[^\s~])([\s\S]*?[^\s~])\1(?=[^~]|$)/,text:/^([`~]+|[^`~])(?:(?= {2,}\n)|(?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)|[\s\S]*?(?:(?=[\\<!\[`*~_]|\b_|https?:\/\/|ftp:\/\/|www\.|$)|[^ ](?= {2,}\n)|[^a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-](?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)))/},Pm={...Ci,br:B(hl).replace("{2,}","*").getRegex(),text:B(Ci.text).replace("\\b_","\\b_| {2,}\\n").replace(/\{2,\}/g,"*").getRegex()},ms={normal:ao,gfm:wm,pedantic:_m},Yn={normal:lo,gfm:Ci,breaks:Pm,pedantic:Lm};class je{constructor(e){p(this,"tokens");p(this,"options");p(this,"state");p(this,"tokenizer");p(this,"inlineQueue");this.tokens=[],this.tokens.links=Object.create(null),this.options=e||en,this.options.tokenizer=this.options.tokenizer||new Ts,this.tokenizer=this.options.tokenizer,this.tokenizer.options=this.options,this.tokenizer.lexer=this,this.inlineQueue=[],this.state={inLink:!1,inRawBlock:!1,top:!0};const t={block:ms.normal,inline:Yn.normal};this.options.pedantic?(t.block=ms.pedantic,t.inline=Yn.pedantic):this.options.gfm&&(t.block=ms.gfm,this.options.breaks?t.inline=Yn.breaks:t.inline=Yn.gfm),this.tokenizer.rules=t}static get rules(){return{block:ms,inline:Yn}}static lex(e,t){return new je(t).lex(e)}static lexInline(e,t){return new je(t).inlineTokens(e)}lex(e){e=e.replace(/\r\n|\r/g,`
`),this.blockTokens(e,this.tokens);for(let t=0;t<this.inlineQueue.length;t++){const r=this.inlineQueue[t];this.inlineTokens(r.src,r.tokens)}return this.inlineQueue=[],this.tokens}blockTokens(e,t=[]){this.options.pedantic?e=e.replace(/\t/g,"    ").replace(/^ +$/gm,""):e=e.replace(/^( *)(\t+)/gm,(a,l,c)=>l+"    ".repeat(c.length));let r,i,s,o;for(;e;)if(!(this.options.extensions&&this.options.extensions.block&&this.options.extensions.block.some(a=>(r=a.call({lexer:this},e,t))?(e=e.substring(r.raw.length),t.push(r),!0):!1))){if(r=this.tokenizer.space(e)){e=e.substring(r.raw.length),r.raw.length===1&&t.length>0?t[t.length-1].raw+=`
`:t.push(r);continue}if(r=this.tokenizer.code(e)){e=e.substring(r.raw.length),i=t[t.length-1],i&&(i.type==="paragraph"||i.type==="text")?(i.raw+=`
`+r.raw,i.text+=`
`+r.text,this.inlineQueue[this.inlineQueue.length-1].src=i.text):t.push(r);continue}if(r=this.tokenizer.fences(e)){e=e.substring(r.raw.length),t.push(r);continue}if(r=this.tokenizer.heading(e)){e=e.substring(r.raw.length),t.push(r);continue}if(r=this.tokenizer.hr(e)){e=e.substring(r.raw.length),t.push(r);continue}if(r=this.tokenizer.blockquote(e)){e=e.substring(r.raw.length),t.push(r);continue}if(r=this.tokenizer.list(e)){e=e.substring(r.raw.length),t.push(r);continue}if(r=this.tokenizer.html(e)){e=e.substring(r.raw.length),t.push(r);continue}if(r=this.tokenizer.def(e)){e=e.substring(r.raw.length),i=t[t.length-1],i&&(i.type==="paragraph"||i.type==="text")?(i.raw+=`
`+r.raw,i.text+=`
`+r.raw,this.inlineQueue[this.inlineQueue.length-1].src=i.text):this.tokens.links[r.tag]||(this.tokens.links[r.tag]={href:r.href,title:r.title});continue}if(r=this.tokenizer.table(e)){e=e.substring(r.raw.length),t.push(r);continue}if(r=this.tokenizer.lheading(e)){e=e.substring(r.raw.length),t.push(r);continue}if(s=e,this.options.extensions&&this.options.extensions.startBlock){let a=1/0;const l=e.slice(1);let c;this.options.extensions.startBlock.forEach(d=>{c=d.call({lexer:this},l),typeof c=="number"&&c>=0&&(a=Math.min(a,c))}),a<1/0&&a>=0&&(s=e.substring(0,a+1))}if(this.state.top&&(r=this.tokenizer.paragraph(s))){i=t[t.length-1],o&&i.type==="paragraph"?(i.raw+=`
`+r.raw,i.text+=`
`+r.text,this.inlineQueue.pop(),this.inlineQueue[this.inlineQueue.length-1].src=i.text):t.push(r),o=s.length!==e.length,e=e.substring(r.raw.length);continue}if(r=this.tokenizer.text(e)){e=e.substring(r.raw.length),i=t[t.length-1],i&&i.type==="text"?(i.raw+=`
`+r.raw,i.text+=`
`+r.text,this.inlineQueue.pop(),this.inlineQueue[this.inlineQueue.length-1].src=i.text):t.push(r);continue}if(e){const a="Infinite loop on byte: "+e.charCodeAt(0);if(this.options.silent){console.error(a);break}else throw new Error(a)}}return this.state.top=!0,t}inline(e,t=[]){return this.inlineQueue.push({src:e,tokens:t}),t}inlineTokens(e,t=[]){let r,i,s,o=e,a,l,c;if(this.tokens.links){const d=Object.keys(this.tokens.links);if(d.length>0)for(;(a=this.tokenizer.rules.inline.reflinkSearch.exec(o))!=null;)d.includes(a[0].slice(a[0].lastIndexOf("[")+1,-1))&&(o=o.slice(0,a.index)+"["+"a".repeat(a[0].length-2)+"]"+o.slice(this.tokenizer.rules.inline.reflinkSearch.lastIndex))}for(;(a=this.tokenizer.rules.inline.blockSkip.exec(o))!=null;)o=o.slice(0,a.index)+"["+"a".repeat(a[0].length-2)+"]"+o.slice(this.tokenizer.rules.inline.blockSkip.lastIndex);for(;(a=this.tokenizer.rules.inline.anyPunctuation.exec(o))!=null;)o=o.slice(0,a.index)+"++"+o.slice(this.tokenizer.rules.inline.anyPunctuation.lastIndex);for(;e;)if(l||(c=""),l=!1,!(this.options.extensions&&this.options.extensions.inline&&this.options.extensions.inline.some(d=>(r=d.call({lexer:this},e,t))?(e=e.substring(r.raw.length),t.push(r),!0):!1))){if(r=this.tokenizer.escape(e)){e=e.substring(r.raw.length),t.push(r);continue}if(r=this.tokenizer.tag(e)){e=e.substring(r.raw.length),i=t[t.length-1],i&&r.type==="text"&&i.type==="text"?(i.raw+=r.raw,i.text+=r.text):t.push(r);continue}if(r=this.tokenizer.link(e)){e=e.substring(r.raw.length),t.push(r);continue}if(r=this.tokenizer.reflink(e,this.tokens.links)){e=e.substring(r.raw.length),i=t[t.length-1],i&&r.type==="text"&&i.type==="text"?(i.raw+=r.raw,i.text+=r.text):t.push(r);continue}if(r=this.tokenizer.emStrong(e,o,c)){e=e.substring(r.raw.length),t.push(r);continue}if(r=this.tokenizer.codespan(e)){e=e.substring(r.raw.length),t.push(r);continue}if(r=this.tokenizer.br(e)){e=e.substring(r.raw.length),t.push(r);continue}if(r=this.tokenizer.del(e)){e=e.substring(r.raw.length),t.push(r);continue}if(r=this.tokenizer.autolink(e)){e=e.substring(r.raw.length),t.push(r);continue}if(!this.state.inLink&&(r=this.tokenizer.url(e))){e=e.substring(r.raw.length),t.push(r);continue}if(s=e,this.options.extensions&&this.options.extensions.startInline){let d=1/0;const f=e.slice(1);let h;this.options.extensions.startInline.forEach(m=>{h=m.call({lexer:this},f),typeof h=="number"&&h>=0&&(d=Math.min(d,h))}),d<1/0&&d>=0&&(s=e.substring(0,d+1))}if(r=this.tokenizer.inlineText(s)){e=e.substring(r.raw.length),r.raw.slice(-1)!=="_"&&(c=r.raw.slice(-1)),l=!0,i=t[t.length-1],i&&i.type==="text"?(i.raw+=r.raw,i.text+=r.text):t.push(r);continue}if(e){const d="Infinite loop on byte: "+e.charCodeAt(0);if(this.options.silent){console.error(d);break}else throw new Error(d)}}return t}}class Ds{constructor(e){p(this,"options");this.options=e||en}code(e,t,r){var s;const i=(s=(t||"").match(/^\S*/))==null?void 0:s[0];return e=e.replace(/\n$/,"")+`
`,i?'<pre><code class="language-'+Oe(i)+'">'+(r?e:Oe(e,!0))+`</code></pre>
`:"<pre><code>"+(r?e:Oe(e,!0))+`</code></pre>
`}blockquote(e){return`<blockquote>
${e}</blockquote>
`}html(e,t){return e}heading(e,t,r){return`<h${t}>${e}</h${t}>
`}hr(){return`<hr>
`}list(e,t,r){const i=t?"ol":"ul",s=t&&r!==1?' start="'+r+'"':"";return"<"+i+s+`>
`+e+"</"+i+`>
`}listitem(e,t,r){return`<li>${e}</li>
`}checkbox(e){return"<input "+(e?'checked="" ':"")+'disabled="" type="checkbox">'}paragraph(e){return`<p>${e}</p>
`}table(e,t){return t&&(t=`<tbody>${t}</tbody>`),`<table>
<thead>
`+e+`</thead>
`+t+`</table>
`}tablerow(e){return`<tr>
${e}</tr>
`}tablecell(e,t){const r=t.header?"th":"td";return(t.align?`<${r} align="${t.align}">`:`<${r}>`)+e+`</${r}>
`}strong(e){return`<strong>${e}</strong>`}em(e){return`<em>${e}</em>`}codespan(e){return`<code>${e}</code>`}br(){return"<br>"}del(e){return`<del>${e}</del>`}link(e,t,r){const i=zo(e);if(i===null)return r;e=i;let s='<a href="'+e+'"';return t&&(s+=' title="'+t+'"'),s+=">"+r+"</a>",s}image(e,t,r){const i=zo(e);if(i===null)return r;e=i;let s=`<img src="${e}" alt="${r}"`;return t&&(s+=` title="${t}"`),s+=">",s}text(e){return e}}class co{strong(e){return e}em(e){return e}codespan(e){return e}del(e){return e}html(e){return e}text(e){return e}link(e,t,r){return""+r}image(e,t,r){return""+r}br(){return""}}class Ue{constructor(e){p(this,"options");p(this,"renderer");p(this,"textRenderer");this.options=e||en,this.options.renderer=this.options.renderer||new Ds,this.renderer=this.options.renderer,this.renderer.options=this.options,this.textRenderer=new co}static parse(e,t){return new Ue(t).parse(e)}static parseInline(e,t){return new Ue(t).parseInline(e)}parse(e,t=!0){let r="";for(let i=0;i<e.length;i++){const s=e[i];if(this.options.extensions&&this.options.extensions.renderers&&this.options.extensions.renderers[s.type]){const o=s,a=this.options.extensions.renderers[o.type].call({parser:this},o);if(a!==!1||!["space","hr","heading","code","table","blockquote","list","html","paragraph","text"].includes(o.type)){r+=a||"";continue}}switch(s.type){case"space":continue;case"hr":{r+=this.renderer.hr();continue}case"heading":{const o=s;r+=this.renderer.heading(this.parseInline(o.tokens),o.depth,om(this.parseInline(o.tokens,this.textRenderer)));continue}case"code":{const o=s;r+=this.renderer.code(o.text,o.lang,!!o.escaped);continue}case"table":{const o=s;let a="",l="";for(let d=0;d<o.header.length;d++)l+=this.renderer.tablecell(this.parseInline(o.header[d].tokens),{header:!0,align:o.align[d]});a+=this.renderer.tablerow(l);let c="";for(let d=0;d<o.rows.length;d++){const f=o.rows[d];l="";for(let h=0;h<f.length;h++)l+=this.renderer.tablecell(this.parseInline(f[h].tokens),{header:!1,align:o.align[h]});c+=this.renderer.tablerow(l)}r+=this.renderer.table(a,c);continue}case"blockquote":{const o=s,a=this.parse(o.tokens);r+=this.renderer.blockquote(a);continue}case"list":{const o=s,a=o.ordered,l=o.start,c=o.loose;let d="";for(let f=0;f<o.items.length;f++){const h=o.items[f],m=h.checked,I=h.task;let b="";if(h.task){const A=this.renderer.checkbox(!!m);c?h.tokens.length>0&&h.tokens[0].type==="paragraph"?(h.tokens[0].text=A+" "+h.tokens[0].text,h.tokens[0].tokens&&h.tokens[0].tokens.length>0&&h.tokens[0].tokens[0].type==="text"&&(h.tokens[0].tokens[0].text=A+" "+h.tokens[0].tokens[0].text)):h.tokens.unshift({type:"text",text:A+" "}):b+=A+" "}b+=this.parse(h.tokens,c),d+=this.renderer.listitem(b,I,!!m)}r+=this.renderer.list(d,a,l);continue}case"html":{const o=s;r+=this.renderer.html(o.text,o.block);continue}case"paragraph":{const o=s;r+=this.renderer.paragraph(this.parseInline(o.tokens));continue}case"text":{let o=s,a=o.tokens?this.parseInline(o.tokens):o.text;for(;i+1<e.length&&e[i+1].type==="text";)o=e[++i],a+=`
`+(o.tokens?this.parseInline(o.tokens):o.text);r+=t?this.renderer.paragraph(a):a;continue}default:{const o='Token with "'+s.type+'" type was not found.';if(this.options.silent)return console.error(o),"";throw new Error(o)}}}return r}parseInline(e,t){t=t||this.renderer;let r="";for(let i=0;i<e.length;i++){const s=e[i];if(this.options.extensions&&this.options.extensions.renderers&&this.options.extensions.renderers[s.type]){const o=this.options.extensions.renderers[s.type].call({parser:this},s);if(o!==!1||!["escape","html","link","image","strong","em","codespan","br","del","text"].includes(s.type)){r+=o||"";continue}}switch(s.type){case"escape":{const o=s;r+=t.text(o.text);break}case"html":{const o=s;r+=t.html(o.text);break}case"link":{const o=s;r+=t.link(o.href,o.title,this.parseInline(o.tokens,t));break}case"image":{const o=s;r+=t.image(o.href,o.title,o.text);break}case"strong":{const o=s;r+=t.strong(this.parseInline(o.tokens,t));break}case"em":{const o=s;r+=t.em(this.parseInline(o.tokens,t));break}case"codespan":{const o=s;r+=t.codespan(o.text);break}case"br":{r+=t.br();break}case"del":{const o=s;r+=t.del(this.parseInline(o.tokens,t));break}case"text":{const o=s;r+=t.text(o.text);break}default:{const o='Token with "'+s.type+'" type was not found.';if(this.options.silent)return console.error(o),"";throw new Error(o)}}}return r}}class sr{constructor(e){p(this,"options");this.options=e||en}preprocess(e){return e}postprocess(e){return e}processAllTokens(e){return e}}p(sr,"passThroughHooks",new Set(["preprocess","postprocess","processAllTokens"]));var Yr,Ni,$s,pl;class Mm{constructor(...e){g(this,Yr);g(this,$s);p(this,"defaults",ro());p(this,"options",this.setOptions);p(this,"parse",ls(this,Yr,Ni).call(this,je.lex,Ue.parse));p(this,"parseInline",ls(this,Yr,Ni).call(this,je.lexInline,Ue.parseInline));p(this,"Parser",Ue);p(this,"Renderer",Ds);p(this,"TextRenderer",co);p(this,"Lexer",je);p(this,"Tokenizer",Ts);p(this,"Hooks",sr);this.use(...e)}walkTokens(e,t){var i,s;let r=[];for(const o of e)switch(r=r.concat(t.call(this,o)),o.type){case"table":{const a=o;for(const l of a.header)r=r.concat(this.walkTokens(l.tokens,t));for(const l of a.rows)for(const c of l)r=r.concat(this.walkTokens(c.tokens,t));break}case"list":{const a=o;r=r.concat(this.walkTokens(a.items,t));break}default:{const a=o;(s=(i=this.defaults.extensions)==null?void 0:i.childTokens)!=null&&s[a.type]?this.defaults.extensions.childTokens[a.type].forEach(l=>{const c=a[l].flat(1/0);r=r.concat(this.walkTokens(c,t))}):a.tokens&&(r=r.concat(this.walkTokens(a.tokens,t)))}}return r}use(...e){const t=this.defaults.extensions||{renderers:{},childTokens:{}};return e.forEach(r=>{const i={...r};if(i.async=this.defaults.async||i.async||!1,r.extensions&&(r.extensions.forEach(s=>{if(!s.name)throw new Error("extension name required");if("renderer"in s){const o=t.renderers[s.name];o?t.renderers[s.name]=function(...a){let l=s.renderer.apply(this,a);return l===!1&&(l=o.apply(this,a)),l}:t.renderers[s.name]=s.renderer}if("tokenizer"in s){if(!s.level||s.level!=="block"&&s.level!=="inline")throw new Error("extension level must be 'block' or 'inline'");const o=t[s.level];o?o.unshift(s.tokenizer):t[s.level]=[s.tokenizer],s.start&&(s.level==="block"?t.startBlock?t.startBlock.push(s.start):t.startBlock=[s.start]:s.level==="inline"&&(t.startInline?t.startInline.push(s.start):t.startInline=[s.start]))}"childTokens"in s&&s.childTokens&&(t.childTokens[s.name]=s.childTokens)}),i.extensions=t),r.renderer){const s=this.defaults.renderer||new Ds(this.defaults);for(const o in r.renderer){if(!(o in s))throw new Error(`renderer '${o}' does not exist`);if(o==="options")continue;const a=o,l=r.renderer[a],c=s[a];s[a]=(...d)=>{let f=l.apply(s,d);return f===!1&&(f=c.apply(s,d)),f||""}}i.renderer=s}if(r.tokenizer){const s=this.defaults.tokenizer||new Ts(this.defaults);for(const o in r.tokenizer){if(!(o in s))throw new Error(`tokenizer '${o}' does not exist`);if(["options","rules","lexer"].includes(o))continue;const a=o,l=r.tokenizer[a],c=s[a];s[a]=(...d)=>{let f=l.apply(s,d);return f===!1&&(f=c.apply(s,d)),f}}i.tokenizer=s}if(r.hooks){const s=this.defaults.hooks||new sr;for(const o in r.hooks){if(!(o in s))throw new Error(`hook '${o}' does not exist`);if(o==="options")continue;const a=o,l=r.hooks[a],c=s[a];sr.passThroughHooks.has(o)?s[a]=d=>{if(this.defaults.async)return Promise.resolve(l.call(s,d)).then(h=>c.call(s,h));const f=l.call(s,d);return c.call(s,f)}:s[a]=(...d)=>{let f=l.apply(s,d);return f===!1&&(f=c.apply(s,d)),f}}i.hooks=s}if(r.walkTokens){const s=this.defaults.walkTokens,o=r.walkTokens;i.walkTokens=function(a){let l=[];return l.push(o.call(this,a)),s&&(l=l.concat(s.call(this,a))),l}}this.defaults={...this.defaults,...i}}),this}setOptions(e){return this.defaults={...this.defaults,...e},this}lexer(e,t){return je.lex(e,t??this.defaults)}parser(e,t){return Ue.parse(e,t??this.defaults)}}Yr=new WeakSet,Ni=function(e,t){return(r,i)=>{const s={...i},o={...this.defaults,...s};this.defaults.async===!0&&s.async===!1&&(o.silent||console.warn("marked(): The async option was set to true by an extension. The async: false option sent to parse will be ignored."),o.async=!0);const a=ls(this,$s,pl).call(this,!!o.silent,!!o.async);if(typeof r>"u"||r===null)return a(new Error("marked(): input parameter is undefined or null"));if(typeof r!="string")return a(new Error("marked(): input parameter is of type "+Object.prototype.toString.call(r)+", string expected"));if(o.hooks&&(o.hooks.options=o),o.async)return Promise.resolve(o.hooks?o.hooks.preprocess(r):r).then(l=>e(l,o)).then(l=>o.hooks?o.hooks.processAllTokens(l):l).then(l=>o.walkTokens?Promise.all(this.walkTokens(l,o.walkTokens)).then(()=>l):l).then(l=>t(l,o)).then(l=>o.hooks?o.hooks.postprocess(l):l).catch(a);try{o.hooks&&(r=o.hooks.preprocess(r));let l=e(r,o);o.hooks&&(l=o.hooks.processAllTokens(l)),o.walkTokens&&this.walkTokens(l,o.walkTokens);let c=t(l,o);return o.hooks&&(c=o.hooks.postprocess(c)),c}catch(l){return a(l)}}},$s=new WeakSet,pl=function(e,t){return r=>{if(r.message+=`
Please report this to https://github.com/markedjs/marked.`,e){const i="<p>An error occurred:</p><pre>"+Oe(r.message+"",!0)+"</pre>";return t?Promise.resolve(i):i}if(t)return Promise.reject(r);throw r}};const Kt=new Mm;function L(n,e){return Kt.parse(n,e)}L.options=L.setOptions=function(n){return Kt.setOptions(n),L.defaults=Kt.defaults,il(L.defaults),L};L.getDefaults=ro;L.defaults=en;L.use=function(...n){return Kt.use(...n),L.defaults=Kt.defaults,il(L.defaults),L};L.walkTokens=function(n,e){return Kt.walkTokens(n,e)};L.parseInline=Kt.parseInline;L.Parser=Ue;L.parser=Ue.parse;L.Renderer=Ds;L.TextRenderer=co;L.Lexer=je;L.lexer=je.lex;L.Tokenizer=Ts;L.Hooks=sr;L.parse=L;L.options;L.setOptions;L.use;L.walkTokens;L.parseInline;Ue.parse;je.lex;const $m=["innerHTML"],Wm={__name:"Markdown",props:{content:{type:String,required:!1,default:"# Headline  <p>Hello World</p>"},fontFamily:{type:String,required:!1,default:null}},setup(n){const e=new L.Renderer;e.link=function(){return L.Renderer.prototype.link.apply(this,arguments).replace("<a","<a target='_blank'")},L.setOptions({renderer:e}),L.use({mangle:!1});const t=n,r=Qo(()=>L(t.content));return(i,s)=>(x(),T("div",{class:"wb-env-atom-markdown",innerHTML:r.value},null,8,$m))}},gl=V(Wm,[["__scopeId","data-v-c3080c9d"]]),Fm={components:{WbMarkdown:gl},props:{...dt,type:{type:String,default:null},content:{type:[String,Array],default:null}},emits:[...ht],setup(n,e){return ut(n,e)},data(){return{lines:[]}},mounted(){this.type==="basic"&&window.requestAnimationFrame(()=>{this.lines=[],this.core.modules.parser.parseBasic(this.content,async(n,e)=>{const t=await this.core.executeCommand(n,e);return e.message&&this.lines.push(X(e.message)),t})})}},zm={class:"wb-module-files-preview"},Bm={key:0,class:"basic"},Vm=["innerHTML"],jm=["src"];function Um(n,e,t,r,i,s){const o=k("wb-markdown");return x(),T("div",zm,[t.type==="basic"?(x(),T("ul",Bm,[(x(!0),T(vt,null,St(i.lines,(a,l)=>(x(),T("li",{key:l},Ce(a),1))),128))])):W("",!0),t.type==="markdown"?(x(),z(o,{key:1,content:t.content},null,8,["content"])):W("",!0),t.type==="html"?(x(),T("div",{key:2,innerHTML:t.content},null,8,Vm)):W("",!0),t.type==="image"?(x(),T("img",{key:3,src:t.content},null,8,jm)):W("",!0)])}const Gm=V(Fm,[["render",Um],["__scopeId","data-v-13e34558"]]),Hm={HAS_WINDOW_OUTPUT:"has_window_output"};async function Ym(n,e,t){const r=await n.executeCommand(`exist "${e}"`);let i=!1;r&&(i=await n.executeCommand('openDialog "File exist, overwrite?" --confirm'));const s=[`makefile "${e}"`];return t&&s.push(`--data="${t}"`),i?s.push("--override"):s.push("--ignore"),n.executeCommand(s.join(" "))}const Xm=({module:n,core:e})=>{const t=e.modules.windows,{fileSystem:r}=n;return[{name:"openPreview",args:[new y({index:0,name:"path",description:"Path to the file"}),new y({name:"maximized",description:"If set, window is maximized."})],async action({path:i,maximized:s}){const o=await r.get(i),{type:a,content:l,openMaximized:c}=o.data;a==="basic"&&!o.data[Hm.HAS_WINDOW_OUTPUT]?await e.modules.parser.parseBasic(l,async(d,f)=>await e.executeCommand(d,f)):t.addWindow({title:o.name,component:Gm,componentData:{type:a,content:l},options:{scaleX:!0,scaleY:!0,scrollX:!0,scrollY:!0},layout:{size:S(420,360)}},{full:c||s||!1})}},{name:"saveFileDialog",args:[new y({index:0,name:"data",description:"File Content"}),new y({index:1,name:"id",description:"File Id"}),new y({index:2,name:"extension",description:"File Extension"})],async action({data:i,id:s,extension:o}){const a=t.addWindow({title:"Save File",component:Zf,componentData:{fsItem:M(r.root),id:s},options:{scaleX:!1,scaleY:!1,scrollX:!1,scrollY:!1}}),{value:l}=await a.awaitClose();if(l){const c=vs(l,o),d=await Ym(e,c,i);if(d)return M(Zo(d))}}},{name:"openFileDialog",args:[],async action(){await t.addWindow({title:"Open File",component:tm,componentData:{fsItem:M(r.root)},options:{scaleX:!1,scaleY:!1,scrollX:!1,scrollY:!1}}).awaitClose()}},{name:"fileinfo",description:"Get info from File or Directory",args:[new y({index:0,name:"path",description:"Path to the file"}),new y({index:1,name:"name",description:"Name from the Info"}),new y({index:2,name:["list","ls"],flag:!0,description:"List all Infos"})],async action({path:i,name:s,list:o},a){const l=await r.itemMeta(i,s,o);if(Array.isArray(l)){const c=new Ht;c.addColumn({value:"Name",align:"left",minWidth:20}),c.addColumn({value:"Value",align:"left",minWidth:20}),c.addRow(l.map(d=>{let f=d.value;return Array.isArray(f)&&(f=f.join(" ")),[d.name,f]})),a.message([c])}return l}},{name:["info","i"],args:[new y({index:0,name:"path",description:"Path to the file"})],async action({path:i},s){let o=r.root;i&&(o=await r.get(i)),o instanceof U||(o=o.parent);let a=await o.getItems();const l=new Ht;l.addColumn([{value:"Unit",align:"left",minWidth:8},{value:"Size",align:"right",minWidth:6},{value:"Used",align:"right",minWidth:6},{value:"Free",align:"right",minWidth:6},{value:"Full",minWidth:4},{value:"Errs",align:"center",minWidth:4},{value:"Status",align:"center",minWidth:10},{value:"Name",align:"right",minWidth:14}]),a=Array.from(a.values()).filter(d=>d instanceof lt),l.addRow(a.map(d=>{let f=0;return(d.size>0||d.maxSize>0)&&(f=parseInt(d.size/d.maxSize*100)),[`${d.id}:`,er(d.maxSize),er(d.size),er(d.maxSize-d.size),`${f}%`,"0",d.locked?"Read":"Read/Write",`${d.name||""}`]}));const c=["","Mounted disks:",l,"","Volumes available:"];a.forEach(d=>{c.push(`${d.name}: [Mounted]`)}),c.push(""),s.message(c)}},{name:["list","ls"],args:[new y({index:0,name:"path",description:"Path to the file"}),new y({name:"dir-size",flag:!0,description:"Show Directory Size."})],async action({path:i,dirSize:s},o){let a=r.currentItem;i&&(a=await r.get(i));const l=Array.from((await a.getItems()).values()),c=new Ht;c.addColumn({value:"Name",align:"left",minWidth:13}),c.addColumn({value:"Size",align:"right",minWidth:8}),c.addColumn({value:"Access",align:"center",minWidth:12}),c.addColumn({value:"Date / Time",align:"center",minWidth:18}),c.addRow(l.reduce((h,m)=>{let I;m instanceof U&&!s?I="DIR":I=xi(er(m.size),8,!0,"0");const b=m.isLocked()?"Read":"Read/Write";return h.push([`${m.id}:`,I,b,m.createdDate?Ei("D-mm-y H:I:S",m.createdDate):""]),h},[]));const d=l.reduce((h,m)=>(m instanceof It&&h++,h),0),f=l.reduce((h,m)=>(h+=m.size,h),0);return o.message([c,`${l.length} files - ${d} directories - ${f} blocks used`]),Promise.resolve()}}]},qm={components:{WbForm:zn,WbButton:kt,WbButtonWrapper:Tt,WbFormFieldTextbox:ss,WbFormFieldDropdown:Qi,WbFormFieldCheckboxGroup:Ja},props:{...dt,fsItem:{type:Object,default(){return null}},model:{type:Object,default(){return{actions:{save(){}},id:null,name:null,symbol:null,visible:!1}}}},emits:[...ht,"close"],setup(n,e){return ut(n,e)},data(){const n=this.fsItem.locked;return{cancelLabel:"Cancel",saveLabel:"Save",fields:{id:{disabled:n,label:"Id",name:"id"},name:{disabled:n,label:"Name",name:"name"},checkboxes:{disabled:n,label:"Others",name:null,items:[{label:"Symbol Visible",name:w.VISIBLE},{label:"Ignore Symbol Rearrange ",name:w.IGNORE_SYMBOL_REARRANGE}]},windowSettings:{disabled:n,label:"Window Settings",name:null,items:[{label:"Has Scale ?",name:w.WINDOW_SCALE},{label:"Has Scroll-X ?",name:w.WINDOW_SCROLL_X},{label:"Has Scroll-Y ?",name:w.WINDOW_SCROLL_Y},{label:"Is Full-Size ?",name:w.WINDOW_FULL_SIZE},{label:"Sort Symbols (Directory)",name:w.WINDOW_SYMBOL_REARRANGE},{label:"Has Sidebar?",name:w.WINDOW_SIDEBAR}]},symbol:{disabled:n,label:"Symbol",name:"symbol",options:Object.keys(_).map(e=>({title:na(e),value:_[String(e)]}))}}}},methods:{onClickCancel(){this.$emit("close")},async onSubmit(){this.locked||await this.model.actions.save(this.model,this.fsItem),this.$emit("close")}}},Km={class:"wb-module-files-edit"},Zm={class:"cols"},Qm={class:"col-2"},Jm={class:"col-2"};function ep(n,e,t,r,i,s){const o=k("wb-form-field-textbox"),a=k("wb-form-field-dropdown"),l=k("wb-form-field-checkbox-group"),c=k("wb-button"),d=k("wb-button-wrapper"),f=k("wb-form");return x(),T("div",Km,[R(f,{class:"form",onSubmit:s.onSubmit},{default:G(()=>[E("div",null,[R(o,F(i.fields.id,{model:t.model}),null,16,["model"]),R(o,F(i.fields.name,{model:t.model}),null,16,["model"]),R(a,F(i.fields.symbol,{model:t.model}),null,16,["model"]),E("div",Zm,[E("div",Qm,[R(l,F(i.fields.checkboxes,{model:t.model}),null,16,["model"])]),E("div",Jm,[R(l,F(i.fields.windowSettings,{model:t.model}),null,16,["model"])])])]),R(d,{align:"outer",full:""},{default:G(()=>[i.cancelLabel?(x(),z(c,{key:0,"style-type":"secondary",label:i.cancelLabel,onClick:s.onClickCancel},null,8,["label","onClick"])):W("",!0),i.saveLabel?(x(),z(c,{key:1,"style-type":"primary",label:i.saveLabel,type:"submit"},null,8,["label"])):W("",!0)]),_:1})]),_:1},8,["onSubmit"])])}const tp=V(qm,[["render",ep],["__scopeId","data-v-df72514a"]]),np={components:{WbForm:zn,WbButton:kt,WbButtonWrapper:Tt,WbFormFieldTextbox:ss,WbFormFieldDropdown:Qi},props:{...dt,fsItem:{type:Object,default(){return null}},model:{type:Object,default(){return{actions:{save:()=>{}},name:null,url:null,symbol:null}}}},emits:[...ht,"close"],setup(n,e){return ut(n,e)},data(){const n=(this.fsItem||{}).locked;return{cancelLabel:"Cancel",saveLabel:"Save",fields:{name:{disabled:n,placeholder:"Name",label:"Name",name:"name"},url:{disabled:n,placeholder:"http://…",label:"Url",name:"url"},symbol:{disabled:n,label:"Symbol",name:"symbol",options:Object.keys(_).map(e=>({title:na(e),value:_[String(e)]}))}}}},computed:{disabledSave(){return!this.model.name||!this.model.url||!this.model.symbol}},methods:{onClickCancel(){this.$emit("close")},async onSubmit(){await this.model.actions.save(this.model,this.fsItem)&&this.$emit("close")}}},rp={class:"wb-module-files-web-link"};function sp(n,e,t,r,i,s){const o=k("wb-form-field-textbox"),a=k("wb-form-field-dropdown"),l=k("wb-button"),c=k("wb-button-wrapper"),d=k("wb-form");return x(),T("div",rp,[R(d,{onSubmit:s.onSubmit},{default:G(()=>[R(o,F(i.fields.name,{model:t.model}),null,16,["model"]),R(o,F(i.fields.url,{model:t.model,type:"url"}),null,16,["model"]),R(a,F(i.fields.symbol,{model:t.model}),null,16,["model"]),R(c,{align:"outer",full:""},{default:G(()=>[i.cancelLabel?(x(),z(l,{key:0,"style-type":"secondary",label:i.cancelLabel,onClick:s.onClickCancel},null,8,["label","onClick"])):W("",!0),i.saveLabel?(x(),z(l,{key:1,"style-type":"primary",label:i.saveLabel,type:"submit",disabled:s.disabledSave},null,8,["label","disabled"])):W("",!0)]),_:1})]),_:1},8,["onSubmit"])])}const Uo=V(np,[["render",sp],["__scopeId","data-v-5a95c505"]]),ip={components:{},props:{...dt,fsItem:{type:Object,default(){return null}}},emits:[...ht],setup(n,e){return ut(n,e)},computed:{meta(){return Array.from(this.fsItem.meta).map(([n,e])=>{if(typeof e=="object")try{e=JSON.stringify(e)}catch(t){console.error(t)}return{title:n,value:e}})},items(){return[{title:"Id",value:this.fsItem.id},{title:"Name",value:this.fsItem.name},{title:"Type",value:this.fsItem.constructor.NAME},{title:"Path",value:this.fsItem.getPath()},{title:"Size",value:er(this.fsItem.size)},{title:"Locked",value:this.fsItem.locked?"Yes":"No"},{title:"Created Date",value:`<nobr>${Ei("H:I:S D.M.Y",this.fsItem.createdDate)}</nobr>`},{title:"Modified Date",value:`<nobr>${Ei("H:I:S D.M.Y",this.fsItem.editedDate)}</nobr>`}]}}},op=n=>(Pi("data-v-171c9833"),n=n(),Mi(),n),ap={class:"wb-module-files-info"},lp=["innerHTML"],cp=op(()=>E("legend",null,"Meta:",-1)),up=["innerHTML"];function dp(n,e,t,r,i,s){return x(),T("div",ap,[E("table",null,[(x(!0),T(vt,null,St(s.items,({title:o,value:a},l)=>(x(),T("tr",{key:l},[E("td",null,Ce(o)+":",1),E("td",{innerHTML:a},null,8,lp)]))),128))]),E("fieldset",null,[cp,E("table",null,[(x(!0),T(vt,null,St(s.meta,({title:o,value:a},l)=>(x(),T("tr",{key:l},[E("td",null,Ce(o)+":",1),E("td",{innerHTML:a},null,8,up)]))),128))])])])}const hp=V(ip,[["render",dp],["__scopeId","data-v-171c9833"]]),fp=({core:n})=>{const{windows:e,symbols:t}=n.modules,r=Ne({open:{disabled:!1},edit:{disabled:!1},duplicate:{disabled:!1},container:{disabled:!1},emptyTrashcan:{disabled:!1},discard:{disabled:!1},info:{disabled:!1},webLink:{disabled:!1},webLinkNew:{disabled:!1},webLinkEdit:{disabled:!1}});function i(){const f=t.getSelectedItems(),h=t.getPrimaryWrapper();r.info.disabled=f.length<1,r.open.disabled=f.length<1,r.edit.disabled=f.length<1||f.find(m=>m.locked||m instanceof Re),r.duplicate.disabled=f.length<1||f.find(({fsItem:m})=>m.locked||m instanceof Re||m instanceof lt),r.container.disabled=!r.open.disabled||h&&h.fsItem&&(h.fsItem instanceof eo||h.fsItem.locked)||!h,r.webLinkEdit.disabled=f.length<1||f.find(m=>!m.fsItem.meta.get(w.WEB_URL)),r.webLinkNew.disabled=r.container.disabled,r.webLink.disabled=r.webLinkNew.disabled&&r.webLinkEdit.disabled,r.emptyTrashcan.disabled=f.length<1||f.find(m=>!(m.fsItem instanceof Re)),r.discard.disabled=f.length<1||f.find(({fsItem:m})=>m.locked||m instanceof Re||m instanceof lt)}return t.events.subscribe(()=>i()),i(),[{order:1,title:"File",items:[{title:"Open",options:r.open,action:s},{title:"Edit",options:r.edit,action:c},{type:ee.SEPARATOR},{title:"Web Link",options:r.webLink,items:[{title:"New",options:r.webLinkNew,action:a},{title:"Edit",options:r.webLinkEdit,action:l}]},{type:ee.SEPARATOR},{title:"Duplicate",options:r.duplicate,action(){const f=t.getSelectedItems();return Promise.all(f.filter(h=>h.fsItem).map(async({fsItem:h})=>{const m=await h.getPath();return n.executeCommand(`copy "${m}" "${m}" -ignore`)}))}},{title:"Make Dir",options:r.container,async action(){const f=t.getPrimaryWrapper().fsItem,h=Yi(await f.getPath(),"Directory");return console.log(`makedir "${h}" -ignore`),n.executeCommand(`makedir "${h}" -ignore`)}},{type:ee.SEPARATOR},{title:"Discard",options:r.discard,action(){const f=t.getSelectedItems();return Promise.all(f.filter(h=>h.fsItem).map(async({fsItem:h})=>{const m=await h.getPath();return n.executeCommand(`remove "${m}" -r`)}))}},{title:"Empty Trashcan",options:r.emptyTrashcan,action(){const f=t.getSelectedItems();return Promise.all(f.filter(h=>h.fsItem).map(async({fsItem:h})=>Promise.all(Array.from((await h.getItems()).values()).map(async m=>{const I=await m.getPath();return n.executeCommand(`remove "${I}" -r -ignore`)}))))}},{type:ee.SEPARATOR},{title:"Info",options:r.info,action(){t.getSelectedItems().filter(h=>h.fsItem).forEach(h=>{e.addWindow({title:`Info File ${h.fsItem.name}`,component:hp,componentData:{fsItem:M(h.fsItem)},layout:{size:S(460,280)},options:{scaleX:!0,scaleY:!0,prompt:!1,scrollX:!0,scrollY:!0}})})}}]}];function s(){t.getSelectedItems().filter(h=>h.fsItem).forEach(h=>{if(h.command){const m={showCommand:!1,show:!0};return n.executeCommand(h.command,m)}})}async function o({name:f,url:h,symbol:m},I){if(I||(I=await n.executeCommand(`saveFileDialog --id="${Ba(f)}"`)),I){const b=n.addExecution();try{const A=I.getPath();await n.executeCommand(`rename "${A}" "${f}" -n`),await n.executeCommand(`editfilemeta "${A}" "${w.WEB_URL}" "${h}"`),await n.executeCommand(`editfilemeta "${A}" "${w.SYMBOL}" "${m}"`)}catch(A){throw b(),new Error(A)}return b(),!0}return!1}function a(){return e.addWindow({title:"Make Link",component:Uo,componentData:{model:{actions:{save:o},name:null,url:null,symbol:"default"}},options:{prompt:!1,scaleX:!1,scaleY:!1,scrollX:!1,scrollY:!1}}).awaitClose()}function l(){t.getSelectedItems().filter(h=>h.fsItem).forEach(h=>{const m=h.fsItem;e.addWindow({title:"Edit Link",component:Uo,componentData:{fsItem:M(m),model:{actions:{save:o},name:m.name,url:m.meta.get(w.WEB_URL),symbol:m.meta.get(w.SYMBOL)}},options:{prompt:!1,scaleX:!1,scaleY:!1,scrollX:!1,scrollY:!1}})})}function c(){t.getSelectedItems().filter(h=>h.fsItem).forEach(h=>{const m=h.fsItem,I=Ne({actions:{save:d},id:m.id,name:m.name});[w.SYMBOL,w.VISIBLE,w.IGNORE_SYMBOL_REARRANGE,w.WINDOW_SCALE,w.WINDOW_SCROLL_X,w.WINDOW_SCROLL_Y,w.WINDOW_FULL_SIZE,w.WINDOW_SYMBOL_REARRANGE,w.WINDOW_SIDEBAR].forEach(b=>{I[String(b)]=m.meta.has(b)?m.meta.get(b):!1}),e.addWindow({title:`Edit File ${m.name}`,component:tp,componentData:{fsItem:M(m),model:I},options:{prompt:!1,scaleX:!1,scaleY:!1,scrollX:!1,scrollY:!1}})})}async function d(f,h){const{id:m,name:I}=f,b=h.getPath();if(!m)throw new Error("Id is emoty!");let A;const $=n.addExecution();try{await Promise.all([w.SYMBOL,w.VISIBLE,w.IGNORE_SYMBOL_REARRANGE,w.WINDOW_SCALE,w.WINDOW_SCROLL_X,w.WINDOW_SCROLL_Y,w.WINDOW_FULL_SIZE,w.WINDOW_SYMBOL_REARRANGE,w.WINDOW_SIDEBAR].map(D=>{let P=f[String(D)];return typeof P=="string"&&(P=`"${P}"`),n.executeCommand(`editfilemeta "${b}" "${D}" ${P}`)})),I&&m!==I?await n.executeCommand(`rename "${b}" "${I}" -n`):A=n.executeCommand(`rename "${b}" "${m}" -rn`),A=n.executeCommand(`rename "${b}" "${m}"`)}catch(D){throw $(),new Error(D)}return $(),A}},mp=({module:n})=>{const{fileSystem:e}=n,t=n.core;return[{name:["mountDisk"],description:"Mount Disk",args:[new y({index:0,name:"id",description:"Disk ID"})],async action({id:r},i){const s=t.addExecution(),a=await(await await O(()=>import("./BuOCOTVg.js"),__vite__mapDeps([3,1]),import.meta.url).then(c=>c.default))(r),l=await e.addFloppyDisk(a({core:t}));i.message(`Mount Disk <strong>${l.name}</strong> <strong>(${l.id})</strong> successful!`),s()}},{name:["changeDirectory","cd"],description:"cd %path%",args:[new y({index:0,name:"path",description:"Directory path"})],async action({path:r}){if(!r)throw C.get("bad_args");try{await e.changeDirectory(r)}catch(i){throw console.error(i),C.get("cant_find",r)}}},{name:["exist"],description:"Check if file exists.",args:[new y({index:0,name:"path",description:"Filename"})],async action({path:r},i){if(!r)throw C.get("bad_args");const s=Te(r),o=await e.exist(r);return o?i.message(`File ${s} exists`):i.message(`File ${s} does not exist`),o}},{name:["makedir","mkdir"],args:[new y({index:0,name:"path",description:"Filename"}),new y({index:1,name:"name",description:"Name"}),new y({name:"ignore",flag:!0,description:"Ignore file exist."})],async action({path:r,name:i,ignore:s},o){if(!r)throw C.get("bad_args");const a=await e.makedir(r,i||Te(r),{ignore:s});return o.message(`Directory "${a.name}" created`),a}},{name:["remove","rm"],args:[new y({index:0,name:"path",description:"Filename"}),new y({name:["recursive","r"],flag:!0,description:"Remove Directory Items and Directories."}),new y({name:["ignore"],flag:!0,description:"Ignore the specified file is deleted."})],async action({path:r,recursive:i,ignore:s},o){if(!r)throw C.get("bad_args");const a=await e.remove(r,i,{ignore:s});return[].concat(a).map(l=>{const c=l.type===It.NAME?"Directory":"File";return o.message(`Removed ${c}: ${l.name}`),l})}},{name:["readfile","getfile"],description:"Get file content",args:[new y({index:0,name:"path",description:"Filename"})],async action({path:r}){if(!r)throw C.get("bad_args");return(await e.get(r)).data}},{name:["makefile","mkfile"],description:"Creates a file with the specified attributes.",args:[new y({index:0,name:"path",description:"Filename"}),new y({index:1,name:"name",description:"Name"}),new y({index:3,name:"data",description:"Data"}),new y({name:"override",flag:!0,description:"Deletes existing file and recreates."})],async action({path:r,name:i,data:s,override:o=!1},a){if(!r)throw C.get("bad_args");typeof s=="string"&&(s=await bi(s));const l=await e.makefile(r,i,s,{override:o});return a.message(`File "${l.name}" created`),l}},{name:["editfile"],description:"Edits file with specified attributes.",args:[new y({index:0,name:"path",description:"Filename"}),new y({index:1,name:"data",description:"Data"})],async action({path:r,data:i},s){if(!r)throw C.get("bad_args");typeof i=="string"&&(i=await bi(i));const o=await e.editfile(r,i);return s.message(`File "${o.name}" edited`),o}},{name:["editfilemeta"],description:"Edits file with specified attributes.",args:[new y({index:0,name:"path",description:"Filename"}),new y({index:1,name:"name",description:"Name"}),new y({index:2,name:"value",description:"Value"})],async action({path:r,name:i,value:s},o){if(!r)throw C.get("bad_args");const a=await e.editfileMeta(r,i,s);return o.message(`File  "${a.name}" Meta edited`),a}},{name:["makelink","mklink"],description:"Creates a link to the specified path.",args:[new y({index:0,name:"ref",description:"Reference path with id (example.ext)."}),new y({index:1,name:"name",description:"Displayed Name"}),new y({index:2,name:"dest",description:"Destination directory."})],async action({ref:r,name:i,dest:s},o){if(!r)throw C.get("bad_args");s=s||".";const a=await e.get(r),l=await e.makelink(a,i);return await e.get(s)!==e.currentItem&&await e.move(l,s,{ignore:!0}),o.message(`Created link "${i}" with "${await a.getPath()}"`),l}},{name:["editlink"],description:"",args:[new y({index:0,name:"path",description:"Reference filepath with id (example.ext)."}),new y({index:1,name:"ref",description:"Destination directory."})],async action({path:r,ref:i},s){if(!(r&&i))throw C.get("bad_args");const o=await e.get(i),a=await e.editlink(r,o);return s.message(`Edited link "${name}" with "${await o.getPath()}"`),a}},{name:"rename",description:"Renamed a file",args:[new y({index:0,name:"path",description:"Filepath with id (example.ext)."}),new y({index:1,name:"value",description:"Value for id or displayed name."}),new y({name:["name","n"],flag:!0,description:"When set, changes the display name."}),new y({name:["removeName","rn"],flag:!0,description:"When set, removes the display name."})],async action({path:r,value:i,name:s,removeName:o},a){if(!o&&(!r||!i))throw C.get("bad_args");const l=await e.get(r),c=s?l.name:l.id;return await e.rename(r,i,{name:s,removeName:o}),a.message(`Renamed from "${c}" to "${i}"`),l}},{name:["cp","copy"],args:[new y({index:0,name:"from",description:"Source Filepath with id (example.ext)."}),new y({index:1,name:"dest",description:"Destination Filepath with id (example.ext)."}),new y({name:["ignore","i"],flag:!0,description:"When sets, creates a new file if exists."})],async action({from:r,dest:i,ignore:s},o){let a=i;if(!a&&s&&(a=r),!a||!r)throw C.get("bad_args");const l=await e.copy(r,a,{ignore:s});return o.message(`Copied from "${r}" to "${a}"`),l}},{name:["mv","move"],description:"move %from% %to%",args:[new y({index:0,name:"from",description:"From path"}),new y({index:1,name:"to",description:"To path"}),new y({index:2,name:"item-position",description:"Sets the position in the Icon view. (x,y)"})],async action({from:r,to:i,itemPosition:s},o){if(!i||!r)throw C.get("bad_args");const a=new Map;s&&a.set("itemPosition",[0,0].map((d,f)=>{const h=s.split(",");return parseInt(h[Number(f)]||0)}));const l=await e.move(r,i,{meta:a});let c;return l instanceof It?c="Directory":c="File",o.message(`${c} moved ${l.name}`),l}},{name:["executeFile"],description:"Execute file.",args:[new y({index:0,name:"path",description:"Path to the file"})],async action({path:r}){if(!r)throw C.get("bad_args");const i=await e.get(r);if(typeof i.action=="function")return i.action(t);throw C.get("cant_find_action",r)}}]};C.add("cant_find_action","Can't find action %1");var Xr,Ko;const pp=new(Ko=class{constructor(){g(this,Xr,void 0)}get(){return u(this,Xr)||v(this,Xr,this.getImports())}getImports(){return Promise.all([O(()=>import("./BYo4aVUG.js"),__vite__mapDeps([4,5,1,2]),import.meta.url),O(()=>import("./C6Atypec.js"),__vite__mapDeps([6,5,1,2]),import.meta.url),O(()=>import("./D5YWn_G_.js"),__vite__mapDeps([7,5,1,2]),import.meta.url)]).then(([e,t,r])=>({app:e.default||e,auth:t.default||t,database:r.default||r}))}},Xr=new WeakMap,Ko),ri=new Map;class gp{constructor(){p(this,"services");p(this,"app");p(this,"firebase")}get name(){return this.app.name}async connect(e,{apiKey:t,url:r}){if(this.services=await pp.get(),this.firebase=this.services.app,this.app)ri.has(e)&&(this.app=ri.get(e));else{const i=this.services.app.initializeApp({apiKey:t,databaseURL:r},e);ri.set(i.name,i),this.app=i}return this.app}async disconnect(){if(!this.app)throw C.get("FirebaseWrapper_noApp");Xn(this),await this.logout(),await this.services.app.deleteApp(this.app),this.app=null}get locked(){return!!this.app&&!this.isLogged()}get currentUser(){const{getAuth:e}=this.services.auth;return e(this.app).currentUser}isLogged(){return!!this.app&&!!this.currentUser}login(e,t){const{getAuth:r,signInWithEmailAndPassword:i}=this.services.auth,s=r(this.app);return Xn(this),i(s,e,t)}logout(){if(this.app){const{getAuth:e,signOut:t}=this.services.auth,r=e(this.app);return t(r)}else throw C.get("FirebaseWrapper_notConnected")}remove(e){Xn(this);const{remove:t,ref:r,getDatabase:i}=this.services.database,s=i(this.app),o=r(s,e);return t(o)}get(e){Xn(this);const{ref:t,onValue:r,getDatabase:i}=this.services.database,s=i(this.app),o=t(s,e);return new Promise(a=>{r(o,l=>a(l.val()))})}async set(e,t){Xn(this);const{ref:r,set:i,getDatabase:s}=this.services.database,o=s(this.app),a=r(o,e);return await i(a,t),t}}function Xn(n){if(!n.app)throw C.get("FirebaseWrapper_notConnected")}C.add([["FirebaseWrapper_notConnected",["Not connected","Not connected"]],["FirebaseWrapper_noApp",["No app available","No app available"]],["FirebaseWrapper_hasApp",["App already available",'App "%1" already available']]]);class bp extends Za{constructor(e){e=Object.assign({storage:new gp},e),super(e)}mount(e){return e.onDisconnect=()=>{this.unmount()},this.storage.connect(e.id,e).then(()=>this)}unmount(){return this.storage.disconnect().then(()=>this)}async load(){try{let e=await this.storage.get(this.name);return!e&&(e={},!this.storage.locked)?this.storage.set(this.name,e).then(t=>t):(this.data=e,e)}catch(e){throw new Error(e)}}save(e){return e=bl(e),this.data=e||this.data,this.storage.set(this.name,e).then(()=>this.data)}get locked(){return this.storage.locked}}function bl(n){return Object.keys(n).reduce((e,t)=>{const r=e[String(t)];return r&&typeof r=="object"&&bl(r),(r==null||r==="")&&delete e[String(t)],e},n)}const qn=new Map,yp=({module:n,core:e})=>{const{fileSystem:t}=n;return[{name:"cloudList",args:[new y({name:"json",flag:!0,description:"Get JSON Export"})],action({json:r},i){const s=Array.from(qn.values());if(r)return Promise.resolve(s);{const o=new Ht;return o.addColumn({value:"Storage (Id)",align:"left",minWidth:15}),o.addColumn({value:"Name",align:"left",minWidth:15}),o.addColumn({value:"Logged In",align:"center",minWidth:9}),o.addRow(s.reduce((a,l)=>(a.push([l.id,l.name,l.storage.storage.isLogged()?"yes":"no"]),a),[])),i.message([o]),Promise.resolve()}}},{name:"cloudMount",args:[new y({index:0,name:"id",flag:!0,description:"Id from Storage."}),new y({index:1,name:"apiKey",description:"Firebase Api-Key."}),new y({index:2,name:"url",description:"Firebase Database-Url."})],async action({id:r,apiKey:i,url:s},o){if(!i||!s)throw C.get("bad_args");const a=e.addExecution(),l=await t.connect(bp,{id:r,apiKey:i,url:s});return qn.set(l.id,l),o.message(`Mount <strong>${l.name}</strong> <strong>(${l.id})</strong> successful!`),a(),l}},{name:"cloudUnmount",args:[new y({index:0,name:"id",flag:!0,description:"Id from Storage."})],async action({id:r},i){if(!r)throw C.get("bad_args");const s=e.addExecution();try{const o=qn.get(r);await t.disconnect(o),qn.delete(o.id),i.message(`Unmount "${o.name}" successful!`),s()}catch(o){throw s(),new Error(o)}}},{name:"cloudAuth",args:[new y({name:"login",flag:!0,description:"Storage Login"}),new y({name:"logout",flag:!0,description:"Logout from Storage."}),new y({name:"email",description:"Email for Login."}),new y({name:"password",description:"Password for Login."}),new y({name:"storage",description:"Specifies which drive is logged on."})],async action({email:r,password:i,storage:s,login:o,logout:a},l){const c=s;if(!c)throw C.get("bad_args");const d=e.addExecution(),f=qn.get(c);let h;if(f)try{if(o){if(!r||!i)throw C.get("bad_args");h=await f.storage.storage.login(r,i),l.message(`Login with ${f.id} (${f.id}) successful!`)}else a&&(h=await f.storage.storage.logout(),l.message(`Logout from ${f.id} (${f.id}) successful!`))}catch(m){switch(d(),m.code){case"auth/user-not-found":case"auth/wrong-password":return m}throw new Error(m)}else throw new Error(`${c} is not mounted.`);return d(),h}}]},Go=new Ri("web_workbench_FS");class yl extends js{constructor({core:e}){super({commands:(...t)=>[...Xm(...t),...mp(...t),...yp(...t)],contextMenu:fp,core:e})}get fileSystem(){return Go}get fs(){return Go}}p(yl,"NAME","Files");class wp{constructor(e){p(this,"defaultItems",new qt);p(this,"activeItems");p(this,"core",null);this.core=e,this.activeItems=this.defaultItems}addDefaultItems(e){this.defaultItems.add(e)}getActiveItems(){return this.activeItems}setActiveItems(e){return this.activeItems=e||this.defaultItems}}const _p={components:{AtomMarkdown:gl},props:{...dt},emits:[...ht],setup(n,e){const t=Ll().versions;return{...ut(n,e),versions:t}},data(){return{content:`# Web-Workbench 1.3
<nobr>Created by Thorn-Welf Walli</nobr><br>Email: lammpee@gmail.com<br>Homepage: [lammpee.de](https://lammpee.de)<br><br>Version: <strong>${this.core.version}</strong><br>Nuxt: <strong>${this.versions.nuxt}</strong><br>Vue: <strong>${this.versions.vue}</strong>`}}},xp={class:"wb-module-core-info"};function Ep(n,e,t,r,i,s){const o=k("atom-markdown");return x(),T("div",xp,[R(o,{content:i.content},null,8,["content"])])}const vp=V(_p,[["render",Ep],["__scopeId","data-v-cf4ce318"]]),Sp=({core:n})=>{const{windows:e}=n.modules;return[{order:0,title:"Web-Workbench",items:[{title:"Settings",action(){return n.executeCommand("openSettings")}},{type:ee.SEPARATOR},{hotKey:"I",keyCode:73,title:"Info",action(){e.addWindow({title:"Info",component:vp,componentData:{},options:{prompt:!1,scaleX:!1,scaleY:!1,scrollX:!1,scrollY:!1}})}},{type:ee.SEPARATOR},{title:"Imprint",action(){return n.executeCommand('execute "Imprint.md"')}},{title:"Disclaimer",action(){return n.executeCommand('execute "Disclaimer.md"')}}]}]},Kn={CENTER:0,ORDER_HORIZONTAL:1,ORDER_VERTICAL:2,ORDER_DIAGONAL_LEFT:3,ORDER_DIAGONAL_RIGHT:4,SPLIT_HORIZONTAL:5,SPLIT_VERTICAL:6},Li={SHOW_STORAGE_SPACE:"windowsShowStorageSpace"},Ip={[Li.SHOW_STORAGE_SPACE]:!0},Op=({core:n})=>[{order:10,title:"Window",items:[{type:ee.CHECKBOX,title:"Show Disk Space",model:n.config.observable,name:Li.SHOW_STORAGE_SPACE,action(e){return n.config.set(Li.SHOW_STORAGE_SPACE,e)}},{type:ee.SEPARATOR},{title:"Order",items:[{title:"Center",action(){n.modules.windows.contentWrapper.setWindowPositions(Kn.CENTER)}},{type:ee.SEPARATOR},{title:"Diagonal (Left to right)",action(){n.modules.windows.contentWrapper.setWindowPositions(Kn.ORDER_DIAGONAL_RIGHT)}},{title:"Diagonal (Right to left)",action(){n.modules.windows.contentWrapper.setWindowPositions(Kn.ORDER_DIAGONAL_LEFT)}},{type:ee.SEPARATOR},{title:"Split (Horizontal)",action(){n.modules.windows.contentWrapper.setWindowPositions(Kn.SPLIT_HORIZONTAL)}},{title:"Split (Vertical)",action(){n.modules.windows.contentWrapper.setWindowPositions(Kn.SPLIT_VERTICAL)}}]}]}],Ap={xmlns:"http://www.w3.org/2000/svg",width:"6",height:"10",viewBox:"0.5 50.5 6 10"},kp=E("path",{fill:"#020203",d:"M.5 50.5h6v2h-4v2h2v2h-2v4h-2z"},null,-1),Tp=[kp];function Rp(n,e){return x(),T("svg",Ap,[...Tp])}const Dp={render:Rp},Cp={xmlns:"http://www.w3.org/2000/svg",width:"6",height:"10"},Np=E("path",{d:"M0 10h6V8H2V6h2V4H2V2h4V0H0z"},null,-1),Lp=[Np];function Pp(n,e){return x(),T("svg",Cp,[...Lp])}const Mp={render:Pp},$p={components:{SvgStorageBarFull:Dp,SvgStorageBarEmpty:Mp},props:{visible:{type:Boolean,default:!0},value:{type:Number,default:.8}},computed:{style(){return{"--bar-height":Math.min(this.value,1)}}}},Wp=n=>(Pi("data-v-d81cda0d"),n=n(),Mi(),n),Fp={class:"icon full"},zp=Wp(()=>E("span",{class:"size"},[E("span",{class:"helper"})],-1)),Bp={class:"icon empty"};function Vp(n,e,t,r,i,s){const o=k("svg-storage-bar-full"),a=k("svg-storage-bar-empty");return t.visible?(x(),T("div",{key:0,class:"wb-env-atom-storage-bar",style:Cn(s.style)},[E("div",null,[E("div",Fp,[R(o)]),zp,E("div",Bp,[R(a)])])],4)):W("",!0)}const jp=V($p,[["render",Vp],["__scopeId","data-v-d81cda0d"]]),Ie={NAME:0,TYPE:1,CREATED_DATE:2,EDITED_DATE:3},Lt={ASCENDING:0,DESCENDING:1},q={SHOW_INVISIBLE_SYMBOLS:"symbolWrapper_showInvisibleItems",ORDER_TYPE:"symbolWrapper_iconsOrderType",ORDER_DIRECTION:"symbolWrapper_iconsOrderDirection"},Up={[q.SHOW_INVISIBLE_SYMBOLS]:!1,[q.ORDER_TYPE]:Ie.NAME,[q.ORDER_DIRECTION]:Lt.ASCENDING};class Ho{constructor({fsItem:e=null,command:t,model:r,layout:i}){p(this,"type",null);p(this,"id",Wn());p(this,"layout",Ne({position:S(0,0),size:S(0,0)}));p(this,"ignoreRearrange",!1);p(this,"model",Ne({title:"Item Title",symbol:_.DEFAULT,used:!1,visible:!0}));if(this.command=t,this.model=Object.assign(this.model,r),this.layout=Object.assign(this.layout,i),this.fsItem=e,this.fsItem){const s=this.fsItem;this.type=Gp(s),this.setProperties(s),this.fsItem.events.subscribe(({name:o})=>{o!=="addItem"&&o!=="removeItem"&&this.setProperties(e)})}}setProperties(e){if(this.model.title=e.name,this.layout.position=S(e.meta.get(w.POSITION)||S(0,0)),this.model.visible=!!e.meta.get(w.VISIBLE),this.model.symbol=e.meta.get(w.SYMBOL),this.model.url=e.meta.get(w.WEB_URL),this.model.ignoreRearrange=e.meta.get(w.IGNORE_SYMBOL_REARRANGE),e instanceof U){const t=[`openDirectory "${e.getPath()}"`];e.meta.get(w.WINDOW_SYMBOL_REARRANGE)&&t.push("-sort-symbols");const r=S(e.meta.get(w.WINDOW_POSITION)||S(0,0));r.length>0&&t.push(`--window-position="${S(r).toArray().join(",")}"`);const i=S(e.meta.get(w.WINDOW_SIZE)||S(0,0));i.length>0&&t.push(`--window-size="${S(i).toArray().join(",")}"`),e.meta.has(w.WINDOW_SCALE)&&t.push(`--window-scale=${e.meta.get(w.WINDOW_SCALE)}`),e.meta.has(w.WINDOW_SCROLL_X)&&t.push(`--window-scroll-x=${e.meta.get(w.WINDOW_SCROLL_X)}`),e.meta.has(w.WINDOW_SCROLL_Y)&&t.push(`--window-scroll-y=${e.meta.get(w.WINDOW_SCROLL_Y)}`),e.meta.has(w.WINDOW_SIDEBAR)&&t.push(`--window-sidebar=${e.meta.get(w.WINDOW_SIDEBAR)}`),e.meta.has(w.WINDOW_FULL_SIZE)&&t.push(`--window-full-size=${e.meta.get(w.WINDOW_FULL_SIZE)}`),this.command=t.join(" ")}else this.model.url||(this.command=`execute "${e.getPath()}"`)}}function Yo(n){return n.map(e=>e instanceof Ho?e:new Ho(e))}function Gp(n){return n instanceof U?"container":n.meta.get(w.WEB_URL)?"link":"default"}var wt,Ws,_t,qr;class Yt{constructor(e,t=[],r=!1){g(this,wt,new Me);g(this,Ws,Wn());g(this,_t,void 0);p(this,"items",Et([]));p(this,"selectedItems",Et([]));g(this,qr,!1);p(this,"layout",Ne({size:S(0,0),position:S(0,0)}));p(this,"size",S(0,0));p(this,"parentSize",S(0,0));v(this,qr,r||!1),v(this,_t,e),this.items.value=Yo(t||[])}get(e){return this.items.value.find(t=>t.id===e)}has(e){return!!this.items.value.find(t=>t.id===e)}add(...e){const t=Yo(e);this.items.value.push(...t.map(M)),u(this,wt).next(new j("add",{wrapper:this,items:t}))}remove(e){typeof e!="object"&&(e=this.get(e)),this.unselectItem(e.id),this.items.value.splice(this.items.value.indexOf(e),1),u(this,wt).next(new j("remove",{wrapper:this,item:e}))}setup(){return Promise.resolve()}moveItem(e,t){const r=this.get(e);return t.add(r),this.remove(r),Promise.resolve()}moveItemToItem(){return Promise.resolve()}savePosition(e,t){return Promise.resolve()}isSelectedItem(e){return this.selectedItems.value.includes(e)}selectItem(e){this.isSelectedItem(e)||(this.selectedItems.value.push(e),u(this,wt).next(new j("selectItem",{wrapper:this,id:e})))}unselectItem(e){this.isSelectedItem(e)&&(this.selectedItems.value=this.selectedItems.value.filter(t=>t!==e),u(this,wt).next(new j("unselectItem",{wrapper:this,id:e})))}clearSelectedItems(){[].concat(this.selectedItems.value).forEach(e=>this.unselectItem(e))}get root(){return u(this,qr)}get events(){return u(this,wt)}get id(){return u(this,Ws)}get core(){return u(this,_t)}rearrangeIcons(e){e=Object.assign({orderType:u(this,_t).config.get(q.ORDER_TYPE),orderDirection:u(this,_t).config.get(q.ORDER_DIRECTION),onlyVisible:!u(this,_t).config.get(q.SHOW_INVISIBLE_SYMBOLS),root:!1,margin:10},e);let t=this.items.value;switch(e.root&&(e.orderType=Ie.NAME,e.orderDirection=Lt.DESCENDING),e.onlyVisible&&(t=t.filter(a=>a.model.visible)),t=t.filter(a=>!a.model.ignoreRearrange),e.orderType){case Ie.TYPE:t=t.sort((a,l)=>a.type.localeCompare(l.type));break;case Ie.CREATED_DATE:t=t.sort((a,l)=>a.createDate===l.createDate?0:a.createDate>l.createDate?1:-1);break;case Ie.EDITED_DATE:t=t.sort((a,l)=>a.editedDate===l.editedDate?0:a.editedDate>l.editedDate?1:-1);break;default:t=t.sort(a=>a.model.title.localeCompare(a.model.title))}switch(e.orderDirection){case Lt.ASCENDING:t.reverse();break}const r=e.margin;let i,s=r;const o=Sa(0,0);return e.root?i=this.size.x:i=r,t.forEach(a=>{e.root?(a.layout.position=S(i-a.layout.size.x,s),a.layout.size.x>o.x&&(o.x=a.layout.size.x),s+a.layout.size.y<this.parentSize.y?s+=a.layout.size.y+r:(i-=o.x+r,s=r)):(a.layout.size.y>o.y&&(o.y=a.layout.size.y),a.layout.position=S(i,s),i+a.layout.size.x<this.parentSize.x||(i=r,s+=o.y+r,a.layout.position=S(i,s)),i+=a.layout.size.x+r)}),Promise.all(t.map(({id:a,layout:l})=>this.savePosition(a,l.position)))}}wt=new WeakMap,Ws=new WeakMap,_t=new WeakMap,qr=new WeakMap;class ir extends Yt{constructor(){super(...arguments);p(this,"fsItem");p(this,"usedMemory",0)}async setup(t){this.fsItem=t;const r=Array.from((await t.getItems()).values());await Promise.all(r.map(async i=>this.add(await ir.fsItemToSymbol(i)))),t.events.subscribe(this.onEventItem.bind(this))}async moveItemToItem(t,r){if(t.locked)throw new Error("Items are locked!");if(r.locked)throw new Error("Destination is locked!");t.meta.set(w.POSITION,S(0,0)),await this.core.modules.files.fs.saveItem(t),await this.core.modules.files.fs.move(t,r,{override:!0})}async moveItem(t,r){const i=this.get(t);if(i.fsItem instanceof rs||i.fsItem instanceof It)try{return await this.moveItemToItem(i.fsItem,r.fsItem),!0}catch(s){return console.warn(s),!1}return Promise.resolve(!1)}savePosition(t,r){const i=this.get(t);i.fsItem.meta.set(w.POSITION,r),this.core.modules.files.fs.saveItem(i.fsItem)}hasFsItem(t){return this.items.value.find(r=>r.fsItem.id===t.id)}async onEventItem({name:t,value:r}){let i;switch(t){case"addItem":i=await ir.fsItemToSymbol(r),this.hasFsItem(r)||this.add(i);break;case"removeItem":this.remove(this.items.value.find(s=>s.fsItem===r));break}this.usedMemory=this.fsItem.size/this.fsItem.maxSize}static getItemsFromItem(t){return Promise.all(Array.from(t.items.values()).map(ir.fsItemToSymbol))}static async fsItemToSymbol(t){const r=await t.getPath(),i={fsItem:t,model:{title:t.name}};return typeof t.action=="function"&&(i.command=`executeFile "${r}"`),t.meta.has(w.WEB_URL)&&(i.url=t.meta.get(w.WEB_URL)),i}}const Hp={xmlns:"http://www.w3.org/2000/svg",width:"31",height:"30",class:"wb_symbol_disk_1"},Yp=E("path",{d:"M0 0h25v2h2v2h2v2h2v24H0z",class:"svg-secondary"},null,-1),Xp=E("path",{fill:"#FFF",d:"M2 2v26h27V6h-2V4h-2V2",class:"svg-primary"},null,-1),qp=E("path",{fill:"#FA5",d:"M7 2h13v10H7z",class:"svg-tertiary"},null,-1),Kp=E("path",{d:"M11 2h5v8h-5z",class:"svg-secondary"},null,-1),Zp=[Yp,Xp,qp,Kp];function wl(n,e){return x(),T("svg",Hp,[...Zp])}const _l={render:wl},Qp=Object.freeze(Object.defineProperty({__proto__:null,default:_l,render:wl},Symbol.toStringTag,{value:"Module"})),Jp={props:{parentLayout:{type:Object,default(){return null}},clampGlobal:{type:Boolean,default:!1},container:{type:Boolean,default(){return!1}},command:{type:String,default:null},id:{type:String,default:null},model:{type:Object,default(){return{title:"Item Title",url:null,symbol:_l,used:!1,visible:!0}}},layout:{type:Object,default(){return{position:S(0,0),size:S(50,50)}}},scrollOffset:{type:Object,default(){return S(0,0)}},wrapper:{type:Object,default(){return M(new Yt)}}},emits:["click"],setup(n){return{wrapperItems:n.wrapper.items,wrapperSelectedItems:n.wrapper.selectedItems}},data(){return{globalPosition:null,moving:!1,positions:{start:null,move:null},subscription:new Zr,parentEl:null,screenModul:cn.modules.screen}},computed:{linkTag(){return this.model.url?"a":"span"},linkBind(){return this.model.url?{href:this.model.url,target:this.model.url?"_blank":null,title:this.model.title}:{}},contentLayout(){return this.screenModul.contentLayout},selected(){return this.wrapperSelectedItems.includes(this.id)},styleClasses(){return{moving:this.moving,selected:this.selected,"symbol-used":this.model.used}},symbolsModule(){return cn.modules.symbols}},watch:{model:{deep:!0,handler(){this.onRefresh()}}},mounted(){this.parentEl=this.$el.parentElement,this.onRefresh()},unmounted(){this.subscription.unsubscribe(),this.wrapper.unselectItem(this.id)},methods:{onRefresh(){this.layout.size=S(200,200),window.requestAnimationFrame(()=>{this.layout.size=S(this.$el.children[0].offsetWidth,this.$el.children[0].offsetHeight)})},getRootBounds(){const{width:n,height:e,left:t,top:r}=this.parentEl.getBoundingClientRect();return{position:S(t,r),size:S(n,e)}},onPointerDown(n){bs(n);const e=this.id;if(!(this.model.url&&this.selected)&&(n.preventDefault(),!this.model.used)){if(this.command&&this.selected){const t={showCommand:!1,show:!0};return this.wrapper.unselectItem(e),this.model.used=!0,cn.executeCommand(this.command,t).then(()=>this.model.used=!1)}ei.shiftActive?this.wrapper.isSelectedItem(e)?this.wrapper.unselectItem(e):this.wrapper.selectItem(e):(this.symbolsModule.getSelectedItems().length>0&&this.symbolsModule.clearSelectedItems(),this.wrapper.selectItem(e)),this.startMove(S(n)),this.$emit("click",this)}},onPointerUp(){const n=this.symbolsModule.getSelectedItems().filter(t=>t.id!==this.id),e=this.wrapper.get(this.id);n.length>0&&e.fsItem instanceof U&&n.forEach(t=>this.wrapper.moveItemToItem(t.fsItem,e.fsItem))},startMove(n){const e=this.getRootBounds();this.positions.lastPosition=S(this.layout.position),this.positions.scrollOffset=S(this.scrollOffset),this.positions.start=n,this.positions.offset=S(()=>this.positions.start-this.layout.position),this.setPosition(n,e,!0),this.moving=!0;let t=n;const r=ei.pointerMove.subscribe(i=>{t=S(i),this.setPosition(S(i),e,!0)});this.subscription.add(ei.pointerUp.pipe(Dc()).subscribe(()=>{if(r.unsubscribe(),this.symbolsModule.getSecondaryWrapper().id!==this.wrapper.id)return this.wrapper.moveItem(this.id,this.symbolsModule.getSecondaryWrapper()).then(i=>(i||(this.layout.position=S(this.positions.lastPosition)),this.globalPosition=null,this.moving=!1,i));if(this.moving=!1,this.setPosition(t,e),!this.layout.position.equals(Se(()=>this.positions.start-this.positions.offset)))return this.wrapper.savePosition(this.id,this.layout.position)}))},setPosition(n,e,t=!1){const r={min:S(0,0),max:Se(()=>e.size-this.layout.size)};this.positions.move=Se(()=>n-this.positions.start);let i=Se(()=>Math.round(this.positions.start+this.positions.move-this.positions.offset));t?(r.min=e.position,r.max=Se(()=>r.max+this.contentLayout.position),i=Se(()=>Math.round(i+r.min)),this.clampGlobal?this.globalPosition=S(()=>Math.max(Math.min(i,this.contentLayout.position+this.wrapper.size-this.layout.size),r.min)):this.globalPosition=i):(this.wrapper.root?this.layout.position=Se(()=>Math.max(Math.min(i,this.wrapper.size-this.layout.size),0)):this.layout.position=Se(()=>Math.max(i,0)),this.globalPosition=null)}}},eg=["data-id"],tg=["innerHTML"];function ng(n,e,t,r,i,s){return x(),T("figure",{"data-id":t.id,class:at(["wb-env-atom-symbol-wrapper-item",s.styleClasses]),style:Cn([t.layout.size.toCSSVars("item-size"),(i.globalPosition||t.layout.position).toCSSVars("item-position")]),"touch-action":"none",onPointerdown:e[0]||(e[0]=(...o)=>s.onPointerDown&&s.onPointerDown(...o)),onPointerup:e[1]||(e[1]=(...o)=>s.onPointerUp&&s.onPointerUp(...o))},[(x(),z(ii(s.linkTag),tr(ta(s.linkBind)),{default:G(()=>[E("i",null,[(x(),z(ii(s.symbolsModule.symbols.get(t.model.symbol))))]),E("figcaption",{innerHTML:t.model.title},null,8,tg)]),_:1},16))],46,eg)}const rg=V(Jp,[["render",ng],["__scopeId","data-v-1d03926a"]]),sg={components:{WbEnvAtomSymbolWrapperItem:rg},props:{parentLayout:{type:Object,default(){return{size:S(window.innerWidth,window.innerHeight)}}},parentScrollable:{type:Boolean,default:!0},parentFocused:{type:Boolean,default:!1},clampSymbols:{type:Boolean,default:!1},wrapper:{type:Yt,default(){return M(new Yt(cn,[{layout:{position:S(100,0)},model:{title:"Item 1",symbol:_.DIRECTORY}},{layout:{position:S(0,0)},model:{title:"Item 2",symbol:_.DEFAULT}},{layout:{position:S(0,0)},model:{title:"Item 3",symbol:_.DEFAULT}}]))}}},emits:["ready","refresh"],setup(n){return{wrapperItems:n.wrapper.items,wrapperSelectedItems:n.wrapper.selectedItems}},data(){const n=cn;return{core:M(n),webWorkbenchConfig:M(n.config.observable),symbolsModule:M(n.modules.symbols),selectedItems:[],layout:{size:S(0,0),position:S(0,0)}}},computed:{styleClasses(){return{"parent-scrollable":this.parentScrollable,active:(this.core.modules.symbols.primaryWrapper||{}).id===this.wrapper.id}},scrollOffset(){return this.parentLayout&&"scrollOffset"in this.parentLayout?this.parentLayout.scrollOffset:S(0,0)},style(){const n=[this.scrollOffset.toCSSVars("symbol-wrapper-scroll-offset")];return this.parentScrollable?n.push(this.size.toCSSVars("symbol-wrapper-size")):n.push(this.layout.size.toCSSVars("symbol-wrapper-size")),n},size(){return this.visibleItems.map(n=>({item:n,index:this.wrapperSelectedItems.indexOf(n.id)+1})).sort((n,e)=>n.index>e.index?1:n.index<e.index?-1:0).reduce((n,{item:e})=>{const t=e.layout.position.x+e.layout.size.x,r=e.layout.position.y+e.layout.size.y;return n.x=n.x<t?t:n.x,n.y=n.y<r?r:n.y,n},Sa(0,0))},showInvisibleItems(){return this.webWorkbenchConfig[q.SHOW_INVISIBLE_SYMBOLS]},visibleItems(){return this.wrapperItems.filter(this.isItemVisible)},parentLayoutSize(){return(this.parentLayout||{}).size}},watch:{parentFocused(n){this.setFocused(n)},wrapper(){this.onResize()},parentLayoutSize(){this.onResize()},size(){this.$nextTick(()=>{this.$emit("refresh",{scroll:!0})})}},mounted(){this.$nextTick(()=>{this.onResize(),this.setFocused(this.parentFocused),this.$emit("ready")})},unmounted(){this.core.modules.symbols.getPrimaryWrapper()&&this.core.modules.symbols.getPrimaryWrapper().id===this.wrapper.id&&this.core.modules.symbols.setPrimaryWrapper(null),this.core.modules.symbols.getSecondaryWrapper()&&this.core.modules.symbols.getSecondaryWrapper().id===this.wrapper.id&&this.core.modules.symbols.setSecondaryWrapper(null)},methods:{setFocused(n){n?this.symbolsModule.setPrimaryWrapper(this.wrapper):this.symbolsModule.getPrimaryWrapper()&&this.symbolsModule.getPrimaryWrapper().id===this.wrapper.id&&this.symbolsModule.setPrimaryWrapper(null)},onResize(){const{left:n,top:e}=this.$el.getBoundingClientRect();this.wrapper.layout=this.layout={position:S(n,e),size:this.parentLayout.size},this.wrapper.size=S(this.$el.offsetWidth,this.$el.offsetHeight),this.wrapper.parentSize=this.parentLayout.size},isItemVisible(n){return this.showInvisibleItems||!this.showInvisibleItems&&n.model.visible},onPointerMove(){this.core.modules.symbols.setSecondaryWrapper(this.wrapper)},onPointerDown(n){(n.target===this.$refs.helper||n.target===this.$refs.items)&&this.wrapper.clearSelectedItems()}}},ig={ref:"helper",class:"helper"},og={ref:"items",class:"items"};function ag(n,e,t,r,i,s){const o=k("wb-env-atom-symbol-wrapper-item");return x(),T("div",{class:at(["wb-env-symbol-wrapper",s.styleClasses]),style:Cn(s.style),onPointerdown:e[0]||(e[0]=(...a)=>s.onPointerDown&&s.onPointerDown(...a)),onPointermove:e[1]||(e[1]=(...a)=>s.onPointerMove&&s.onPointerMove(...a))},[E("div",ig,null,512),E("div",og,[(x(!0),T(vt,null,St(s.visibleItems,(a,l)=>(x(),z(o,F({key:l,"clamp-global":t.clampSymbols,ref_for:!0},a,{wrapper:t.wrapper,"parent-layout":i.layout,"scroll-offset":s.scrollOffset}),null,16,["clamp-global","wrapper","parent-layout","scroll-offset"]))),128))],512)],38)}const lg=V(sg,[["render",ag],["__scopeId","data-v-977393a8"]]),cg={components:{WbButton:kt,WbFormFieldTextbox:ss,WbButtonWrapper:Tt},props:{message:{type:String,default(){return"Dialog Message"}},confirm:{type:Boolean,default:!1},prompt:{type:Boolean,default:!1},promptType:{type:String,default:"text"},promptStep:{type:Number,default:void 0},promptValue:{type:String,default:null},password:{type:Boolean,default:!1},apply:{type:Function,default(){return null}},abort:{type:Function,default(){return null}},applyLabel:{type:String,default(){return"Continue"}},abortLabel:{type:String,default(){return"Cancel"}},yesLabel:{type:String,default(){return"Yes"}},noLabel:{type:String,default(){return"No"}}},emits:["apply","abort"],data(){return{inputModel:{value:this.promptValue}}},computed:{isNumber(){return this.promptType==="number"},type(){return this.password?"password":this.promptType},formattedMessage(){return this.message.replace(/\\n|\n/g,"<br>")}},methods:{onClickApply(){const n=this.inputModel.value||!0;typeof this.apply=="function"?this.apply(n):this.$emit("apply",n)},onClickAbort(){typeof this.abort=="function"?this.abort():this.$emit("abort")}}},ug={class:"wb-env-molecule-dialog-content"},dg=["innerHTML"],hg={key:1,class:"input"};function fg(n,e,t,r,i,s){const o=k("wb-form-field-textbox"),a=k("wb-button"),l=k("wb-button-wrapper");return x(),T("div",ug,[E("div",null,[t.message?(x(),T("p",{key:0,innerHTML:s.formattedMessage},null,8,dg)):W("",!0),t.prompt?(x(),T("div",hg,[R(o,{ref:"dialogInput",model:i.inputModel,placeholder:null,step:t.promptStep,type:s.type,label:null},null,8,["model","step","type"])])):W("",!0),R(l,{align:t.abortLabel?"outer":"center",class:"buttons"},{default:G(()=>[t.applyLabel||t.confirm&&t.yesLabel?(x(),z(a,{key:0,"style-type":"dialog",label:t.confirm?t.yesLabel:t.applyLabel,onClick:s.onClickApply},null,8,["label","onClick"])):W("",!0),t.abortLabel||t.confirm&&t.noLabel?(x(),z(a,{key:1,"style-type":"dialog",label:t.confirm?t.noLabel:t.abortLabel,onClick:s.onClickAbort},null,8,["label","onClick"])):W("",!0)]),_:1},8,["align"])])])}const xl=V(cg,[["render",fg],["__scopeId","data-v-2d929a47"]]),Lg=Object.freeze(Object.defineProperty({__proto__:null,default:xl},Symbol.toStringTag,{value:"Module"})),mg=({module:n,core:e})=>{const{files:t,windows:r,symbols:i}=e.modules,s=t.fs;return[{name:["openDirectory","openDir"],description:"Opens the specified directory.",args:[new y({index:0,name:"path",description:"Path to the directory."}),new y({name:"sortSymbols",description:"Sort Symbols",flag:!0}),new y({name:"windowSize",description:"Window Size"}),new y({name:"windowPosition",description:"Window Position"}),new y({name:"windowScale",description:"Window Scale"}),new y({name:"windowScrollX",description:"Window Scroll-X"}),new y({name:"windowScrollY",description:"Window Scroll-Y"}),new y({name:"windowSidebar",description:"Window Sidebar"}),new y({name:"windowFullSize",description:"Window Full-Size"})],async action({path:o,sortSymbols:a,windowSize:l,windowPosition:c,windowScale:d,windowScrollX:f,windowScrollY:h,windowSidebar:m,windowFullSize:I}){if(!o)throw C.get("bad_args");const b=await s.get(o),A=await i.addFileSystemWrapper(b),$=i.symbolWrappers.get(A),D=Ne({value:b.size/b.maxSize}),P=r.addWindow({title:b.name,layout:{size:S(...(l||"400,200").split(",").map(pe=>Number(pe))),position:S(...(c||"0,0").split(",").map(pe=>Number(pe)))},symbolWrapper:$,sidebarComponent:jp,sidebarComponentData:D,component:lg,componentData:{wrapper:$,parentScrollable:f||h},options:{sidebar:m!==void 0?m:!0,scale:d!==void 0?d:!0,scrollX:f!==void 0?f:!0,scrollY:h!==void 0?h:!0,center:!c}},{active:!0,full:I}),me=()=>{D.value=b.size/b.maxSize},Z=[$.events.subscribe(me)];return new Promise(pe=>{P.events.subscribe(({name:uo})=>{uo==="ready"&&a?window.requestAnimationFrame(()=>{$.rearrangeIcons()}):uo==="close"?(Z.forEach(Sl=>Sl.unsubscribe()),i.removeWrapper(A),pe()):me()})})}},{name:["openDialog"],description:"Open a Dialog.",args:[new y({index:0,name:["message"],description:"Message from Dialog."}),new y({index:1,name:["title"],description:"Title from Dialog."}),new y({name:["apply"],description:"Title from apply button."}),new y({name:["abort"],description:"Title from abort button."}),new y({name:["confirm"],flag:!0,description:"Defines the confirm dialog"}),new y({name:["prompt"],flag:!0,description:"Defines the prompt dialog"}),new y({name:["promptType"],description:"Type from prompt dialog (e.g. text, number, email). (Default: text)"}),new y({name:["promptStep"],description:"Step from prompt dialog (e.g. 1, 0.1, 0.01). (Default: 1)"}),new y({name:["promptValue"],description:"Default value from prompt dialog."}),new y({name:["secret"],flag:!1,description:"Input is illegible."})],action:o=>{const{title:a=null,message:l=null,apply:c=null,abort:d=null,confirm:f=!1,prompt:h=!1,promptType:m="text",promptStep:I=void 0,promptValue:b=null,secret:A=!1}=o;let $;const D=Z=>{$(Z)},P=()=>{$(!1)},me=n.addWindow(new dr({title:a,component:xl,componentData:{title:a,message:l,secret:A,confirm:f,prompt:h,promptType:m,promptStep:Number(I),promptValue:b,applyLabel:c||"Continue",abortLabel:d,apply:D,abort:P},options:{scaleX:!1,scaleY:!1,scrollX:!1,scrollY:!1,close:!1}}));return me.awaitClose().then(()=>P()),new Promise(Z=>{$=Z}).then(Z=>(me.close(),Z))}}]};var Tn;class El extends js{constructor(t){const{core:r}=Object.assign({core:null},t);super({config:Ip,commands:mg,core:r});g(this,Tn,new Map);p(this,"contentWrapper");p(this,"globalWrapper");p(this,"contextMenu",Ne(new wp(this)));this.contentWrapper=this.getWrapper(this.addWrapper(new ko(r))),this.globalWrapper=this.getWrapper(this.addWrapper(new ko(r)))}addWindow(t,r){return t instanceof dr||(t=new dr(t)),t.componentData&&(t.componentData.core=M(this.core)),r=Object.assign({global:!1},r),r.global?t=this.globalWrapper.add(t,r):t=this.contentWrapper.add(t,r),t}getWrapper(t){return u(this,Tn).get(t)}addWrapper(t){return u(this,Tn).set(t.id,t),t.id}removeWrapper(t){typeof t!="string"&&(t=t.id),u(this,Tn).delete(t)}isContextMenu(t){return t.id===this.getActiveContextMenu().id}setup(){this.contextMenu.addDefaultItems(new qt(Sp,{core:this.core})),this.contextMenu.addDefaultItems(new qt(Op,{core:this.core}))}clear(){this.contentWrapper.clear(),this.globalWrapper.clear()}getActiveContextMenu(){return this.contextMenu.getActiveItems()}setActiveContextMenu(t){return this.contextMenu.setActiveItems(t)}}Tn=new WeakMap,p(El,"NAME","Windows");const pg={[_.DEFAULT]:()=>O(()=>import("./DYpn9OZY.js"),__vite__mapDeps([8,1]),import.meta.url).then(n=>n.default),[_.DIRECTORY]:()=>O(()=>import("./CX07HlZO.js"),__vite__mapDeps([9,1]),import.meta.url).then(n=>n.default),[_.DIRECTORY_PREFS]:()=>O(()=>import("./Du-wqy0K.js"),__vite__mapDeps([10,1]),import.meta.url).then(n=>n.default),[_.CLOUD_DISK]:()=>O(()=>import("./D9mEQk3-.js"),__vite__mapDeps([11,1]),import.meta.url).then(n=>n.default),[_.HARD_DISK]:()=>O(()=>import("./CvYFf7ro.js"),__vite__mapDeps([12,1]),import.meta.url).then(n=>n.default),[_.RAM_DISK]:()=>O(()=>import("./DG0AGynt.js"),__vite__mapDeps([13,1]),import.meta.url).then(n=>n.default),[_.TMP_DISK]:()=>O(()=>import("./CQevHdkW.js"),__vite__mapDeps([14,1]),import.meta.url).then(n=>n.default),[_.DISK_1]:()=>O(()=>Promise.resolve().then(()=>Qp),void 0,import.meta.url).then(n=>n.default),[_.DISK_2]:()=>O(()=>import("./CDEnbuoY.js"),__vite__mapDeps([15,1]),import.meta.url).then(n=>n.default),[_.DISK_WORKBENCH13]:()=>O(()=>import("./BOjWWVT9.js"),__vite__mapDeps([16,1]),import.meta.url).then(n=>n.default),[_.DISK_MARKDOWN]:()=>O(()=>import("./BAfAdOZN.js"),__vite__mapDeps([17,1]),import.meta.url).then(n=>n.default),[_.DISK_BASIC]:()=>O(()=>import("./PX9liy6B.js"),__vite__mapDeps([18,1]),import.meta.url).then(n=>n.default),[_.WORK]:()=>O(()=>import("./D5f2kSBt.js"),__vite__mapDeps([19,1]),import.meta.url).then(n=>n.default),[_.CONSOLE]:()=>O(()=>import("./CGQYWxZI.js"),__vite__mapDeps([20,1]),import.meta.url).then(n=>n.default),[_.SETTINGS]:()=>O(()=>import("./BPYBmYvS.js"),__vite__mapDeps([21,1]),import.meta.url).then(n=>n.default),[_.TRASHCAN]:()=>O(()=>import("./BRkJV5VI.js"),__vite__mapDeps([22,1]),import.meta.url).then(n=>n.default),[_.COMPUTER_1]:()=>O(()=>import("./CaPctdXg.js"),__vite__mapDeps([23,1]),import.meta.url).then(n=>n.default),[_.TELEPHONE]:()=>O(()=>import("./Bm9KeftK.js"),__vite__mapDeps([24,1]),import.meta.url).then(n=>n.default),[_.CURSOR]:()=>O(()=>import("./Cl5zsZzH.js"),__vite__mapDeps([25,1]),import.meta.url).then(n=>n.default),[_.PREFERENCE]:()=>O(()=>import("./DAxX-T3A.js"),__vite__mapDeps([26,1]),import.meta.url).then(n=>n.default),[_.WEB_BASIC]:()=>O(()=>import("./DRZbjGCy.js"),__vite__mapDeps([27,1]),import.meta.url).then(n=>n.default),[_.WEB_PAINTING]:()=>O(()=>import("./-aSK4457.js"),__vite__mapDeps([28,1]),import.meta.url).then(n=>n.default),[_.COLORS]:()=>O(()=>import("./CUqERPoj.js"),__vite__mapDeps([29,1]),import.meta.url).then(n=>n.default),[_.PRINT_1]:()=>O(()=>import("./KvhaOfvu.js"),__vite__mapDeps([30,1]),import.meta.url).then(n=>n.default),[_.PRINT_2]:()=>O(()=>import("./CdTrGCMS.js"),__vite__mapDeps([31,1]),import.meta.url).then(n=>n.default),[_.NOTEPAD]:()=>O(()=>import("./DNYj7zwz.js"),__vite__mapDeps([32,1]),import.meta.url).then(n=>n.default),[_.BASIC]:()=>O(()=>import("./CH1IE1qC.js"),__vite__mapDeps([33,1]),import.meta.url).then(n=>n.default),[_.IMAGE]:()=>O(()=>import("./Brip0eHB.js"),__vite__mapDeps([34,1]),import.meta.url).then(n=>n.default),[_.NOTE]:()=>O(()=>import("./C9UENgWi.js"),__vite__mapDeps([35,1]),import.meta.url).then(n=>n.default),[_.NOTE_BLANK]:()=>O(()=>import("./C6hlHM7V.js"),__vite__mapDeps([36,1]),import.meta.url).then(n=>n.default),[_.LARGE_NOTE]:()=>O(()=>import("./QOQ04Ux-.js"),__vite__mapDeps([37,1]),import.meta.url).then(n=>n.default),[_.LARGE_NOTE_RICH]:()=>O(()=>import("./CSnpy7qV.js"),__vite__mapDeps([38,1]),import.meta.url).then(n=>n.default),[_.FULLSCREEN]:()=>O(()=>import("./C9ZDYCkk.js"),__vite__mapDeps([39,1]),import.meta.url).then(n=>n.default),[_.CALCULATOR]:()=>O(()=>import("./BWrSqntS.js"),__vite__mapDeps([40,1]),import.meta.url).then(n=>n.default),[_.CLOCK]:()=>O(()=>import("./D4Q0FgGI.js"),__vite__mapDeps([41,1]),import.meta.url).then(n=>n.default),[_.KEYBOARD_QUESTION]:()=>O(()=>import("./BPMq7uNv.js"),__vite__mapDeps([42,1]),import.meta.url).then(n=>n.default),[_.LARGE_NOTEPAD]:()=>O(()=>import("./C5vEFwsC.js"),__vite__mapDeps([43,1]),import.meta.url).then(n=>n.default),[_.LARGE_NOTEPAD_HELP]:()=>O(()=>import("./DfmW4uh2.js"),__vite__mapDeps([44,1]),import.meta.url).then(n=>n.default),[_.RABBIT]:()=>O(()=>import("./DvEgEVc3.js"),__vite__mapDeps([45,1]),import.meta.url).then(n=>n.default),[_.MORE]:()=>O(()=>import("./Cac8DBbn.js"),__vite__mapDeps([46,1]),import.meta.url).then(n=>n.default),[_.SAY]:()=>O(()=>import("./BKvtO_EN.js"),__vite__mapDeps([47,1]),import.meta.url).then(n=>n.default),[_.GITHUB]:()=>O(()=>import("./COJ2Xz6X.js"),__vite__mapDeps([48,1]),import.meta.url).then(n=>n.default),[_.LAMMPEE]:()=>O(()=>import("./Cyw6IrO5.js"),__vite__mapDeps([49,1]),import.meta.url).then(n=>n.default),[_.CUBY]:()=>O(()=>import("./XduFV6HS.js"),__vite__mapDeps([50,1]),import.meta.url).then(n=>n.default),[_.NUXT]:()=>O(()=>import("./4i7cASd3.js"),__vite__mapDeps([51,1]),import.meta.url).then(n=>n.default),[_.CLOWN]:()=>O(()=>import("./DdKCA4zR.js"),__vite__mapDeps([52,1]),import.meta.url).then(n=>n.default),[_.DISALLOW_1]:()=>O(()=>import("./B7r5w4l0.js"),__vite__mapDeps([53,1]),import.meta.url).then(n=>n.default),[_.COPY_1]:()=>O(()=>import("./DHuRhKTd.js"),__vite__mapDeps([54,1]),import.meta.url).then(n=>n.default),[_.COPY_2]:()=>O(()=>import("./CpZ9W7Al.js"),__vite__mapDeps([55,1]),import.meta.url).then(n=>n.default),[_.DISPLAY_KEYBOARD]:()=>O(()=>import("./C4wAheY-.js"),__vite__mapDeps([56,1]),import.meta.url).then(n=>n.default),[_.PALETTE]:()=>O(()=>import("./DgXMpUPi.js"),__vite__mapDeps([57,1]),import.meta.url).then(n=>n.default),[_.SIGN_1]:()=>O(()=>import("./rPQHpP1j.js"),__vite__mapDeps([58,1]),import.meta.url).then(n=>n.default),[_.DOCUMENT_EDITOR]:()=>O(()=>import("./Bqxd0YcR.js"),__vite__mapDeps([59,1]),import.meta.url).then(n=>n.default),[_.DOCUMENT_READER]:()=>O(()=>import("./CLdSl3R5.js"),__vite__mapDeps([60,1]),import.meta.url).then(n=>n.default),[_.SYNTHESIZER]:()=>O(()=>import("./BxYi5TQO.js"),__vite__mapDeps([61,1]),import.meta.url).then(n=>n.default)},gg=({module:n,core:e})=>[{order:11,title:"Symbol",items:[{type:ee.CHECKBOX,title:"Show Invisible Symbols",model:e.config.observable,name:q.SHOW_INVISIBLE_SYMBOLS,action(t){return e.config.set(q.SHOW_INVISIBLE_SYMBOLS,t)}},{title:"Rearrange Symbols",hotKey:"R",keyCode:82,action(){const t=n.getDefaultWrapper(),r=n.getPrimaryWrapper();return r.id!==t.id?(r.rearrangeIcons(),ye(r.fsItem)):(t.rearrangeIcons({root:!0}),ye(t.fsItem))}},{title:"Order Type",items:[{model:e.config.observable,type:ee.RADIO,name:q.ORDER_TYPE,value:Ie.NAME,title:"Name",action(){return e.config.set(q.ORDER_TYPE,Ie.NAME)}},{model:e.config.observable,type:ee.RADIO,name:q.ORDER_TYPE,value:Ie.TYPE,title:"Type",action(){return e.config.set(q.ORDER_TYPE,Ie.TYPE)}},{model:e.config.observable,type:ee.RADIO,name:q.ORDER_TYPE,value:Ie.CREATED_DATE,title:"Created Date",action(){return e.config.set(q.ORDER_TYPE,Ie.CREATED_DATE)}},{model:e.config.observable,type:ee.RADIO,name:q.ORDER_TYPE,value:Ie.EDITED_DATE,title:"Edited Date",action(){return e.config.set(q.ORDER_TYPE,Ie.EDITED_DATE)}}]},{title:"Order Direction",items:[{model:e.config.observable,type:ee.RADIO,name:q.ORDER_DIRECTION,value:Lt.ASCENDING,title:"Ascending",action(){return e.config.set(q.ORDER_DIRECTION,Lt.ASCENDING)}},{model:e.config.observable,type:ee.RADIO,name:q.ORDER_DIRECTION,value:Lt.DESCENDING,title:"Descending",action(){return e.config.set(q.ORDER_DIRECTION,Lt.DESCENDING)}}]}]}],bg=({module:n})=>[{name:["rearrangeIcons"],description:"Rearrange Icons",args:[new y({name:"id",description:"Wraper id"}),new y({name:"root",description:"Use root wrapper",flag:!0})],async action({id:e,root:t}){const r=n.getDefaultWrapper(),i=n.getPrimaryWrapper();if(await new Promise(s=>window.requestAnimationFrame(s)),t)return r.rearrangeIcons({root:!0}),ye(r.fsItem);{let s=i;return e&&(s=n.get(e)),s.rearrangeIcons(),ye(s.fsItem)}}}];var xt,Ut,Je,Rn,Gt,Kr;class vl extends js{constructor(t){const{core:r}=Object.assign({core:null},t);super({config:Up,commands:bg,contextMenu:gg,core:r});g(this,xt,new Me);g(this,Ut,new Map);g(this,Je,new Map);g(this,Rn,{});p(this,"hasSelectedItems",!1);g(this,Gt,void 0);g(this,Kr,void 0);p(this,"activeWrapper");p(this,"defaultWrapper");p(this,"primaryWrapper");p(this,"secondaryWrapper")}addWrapper(t){return t=M(t),u(this,Je).set(t.id,t),u(this,Rn)[t.id]=t,t.events.subscribe(this.onEventWrapper.bind(this)),t.id}onEventWrapper({name:t,value:r}){const{wrapper:i}=r;(t==="selectItem"||t==="unselectItem")&&(this.hasSelectedItems=i.selectedItems.value.length>0,u(this,xt).next(new j("hasSelectedItems",this.hasSelectedItems)))}removeWrapper(t){typeof t!="string"&&(t=t.id),u(this,Je).delete(t),delete u(this,Rn)[String(t)]}getActiveWrapper(t){const r=this.core.modules.windows.contentWrapper.getActiveWindow();return r&&r.symbolWrapper?r.symbolWrapper:t?null:this.activeWrapper}getSelectedItems(){return Array.from(u(this,Je).values()).reduce((t,r)=>(t.push(...r.selectedItems.value.map(i=>r.get(i))),t),[])}clearSelectedItems(){return Array.from(u(this,Je).values()).forEach(t=>{t.clearSelectedItems()})}async addFileSystemWrapper(t,r){const i=new ir(this.core,null,r);return await i.setup(t),this.addWrapper(i)}async setup(){await this.loadCoreSymbols(),this.setDefaultWrapper(await this.addFileSystemWrapper(this.core.modules.files.fs.root,!0))}loadCoreSymbols(){return Promise.all(Object.values(_).map(async t=>u(this,Ut).set(t,await pg[String(t)]())))}get(t){return u(this,Je).get(t)}setDefaultWrapper(t){v(this,Kr,t),this.primaryWrapper=this.secondaryWrapper=this.activeWrapper=this.defaultWrapper=this.symbolWrappers.get(t)}getDefaultWrapper(){return this.defaultWrapper}getPrimaryWrapper(){return this.primaryWrapper||this.defaultWrapper}getSecondaryWrapper(){return this.secondaryWrapper||this.defaultWrapper}setPrimaryWrapper(t){t instanceof Yt&&(t=t.id),this.primaryWrapper=this.symbolWrappers.get(t),u(this,xt).next(new j("setPrimaryWrapper",this.getPrimaryWrapper()))}setSecondaryWrapper(t){t instanceof Yt&&(t=t.id),this.secondaryWrapper=this.symbolWrappers.get(t),u(this,xt).next(new j("setSecondaryWrapper",this.secondaryWrapper))}setActiveWrapper(t){t instanceof Yt&&(t=t.id);let r=this.symbolWrappers.get(u(this,Gt));return t!==u(this,Gt)&&(v(this,Gt,t),this.activeWrapper=this.symbolWrappers.get(u(this,Gt)),r=this.activeWrapper||this.symbolWrappers.get(u(this,Kr)),u(this,xt).next(new j("setActiveWrapper",r))),r}addSymbol(t,r){u(this,Ut).set(t,r)}removeSymbol(t){u(this,Ut).delete(t)}get wrappersObservable(){return u(this,Rn)}get events(){return u(this,xt)}get symbols(){return u(this,Ut)}get symbolWrappers(){return u(this,Je)}}xt=new WeakMap,Ut=new WeakMap,Je=new WeakMap,Rn=new WeakMap,Gt=new WeakMap,Kr=new WeakMap,p(vl,"NAME","Symbols");const as=new _i;as.addModule(rl);as.addModule(yl);as.addModule(El);as.addModule(vl);const cn=as,Pg=Object.freeze(Object.defineProperty({__proto__:null,default:cn},Symbol.toStringTag,{value:"Module"}));export{Pu as $,y as A,Sg as B,N as C,Wa as D,du as E,hu as F,Qt as G,Xt as H,wd as I,Rg as J,Gc as K,Mn as L,js as M,Se as N,lr as O,Qn as P,Ln as Q,ci as R,Zr as S,yu as T,ma as U,ec as V,ko as W,zl as X,xg as Y,gl as Z,nn as _,_u as a,w as a0,_ as a1,H as a2,Ge as a3,Qr as a4,Hm as a5,Ea as a6,Wn as a7,Me as a8,j as a9,Vf as aa,Ja as ab,zn as ac,kt as ad,Qi as ae,ss as af,jh as ag,zd as ah,Rt as ai,Bl as aj,Eg as ak,Op as al,Tg as am,po as an,Vu as ao,Ag as ap,Tt as aq,qt as ar,Lg as as,Pg as at,ei as b,Li as c,Ig as d,wo as e,Dc as f,S as g,Sa as h,vu as i,dt as j,ht as k,lg as l,Oo as m,ft as n,vg as o,wh as p,ee as q,$a as r,Og as s,bs as t,ut as u,Ht as v,cn as w,ja as x,X as y,Sd as z};
