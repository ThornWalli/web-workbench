const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./DGwTsC-U.js","./DOMGF9Hs.js","./CotJlvW-.js","./DKrsSnpo.js","./CXbNF4JJ.css","./Bnsp_u8C.js","./CQXTE7NH.js","./B2exwp0w.js","./CpIyErmU.js","./BJWMXN3a.js","./DN_9BI7-.js","./BII7ONQG.js","./CZZPvNTk.js","./6C4StZv5.js","./D4lI5vpz.js","./BE-N3i2n.js","./Ce6njBYG.js","./DdQrQ7-5.js","./6jpuwjT2.js","./On0xenC3.js","./djI3_XgP.js","./RAasLaaH.js","./DNvW6rqi.js","./BUE24yXb.js","./CHLd88nu.css","./CnXvK7_p.js","./CqM9fYIm.css","./BflcHXSR.js","./9V19AFUE.js","./eeW43C70.js","./DMzq3-W3.js","./CJLX7oOC.js","./CNlRQWZy.js","./ol2dnVJx.js","./BlhZwPhK.js","./D9awfk1U.js","./CNkvSXuu.js","./CPKtgNO1.js","./Cc_Og2B_.js","./Bu9-HbQ4.js","./Cpj98o6Y.js","./DG6QdPnO.js","./D-Cgqglr.js","./CxKYomUj.js","./CHpeLE9u.js","./WZmY4AAg.js","./BWR5uye1.js","./CV0dHcg-.js","./BC_yceLI.js","./CaAbksje.js","./CJXA4BGR.css","./CshrRwMP.js","./CnKnkMed.js","./DhnHJytn.js","./DxpqQ76W.js","./DEAznjDA.css","./M0-75C7T.js","./CJlLddzR.js","./BVZzrE_-.css","./W7H9nAKY.js","./Bn0T8SwD.css","./E3_DWDMo.js","./6Hezpcw1.css","./kzTe6ghS.css","./B1s32xR9.js","./B1jPSlgX.js","./BSKES50A.css","./D8yRlGaa.css","./6e4iIPTf.js","./D5AYwgt_.js","./CYV3YR6m.css","./DQQa_9j-.css","./CQaTPF_f.js","./DcRMuGxK.js","./CuhyRvkQ.css","./WZpB47X6.css","./D9pixoYF.js","./Dm5CVc8Y.js","./UL4QHW6C.css","./BpDzjSrE.css","./k7DJIEn6.js","./B1ZubJLv.css","./ClNqYWJq.js","./Cm4M5IhY.css","./BxS9pqvC.js","./Bl2I1CnH.css","./C77FQkOd.js","./BXN9UGKo.css","./Ca2NcYDH.js","./BXDR1XBf.js","./DI3A0fxi.js","./DLyaWjaL.js","./CtnIK4HD.css","./0poC4doi.js","./DkCGi0kC.css","./DYFTzbe8.js","./B6o3xZ_o.css","./CbRKCzqT.js","./D6WwiM7C.js","./VtS9hTy9.js","./BADSAepT.css","./Bhv61Pvd.css","./DSRUEjWf.js","./Dl97Mvjk.css","./BSyG_usj.js","./CTrxkmWA.js","./DNMHntIy.css","./D-uygdNZ.css","./CzuRr9uc.js","./DjnUqd9k.js","./BtDs4BTf.css","./DnwQRW5p.js","./NgN1EEC6.css","./CxF3EGor.js","./BEDCjkIE.js","./BMC72IpY.js","./CHx_Ht_W.js"])))=>i.map(i=>d[i]);
var zt=Object.defineProperty;var Qt=(s,t,e)=>t in s?zt(s,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):s[t]=e;var c=(s,t,e)=>Qt(s,typeof t!="symbol"?t+"":t,e);import{L as it,K as T}from"./CotJlvW-.js";import{i as p,I as Gt}from"./CpIyErmU.js";import{c as X,I as S,l as Q,S as C,h as Vt}from"./DOMGF9Hs.js";import{a as O,b as jt,f as mt}from"./BE-N3i2n.js";import{o as et,c as Zt}from"./eeW43C70.js";import{O as Jt}from"./DdQrQ7-5.js";import{c as lt,t as Xt,l as Yt}from"./ol2dnVJx.js";import{f as qt}from"./CNlRQWZy.js";import{S as vt}from"./6C4StZv5.js";import{u as $t,i as Kt,a as te,b as ee,r as se,c as oe}from"./D9awfk1U.js";import{K as ie}from"./B2exwp0w.js";import{e as ne,s as re,f as ae}from"./CPKtgNO1.js";import{T as ce,g as le}from"./CHpeLE9u.js";import{t as Ct}from"./WZmY4AAg.js";import{K as ft}from"./CZZPvNTk.js";import{n as At,s as nt}from"./D-Cgqglr.js";import{C as D}from"./CxKYomUj.js";import{t as pe}from"./BC_yceLI.js";import{f as ue}from"./CaAbksje.js";var q=(s=>(s.CONTENT="content",s.OUTPUT_TYPE="type",s))(q||{}),M=(s=>(s.WEB_PAINT_DISPLAY_BACKGROUND="extras13_web_paint_display_background",s.WEB_PAINT_DISPLAY_FOREGROUND="extras13_web_paint_display_foreground",s.WEB_PAINT_DISPLAY_GRID_COLOR="extras13_web_paint_display_grid_color",s.WEB_PAINT_FIT_IMAGE="extras13_web_paint_fit_image",s.WEB_PAINT_NATIVE_THEME="extras13_web_paint_native_theme",s.WEB_PAINT_PALETTES="extras13_web_paint_palettes",s.WEB_PAINT_DEBUG="extras13_web_paint_debug",s))(M||{}),he=(s=>(s.LEFT_TOP="left_top",s.TOP="top",s.RIGHT_TOP="right_top",s.LEFT="left",s.CENTER="center",s.RIGHT="right",s.LEFT_BOTTOM="left_bottom",s.BOTTOM="bottom",s.RIGHT_BOTTOM="right_bottom",s))(he||{}),w=(s=>(s.DEFAULT="default",s.REFRESH="refresh",s.REFRESH_SUCCESS="refreshSuccess",s.DEBUG="debug",s.INIT="init",s.INIT_SUCCESS="initSuccess",s.SYNC_STATE="syncState",s.SYNC_STATE_SUCCESS="syncStateSuccess",s.ADD_RENDER_WORKER_PORT="addRenderWorkerPort",s.ADD_RENDER_WORKER_PORT_SUCCESS="addRenderWorkerPortSuccess",s.LOAD_IMAGE="loadImage",s.LOAD_IMAGE_SUCCESS="loadImageSuccess",s.UPDATE_CANVAS="updateCanvas",s.UPDATE_BUFFER="updateBuffer",s.UPDATE_BUFFER_SUCCESS="updateBufferSuccess",s.STACK="stack",s.STACK_SUCCESS="stackSuccess",s.UNDO_STACK="undoStack",s.UNDO_STACK_SUCCESS="undoStackSuccess",s.REDO_STACK="redoStack",s.REDO_STACK_SUCCESS="redoStackSuccess",s.CLEAR="clear",s.CLEAR_SUCCESS="clearSuccess",s.SET_ZOOM="setZoom",s.SET_ZOOM_SUCCESS="setZoomSuccess",s.ZOOM_FIT="zoomFit",s.ZOOM_FIT_SUCCESS="zoomFitSuccess",s.SET_POSITION="setPosition",s.SET_POSITION_SUCCESS="setPositionSuccess",s.USE_TOOL="useTool",s.USE_TOOL_SUCCESS="useToolSuccess",s.SET_SELECT_OPTIONS="setSelectOptions",s.SET_SELECT_OPTIONS_SUCCESS="setSelectOptionsSuccess",s.GET_DATA="getData",s.GET_DATA_SUCCESS="getDataSuccess",s.RESIZE="resize",s.RESIZE_SUCCESS="resizeSuccess",s.RESIZE_CANVAS="resizeCanvas",s.RESIZE_CANVAS_SUCCESS="resizeCanvasSuccess",s.GET_COLORS="getColors",s.GET_COLORS_SUCCESS="getColorsSuccess",s.IMAGE_OPERATION="imageOperation",s.IMAGE_OPERATION_SUCCESS="imageOperationSuccess",s.COLOR_PICKER="colorPicker",s.COLOR_PICKER_SUCCESS="colorPickerSuccess",s.SET_OPTIONS="setOptions",s.SET_OPTIONS_SUCCESS="setOptionsSuccess",s.DRAW_RECTANGLE="drawRectangle",s.DRAW_RECTANGLE_SUCCESS="drawRectangleSuccess",s.DRAW_BRUSH="drawBrush",s))(w||{});function de(s,t,e){let o,i,n;if(t===0)o=i=n=e;else{const a=(u,_,E)=>(E<0&&(E+=1),E>1&&(E-=1),E<.16666666666666666?u+(_-u)*6*E:E<.5?_:E<.6666666666666666?u+(_-u)*(.6666666666666666-E)*6:u),l=e<.5?e*(1+t):e+t-e*t,f=2*e-l;o=a(f,l,s/360+1/3),i=a(f,l,s/360),n=a(f,l,s/360-1/3)}return{r:Math.round(o*255),g:Math.round(i*255),b:Math.round(n*255)}}class g{constructor(t,e=0,o=0,i=255){c(this,"r");if(this.g=e,this.b=o,this.a=i,Array.isArray(t))[this.r,this.g,this.b,this.a]=t;else if(typeof t=="string"){const n=g.fromHex(t);this.r=n.r,this.g=n.g,this.b=n.b,this.a=n.a}else typeof t=="object"?(this.r=t.r||0,this.g=t.g||0,this.b=t.b||0,this.a=t.a!==void 0?t.a:255):(this.r=t,this.g=e||0,this.b=o||0,this.a=i===void 0?255:i);this.r=Math.min(Math.max(this.r,0),255),this.g=Math.min(Math.max(this.g,0),255),this.b=Math.min(Math.max(this.b,0),255),this.a=Math.min(Math.max(this.a,0),255)}static fromHex(t){t.length===4&&(t=`#${t[1]}${t[1]}${t[2]}${t[2]}${t[3]}${t[3]}`);const e=parseInt(t.slice(1,3),16),o=parseInt(t.slice(3,5),16),i=parseInt(t.slice(5,7),16),n=parseInt(t.slice(7,9),16);return new g(e,o,i,isNaN(n)?255:n)}static fromHsl(t,e,o,i=255){const{r:n,g:a,b:l}=de(t,e,o);return new g(n,a,l,i)}static isValidHex(t){return/^#([0-9a-fA-F]{3}|[0-9a-fA-F]{6}|[0-9a-fA-F]{8})$/.test(t)}toInverted(){return new g(255-this.r,255-this.g,255-this.b,this.a)}toJSON(){return{_type:this.constructor.name,r:this.r,g:this.g,b:this.b,a:this.a}}toHex(){return`#${this.toRGBA().map(t=>t.toString(16).padStart(2,"0")).join("")}`}toRGB(){return[this.r,this.g,this.b]}toRGBA(){return[...this.toRGB(),this.a]}toCSSRGBA(){return[...this.toRGB(),this.a/255]}toHsl(){const t=this.r/255,e=this.g/255,o=this.b/255,i=Math.max(t,e,o),n=Math.min(t,e,o);let a=0,l=0;const f=(i+n)/2;if(i===n)a=l=0;else{const u=i-n;switch(l=f>.5?u/(2-i-n):u/(i+n),i){case t:a=(e-o)/u+(e<o?6:0);break;case e:a=(o-t)/u+2;break;case o:a=(t-e)/u+4;break}a/=6}return[Math.round(a*360),l,f]}toHsla(){const[t,e,o]=this.toHsl();return[t,e,o,this.a]}toHsv(){const t=this.r/255,e=this.g/255,o=this.b/255,i=Math.max(t,e,o),n=Math.min(t,e,o);let a=0,l=0;const f=i,u=i-n;if(i!==0)l=u/i;else return[0,0,0];if(i===n)a=0;else{switch(i){case t:a=(e-o)/u+(e<o?6:0);break;case e:a=(o-t)/u+2;break;case o:a=(t-e)/u+4;break}a/=6}return[Math.round(a*360),l,f]}toHsva(){const[t,e,o]=this.toHsv();return[t,e,o,this.a]}getHslaHue(){const[t]=this.toHsl();return t}getHslaSaturation(){const[t]=this.toHsl();return t}getHslaLightness(){const[t]=this.toHsl();return t}setHslaHue(t){const[e,o,i]=this.toHsl();return g.fromHsl(e+t,o,i,this.a)}setHslaSaturation(t){const[e,o,i]=this.toHsl();return g.fromHsl(e,o+t,i,this.a)}setHslaLightness(t){const[e,o,i]=this.toHsl();return g.fromHsl(e,o,i+t,this.a)}equals(t){return this.r===t.r&&this.g===t.g&&this.b===t.b&&this.a===t.a}}const U={fatal:0,error:0,warn:1,log:2,info:3,success:3,fail:3,debug:4,trace:5,verbose:Number.POSITIVE_INFINITY},gt={silent:{level:-1},fatal:{level:U.fatal},error:{level:U.error},warn:{level:U.warn},log:{level:U.log},info:{level:U.info},success:{level:U.success},fail:{level:U.fail},ready:{level:U.info},start:{level:U.info},box:{level:U.info},debug:{level:U.debug},trace:{level:U.trace},verbose:{level:U.verbose}};function rt(s){if(s===null||typeof s!="object")return!1;const t=Object.getPrototypeOf(s);return t!==null&&t!==Object.prototype&&Object.getPrototypeOf(t)!==null||Symbol.iterator in s?!1:Symbol.toStringTag in s?Object.prototype.toString.call(s)==="[object Module]":!0}function pt(s,t,e=".",o){if(!rt(t))return pt(s,{},e);const i=Object.assign({},t);for(const n in s){if(n==="__proto__"||n==="constructor")continue;const a=s[n];a!=null&&(Array.isArray(a)&&Array.isArray(i[n])?i[n]=[...a,...i[n]]:rt(a)&&rt(i[n])?i[n]=pt(a,i[n],(e?`${e}.`:"")+n.toString()):i[n]=a)}return i}function me(s){return(...t)=>t.reduce((e,o)=>pt(e,o,""),{})}const fe=me();function Ae(s){return Object.prototype.toString.call(s)==="[object Object]"}function ge(s){return!(!Ae(s)||!s.message&&!s.args||s.stack)}let at=!1;const yt=[];class b{constructor(t={}){c(this,"options");c(this,"_lastLog");c(this,"_mockFn");const e=t.types||gt;this.options=fe({...t,defaults:{...t.defaults},level:ct(t.level,e),reporters:[...t.reporters||[]]},{types:gt,throttle:1e3,throttleMin:5,formatOptions:{date:!0,colors:!1,compact:!0}});for(const o in e){const i={type:o,...this.options.defaults,...e[o]};this[o]=this._wrapLogFn(i),this[o].raw=this._wrapLogFn(i,!0)}this.options.mockFn&&this.mockTypes(),this._lastLog={}}get level(){return this.options.level}set level(t){this.options.level=ct(t,this.options.types,this.options.level)}prompt(t,e){if(!this.options.prompt)throw new Error("prompt is not supported!");return this.options.prompt(t,e)}create(t){const e=new b({...this.options,...t});return this._mockFn&&e.mockTypes(this._mockFn),e}withDefaults(t){return this.create({...this.options,defaults:{...this.options.defaults,...t}})}withTag(t){return this.withDefaults({tag:this.options.defaults.tag?this.options.defaults.tag+":"+t:t})}addReporter(t){return this.options.reporters.push(t),this}removeReporter(t){if(t){const e=this.options.reporters.indexOf(t);if(e!==-1)return this.options.reporters.splice(e,1)}else this.options.reporters.splice(0);return this}setReporters(t){return this.options.reporters=Array.isArray(t)?t:[t],this}wrapAll(){this.wrapConsole(),this.wrapStd()}restoreAll(){this.restoreConsole(),this.restoreStd()}wrapConsole(){for(const t in this.options.types)console["__"+t]||(console["__"+t]=console[t]),console[t]=this[t].raw}restoreConsole(){for(const t in this.options.types)console["__"+t]&&(console[t]=console["__"+t],delete console["__"+t])}wrapStd(){this._wrapStream(this.options.stdout,"log"),this._wrapStream(this.options.stderr,"log")}_wrapStream(t,e){t&&(t.__write||(t.__write=t.write),t.write=o=>{this[e].raw(String(o).trim())})}restoreStd(){this._restoreStream(this.options.stdout),this._restoreStream(this.options.stderr)}_restoreStream(t){t&&t.__write&&(t.write=t.__write,delete t.__write)}pauseLogs(){at=!0}resumeLogs(){at=!1;const t=yt.splice(0);for(const e of t)e[0]._logFn(e[1],e[2])}mockTypes(t){const e=t||this.options.mockFn;if(this._mockFn=e,typeof e=="function")for(const o in this.options.types)this[o]=e(o,this.options.types[o])||this[o],this[o].raw=this[o]}_wrapLogFn(t,e){return(...o)=>{if(at){yt.push([this,t,o,e]);return}return this._logFn(t,o,e)}}_logFn(t,e,o){if((t.level||0)>this.level)return!1;const i={date:new Date,args:[],...t,level:ct(t.level,this.options.types)};!o&&e.length===1&&ge(e[0])?Object.assign(i,e[0]):i.args=[...e],i.message&&(i.args.unshift(i.message),delete i.message),i.additional&&(Array.isArray(i.additional)||(i.additional=i.additional.split(`
`)),i.args.push(`
`+i.additional.join(`
`)),delete i.additional),i.type=typeof i.type=="string"?i.type.toLowerCase():"log",i.tag=typeof i.tag=="string"?i.tag:"";const n=(l=!1)=>{const f=(this._lastLog.count||0)-this.options.throttleMin;if(this._lastLog.object&&f>0){const u=[...this._lastLog.object.args];f>1&&u.push(`(repeated ${f} times)`),this._log({...this._lastLog.object,args:u}),this._lastLog.count=1}l&&(this._lastLog.object=i,this._log(i))};clearTimeout(this._lastLog.timeout);const a=this._lastLog.time&&i.date?i.date.getTime()-this._lastLog.time.getTime():0;if(this._lastLog.time=i.date,a<this.options.throttle)try{const l=JSON.stringify([i.type,i.tag,i.args]),f=this._lastLog.serialized===l;if(this._lastLog.serialized=l,f&&(this._lastLog.count=(this._lastLog.count||0)+1,this._lastLog.count>this.options.throttleMin)){this._lastLog.timeout=setTimeout(n,this.options.throttle);return}}catch{}n(!0)}_log(t){for(const e of this.options.reporters)e.log(t,{options:this.options})}}function ct(s,t={},e=3){return s===void 0?e:typeof s=="number"?s:t[s]&&t[s].level!==void 0?t[s].level:e}b.prototype.add=b.prototype.addReporter;b.prototype.remove=b.prototype.removeReporter;b.prototype.clear=b.prototype.removeReporter;b.prototype.withScope=b.prototype.withTag;b.prototype.mock=b.prototype.mockTypes;b.prototype.pause=b.prototype.pauseLogs;b.prototype.resume=b.prototype.resumeLogs;function ye(s={}){return new b(s)}class Ee{constructor(t){c(this,"options");c(this,"defaultColor");c(this,"levelColorMap");c(this,"typeColorMap");this.options={...t},this.defaultColor="#7f8c8d",this.levelColorMap={0:"#c0392b",1:"#f39c12",3:"#00BCD4"},this.typeColorMap={success:"#2ecc71"}}_getLogFn(t){return t<1?console.__error||console.error:t===1?console.__warn||console.warn:console.__log||console.log}log(t){const e=this._getLogFn(t.level),o=t.type==="log"?"":t.type,i=t.tag||"",a=`
      background: ${this.typeColorMap[t.type]||this.levelColorMap[t.level]||this.defaultColor};
      border-radius: 0.5em;
      color: white;
      font-weight: bold;
      padding: 2px 0.5em;
    `,l=`%c${[i,o].filter(Boolean).join(":")}`;typeof t.args[0]=="string"?e(`${l}%c ${t.args[0]}`,a,"",...t.args.slice(1)):e(l,a,...t.args)}}function we(s={}){return ye({reporters:s.reporters||[new Ee({})],prompt(e,o={}){return o.type==="confirm"?Promise.resolve(confirm(e)):Promise.resolve(prompt(e))},...s})}const Se=we(),J=Se.withTag("webPaint"),Te=J.withTag("workerManager");J.withTag("display");const Dt=J.withTag("worker");Dt.withTag("main");Dt.withTag("display");async function Ie(s,t,e){var o;switch(e.type){case w.INIT:s.options.debug&&J.withTag("Incoming").withTag("action").withTag(w.INIT).success(e);break;case w.SYNC_STATE:t.setState(e.payload);break;case w.UPDATE_BUFFER:console.log("[WorkerManager] BOOOOM",e);break;case w.RESIZE_CANVAS_SUCCESS:{const i=e.payload;(o=t.currentDocument)==null||o.setDimension(i.dimension)}break;default:s.options.debug&&J.withTag("Incoming").withTag("main").withTag("action").warn("Action not handled in WorkerManager:",e);break}}async function ve(s,t,e,o){switch(o.type){case w.INIT_SUCCESS:s.config.get(M.WEB_PAINT_FIT_IMAGE)?e.actions.fitZoom():e.actions.setPosition(p(0,0));break;case w.SET_ZOOM_SUCCESS:{const{currentZoomLevel:i}=o.payload;e.setCurrentZoomLevel(i),o.payload&&"position"in o.payload&&(e.options.position=p(o.payload.position.x,o.payload.position.y))}break;default:s.options.debug&&J.withTag("Incoming").withTag("display").withTag("action").warn("Action not handled in WorkerManager:",o);break}}const Ce=[{validator:()=>!0,handler:()=>s=>s.pipe(O(t=>t))}];class W{constructor(t,e){c(this,"validator");c(this,"handler");this.validator=t,this.handler=e}}const De=(s=[])=>[...s,...Ce],_e=[{validator:()=>!0,handler:()=>s=>s.pipe(O(t=>t))}],be=(s=[])=>[...s,..._e],_t={[Object.prototype.constructor.name]:s=>t=>t.pipe(O(Object.entries),Z(s),O(Object.fromEntries)),[Array.prototype.constructor.name]:s=>t=>t.pipe(Zt(),Z(s),Xt()),[Promise.prototype.constructor.name]:s=>t=>t.pipe(lt(e=>qt(e)),Z(s)),[Jt.prototype.constructor.name]:s=>t=>t.pipe(lt(e=>e),Z(s)),[void 0]:()=>s=>s};function Oe(s=[]){return t=>t.pipe(Z(De(s)))}function Pe(s=[]){return t=>t.pipe(Z(be(s)))}function Z(s){return t=>t.pipe(jt(e=>{const o=Ne(e),i=o&&_t[o];return i?et(e).pipe(i(s)):et(e)}),ke(s))}function Ne(s){if(s==null)return;const t=s.constructor;if(t){const e=t.name;if(Object.prototype.hasOwnProperty.call(_t,e))return e}}function ke(s){return t=>t.pipe(lt(e=>et(e).pipe(Le(s,e).handler())))}const Le=(s,t)=>{const e=s.find(({validator:o})=>o(t));return e||{validator:()=>!0,handler:o=>o}};var bt=(s=>(s.FILLED="filled",s.STROKED="stroked",s.STROKED_FILLED="stroked_filled",s))(bt||{}),R=(s=>(s.CIRCLE="circle",s.SQUARE="square",s.DOTS="dots",s))(R||{}),r=(s=>(s.NONE="none",s.DOTTED_FREEHAND="dotted_freehand",s.CONTINUOUS_FREEHAND="continuous_freehand",s.STRAIGHT_LINE="straight_line",s.CURVE_LINE="curve_line",s.FILL_TOOL="fill_tool",s.AIR_BRUSH="airbrush",s.RECTANGLE="rectangle",s.CIRCLE="circle",s.ELLIPSE="ellipse",s.POLYGON="polygon",s.CROP="crop",s.TEXT="text",s.SPLIT_SCREEN="splitScreen",s.MAGNIFY="magnify",s.ZOOM="zoom",s.STACK_REDO="stack_redo",s.STACK_UNDO="stack_undo",s.CLEAR="clear",s.ZOOM_FIT="zoom_fit",s.COLOR_PICKER="color_picker",s.IMAGE_OPERATION="image_operation",s))(r||{});class Ue{constructor(t){this.display=t}useTool(t,{domEvents:e}){switch(this.display.app.options.select.tool.value){case r.ZOOM:{const i=this.display.app.options.zoomStep,n=1+(e.shiftLeftActive?-i:i);this.setZoom(t,n)}}}setPosition(t){return this.display.options.position=t,this.display.action({type:w.SET_POSITION,payload:{position:t}})}setZoom(t=p(0,0),e){return this.display.options.zoomLevel=e,this.display.action({type:w.SET_ZOOM,payload:{zoomLevel:e,position:t}})}colorPicker(t){return this.display.action({type:w.COLOR_PICKER,payload:{position:t}})}async fitZoom(){const t=this.display;await t.actions.setPosition(p(0,0)),await t.actions.setZoom(p(0,0),0),await t.action({type:w.ZOOM_FIT,payload:{}})}async setOptions(){const t=this.display;await t.action({type:w.SET_OPTIONS,payload:{options:t.options}})}}p(-1,-1),p(0,-1),p(1,-1),p(-1,0),p(0,0),p(1,0),p(-1,1),p(0,1),p(1,1);class st{constructor(t){c(this,"origin");c(this,"position");c(this,"colors");c(this,"zoomLevel");c(this,"precision");const{origin:e,position:o,colors:i,zoomLevel:n}=t||{};this.origin=e||"center",this.position=o?p(o.x,o.y):p(0,0),this.colors={background:i!=null&&i.background?new g(i.background):new g(0,0,0),foreground:i!=null&&i.foreground?new g(i.foreground):new g(255,255,255),grid:i!=null&&i.grid?new g(i.grid):new g(0,0,0,.2)},this.zoomLevel=n||1,this.precision=3}toJSON(){return{_type:this.constructor.name,origin:this.origin,position:this.position.toJSON(),colors:{background:this.colors.background.toJSON(),foreground:this.colors.foreground.toJSON(),grid:this.colors.grid.toJSON()},zoomLevel:this.zoomLevel,precision:this.precision}}}class Be{constructor(t,e={}){c(this,"id",crypto.randomUUID());c(this,"actions");c(this,"app");c(this,"worker");c(this,"options");c(this,"currentZoomLevel",1);this.app=t,this.options=new st(e),this.actions=new Ue(this)}setWorker(t){this.worker=t}setCurrentZoomLevel(t){this.options.zoomLevel=t}action(t,e){return this.app.workerManager.action(t,e,this.worker)}setColors(t){this.options.colors={background:new g(t.background),foreground:new g(t.foreground),grid:new g(t.grid)},this.actions.setOptions()}}class F{constructor(t){c(this,"id");c(this,"color");const{id:e,color:o}=t||{};this.id=e||crypto.randomUUID(),this.color=o?new g(o):new g(0,0,0)}setColor(t){this.color=t}equal(t){return this.id===(t==null?void 0:t.id)}toJSON(){return{_type:this.constructor.name,id:this.id,color:this.color.toJSON()}}}class ot{constructor(t){c(this,"id");c(this,"name");c(this,"description");c(this,"colors");c(this,"locked");const{id:e,name:o,description:i,colors:n,locked:a}=t||{};this.id=e||crypto.randomUUID(),this.name=o||"",this.description=i,this.colors=(n||[]).map(l=>new F(l)),this.locked=a}toJSON(){return{_type:this.constructor.name,id:this.id,name:this.name,description:this.description,colors:this.colors.map(t=>t.toJSON()),locked:this.locked}}}const Re=[new W(s=>s&&s instanceof Gt,()=>s=>s.pipe(O(t=>t.toJSON()))),new W(s=>s&&s instanceof st,()=>s=>s.pipe(O(t=>t.toJSON()))),new W(s=>s&&s instanceof g,()=>s=>s.pipe(O(t=>t.toJSON()))),new W(s=>s&&s instanceof F,()=>s=>s.pipe(O(t=>t.toJSON()))),new W(s=>s&&s instanceof ot,()=>s=>s.pipe(O(t=>t.toJSON())))],Me=[new W(s=>typeof s=="object"&&"x"in s&&"y"in s,()=>s=>s.pipe(O(t=>p(t.x,t.y)))),new W(s=>s&&st.prototype.constructor.name===s._type,()=>s=>s.pipe(O(t=>new st(t)))),new W(s=>s&&g.prototype.constructor.name===s._type,()=>s=>s.pipe(O(t=>new g(t)))),new W(s=>s&&F.prototype.constructor.name===s._type,()=>s=>s.pipe(O(t=>new F(t)))),new W(s=>s&&ot.prototype.constructor.name===s._type,()=>s=>s.pipe(O(t=>new ot(t))))];function xe(){return s=>s.pipe(Oe(Re))}function Et(){return s=>s.pipe(Pe(Me))}class Fe{constructor(t,e,o={debug:!1}){c(this,"subscription",new vt);c(this,"readyResolver",Promise.withResolvers());c(this,"mainWorker",null);c(this,"displayWorkers",[]);c(this,"resolveMap",new Map);this.app=t,this.config=e,this.options=o}async setup(){var o;const t=new Worker(new URL(""+new URL("main-HUaDuyhP.js",import.meta.url).href,import.meta.url),{type:"module"});this.mainWorker=t;const e={type:w.INIT,payload:{debug:this.options.debug}};(o=this.subscription)==null||o.add(mt(this.mainWorker,"message").pipe(O(i=>i.data),Et()).subscribe(i=>{this.onMessageMainWorker(i)})),await this.action(e),this.readyResolver.resolve()}get ready(){return this.readyResolver.promise}destroy(){var t;(t=this.subscription)==null||t.unsubscribe(),this.mainWorker&&(this.mainWorker.terminate(),this.mainWorker=null),this.displayWorkers.forEach(e=>e.terminate()),this.displayWorkers=[]}addDisplay(t,e){return new Promise(o=>{var n;const i=new Worker(new URL(""+new URL("display-zemnJUhE.js",import.meta.url).href,import.meta.url),{type:"module"});if(t.setWorker(i),(n=this.subscription)==null||n.add(mt(i,"message").pipe(O(a=>a.data),Et()).subscribe(a=>this.onMessageDisplayWorker(a,t))),this.displayWorkers.push(i),e){const a=e.transferControlToOffscreen(),l=new MessageChannel,f={type:w.INIT,payload:{debug:this.options.debug,options:t.options,canvas:a,port:l.port1}};if(this.mainWorker){const u={type:w.ADD_RENDER_WORKER_PORT,payload:{port:l.port2}};this.action(u,[l.port2]).then(()=>o())}this.action(f,[a,l.port1],i)}})}removeDisplay(t){var e;this.displayWorkers=this.displayWorkers.filter(o=>o!==t.worker),(e=t.worker)==null||e.terminate(),t.worker=void 0}async action(t,e,o=this.mainWorker){const i=crypto.randomUUID(),n=Promise.withResolvers();tt.set(i,n.resolve),this.options.debug&&Te.withTag("action").withTag(t.type).start(t,o);const a=await Yt(et({id:i,data:t}).pipe(xe()));return o.postMessage(a,e||[]),n.promise.then(l=>(tt.delete(i),l))}async onMessageMainWorker(t){var i;const{id:e,data:o}=t;await Ie(this,this.app,o),(i=tt.get(e))==null||i(o)}async onMessageDisplayWorker(t,e){var n;const{id:o,data:i}=t;await ve(this,this.app,e,i),(n=tt.get(o))==null||n(i)}}const tt=new Map;class ${constructor({name:t,meta:e,data:o}){c(this,"name");c(this,"meta");c(this,"data");this.name=t,this.meta=e,this.data=o||He(e.dimension.x,e.dimension.y)}setDimension(t){this.meta.dimension=t}destroy(){this.data.close()}}function He(s,t){const e=new OffscreenCanvas(s,t),o=e.getContext("2d");if(!o)throw new Error("Failed to get 2D context from OffscreenCanvas");return o.fillStyle="white",o.fillRect(0,0,s,t),e.transferToImageBitmap()}async function lo(s){const t=await $t(s),e={dimension:p(t.width,t.height)};return new $({name:"Untitled Document",meta:e,data:t.transferToImageBitmap()})}async function We(s){const t=await Kt(await createImageBitmap(s)),e={dimension:p(t.width,t.height)};return new $({name:s.name||"Untitled Document",meta:e,data:t.transferToImageBitmap()})}async function ze(s){const t=await te(s),e={dimension:p(t.width,t.height)};return new $({name:"Untitled Document",meta:e,data:t.transferToImageBitmap()})}function Qe(s,t){const e=new OffscreenCanvas(s,t),o=e.getContext("2d");if(!o)throw new Error("Failed to get 2D context from OffscreenCanvas");return o.fillStyle="white",o.fillRect(0,0,s,t),e.transferToImageBitmap()}function Ot(s=p(300,240)){return new $({name:"Blank Document",meta:{dimension:s},data:Qe(s.x,s.y)})}function Pt(){return{type:R.CIRCLE,size:5}}function Nt(){return{shapeStyle:bt.STROKED_FILLED,value:r.NONE,segmentLength:1,gapLength:0,interpolateSegments:!1,airBrushStrength:50,airBrushWeight:1}}function kt(){return{primaryColor:new F({color:new g(0,0,0)}),secondaryColor:new F({color:new g(255,0,0)}),palette:new ot({name:"Default Palette",colors:[new F({color:new g(0,0,0,0)}),new F({color:new g(0,0,0)}),new F({color:new g(255,0,0)}),new F({color:new g(0,255,0)}),new F({color:new g(0,0,255)})]}),paletteSteps:new g(4,1,1)}}function po(){return[{value:{type:R.CIRCLE,size:1},title:"Small Circle"},{value:{type:R.CIRCLE,size:3},title:"Medium Circle"},{value:{type:R.CIRCLE,size:5},title:"Large Circle"},{value:{type:R.CIRCLE,size:7},title:"Extra Large Circle"},{value:{type:R.SQUARE,size:5},title:"Extra Large Square"},{value:{type:R.SQUARE,size:4},title:"Large Square"},{value:{type:R.SQUARE,size:3},title:"Medium Square"},{value:{type:R.SQUARE,size:2},title:"Small Square"},{value:{type:R.DOTS,size:4},title:"Small Dots"},{value:{type:R.DOTS,size:8},title:"Medium Dots"}]}function uo({shiftActive:s,canRedo:t,canUndo:e}){return[{value:r.DOTTED_FREEHAND,title:"Dotted Freehand"},{value:r.CONTINUOUS_FREEHAND,title:"Continuous Freehand"},{value:r.STRAIGHT_LINE,title:"Straight Line"},{value:r.CURVE_LINE,title:"Curve"},{value:r.FILL_TOOL,title:"Fill Tool"},{value:r.AIR_BRUSH,title:"Air Brush"},{value:r.RECTANGLE,title:"Rectangle"},{value:r.CIRCLE,title:"Circle"},{value:r.ELLIPSE,title:"Ellipse"},{value:r.POLYGON,title:"Polygon"},{value:r.CROP,title:"Brush Selector"},{passive:!0,value:r.SPLIT_SCREEN,title:"Split Screen"},{value:r.COLOR_PICKER,title:"Color Picker",hotKey:{code:ie.KEY_I,title:"I"}},{passive:!0,value:r.ZOOM_FIT,title:"Fit to Screen"},{value:r.MAGNIFY,title:"Magnify"},{value:r.ZOOM,title:"Zoom"},...s?[{disabled:!t,value:r.STACK_REDO,passive:!0,title:"Redo"}]:[{disabled:!e,value:r.STACK_UNDO,passive:!0,title:"Undo"}],{value:r.CLEAR,passive:!0,title:"Clear"}]}var Y=(s=>(s.START="start",s.STOP="stop",s.FORWARD="forward",s.BACKWARD="backward",s))(Y||{});class Ge{constructor(t){this.app=t}startStack(){return this.app.workerManager.action({type:w.STACK,payload:{action:Y.START}})}stopStack(){return this.app.workerManager.action({type:w.STACK,payload:{action:Y.STOP}})}stackUndo(){return this.app.workerManager.action({type:w.STACK,payload:{action:Y.BACKWARD}})}stackRedo(){return this.app.workerManager.action({type:w.STACK,payload:{action:Y.FORWARD}})}setSelectOptions(t){return this.app.workerManager.action({type:w.SET_SELECT_OPTIONS,payload:t})}getData(t={}){return this.app.workerManager.action({type:w.GET_DATA,payload:t})}resize(t){return this.app.workerManager.action({type:w.RESIZE,payload:t})}resizeCanvas(t){return this.app.workerManager.action({type:w.RESIZE_CANVAS,payload:t})}async getColors(){return await this.app.workerManager.action({type:w.GET_COLORS,payload:{}})}}class Ve{constructor(t){c(this,"select");c(this,"display");c(this,"zoomStep");const{select:e,display:o,zoomStep:i}=t||{};this.select=e||{brush:Pt(),tool:Nt(),color:kt()},this.display=o||{colors:{background:new g(255,255,255),foreground:new g(0,0,0),grid:new g(0,0,0,.2)}},this.zoomStep=i||.2}}class je{constructor({options:t},e){c(this,"actions",new Ge(this));c(this,"state",{stackCount:0,stackIndex:-1,stackMaxSize:0});c(this,"workerManager");c(this,"currentDocument");c(this,"currentDisplay");c(this,"canvas");c(this,"options");c(this,"displays",[]);this.options=new Ve(t),this.workerManager=new Fe(this,e),this.setDisplay(this.addDisplay())}async setup(){await this.workerManager.setup(),this.setDocument(Ot())}closeDocument(){this.currentDocument=void 0}addDisplay(t){const e=new Be(this,{colors:this.options.display.colors,...t||{}});return this.displays.push(e),e}setDisplays(t){if(t<1||t>4)throw new Error("Display count must be between 1 and 4");const e=t-this.displays.length;for(let o=0;o<Math.abs(e);o++)e<0?this.removeDisplay(this.displays[this.displays.length-1]):this.addDisplay()}setDisplayColors(t){this.displays.forEach(e=>{e.setColors(t)})}get hasMaxDisplays(){return this.displays.length>=4}async setDisplayCanvas(t,e){await this.workerManager.addDisplay(t,e)}removeDisplayCanvas(t){this.workerManager.removeDisplay(t)}removeDisplay(t){this.workerManager.removeDisplay(t),this.displays=this.displays.filter(e=>e!==t)}removeDisplays(){return Promise.all(this.displays.map(t=>this.workerManager.removeDisplay(t)))}async setDocument(t){this.currentDocument&&this.currentDocument.destroy();const e=t.data;this.currentDocument=t;const o={type:w.LOAD_IMAGE,payload:{imageBitmap:e}};await this.workerManager.action(o,[e])}setDisplay(t){typeof t=="string"&&(t=this.displays.find(e=>e.id===t)),this.currentDisplay=t}actionDisplay(t,e,o){return this.workerManager.action(e,o,t.worker)}get ready(){return Promise.all([this.workerManager.ready])}setState(t){this.state={...this.state,...t}}setBrush(t){this.options.select.brush=t}setSelectOptions(t,e,o=!1){let i;o&&(i={...this.options.select[t],...e}),this.options.select={...this.options.select,[t]:i||e},this.actions.setSelectOptions(this.options.select)}setColor(t){this.options.select.color=t}setColorPalette(t){this.options.select.color.palette=t}async getImageData(){const{payload:t}=await this.actions.getData(),{buffer:e,dimension:o}=t,i=new Uint8ClampedArray(e.length);return i.set(e),new ImageData(i,o.x,o.y)}}const Ze=new ce({name:"Pastel Beige",colorOptions:{layout:{primary:"#F5F5DC",secondary:"#000000",tertiary:"#D2B48C",quaternary:"#6B4226",invert:{primary:"#6B4226",secondary:"#D2B48C",tertiary:"#000000",quaternary:"#F5F5DC"}},content:{primary:"#F5F5DC",secondary:"#000000",tertiary:"#D2B48C",quaternary:"#6B4226",invert:{primary:"#F5F5DC",secondary:"#6B4226",tertiary:"#000000",quaternary:"#F5F5DC"}}}});function Je(s){if(!s.colorOptions)throw new Error("Theme must have colorOptions defined");return s.extend({name:"Web Paint",colors:{disks:{webPaint:Lt(le(s.colorOptions))}}})}function Lt(s=["#FFF","#000","#FFAA55","#0055AA"]){return{originSelect:{background:s[2],foreground:s[0],selected:{background:s[1],foreground:s[0]}},colorSelect:{border:s[3],selcted:{border:s[0]},filled:{border:s[0],selected:{border:s[3]}}},iconButton:{background:s[1],foreground:s[0],hover:{background:s[1],foreground:s[0]},filled:{background:s[3],foreground:s[0],hover:{background:s[2],foreground:s[3]}}},sidebar:{background:{primary:s[2],secondary:s[0]},border:s[2],brushSelect:{background:s[0],item:{foreground:s[2],selected:{foreground:s[3]}}},toolSelect:{background:s[2],item:{background:s[0],foreground:s[3],selected:{background:s[2],foreground:s[3]}}},colorSelect:{background:"#000",item:{selected:{border:"#fff"}}}}}}const Xe=Ze.extend({name:"Web Painting",colors:{disks:{webPaint:Lt(["#F5F5DC","#6B4226","#D2B48C","#000000"])}}});class Ut{constructor({type:t,app:e,actions:o,domEvents:i,options:n}){c(this,"type");c(this,"app");c(this,"actions");c(this,"options");c(this,"domEvents");this.type=t,this.app=e,this.actions=o,this.options=n||{},this.domEvents=i}destroy(){}getDisplay(){return this.app.currentDisplay}action(t={},e){}}class P extends Ut{constructor({domEvents:e,interactingMove:o,...i}){super({...i});c(this,"interactingMove",!1);this.interactingMove=o??!0,this.domEvents=e}click(e,o){}async pointerDown(e){}async pointerUp(e){}pointerMove(e){}contextMenu(e){}pointerCancel(e){}cancel(e){}reset(e){e.ctx.clearRect(0,0,e.ctx.canvas.width,e.ctx.canvas.height)}action(e={},{event:{dimension:o,normalizedPosition:i}}){const n={...this.options,...e},a=this.app.workerManager,l=this.getDisplay();return a.action({type:w.USE_TOOL,payload:{tool:this.type,toolOptions:n,meta:{dimension:o,displayPosition:l.options.position,position:i,zoomLevel:l.options.zoomLevel}}})}}class Ye extends P{}class qe extends P{constructor(t){super({...t,type:r.ZOOM,options:{}})}async pointerUp({normalizedPosition:t}){var n;const e=this.getDisplay(),o=this.app.options.zoomStep,i=1+((n=this.domEvents)!=null&&n.shiftLeftActive?-o:o);e.options.zoomLevel=i,await e.action({type:w.SET_ZOOM,payload:{zoomLevel:i,position:t}})}}class $e extends P{constructor(e){super({...e,type:r.MAGNIFY,options:{}});c(this,"bounds");c(this,"startPosition");c(this,"color",new g(255,170,85,1))}async pointerUp({dimension:e,ctx:o,normalizePosition:i}){var _;if(o.clearRect(0,0,o.canvas.width,o.canvas.height),!this.startPosition||!this.bounds)return;const n=this.bounds,a=this.getDisplay(),l=p(()=>Math.abs(e/n.dimension*a.app.options.zoomStep));if(l.x===1/0||l.y===1/0)return;const f=i(p(()=>n.position+n.dimension/2)),u=1+((_=this.domEvents)!=null&&_.shiftLeftActive?-1:1)*Math.max(l.x,l.y);this.startPosition=void 0,await a.action({type:w.SET_ZOOM,payload:{zoomLevel:u,position:f}})}async pointerDown({position:e,ctx:o}){this.startPosition=e,o.beginPath()}pointerMove({position:e,ctx:o}){this.startPosition&&(o.clearRect(0,0,o.canvas.width,o.canvas.height),o.strokeStyle=`2px ${this.color.toHex()}`,o.lineWidth=2,this.bounds={position:this.startPosition,dimension:p(()=>e-this.startPosition)},o.strokeRect(this.bounds.position.x,this.bounds.position.y,this.bounds.dimension.x,this.bounds.dimension.y))}}class Ke extends P{constructor(t){super({...t,options:{...t.options,stackable:!0}})}pointerMove(t){super.pointerMove(t),this.action({},{event:t})}async pointerDown(t){await super.pointerDown(t),await this.app.actions.startStack(),this.action({},{event:t})}async pointerUp(t){await super.pointerUp(t),await this.app.actions.stopStack()}}class Bt extends Ke{constructor(e){var o;super({...e,type:e.type||r.DOTTED_FREEHAND,options:{...e.options,holdInterval:((o=e.options)==null?void 0:o.holdInterval)||20}});c(this,"timer");c(this,"canPressHold");c(this,"holdEvent");this.canPressHold=!1}async pointerDown(e){if(await super.pointerDown(e),this.canPressHold){if(!this.options.holdInterval)throw new Error("Hold interval must be defined for DottedFreehand tool.");this.timer=Ct(0,this.options.holdInterval).subscribe(()=>{this.pointerMove({...e,...this.holdEvent})})}}pointerMove(e){this.canPressHold&&(this.holdEvent=e),super.pointerMove(e)}async pointerUp(e){return this.timer&&(this.timer.unsubscribe(),this.timer=void 0,this.holdEvent=void 0),super.pointerUp(e)}}class ts extends Bt{constructor(t){super({...t,type:r.CONTINUOUS_FREEHAND,options:{lastPosition:p(0,0)}})}async pointerDown(t){this.options.lastPosition=t.normalizedPosition,await super.pointerDown(t)}pointerMove(t){super.pointerMove(t),this.options.lastPosition=t.normalizedPosition}async pointerUp(t){return this.options.lastPosition=t.normalizedPosition,super.pointerUp(t)}}class es extends P{constructor(e){var o;super({...e,type:r.AIR_BRUSH,options:{...e.options,stackable:!0,holdInterval:((o=e.options)==null?void 0:o.holdInterval)||10,round:!0}});c(this,"timer");c(this,"holdEvent")}pointerMove(e){super.pointerMove(e),this.holdEvent=e,this.action(this.options,{event:e})}async pointerDown(e){if(await super.pointerDown(e),await this.app.actions.startStack(),!this.options.holdInterval)throw new Error("Hold interval must be defined for DottedFreehand tool.");this.timer=Ct(0,this.options.holdInterval).subscribe(()=>{this.pointerMove({...e,...this.holdEvent})})}async pointerUp(e){this.timer&&(this.timer.unsubscribe(),this.timer=void 0,this.holdEvent=void 0),await super.pointerUp(e),await this.app.actions.stopStack()}}class ss{constructor(t){c(this,"dimension",p(11,11));c(this,"position",p(0,0));c(this,"intersectMap");c(this,"selected",!1);this.position=p(t.x,t.y)}intersect(t){const e=t.x<this.position.x+this.dimension.x&&t.x+this.dimension.x>this.position.x,o=t.y<this.position.y+this.dimension.y&&t.y+this.dimension.y>this.position.y;return e&&o}}var H=(s=>(s.START="start",s.MOVE="move",s.STOP="stop",s))(H||{});class ut extends P{constructor(e){super({...e,options:{...e.options,stackable:!0}});c(this,"startEvent");c(this,"selectedAnchor");c(this,"anchors");this.selectedAnchor=void 0,this.anchors=[]}async pointerDown(e){await super.pointerDown(e),this.startEvent=e}cancel(e){super.cancel(e),this.reset(e)}drawAnchors(e,o={stroke:!0}){this.anchors.forEach(i=>{this.drawAnchor(e,i,o)})}drawAnchor(e,o,{stroke:i}={stroke:!0}){e.ctx.lineWidth=1,e.ctx.fillStyle=this.app.options.select.color.secondaryColor.color.toHex(),(o===this.selectedAnchor||!i)&&(e.ctx.fillStyle=this.app.options.select.color.primaryColor.color.toInverted().toHex()),e.ctx.strokeStyle=this.app.options.select.color.primaryColor.color.toHex();const n=p(()=>Math.round(o.position-o.dimension/2));e.ctx.fillRect(n.x,n.y,o.dimension.x,o.dimension.y),e.ctx.strokeRect(n.x,n.y,o.dimension.x,o.dimension.y)}getAnchorByPosition(e){return this.anchors.find(o=>o.intersect(e)?o:!1)}addAnchor(e){const o=new ss(e);return this.anchors.push(o),o}reset(e){super.reset(e),this.anchors=[],this.selectedAnchor=void 0}}class os extends ut{constructor(e){super({...e,type:r.STRAIGHT_LINE});c(this,"lineWidth",2);c(this,"started",!1)}async pointerDown(e){if(await super.pointerDown(e),this.selectedAnchor){const o=this.getAnchorByPosition(e.position);o?this.selectedAnchor=o:(await this.app.actions.startStack(),await this.action({state:H.STOP,anchorDimension:e.normalizeDimension(this.anchors[0].dimension),anchorPositions:this.anchors.map(i=>e.normalizePosition(i.position))},{event:e}),await this.app.actions.stopStack(),this.reset(e))}else this.action({state:H.START,stackable:!1},{event:e}),this.started=!0;this.render(e)}async pointerMove(e){var o;this.started&&(await super.pointerMove(e),(o=this.domEvents)!=null&&o.pointerActive&&(this.anchors.length<1&&(this.addAnchor(e.position),this.selectedAnchor=this.addAnchor(e.position)),this.selectedAnchor&&(this.selectedAnchor.position=e.position),this.render(e),this.action({stackable:!1,state:H.MOVE,anchorDimension:e.normalizeDimension(this.anchors[0].dimension),anchorPositions:this.anchors.map(i=>e.normalizePosition(i.position))},{event:e})))}reset(e){super.reset(e),this.started=!1}render(e){e.ctx.clearRect(0,0,e.ctx.canvas.width,e.ctx.canvas.height),this.anchors.length>1&&this.drawAnchors(e)}}class is extends ut{constructor(e){super({...e,type:r.CURVE_LINE});c(this,"lineWidth",2);c(this,"started",!1);c(this,"primaryHelperOffset");c(this,"secondaryHelperOffset")}async pointerUp(e){await super.pointerUp(e),this.anchors.length>1&&this.anchors.length!==4&&this.createHelpers(e),this.selectedAnchor=void 0}async pointerDown(e){await super.pointerDown(e);const o=this.getAnchorByPosition(e.position);if(o&&this.selectedAnchor!==o)this.selectedAnchor=o;else if(this.anchors.length===4&&!o){await this.app.actions.startStack(),await this.action({state:H.STOP,anchorDimension:e.normalizeDimension(this.anchors[0].dimension),anchorPositions:this.anchors.map(i=>e.normalizePosition(i.position))},{event:e}),await this.app.actions.stopStack(),this.reset(e);return}else this.anchors.length>1&&this.anchors.length!==4?this.createHelpers(e):this.selectedAnchor||(this.addAnchor(e.position),this.selectedAnchor=this.addAnchor(e.position),this.action({state:H.START,stackable:!1},{event:e}),this.started=!0);this.render(e)}async pointerMove(e){var o;if(this.started&&(await super.pointerMove(e),(o=this.domEvents)!=null&&o.pointerActive)){if(this.anchors.length<2&&(this.addAnchor(e.position),this.selectedAnchor=this.addAnchor(e.position)),this.selectedAnchor){let i=e.position;i=e.position,this.selectedAnchor.position=i,this.selectedAnchor===this.primaryAnchor&&this.primaryHelper?this.primaryHelper.position=this.primaryHelperOffset:this.selectedAnchor===this.secondaryAnchor&&this.secondaryHelper?this.secondaryHelper.position=p(()=>this.selectedAnchor.position+this.secondaryHelperOffset):(this.selectedAnchor===this.primaryHelper||this.selectedAnchor===this.secondaryHelper)&&this.refreshHelperOffset()}this.render(e),this.action({state:H.MOVE,stackable:!1,anchorDimension:e.normalizeDimension(this.anchors[0].dimension),anchorPositions:this.anchors.map(i=>e.normalizePosition(i.position))},{event:e})}}reset(e){super.reset(e),this.started=!1,this.primaryHelperOffset=void 0,this.secondaryHelperOffset=void 0}get primaryAnchor(){return this.anchors[0]}get secondaryAnchor(){return this.anchors[1]}get primaryHelper(){return this.anchors[2]}get secondaryHelper(){return this.anchors[3]}refreshHelperOffset(){this.primaryHelper&&(this.primaryHelperOffset=p(()=>this.primaryHelper.position-this.primaryAnchor.position)),this.secondaryHelper&&(this.secondaryHelperOffset=p(()=>this.secondaryHelper.position-this.secondaryAnchor.position))}createHelpers(e){let o=wt(this.primaryAnchor,this.secondaryAnchor);this.addAnchor(p(o[0],o[1])),o=wt(this.secondaryAnchor,this.primaryAnchor),this.addAnchor(p(o[0],o[1])),this.refreshHelperOffset(),this.render(e)}render(e){if(e.ctx.clearRect(0,0,e.ctx.canvas.width,e.ctx.canvas.height),this.anchors.length>1){const o=new Path2D;this.anchors.length>2?(o.moveTo(this.primaryAnchor.position.x,this.primaryAnchor.position.y),o.bezierCurveTo(this.primaryHelper.position.x,this.primaryHelper.position.y,this.secondaryHelper.position.x,this.secondaryHelper.position.y,this.secondaryAnchor.position.x,this.secondaryAnchor.position.y)):(o.moveTo(this.primaryAnchor.position.x,this.primaryAnchor.position.y),o.lineTo(this.secondaryAnchor.position.x,this.secondaryAnchor.position.y)),e.ctx.strokeStyle=this.app.options.select.color.primaryColor.color.toInverted().toHex(),e.ctx.lineWidth=this.lineWidth,e.ctx.stroke(o)}this.drawAnchors(e,{stroke:!1})}}function wt(s,t){const e=ns(Math.round(s.position.x),Math.round(s.position.y),Math.round(t.position.x),Math.round(t.position.y));return e[Math.floor(e.length/4)]}function ns(s,t,e,o,i=0){const n=Math.abs(e-s),a=s<e?1:-1,l=Math.abs(o-t),f=t<o?1:-1;let u=(n>l?n:-l)/2;const _=[];let E=0;for(;i===0||E>=1?(_.push([s,t]),E=0):E+=1/i,!(s===e&&t===o);){const N=u;N>-n&&(u-=l,s+=a),N<l&&(u+=n,t+=f)}return _}class rs extends P{constructor(e){super({...e,type:r.RECTANGLE,options:{...e.options,position:p(0,0),dimension:p(0,0)}});c(this,"startEvent");c(this,"bounds",{position:p(0,0),dimension:p(0,0)})}async pointerUp(e){const{normalizePosition:o,normalizeDimension:i}=e;if(!this.startEvent)return;const n=this.bounds;this.startEvent=void 0,await this.app.actions.startStack(),await this.action({state:"STOP",position:o(n.position),dimension:i(n.dimension)},{event:e}),await this.app.actions.stopStack(),this.reset(e)}async pointerDown(e){await super.pointerDown(e),this.startEvent=e;const{ctx:o,normalizePosition:i,normalizeDimension:n}=e;o.beginPath(),this.action({state:"START",stackable:!1,position:i(this.bounds.position),dimension:n(this.bounds.dimension)},{event:e})}pointerMove(e){const{position:o,normalizePosition:i,normalizeDimension:n}=e;this.startEvent&&(this.bounds={position:this.startEvent.position,dimension:p(()=>o-this.startEvent.position)},this.action({state:"MOVE",stackable:!1,position:i(this.bounds.position),dimension:n(this.bounds.dimension)},{event:e}))}reset(e){super.reset(e);const{ctx:o}=e;o.clearRect(0,0,o.canvas.width,o.canvas.height)}}class as extends P{constructor(t){super({...t,type:r.STACK_REDO,options:{}})}click(t,e){super.click(t,e),this.app.actions.stackRedo()}}class cs extends P{constructor(t){super({...t,type:r.STACK_UNDO,options:{}})}click(t,e){super.click(t,e),this.app.actions.stackUndo()}}class ls extends P{constructor(t){super({...t,type:r.CLEAR,options:{stackable:!0,passive:!0}})}async click(t,e){super.click(t,e),await this.app.actions.startStack(),await this.app.workerManager.action({type:w.USE_TOOL,payload:{tool:this.type,toolOptions:this.options}}),await this.app.actions.stopStack()}}class Rt extends P{constructor(e){super({...e,type:r.ELLIPSE,options:{...e.options,position:p(0,0),dimension:p(0,0)}});c(this,"bounds",{position:p(0,0),dimension:p(0,0)});c(this,"startEvent");c(this,"actionTimeout")}async pointerUp(e){const{normalizePosition:o,normalizeDimension:i}=e;if(!this.startEvent)return;const n=this.bounds;this.startEvent=void 0,await this.app.actions.startStack(),await this.action({state:"STOP",position:o(n.position),dimension:i(n.dimension)},{event:e}),await this.app.actions.stopStack(),this.reset(e)}async pointerDown(e){this.startEvent=e;const{ctx:o,normalizePosition:i,normalizeDimension:n}=e;o.beginPath(),this.action({state:"START",stackable:!1,position:i(this.bounds.position),dimension:n(this.bounds.dimension)},{event:e})}pointerMove(e){const{position:o,normalizePosition:i,normalizeDimension:n}=e;if(!this.startEvent)return;let a=p(()=>o-this.startEvent.position);this.options.square&&(a=p(a.x,Math.abs(a.x)*(a.y<0?-1:1))),this.bounds={position:this.startEvent.position,dimension:a},window.clearTimeout(this.actionTimeout),this.actionTimeout=window.setTimeout(()=>{this.action({state:"MOVE",stackable:!1,position:i(this.bounds.position),dimension:n(this.bounds.dimension)},{event:e})},1e3/60)}reset(e){super.reset(e);const{ctx:o}=e;o.clearRect(0,0,o.canvas.width,o.canvas.height)}}class ps extends Rt{constructor(t){super({...t,type:r.CIRCLE,options:{...t.options,square:!0}})}}class us extends ut{constructor(e){var o;super({...e,type:r.POLYGON});c(this,"lineWidth",2);c(this,"subscription",new vt);c(this,"started",!1);c(this,"preComplete",!1);c(this,"complete",!1);this.subscription.add((o=this.domEvents)==null?void 0:o.keyDown.subscribe(async i=>{this.startEvent&&(i.key===ft.BACKSPACE||i.key===ft.DELETE)&&(this.anchors=this.anchors.filter(n=>n!==this.selectedAnchor),this.render(this.startEvent))}))}destroy(){super.destroy(),this.subscription.unsubscribe()}async pointerDown(e){await super.pointerDown(e);const o=this.getAnchorByPosition(e.position);this.selectedAnchor?o?o!==this.selectedAnchor?(this.preComplete=!1,this.selectedAnchor=o):this.preComplete?(this.complete=!0,this.selectedAnchor=void 0,await this.app.actions.startStack(),await this.action({state:H.STOP,anchorDimension:e.normalizeDimension(this.anchors[0].dimension),anchorPositions:this.anchors.map(i=>e.normalizePosition(i.position)),complete:!0},{event:e}),await this.app.actions.stopStack(),this.reset(e)):o===o&&(this.preComplete=!0):this.complete||(this.selectedAnchor=this.addAnchor(e.position),this.action({stackable:!1,state:H.MOVE,anchorDimension:e.normalizeDimension(this.anchors[0].dimension),anchorPositions:this.anchors.map(i=>e.normalizePosition(i.position))},{event:e})):o?(this.preComplete=!1,this.selectedAnchor=o):(this.action({state:H.START,stackable:!1},{event:e}),this.selectedAnchor=this.addAnchor(e.position),this.started=!0),this.render(e)}async pointerMove(e){var o;this.started&&(await super.pointerMove(e),(o=this.domEvents)!=null&&o.pointerActive&&(this.selectedAnchor&&(this.selectedAnchor.position=e.position),this.render(e),this.action({stackable:!1,state:H.MOVE,anchorDimension:e.normalizeDimension(this.anchors[0].dimension),anchorPositions:this.anchors.map(i=>e.normalizePosition(i.position))},{event:e})))}reset(e){super.reset(e),this.started=!1,this.complete=!1,this.preComplete=!1}render(e){this.anchors.forEach(o=>{o.selected=this.selectedAnchor===o}),e.ctx.clearRect(0,0,e.ctx.canvas.width,e.ctx.canvas.height),this.drawAnchors(e,{stroke:!this.preComplete})}}class hs extends P{constructor(t){super({...t,type:r.FILL_TOOL,options:{...t.options,stackable:!0}})}async pointerDown(t){await super.pointerDown(t),await this.app.actions.startStack(),await this.action({},{event:t}),await this.app.actions.stopStack()}}function ds(s,t){const e=p(()=>Math.min(t.dimension,0)),o=p(()=>Math.round(t.position+e));return s.x>=o.x&&s.x<=o.x+Math.abs(t.dimension.x)&&s.y>=o.y&&s.y<=o.y+Math.abs(t.dimension.y)}class ms extends P{constructor(e){super({...e,type:r.CROP,options:{...e.options,stackable:!0}});c(this,"bounds");c(this,"color",new g(255,0,0,255));c(this,"moving",!1);c(this,"startEvent");c(this,"lastEvent");c(this,"moveOffset")}async pointerDown(e){const o=this.bounds&&ds(e.position,this.bounds)||!1;this.moving&&this.bounds&&!o?(await this.app.actions.startStack(),this.action({state:"STOP",stackable:!0},{event:e}),await this.app.actions.stopStack(),this.reset(e)):this.bounds&&!this.moving&&o&&(this.moving=!0,this.action({state:"START",stackable:!1},{event:e})),this.moving?this.moveOffset=p(()=>e.position-this.bounds.position):(this.startEvent=e,this.lastEvent=void 0,await super.pointerDown(e)),this.render(e)}action(e,{event:o}){var a;const i=p(()=>Math.min(this.bounds.dimension,0)),n=p(()=>this.bounds.position+i);return super.action({position:o.normalizePosition(n),dimension:o.normalizeDimension(p(()=>Math.abs(this.bounds.dimension))),copy:((a=this.domEvents)==null?void 0:a.shiftActive)||!1,...e},{event:o})}pointerMove(e){this.startEvent&&(this.moving?this.bounds.position=e.unnormalizePosition(e.fixedPosition(p(()=>e.position-this.moveOffset))):(this.bounds={position:e.unnormalizePosition(e.fixedPosition(this.startEvent.position)),dimension:e.unnormalizeDimension(e.fixedDimension(p(()=>e.position-this.startEvent.position)))},this.lastEvent=e),this.render(e),this.action({state:"MOVE",stackable:!1},{event:e}))}render(e){if(!this.bounds)return;const o=e.ctx;o.clearRect(0,0,o.canvas.width,o.canvas.height),o.strokeStyle=`dotted ${this.color.toHex()}`,o.lineWidth=1,o.setLineDash([6]),o.strokeRect(this.bounds.position.x,this.bounds.position.y,this.bounds.dimension.x,this.bounds.dimension.y)}reset(e){super.reset(e),this.bounds=void 0,this.moving=!1,this.startEvent=void 0,this.lastEvent=void 0,this.moveOffset=void 0}}class fs extends P{constructor(e){super({...e,interactingMove:!1,type:r.COLOR_PICKER,options:{}});c(this,"lastColor")}async pointerDown(e){await super.pointerDown(e),this.lastColor&&this.app.options.select.color.primaryColor.setColor(this.lastColor)}async pointerMove(e){if(this.getDisplay()){const{payload:i}=await this.action({},{event:e}),n=e.ctx;n.clearRect(0,0,e.ctx.canvas.width,e.ctx.canvas.height);const{color:a,position:l}=i;i.color&&(this.lastColor=a,As(n,p(10,10),{color:a,position:l}))}}}function As(s,t,e){s.fillStyle="#000",s.fillRect(t.x,t.y,188,32),s.fillStyle=e.color.toHex(),s.fillRect(t.x+6,t.y+6,20,20),s.fillStyle="#fff";const o=10,i=p(()=>t+p(32,4+o));s.font=`${o}px "BitFontCanvas"`,s.fontKerning="normal",s.letterSpacing="0px",s.fillText(`Color   : ${e.color.toHex()}`,i.x,i.y),s.fillText(`Position: ${e.position.x},${e.position.y}`,i.x,i.y+o+4)}class gs extends P{constructor(t){super({...t,type:r.ZOOM,options:{passive:!0}})}async click(){const t=this.getDisplay();t&&(await t.actions.setPosition(p(0,0)),await t.actions.setZoom(p(0,0),0),await t.action({type:w.ZOOM_FIT,payload:{}}))}}class ys extends P{constructor(t){super({...t,type:r.SPLIT_SCREEN,options:{}})}async click(t,e){super.click(t,e);debugger;const{value:o}=await this.actions.prompt({type:"number",text:"Screen Count? (1-4)",value:1,min:1,max:4,size:1,step:1,required:!0});this.app.setDisplays(o)}}class Es extends Ut{constructor(t){super({...t,options:{...t.options,abstract:!0}})}async execute(t){this.options.stackable&&await this.app.actions.startStack(),await this.app.workerManager.action({type:w.USE_TOOL,payload:{tool:this.type,toolOptions:{...this.options,...t}}}),this.options.stackable&&await this.app.actions.stopStack()}action(t={}){const e={...this.options,...t};this.app.workerManager.action({type:w.USE_TOOL,payload:{tool:this.type,toolOptions:e}})}}class ws extends Es{constructor(t){super({...t,type:r.IMAGE_OPERATION,options:{stackable:!0}})}}const v={[r.NONE]:Ye,[r.ZOOM]:qe,[r.MAGNIFY]:$e,[r.CONTINUOUS_FREEHAND]:ts,[r.STRAIGHT_LINE]:os,[r.CURVE_LINE]:is,[r.DOTTED_FREEHAND]:Bt,[r.AIR_BRUSH]:es,[r.RECTANGLE]:rs,[r.CIRCLE]:ps,[r.ELLIPSE]:Rt,[r.POLYGON]:us,[r.STACK_REDO]:as,[r.STACK_UNDO]:cs,[r.FILL_TOOL]:hs,[r.CROP]:ms,[r.CLEAR]:ls,[r.ZOOM_FIT]:gs,[r.COLOR_PICKER]:fs,[r.SPLIT_SCREEN]:ys},Ss={[r.IMAGE_OPERATION]:ws};function Ts(s){switch(s){case r.IMAGE_OPERATION:return Ss[r.IMAGE_OPERATION];default:throw new Error(`Tool ${s} is not implemented.`)}}function ho(s){switch(s){case r.NONE:return v[r.NONE];case r.ZOOM:return v[r.ZOOM];case r.MAGNIFY:return v[r.MAGNIFY];case r.CONTINUOUS_FREEHAND:return v[r.CONTINUOUS_FREEHAND];case r.DOTTED_FREEHAND:return v[r.DOTTED_FREEHAND];case r.STRAIGHT_LINE:return v[r.STRAIGHT_LINE];case r.CURVE_LINE:return v[r.CURVE_LINE];case r.AIR_BRUSH:return v[r.AIR_BRUSH];case r.RECTANGLE:return v[r.RECTANGLE];case r.CIRCLE:return v[r.CIRCLE];case r.ELLIPSE:return v[r.ELLIPSE];case r.POLYGON:return v[r.POLYGON];case r.FILL_TOOL:return v[r.FILL_TOOL];case r.CROP:return v[r.CROP];case r.STACK_REDO:return v[r.STACK_REDO];case r.STACK_UNDO:return v[r.STACK_UNDO];case r.CLEAR:return v[r.CLEAR];case r.ZOOM_FIT:return v[r.ZOOM_FIT];case r.COLOR_PICKER:return v[r.COLOR_PICKER];case r.SPLIT_SCREEN:return v[r.SPLIT_SCREEN];default:throw new Error(`Tool ${s} is not implemented.`)}}const Is=X(({core:s})=>{let t,e,o,i,n,a,l;return[{meta:[[S.SYMBOL,Q.WEB_PAINTING]],id:"WebPaint.app",name:"WebPaint",createdDate:new Date(2017,7,5).getTime(),editedDate:new Date(2025,5,29).getTime(),async action(){var ht,dt;if(!((ht=s.modules.screen)==null?void 0:ht.contentLayout))throw new Error("Content layout not found");const d=new je({options:{select:{brush:Pt(),tool:Nt(),color:kt()},display:{colors:{background:g.fromHex(s.config.get(M.WEB_PAINT_DISPLAY_BACKGROUND)),foreground:g.fromHex(s.config.get(M.WEB_PAINT_DISPLAY_FOREGROUND)),grid:g.fromHex(s.config.get(M.WEB_PAINT_DISPLAY_GRID_COLOR))}}}},s.config),y=it({fsItem:void 0,app:d,actions:xt(d)}),k=y.app;await k.setup(),k.workerManager.ready.then(async()=>{k.setDocument(Ot(p(256,256)))});const B=(dt=s.modules.windows)==null?void 0:dt.addWindow({component:await T(()=>import("./DGwTsC-U.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50]),import.meta.url).then(x=>x.default),componentData:{core:s,model:y},options:{title:"WebPaint - Extras 1.3",embed:!0,borderless:!0}},{group:"extras13WebPaint",full:!0});y.actions.setTheme(Xe),B==null||B.awaitClose().then(()=>{var x;[t,e,o,i,n].forEach(V=>V==null?void 0:V.close()),(x=s.modules.screen)==null||x.setTheme(void 0)});function xt(x){const V={setTheme:I=>{var j,L;s.config.get(M.WEB_PAINT_NATIVE_THEME)&&((j=s.modules.screen)!=null&&j.currentTheme)?s.modules.screen.setTheme(Je(s.modules.screen.currentTheme)):(L=s.modules.screen)==null||L.setTheme(I)},import:async I=>{x.setDocument(await We(I))},export:async I=>{const j=await T(()=>import("./CshrRwMP.js").then(L=>L.F),__vite__mapDeps([51,40]),import.meta.url).then(L=>L.default);try{const L=await x.getImageData();let K=await ee(L);I.resize&&(K=await se(K,I.resize.x,I.resize.y));const Ft=await K.convertToBlob({type:I.type,quality:I.quality}),Ht=I.type.split("/")[1]||"png",Wt=(I.filename||`webpainting_${Date.now()}`)+`.${Ht}`;await j.saveAs(Ft,Wt)}catch(L){console.error("An error occurred during export.",L)}},useAbstractTool:(I,j)=>{const L=Ts(I);if(!L)throw new Error(`Tool ${I} is not implemented`);return new L({app:x,actions:V}).execute(j)},openValueInput:I=>u(I),async prompt(I){return(await u(I)).awaitClose()},openInfo:()=>_(y),openSettings:()=>f(y),openExport:()=>z(y),close:()=>{B==null||B.close()},focus:()=>{B==null||B.focus()},newDocument:async()=>{y.fsItem=void 0,await x.setDocument(new $({name:"New Document",meta:{dimension:p(640,480)}}))},openDocument:async()=>{await Ds(s,y)},saveDocument:async()=>{await St(s,y)},saveAsDocument:async()=>{await St(s,y,!0)},documentResize:async I=>{await x.actions.resize(I)},documentResizeCanvas:async I=>{await x.actions.resizeCanvas(I)},openResize:()=>vs(s,y,!0),openResizeCanvas:()=>Cs(s,y,!0),openColorPalette:()=>E(s,y),openColorPicker:I=>N(I),openDebugColorPickers:()=>G(),openDebugColorPicker:()=>h()};return V}}}];async function f(m){var d;return o||(o=(d=s.modules.windows)==null?void 0:d.addWindow({component:await T(()=>import("./CnKnkMed.js"),__vite__mapDeps([52,23,2,24,53,54,55,56,57,58,25,1,3,4,26,59,60,61,62,8,15,14,16,13,17,18,29,30,31,32,33,34,35,36,7,37,38,39,28,40,41,42,21,22,43,44,45,46,47,12,48,49,63]),import.meta.url).then(y=>y.default),componentData:{model:m},options:{title:"Settings"}},{group:"extras13WebPaint"}),o==null||o.awaitClose().then(()=>{o=void 0}),o)}async function u(m){var d;return l||(l=(d=s.modules.windows)==null?void 0:d.addWindow({component:await T(()=>import("./B1s32xR9.js"),__vite__mapDeps([64,23,2,24,65,54,55,66,67]),import.meta.url).then(y=>y.default),componentData:{...m},options:{title:"Value Input",embed:!0,center:!0,borderless:!0,filled:!0}},{group:"extras13WebPaint"}),l==null||l.awaitClose().then(()=>{l=void 0}),l)}async function _(m){var d;return t||(t=(d=s.modules.windows)==null?void 0:d.addWindow({component:await T(()=>import("./6e4iIPTf.js"),__vite__mapDeps([68,69,1,2,3,4,70,71]),import.meta.url).then(y=>y.default),componentData:{model:m},options:{title:"Info"}},{group:"extras13WebPaint"}),t==null||t.awaitClose().then(()=>{t=void 0}),t)}async function E(m,d){return i||(i=m.modules.windows.addWindow({component:await T(()=>import("./CQaTPF_f.js"),__vite__mapDeps([72,2,23,24,59,60,61,62,73,54,55,74,25,1,3,4,26,19,12,8,7,20,14,16,13,17,21,15,18,10,22,29,30,31,32,33,34,35,36,37,38,39,28,40,41,42,43,44,45,46,47,48,49,75]),import.meta.url).then(y=>y.default),componentData:{core:m,model:d},options:{title:"Color Palette",filled:!0}},{group:"extras13WebPaint"}),i.awaitClose().then(()=>{i=void 0}),i)}async function N(m){return i||(i=s.modules.windows.addWindow({component:await T(()=>import("./D9pixoYF.js"),__vite__mapDeps([76,77,8,2,78,73,54,55,74,65,66,23,24,59,60,61,62,1,3,4,15,14,16,13,17,18,29,30,31,32,33,34,35,36,7,37,38,39,28,40,41,42,21,22,43,44,45,46,47,12,48,49,79]),import.meta.url).then(d=>d.default),componentData:{color:m},options:{title:"Color Picker",filled:!0}},{group:"extras13WebPaint"}),i.awaitClose().then(()=>{i=void 0}),i)}async function z(m){var d;return e||(e=(d=s.modules.windows)==null?void 0:d.addWindow({component:await T(()=>import("./k7DJIEn6.js"),__vite__mapDeps([80,8,23,2,24,65,54,55,66,73,74,59,60,61,62,81]),import.meta.url).then(y=>y.default),componentData:{model:m},options:{title:"Export"}},{group:"extras13WebPaint"}),e==null||e.awaitClose().then(()=>{e=void 0}),e)}async function G(){return n||(n=s.modules.windows.addWindow({component:await T(()=>import("./ClNqYWJq.js"),__vite__mapDeps([82,77,8,2,78,65,54,55,66,1,3,4,15,14,16,13,17,18,29,30,31,32,33,34,35,36,7,37,38,39,28,40,41,42,21,22,43,44,45,46,47,12,48,49,83]),import.meta.url).then(m=>m.default),componentData:{},options:{title:"Debug Color Pickers",scrollY:!0}},{group:"extras13WebPaint"}),n==null||n.awaitClose().then(()=>{n=void 0}),n)}async function h(){return a||(a=s.modules.windows.addWindow({component:await T(()=>import("./D9pixoYF.js"),__vite__mapDeps([76,77,8,2,78,73,54,55,74,65,66,23,24,59,60,61,62,1,3,4,15,14,16,13,17,18,29,30,31,32,33,34,35,36,7,37,38,39,28,40,41,42,21,22,43,44,45,46,47,12,48,49,79]),import.meta.url).then(m=>m.default),componentData:{},options:{title:"Debug Color Picker",filled:!0}},{group:"extras13WebPaint"}),a.awaitClose().then(()=>{a=void 0}),a)}});async function vs(s,t,e=!1){var i;const o=(i=s.modules.windows)==null?void 0:i.addWindow({component:await T(()=>import("./BxS9pqvC.js"),__vite__mapDeps([84,8,23,2,24,65,54,55,66,73,74,59,60,61,62,9,85]),import.meta.url).then(n=>n.default),componentData:{model:t},options:{title:"Document Resize"}},{group:"extras13WebPaint"});return e?o:o==null?void 0:o.awaitClose()}async function Cs(s,t,e=!1){var i;const o=(i=s.modules.windows)==null?void 0:i.addWindow({component:await T(()=>import("./C77FQkOd.js"),__vite__mapDeps([86,8,23,2,24,65,54,55,66,59,60,61,62,1,3,4,15,14,16,13,17,18,29,30,31,32,33,34,35,36,7,37,38,39,28,40,41,42,21,22,43,44,45,46,47,12,48,49,87]),import.meta.url).then(n=>n.default),componentData:{model:t},options:{title:"Document Resize Canvas"}},{group:"extras13WebPaint"});return e?o:o==null?void 0:o.awaitClose()}async function St(s,t,e=!1){const o=await t.app.getImageData(),i=await oe(o);console.log("Saving content:",i);let n=Object.assign({[q.OUTPUT_TYPE]:"image",[q.CONTENT]:i});n=await btoa(JSON.stringify(n));let a;return!e&&t.fsItem?(a=await ne(s,{path:t.fsItem.getPath(),data:n}),a?await s.executeCommand('openDialog "File saved."'):await s.executeCommand('openDialog "File could not be saved."'),a):(t.fsItem=await re(s,{data:n,extension:"img"}),t.fsItem)}async function Ds(s,t){const e=await s.executeCommand("openFileDialog");if(e)if(q.CONTENT in e.value)t.app.setDocument(await ze(await _s(e.value[q.CONTENT]))),t.fsItem=e.fsItem;else throw new Error("Can't read file content")}function _s(s){return new Promise(t=>{const e=new Image;e.src=s,e.onload=()=>t(e)})}const bs=""+new URL("pWAMfWPQ.jpg",import.meta.url).href,Os="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAQQAAAEGCAYAAACDwOsBAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAkTSURBVHgB7d1Bctw2FgZgaioHic8wuYCrrDM5O2/jM8kLHyBzBh9FU0qZr2RGEAESJAHw+zapSM1md0d5+PkAoh+m/j1PcB8P04H+MwH8dGi1OYmEwB0d8v+uhACEYRPC589/Tz35+vWPN3/+9PQ00Y7Hx8c3f37031vq72Oq/P+whAAEBQE68JJAEinkearYR1MQgPDbBB1KXcvX0mrvZk4Jb/QU5pSwq6cgIQBBQYAOHdVTUBCAoIfAUErXA7wzv9+F2j0FCQEICgIMoFZPQUEAgoIAA9mbFBQEICgIMKCtSUFBAIKCAAMrTQoKAhAUBLiB3KSgIADBvQxwI2v3PkgIQFAQgKAgAEFBAIKCAAQFAQgKAhAUBCAoCECwUpGh9L6L8tUkBCAoCEBQEICgh0CXWv125t5JCEBQEICgIABBQQCCggAEswyNe3x8nOAsEgIQFAQgKAhA0ENoROJbdeBUEgIQFAQgKAhAUBCAoCAAQUEAgoIABAUBCAoCEBQEICgIQFAQgKAgAEFBAIKCAAQFAQgKAhAUBCAoCEBQEICgIABBQQCCggAEBQEICgIQFAQgKAhAUBCAoCAAQUEAgoIABAUBCAoCEBQEICgIQFAQgKAgAEFBAIKCAITfpn49Tw37+vWP6QifP/89wVEkBCD0lBCaTgQpz89vv+yHh4dpizl5SAocQUIAQssJ4c2hdTnibh1pcx3VC0glh9n8vlLv96jXRR+OSogSAhBaSgjvDplrI2pr9r7e+fhlUjg7IXEvEgIQWkgIWb2C1pw9Uqd6Cku9JSned3YClBCAcGVC+GUoM7LB9SQEIPR8L0MTltd4kg49kxCAcEVCGKJ3YP6fEUkIQFAQKntJDtIDvVIQgHBmD+FW6w5yVxZCSyQEIFiHUNnyLsVeksKff/4v63F//fXfTcetPU9K6vlzj89V+j5qn78VEgIQzkgIt+gdLN9XKim0ah7xSkfk3MRQOqJuTR6ltp5nPm60pCAhAEEPYSF3r8LcpLNMClv12oNYJo+1RDH/vrRXUauXkXo9qfONlhQkBCCclhBaH+FqJ4Nax9WyNvKVXvuXjqRnO+r1XPV+ziIhAOHI1vcpswupa/PcfeuPTgZHK92PIfdaf/nz0udLPf/e51l7vqNfz9bPaau9f98pqb97CQEIt5tl6D0R7FV7JKv1fKM+T28kBCAckRCaXJk4WjI4ay/HUVfk1TbK5yQhAKHmLENWMqh991+tewQkA1pklgG4zJ4ewqbvZEyt7a890v348eOXf//w4cOh5ztKaoSQDDjCsNOOv//++wSU2VIQqswirO0XsNaDWNP7tbZeAVfQQwBCSUI4ZH1Bqqcw+v4BKVclg713L+7dI3HrebceX3ovw13WYUgIQMgZhi9deZibFHq/xm6lZ1C6b8LWkXNrItn6uNxkc9Yuz7msQwAu814PoelkMErXvbXZhOX9/qX7FPR27T36DkilJAQgNLcwaXmvw6jfkdjqOoOt1+Jbn/8qazsf3TU5SAhAeCshXNI7SK1DkAzOUevaf60HkRqBU/sJlPY0Sl+3fR5+JSEA4XVCODUZ3OUuvl7e59l7LRrJ2yQhAOH0WQazCGOx5+JYJAQgvAxjl37DkmQAae5lAC5zWA/hbnsBSgaMQEIAQvWEcJdZBBiRhACEagnhLvcinOXbt29Fj//06dOu40stz3fWeVOvI3Xetd/vPe8s9/lTn1srJAQgVFuHcPdEcPQsw9oImHtc7shWOrJuTQy1jiv9fLa+772fdynrEIDLVOsh6BVc4+hr19ykMP8+9zx7X8/yvLn2juCj9ApSJAQgDPtlr3exNmJuvUZfjvhHdeu3OjsZpI6r3TO4moQABAlhEKUj1dEjWa0ufenv1x5f632PlgxmEgIQJITOPD4+vvnzp6enf/5ZOlLlrh+ZR8Tl+VPnTT1uTeq4tfMe9U1ftT/v1kkIQJAQOldrpEqtI8hNBltXJC7Ps5SbSFJyk0muUZPBTEIAgoTQqdojVepaeXm+2TIZrB0/X+OnRuzc85e+3/l5935eoyeDmYQAhNN2XR6dPRU5grsdgcsoCJW8JILXqeClsq/NjUNrFAQg6CFUJhXQMwkBCApCZcteAvREQQCClYonmVPDx48fp+/fv//r51fJ7Xns3Y379Y8mmiUhnOzLly8TtMosw0FyVy5etcLx6GTwznkkhIZJCEDQQ7hIaoQ+OjGclQzok4QABAnhJFtXMNb6zkzJgBwSAhAkhIutjcjzyL41KQycDHJf8MPG49aeJ+V55/G5St9H1vklBCBYh3CQ5Yi+txdQOvtwdTI4cf3B3hG51oi+9kHWev97/4O9+zokBCDoIXRimTRSicNsQrazkkEtpQnkeeV53nyfEgIQJITOpJJC6fFH6eDehdqzALVmMUrPc8jzSAhAkBBOVnu2IZeewWnrA65SZZZDQgCChHCwrbMBtUb03PMOvO/B6MmgKgkBCBLCSY5aaVjrvAN+N+XdksHabMe76w9mEgIQJISTbF1RWPu8uY/LnQ3paM/E3pNBrXslrFQE8kgIF6l1jX5U0qh1l2YDjk4GuR/M8nEPhb9/SDxuWvn5tPK8v5AQgPCvhDDAiMAJOugdjD6bYMck4Fivq4adkyo6e14/tUPT1vMXrLC04m8gEgIQzDIMIpUMcp21LoK2SQhAkBAGVbqzUqpX8M5xIsWAJAQgSAiDSa0wXEsIa7MSr34vGQxMQgCChDCo0lmHjH0SJIMbkBCAICFU1trOQ6X7GViJeG8SAhAkhEp635NQr4AXEgIQJISdek0GegW8RUIAwm0TQu27++wfwQgkBCDoIezU8WxC/GiCnyQEIEgIP43eA5AMyCEhAEFBAIKCAAQ9hMHpHVBCQgCChDAoyYAtJAQgKAhAUBCAoIcwCN+wRA0SAhAkhE5l7OcgGVBMQgCChNC4gp2dJAJ2kxCAICE0JrWLs5WHnEFCAIKE0DjfqMSZJAQgSAjtkww4jYQABAUBCAoCEBQEICgIQFAQgKAgAEFBAIKCAAQFAQgKAhAUBCAoCEBQEICgIABBQQCCggCE17vxPE+0yI5JnEZCAIKCAAQFAQj/BxP176+Lo3jpAAAAAElFTkSuQmCC",Ps="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACgAAAAcCAYAAAATFf3WAAAACXBIWXMAAAWJAAAFiQFtaJ36AAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAFySURBVHgBzZcBksIgDACTTh9wT7hP6SP1U/eTHtQGaJrEhDqVnVGxk8IaAlSEMVmogTAeS2JtICJMMBZFjhgpgzu5nL31A8ZAlCtvX0aV2zUiHTrjPH2bct5O1A4t8Fg9aPUlyYkXPiEnwYU9cpnLtpksRFJeucyl+2CWichlLhPkU9zImnUzg4/z9Xd71DbAbrrTtfwFewWl1cYDZClik7PiNVpB8S7XVpAywOOWx+3Vvj9r4PMuyllZxBqj/yqqF6Ood08gJFfu3yRTzF/6+NXGkPqeQJHLN9DrLI3wDwSZW6G3A9WpOFx30i/YTKFJz2rOU9y7C8x8cFMyFfkKbRlUW7QgWP01tQe9IEhPsdK5SXJEkuQrlBN8sEBNECxJUU6TbOXYSu6Ry0w17pg1U+4DRM9iFOuPnQIcLVNaZreBXHJawOsEl+pHyiZbMKUTQbxJgHtztQJ10SA9YpEbimFElpVL93EU/k8SiD1/Rib+AQhe0VUs7Fs4AAAAAElFTkSuQmCC",Ns="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABYAAAAVCAYAAABCIB6VAAAACXBIWXMAAAWJAAAFiQFtaJ36AAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAB7SURBVHgB7ZXdDoAgCIUPjmftoXpZ+7moaSjYoNbWd+HmPB4ZIhKAjAB4Hydn75mQEMT3jLmYrbm50Mq/ouV6LedzkUjYbNSKqdAMLdqkRaLR0rI1AometjQeeSiK9sVyG6FbbrhHHdJDqRBO9jF2bJ9/2zzY7irkz1sAUAkbb2UHezIAAAAASUVORK5CYII=";function ks(){return{[M.WEB_PAINT_DISPLAY_BACKGROUND]:"#CCCCCCFF",[M.WEB_PAINT_DISPLAY_FOREGROUND]:"#FFFFFFFF",[M.WEB_PAINT_DISPLAY_GRID_COLOR]:"#00000033",[M.WEB_PAINT_FIT_IMAGE]:!0,[M.WEB_PAINT_NATIVE_THEME]:!1,[M.WEB_PAINT_DEBUG]:!1}}const mo={LENNA:bs,DISK:Os,WEB_PAINTING:Ps,CUBY:Ns};var Mt=(s=>(s.WEB_BASIC_SHOW_PREVIEW="extras13_web_basic_show_preview",s))(Mt||{}),A=(s=>(s.CONTENT="content",s.OUTPUT_TYPE="type",s))(A||{});function Ls(){return{[Mt.WEB_BASIC_SHOW_PREVIEW]:"extras13_web_basic_show_preview"}}function Tt(){return{[D.HAS_WINDOW_OUTPUT]:!1,[A.CONTENT]:"",[A.OUTPUT_TYPE]:"basic"}}function Us(s=["#FFF","#000","#FFAA55","#0055AA"]){return{}}const Bs=pe.extend({name:"Web Basic",colors:{disks:{webBasic:Us(["#000","#fff","#fff","#fff"])}}}),Rs=X(({core:s})=>{let t;return[{meta:[[S.SYMBOL,Q.WEB_BASIC],[S.WINDOW_SIZE,p(360,200)]],id:"WebBasic.app",name:"WebBasic",createdDate:new Date(2017,7,5).getTime(),editedDate:new Date(2020,3,14).getTime(),async action({modules:o},i){var z,G;if(!o.windows)throw new Error("Windows module not found");const n=o.windows,a=s.addExecution();let l;const f=it({value:Tt(),fsItem:void 0,output:[],openValue:void 0});if(i)if(l=await((z=o.files)==null?void 0:z.fs.get(i)),l&&A.CONTENT in l.data){const h={...l.data,[A.CONTENT]:[].concat(l.data[A.CONTENT]).join(`
`)};f.fsItem=l,f.value=h}else throw new Error("Can't read file content");const[u,_]=await Promise.all([T(()=>import("./Ca2NcYDH.js"),__vite__mapDeps([88,89,2,41,19,12,8,7,20,14,16,13,17,21,15,18,22,90,34,91,46,47,92,42,1,3,4,43,6,11,29,30,31,32,33,35,36,37,38,39,28,40,44,45,48,49]),import.meta.url).then(h=>h.default),T(()=>import("./0poC4doi.js"),__vite__mapDeps([93,2,94]),import.meta.url).then(h=>h.default)]),E=n.addWindow({component:u,componentData:{model:f,"onUpdate:value":h=>{f.value=h}},options:{title:"WebBasic - Extras 1.3",scaleX:!0,scaleY:!0,scrollX:!0,scrollY:!0,center:!1,embed:!1,borderless:!0},layout:{size:p(540,360)}},{group:"extras13WebBasic"});let N;f.actions={close:()=>{E==null||E.close()},focus:()=>{E==null||E.focus()},reset:()=>{f.value=Tt(),f.fsItem=void 0,f.output=[],f.openValue=void 0},togglePreview:(h=!0)=>{h?(N=n.addWindow({component:_,componentData:{model:f},options:{title:"Preview - WebBasic - Extras 1.3",scaleX:!0,scaleY:!0,scrollX:!0,scrollY:!0,center:!1,close:!1,embed:!1,borderless:!0},layout:{size:p(540,360)}},{group:"extras13WebBasic",active:!1}),window.requestAnimationFrame(()=>{n.contentWrapper.setWindowPositions(At.SPLIT_HORIZONTAL,[E,N],{embed:!0})})):N&&(E==null||E.unfocus(),N.close(),window.requestAnimationFrame(()=>{n.contentWrapper.setWindowPositions(At.SPLIT_HORIZONTAL,[E],{embed:!0}),E==null||E.focus()}))},openInfo:()=>e(f)},(G=s.modules.screen)==null||G.setTheme(Bs),a(),E.awaitClose().then(()=>{var h;N==null||N.close(),t==null||t.close(),(h=s.modules.screen)==null||h.setTheme(void 0)})}}];async function e(o){var i;return t||(t=(i=s.modules.windows)==null?void 0:i.addWindow({component:await T(()=>import("./DYFTzbe8.js"),__vite__mapDeps([95,69,1,2,3,4,70,96]),import.meta.url).then(n=>n.default),componentData:{model:o},options:{title:"Info"}},{group:"extras13WebBasic"}),t==null||t.awaitClose().then(()=>{t=void 0}),t)}}),Ms=X(()=>[{meta:[[S.SYMBOL,C.DIRECTORY],[S.WINDOW_SIZE,p(380,200)],[S.WINDOW_SYMBOL_REARRANGE,!0]],id:"BasicDemos",name:"Basic Demos",createdDate:new Date(2017,7,5).getTime(),editedDate:new Date(2020,3,14).getTime(),items:[{meta:[[S.SYMBOL,C.BASIC]],id:"TEST.bas",data:{[D.HAS_WINDOW_OUTPUT]:!0,[A.OUTPUT_TYPE]:"basic",[A.CONTENT]:['PRINT USING "# #"; 1,2']}},{meta:[[S.SYMBOL,C.BASIC]],id:"FunctionTest.bas",data:{[D.HAS_WINDOW_OUTPUT]:!0,[A.OUTPUT_TYPE]:"basic",[A.CONTENT]:['PRINT USING "LEN(\\"ABC\\") #"; LEN("ABC")','PRINT USING "ASC(\\"D\\") ##"; ASC("D")','PRINT USING "CHR$(68) ##"; CHR$(68)','PRINT USING "LEFT$(\\"XYZ\\", LEN(\\"XYZ\\")-1) #"; LEFT$("XYZ", LEN("XYZ")-1)','PRINT USING "RIGHT$(\\"XYZ\\", LEN(\\"XYZ\\")-1) #"; RIGHT$("XYZ", LEN("XYZ")-1)']}},{meta:[[S.SYMBOL,C.BASIC]],id:"Fibonacci.bas",data:{[D.HAS_WINDOW_OUTPUT]:!0,[A.OUTPUT_TYPE]:"basic",[A.CONTENT]:["CLS","READ max","DIM fib%(max)","LET fib(1) = 1","LET fib(2) = 2","FOR i=3 TO max","LET fib(i) = fib(i - 2) + fib(i -1)","NEXT i","FOR i=1 TO max","PRINT fib(i)","NEXT i","DATA 10","END"]}},{meta:[[S.SYMBOL,C.BASIC]],id:"Area.bas",data:{[D.HAS_WINDOW_OUTPUT]:!0,[A.OUTPUT_TYPE]:"basic",[A.CONTENT]:["CLS","DIM w%,h%,a%","LET w%=12","LET h%=4","LET a%=w%*h%",'PRINT "With the width " + w%','PRINT " and the height " + h%','PRINT " you have the area " + a%']}},{meta:[[S.SYMBOL,C.BASIC]],id:"Circle.bas",data:{[D.HAS_WINDOW_OUTPUT]:!0,[A.OUTPUT_TYPE]:"basic",[A.CONTENT]:["CLS","DIM r,a","LET r=5","READ pi","LET a=r*r*pi",'PRINT USING "With the radius ##.##"; r','PRINT USING "we have the area ##.##"; a',"DATA 3.14","END"]}},{meta:[[S.SYMBOL,C.BASIC]],id:"Your_Name.bas",data:{[D.HAS_WINDOW_OUTPUT]:!0,[A.OUTPUT_TYPE]:"basic",[A.CONTENT]:["CLS",'PRINT "What is your name?"',"INPUT n$",'PRINT "What is your shoe size?"',"INPUT size",'PRINT "Hello "; n$','PRINT USING "your shoe size is ##.##"; size',"END"]}},{meta:[[S.SYMBOL,C.BASIC]],id:"GuessTheNumber.bas",data:{[D.HAS_WINDOW_OUTPUT]:!0,[A.OUTPUT_TYPE]:"basic",[A.CONTENT]:["GuessTheNumber","CLS","READ max%","DIM number%, guess%, guesses%, message$",'LET message$ =  ""','PRINT "The number is between 1-1000."',"LET number% = INT(RND * max%) + 1","LET guess% = 1","LET guesses% = 0","WHILE guess%<>number%",'PRINT "Guess the number"',"PRINT message$","INPUT message$ guess%","IF (guess%<>number%) THEN","IF (guess%>number%) THEN",'LET message$ = "Your guess was too high"',"ELSE",'LET message$ =  "Your guess was too low"',"ENDIF","ENDIF","LET guesses% = guesses% + 1","WEND",'PRINT USING "You found the number in # tries"; guesses%',"DATA 1000","END"]}},{meta:[[S.SYMBOL,C.BASIC]],id:"Factorial.bas",data:{[D.HAS_WINDOW_OUTPUT]:!0,[A.OUTPUT_TYPE]:"basic",[A.CONTENT]:["DIM result, n",'PRINT "Calculate the factorial of"',"INPUT n","LET result = 1","FOR i = n TO 1 STEP -1","LET result = result * i","NEXT i",'PRINT USING "#! = #"; n, result',"END"]}},{meta:[[S.SYMBOL,C.BASIC]],id:"Pyramid.bas",data:{[D.HAS_WINDOW_OUTPUT]:!0,[A.OUTPUT_TYPE]:"basic",[A.CONTENT]:["CLS","DIM stars$",'PRINT "Enter the height of the pyramid"',"INPUT height",'LET stars$ = ""',"FOR i = 1 TO height",'LET stars$ = ""',"FOR j = 1 TO (i+i-1)",'LET stars$ = stars$ + "*"',"NEXT j","PRINT SPC(height - i) + stars","NEXT i","END"]}},{meta:[[S.SYMBOL,C.BASIC]],id:"Bubble_Sort.bas",data:{[D.HAS_WINDOW_OUTPUT]:!0,[A.OUTPUT_TYPE]:"basic",[A.CONTENT]:["CLS","READ max","DIM SHARED numbers(max)","SUB CreateList(max) STATIC","FOR i=1 TO max","LET numbers(i) = INT(RND * 100)","NEXT i","END SUB","SUB PrintList(max) STATIC","FOR i=1 TO max","PRINT numbers(i)","NEXT i","END SUB","SUB SwapValues(i%, j%) STATIC","LET numbers(i%) = numbers(i%) XOR numbers(j%)","LET numbers(j%) = numbers(i%) XOR numbers(j%)","LET numbers(i%) = numbers(i%) XOR numbers(j%)","END SUB","SUB Sort(max) STATIC","FOR i%=1 TO (max - 1)","FOR j%=i% TO max","IF numbers(i%)>numbers(j%) THEN","CALL SwapValues(i, j)","END IF","NEXT j%","NEXT i%","END SUB","CreateList(max)","Sort(max)","PrintList(max)","DATA 10","END"]}},{meta:[[S.SYMBOL,C.BASIC]],id:"Goto.bas",data:{[D.HAS_WINDOW_OUTPUT]:!0,[A.OUTPUT_TYPE]:"basic",[A.CONTENT]:['PRINT "Step 1"','PRINT "Step 2"','PRINT "Step 3"',"GOTO ignore",'PRINT "Step 4"',"ignore:",'PRINT "Step 5"']}},{meta:[[S.SYMBOL,C.BASIC]],id:"Vars.bas",data:{[D.HAS_WINDOW_OUTPUT]:!0,[A.OUTPUT_TYPE]:"basic",[A.CONTENT]:["DIM A, B","LET A = 2000",'LET B = "Hello World"','PRINT USING "A: #"; A','PRINT USING "B: #"; B']}},{meta:[[S.SYMBOL,C.BASIC]],id:"If.bas",data:{[D.HAS_WINDOW_OUTPUT]:!0,[A.OUTPUT_TYPE]:"basic",[A.CONTENT]:["DIM A, B","LET A = 1","LET B = 2","IF A == B THEN",'PRINT "true"',"ELSE",'PRINT "false"',"END","IF (A < B) THEN",'PRINT "true"',"END"]}},{meta:[[S.SYMBOL,C.BASIC]],id:"For.bas",data:{[D.HAS_WINDOW_OUTPUT]:!0,[A.OUTPUT_TYPE]:"basic",[A.CONTENT]:["DIM i%","FOR i% = 1 TO 5",'PRINT USING "For Number #"; i%',"NEXT i%"]}},{meta:[[S.SYMBOL,C.BASIC]],id:"For_Step.bas",data:{[D.HAS_WINDOW_OUTPUT]:!0,[A.OUTPUT_TYPE]:"basic",[A.CONTENT]:["CLS","FOR i% = 0 TO 6 STEP 2",'PRINT "For Step Number #"; i%',"NEXT i%"]}},{meta:[[S.SYMBOL,C.BASIC]],id:"While.bas",data:{[D.HAS_WINDOW_OUTPUT]:!0,[A.OUTPUT_TYPE]:"basic",[A.CONTENT]:["DIM i%","LET i%=0","WHILE i% < 5",'PRINT USING "While Number #"; i%',"LET i% = i% + 1","WEND"]}},{meta:[[S.SYMBOL,C.BASIC]],id:"Pause.bas",data:{[D.HAS_WINDOW_OUTPUT]:!0,[A.OUTPUT_TYPE]:"basic",[A.CONTENT]:["DIM duration","LET duration = 2500",'PRINT USING "Start with Pause #ms"; duration',"PAUSE duration",'PRINT "End Pause"','PRINT USING "Start with Sleep #ms"; duration',"PAUSE duration",'PRINT "End Sleep"']}}]}]),It="newEntry",xs=X(({core:s})=>{let t;const e=new Map;return[{meta:[[S.SYMBOL,Q.GUEST_BOOK]],id:"GuestBook.app",name:"Guestbook",createdDate:new Date(2025,5,17).getTime(),editedDate:new Date(2025,5,17).getTime(),async action(){const n=s.addExecution(),a=`# Guest Book
Feel free to leave a message, share your thoughts, or just say hello.
Your words mean a lot and help make this space more personal and memorable.
Thanks for stopping by!`,l="## A collection of entries left by our visitors.",u=it({isLocked:!1,options:{fileItemPath:"CDGUESTBOOK:data.json"},entries:[],selectedEntries:[]});let _;try{_=await E()}catch(h){throw console.error(h),new Error("GuestBook file not found. Please setup storage first.")}u.isLocked=_.isLocked();async function E(){var m;const h=await((m=s.modules.files)==null?void 0:m.fs.get(u.options.fileItemPath));if(!h)throw new Error("File not found");return h}async function N(){return _.data.content}async function z(){const h=s.addExecution(),m=await N();u.entries=m,h()}u.actions={close:()=>{G.close()},openInfo:()=>o(u),setOptions:h=>{Object.assign(u.options,h)},setupStorage:Fs(s,u),updateStorage:async()=>{var m;const h=s.addExecution();try{const d=await((m=s.modules.files)==null?void 0:m.fs.get(u.options.fileItemPath));d&&(d.data={type:"json",content:u.entries},await nt(d),await z(),h())}catch(d){throw h(),d}},import:async h=>{var d;const m=s.addExecution();try{const y=JSON.parse(await h.text()),k=await((d=s.modules.files)==null?void 0:d.fs.get(u.options.fileItemPath));k&&(k.data={type:"json",content:y},await nt(k),await z()),m()}catch(y){throw m(),y}},export:async()=>{const h=s.addExecution(),m=await T(()=>import("./CshrRwMP.js").then(d=>d.F),__vite__mapDeps([51,40]),import.meta.url).then(d=>d.default);try{const d=new Blob([JSON.stringify(u.entries)],{type:"application/json;charset=utf-8"});await m.saveAs(d,`${ue(new Date)}_guest_book.json`),h()}catch(d){throw h(),d}},writeEntry:async()=>{i(u)},addEntry:async h=>{var k;const m=s.addExecution(),d=await(await ae.getFunction("guestBookAdd"))({entry:h}),y=d.data.entry;if(d.data.error)throw m(),new Error(d.data.error);y&&(u.entries.push(y),m(),await s.executeCommand(`openDialog "Thank you for your entry!
Your message has been successfully submitted and will appear in the guestbook shortly."`)),(k=e.get(It))==null||k.close()},editEntry:async(h,m)=>{var y,k;const d=u.entries.find(B=>B.id===m.id);if(!d)throw new Error("Entry not found");d.author=h.author,d.subject=h.subject,d.message=h.message,await((y=u.actions)==null?void 0:y.updateStorage()),(k=e.get(m.id))==null||k.close()},setSelectedEntries:h=>{u.selectedEntries=h},publishEntries:(h,m)=>{h.forEach(d=>{u.entries.find(y=>y.id===d).published=m}),u.selectedEntries=[]},editEntries:async h=>{u.entries.filter(m=>h.includes(m.id)).forEach(m=>{i(u,m)})},removeEntries(h){u.entries=u.entries.filter(m=>!h.includes(m.id)),u.selectedEntries=[]},truncate:async()=>{var h;if(await s.executeCommand('openDialog --confirm "Really empty the guestbook?"')){const m=s.addExecution();u.entries=[],u.selectedEntries=[];const d=await((h=s.modules.files)==null?void 0:h.fs.get(u.options.fileItemPath));d&&(d.data={type:"json",content:[]},await nt(d)),m()}}},await z();const G=s.modules.windows.addWindow({layout:{size:p(480,320),position:p(0,0)},component:await T(()=>import("./CbRKCzqT.js"),__vite__mapDeps([97,98,1,2,3,4,5,6,7,11,69,70,59,60,61,62,41,99,54,55,56,57,100,101]),import.meta.url).then(h=>h.default),componentData:{model:u,introContent:a,listContent:l},options:{title:"Guestbook",scale:!0,scrollX:!1,scrollY:!0,filled:!0}},{group:"extras13GuestBook",full:!0});G.awaitClose().then(()=>{Array.from(e.values()).forEach(h=>{h.close()}),t==null||t.close()}),n()}}];async function o(n){return t||(t=s.modules.windows.addWindow({component:await T(()=>import("./DSRUEjWf.js"),__vite__mapDeps([102,69,1,2,3,4,70,98,5,6,7,11,103]),import.meta.url).then(async a=>a.default),componentData:{model:n},options:{title:"Info"}},{group:"extras13GuestBook"}),t.awaitClose().then(()=>{t=void 0}),t)}async function i(n,a){const l=(a==null?void 0:a.id)||It;if(e.has(l))return e.get(l);const f=s.modules.windows.addWindow({layout:{size:p(480,320)},component:await T(()=>import("./BSyG_usj.js"),__vite__mapDeps([104,98,1,2,3,4,5,6,7,11,23,24,105,54,55,8,106,65,66,59,60,61,62,69,70,107]),import.meta.url).then(async u=>u.default),componentData:{model:n,originEntry:a},options:{title:"Entry",scale:!0,scroll:!1}},{group:"extras13GuestBook"});return f.awaitClose().then(()=>{e.delete(l)}),e.set(l,f),f}});function Fs(s,t){return async()=>{const e=t.options.fileItemPath,o=await s.executeCommand(`exist "${e}"`),i=window.btoa(JSON.stringify({type:"json",content:[]}));let n=!1;if(o&&(n=await s.executeCommand('openDialog "File exist, overwrite?" --confirm')),!o||n){const a=[`makefile "${e}"`];return i&&a.push(`--data="${i}"`),n&&a.push("--override"),s.executeCommand(a.join(" "))}}}const Hs=X(({core:s})=>{let t;return[{meta:[[S.SYMBOL,C.DEFAULT]],id:"Base64Converter.app",name:"Base64Converter",createdDate:new Date(2023,8,4).getTime(),editedDate:new Date(2023,8,4).getTime(),async action({modules:o}){var l;const i=s.addExecution(),n=it({actions:{openInfo:()=>e(n)}}),a=(l=o.windows)==null?void 0:l.addWindow({component:await T(()=>import("./CzuRr9uc.js"),__vite__mapDeps([108,2,109,1,3,4,7,11,23,24,65,54,55,66,61,62,110]),import.meta.url).then(f=>f.default),componentData:{model:n},options:{title:"Base64 Converter"}},{group:"extras13ToolsBase64Converter"});a==null||a.awaitClose().then(()=>{t==null||t.close()}),i()}}];async function e(o){var i;return t||(t=(i=s.modules.windows)==null?void 0:i.addWindow({component:await T(()=>import("./DnwQRW5p.js"),__vite__mapDeps([111,69,1,2,3,4,70,109,7,11,112]),import.meta.url).then(n=>n.default),componentData:{model:o},options:{title:"Info"}},{group:"extras13ToolsBase64Converter"}),t==null||t.awaitClose().then(()=>{t=void 0}),t)}}),Ws=X(async({core:s})=>[{id:"Tools",name:"Tools",meta:[[S.WINDOW_SIZE,p(160,120)],[S.WINDOW_SYMBOL_REARRANGE,!0]],createdDate:new Date(2024,8,9).getTime(),editedDate:new Date(2024,8,9).getTime(),items:[...await Hs({core:s})]}]),zs=Vt(async({core:s})=>{var t;return s.config.setDefaults(ks()),s.config.setDefaults(Ls()),(t=s.modules.symbols)==null||t.addSymbols([{key:Q.DISK_EXTRAS13,component:await T(()=>import("./CxF3EGor.js"),__vite__mapDeps([113,2]),import.meta.url).then(e=>e.default),group:"disk_extras13"},{key:Q.WEB_BASIC,component:await T(()=>import("./BEDCjkIE.js"),__vite__mapDeps([114,2]),import.meta.url).then(e=>e.default),group:"disk_extras13"},{key:Q.WEB_PAINTING,component:await T(()=>import("./BMC72IpY.js"),__vite__mapDeps([115,2]),import.meta.url).then(e=>e.default),group:"disk_extras13"},{key:Q.GUEST_BOOK,component:await T(()=>import("./CHx_Ht_W.js"),__vite__mapDeps([116,2]),import.meta.url).then(e=>e.default),group:"disk_extras13"}]),{locked:!0,meta:[[S.SYMBOL,Q.DISK_EXTRAS13],[S.WINDOW_SIZE,p(320,220)],[S.WINDOW_POSITION,p(310,10)],[S.WINDOW_SYMBOL_REARRANGE,!0]],name:"Extras 1.3",items:[...await Ws({core:s}),...await Is({core:s}),...await Rs({core:s}),...await Ms({core:s}),...await xs({core:s})]}}),fo=Object.freeze(Object.defineProperty({__proto__:null,default:zs},Symbol.toStringTag,{value:"Module"}));export{R as B,M as C,mo as D,he as O,ot as P,bt as S,r as T,w as W,uo as a,lo as b,g as c,ho as d,F as e,ks as f,po as g,de as h,Mt as i,A as j,fo as k,Xe as t};
