const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./CshrRwMP.js","./Cpj98o6Y.js"])))=>i.map(i=>d[i]);
import{d as J,ab as j,r as v,k as m,o as z,W as X,F as x,z as b,D as _,A as d,y as I,X as Q,Y as Z,G as u,C as r,B as E,P as A,K as ee,_ as le}from"./BkRx7U8b.js";import{W as te}from"./BPnw8H1C.js";import{W as y}from"./DpGpKT4E.js";import{W as c}from"./D9PjJnFw.js";import{W}from"./CcXWfcLA.js";import{o as oe,d as ae,C as B,e as k,u as ne,p as ie,q as re,i as F}from"./Dv1mzSl-.js";import{W as se}from"./Ca7ITM_r.js";import{d as ue}from"./DeEbP9sG.js";import{a as ce}from"./B4rpyJsK.js";import{S as de}from"./Wv4Ty0OG.js";import{f as pe}from"./C723tzWh.js";import"./eRs2tlcG.js";import"./ClLpnmyR.js";import"./BTMT_sH9.js";import"./OlYXjGCK.js";import"./KQEr41HO.js";import"./D4lI5vpz.js";import"./OAVrZOa6.js";import"./D4b9WN8K.js";import"./CVx03s7S.js";import"./rEnmFtaA.js";import"./BnD3zOT9.js";import"./312NxIbt.js";import"./Bpi429LP.js";import"./DFTH32ee.js";import"./CTpy3bpH.js";import"./D7YMvfqk.js";import"./CNkvSXuu.js";import"./BtH6r1li.js";import"./QwGUwJAP.js";import"./BoZA8JgY.js";import"./Cpj98o6Y.js";import"./DG6QdPnO.js";import"./B3Wmi0DA.js";import"./CtlMGvom.js";import"./CxKYomUj.js";import"./CJzlme9J.js";import"./CcuCSIbb.js";import"./Gl1UmUM-.js";import"./CV0dHcg-.js";import"./CaAbksje.js";import"./Ds4KxLLa.js";import"./CL1V9BUB.js";const me={class:"colors style-scrollbar"},ve=["id","name","value","checked","onInput"],be=["for"],_e={class:"test"},fe={class:"info"},we={class:"font-bit-font"},ye={class:"font-bit-font"},ke=J({__name:"ColorPalette",props:{core:{},model:{}},setup(S){const{t:o}=ne(),D=j(),t=v(),a=m(()=>t.value?t.value.colors:[]),s=v(),N=v(null),p=S;function T(e,l){l.setColor(e),w()}const f=v([oe()].concat(ae())),C=m(()=>[...f.value,...n.value]),n=m({get:()=>(p.core.config.get(B.WEB_PAINT_PALETTES)||[]).map(e=>new k(e)),set:e=>{p.core.config.set(B.WEB_PAINT_PALETTES,e)}});function w(){n.value=[...n.value]}const U=m(()=>({label:o("window.color_palette.colors_from_palette.label"),hideLabel:!0,modelValue:"","onUpdate:model-value":e=>{const l=C.value.find(i=>i.id===e);t.value&&l&&(t.value.colors.push(...l.colors),w())},options:[{label:o("window.color_palette.colors_from_palette.items.default.label"),value:""},...n.value.length>0?[{label:o("window.color_palette.colors_from_palette.items.custom_palettes.label"),options:n.value.map(e=>({label:e.name,value:e.id}))}]:[],{label:o("window.color_palette.colors_from_palette.items.builtin_palettes.label"),options:f.value.map(e=>({label:e.name,value:e.id}))}]})),V=m(()=>({label:o("window.color_palette.palette.label"),hideLabel:!0,modelValue:t.value?.id,"onUpdate:model-value":e=>t.value=C.value.find(l=>l.id===e),options:[{label:o("window.color_palette.palette.items.new.label"),value:""},...n.value.length>0?[{label:o("window.color_palette.palette.items.custom_palettes.label"),options:n.value.map(e=>({label:e.name,value:e.id,group:"custom"}))}]:[],{label:o("window.color_palette.palette.items.builtin_palettes.label"),options:f.value.map(e=>({label:e.name,value:e.id,group:"built-in"}))}]})),P=new de;z(()=>{t.value=ie(re.WIN_256),P.add(ue.keyDown.pipe(pe(e=>e.key===ce.BACKSPACE)).subscribe(()=>{g()}))}),X(()=>{P.unsubscribe()});function q(){if(!s.value)return;const e=a.value.findIndex(l=>l.equal(s.value));if(e>0){const l=a.value[e-1];a.value[e-1]=a.value[e],a.value[e]=l}}function L(){if(!s.value)return;const e=a.value.findIndex(l=>l.equal(s.value));if(e<a.value.length-1){const l=a.value[e+1];a.value[e+1]=a.value[e],a.value[e]=l}}function M(){n.value=[...n.value,new k({name:"New Palette",colors:[]})],t.value=n.value[n.value.length-1]}function O(){if(!t.value)return;const e=n.value.findIndex(l=>l.id===t.value.id);e!==-1&&(n.value.splice(e,1),t.value=void 0),t.value=n.value[Math.max(e-1,0)]}async function K(){if(t.value){const e=(await p.model.actions.prompt({text:"Rename Palette",type:"text",value:t.value.name||""}))?.value;t.value.name=e,w()}}function R(){a.value.push(new F),s.value=a.value[a.value.length-1]}function g(){if(!s.value)return;const e=a.value.findIndex(l=>l.equal(s.value));e!==-1&&(a.value.splice(e,1),s.value=void 0),s.value=a.value[Math.max(e-1,0)]}async function G(e){if(e&&e[0]){const l=new k(JSON.parse(await e[0].text()));n.value.find(({id:i})=>l.id===i)?n.value=n.value.map(i=>i.id===l.id?l:i):n.value=[...n.value,l]}}async function Y(){const e=await ee(()=>import("./CshrRwMP.js").then(l=>l.F),__vite__mapDeps([0,1]),import.meta.url).then(l=>l.default);try{await e.saveAs(new Blob([JSON.stringify(t.value)]),Date.now()+"-palette.json")}catch(l){console.error("An error occurred during export.",l)}}async function $(){const{payload:e}=await p.model.app.actions.getColors();e.colors.length>1e3&&console.warn("Palette must not exceed 100 colors."),t.value?.colors&&(t.value.colors=e.colors.slice(0,500).map(l=>new F({color:l})))}function H(){t.value&&p.model.app.setColorPalette(t.value)}return(e,l)=>(b(),x(te,{class:"wb-disks-extras13-web-paint-color-palette"},{default:_(()=>[d("div",me,[d("ul",{ref_key:"itemsEl",ref:N},[(b(!0),I(Q,null,Z(a.value,i=>(b(),I("li",{key:i.id},[d("input",{id:"color-palette-"+i.id,type:"radio",name:`${u(D)}-palette-color`,value:i.id,checked:i.equal(s.value),onInput:h=>s.value=i},null,40,ve),d("label",{for:"color-palette-"+i.id},[(b(),x(se,{key:i.color.toHex(),selected:i.equal(s.value),readonly:!i.equal(s.value),embed:"","model-value":i.color,"onUpdate:modelValue":h=>T(h,i)},null,8,["selected","readonly","model-value","onUpdate:modelValue"]))],8,be)]))),128))],512)]),d("div",null,[d("div",_e,[d("div",fe,[d("span",we,"Total: "+E(a.value.flat().length),1),d("span",ye,E(s.value?.color.toHex()),1)]),l[0]||(l[0]=d("div",{class:"separator"},null,-1)),r(y,{embed:""},{default:_(()=>[r(c,{disabled:t.value?.locked,type:"button","style-type":"compact",label:u(o)("window.color_palette.add_color.label"),onClick:R},null,8,["disabled","label"]),r(c,{disabled:t.value?.locked,type:"button","style-type":"compact",label:u(o)("window.color_palette.remove_color.label"),onClick:g},null,8,["disabled","label"]),r(c,{disabled:t.value?.locked,type:"button","style-type":"compact",label:u(o)("window.color_palette.move_color_backward.label"),onClick:q},null,8,["disabled","label"]),r(c,{disabled:t.value?.locked,type:"button","style-type":"compact",label:u(o)("window.color_palette.move_color_forward.label"),onClick:L},null,8,["disabled","label"])]),_:1})]),r(W,A({"style-type":"compact"},V.value),null,16),r(y,null,{default:_(()=>[r(W,A({"style-type":"compact",disabled:t.value?.locked},U.value),null,16,["disabled"]),r(c,{style:{flex:"0"},type:"button","style-type":"compact",label:u(o)("window.color_palette.colors_from_image.label"),disabled:t.value?.locked,onClick:$},null,8,["label","disabled"])]),_:1}),r(y,{type:"grid",columns:3,embed:""},{default:_(()=>[r(c,{type:"upload","style-type":"compact",label:u(o)("window.color_palette.import_palette.label"),onUpload:G},null,8,["label"]),r(c,{type:"button","style-type":"compact",label:u(o)("window.color_palette.add_palette.label"),onClick:M},null,8,["label"]),r(c,{disabled:t.value?.locked,type:"button","style-type":"compact",label:u(o)("window.color_palette.remove_palette.label"),onClick:O},null,8,["disabled","label"]),r(c,{type:"button","style-type":"compact",label:u(o)("window.color_palette.export_palette.label"),onClick:Y},null,8,["label"]),r(c,{disabled:t.value?.locked,type:"button","style-type":"compact",label:u(o)("window.color_palette.rename_palette.label"),onClick:K},null,8,["disabled","label"]),r(c,{disabled:!t.value,type:"button","style-type":"compact",label:u(o)("window.color_palette.save_palette.label"),onClick:H},null,8,["disabled","label"])]),_:1})])]),_:1}))}}),cl=le(ke,[["__scopeId","data-v-67a436f6"]]);export{cl as default};
