import{E as g}from"./CN6qd5Iu.js";import{r as S,u as h}from"./B3Wmi0DA.js";import{C as T}from"./CxKYomUj.js";import{C,P as c}from"./ZgeBdbgH.js";import{d as x,a as n,b as O,u as y}from"./ClLpnmyR.js";import{S as B}from"./B9nPFJJ2.js";import{K as m}from"./B4rpyJsK.js";import{O as W,d as b,r as K,k as N,a0 as E,o as R,a1 as _,y as P,z as A,C as V,G as D,_ as M}from"./BkRx7U8b.js";import{u as Y}from"./JsFOm8c5.js";import"./DG6QdPnO.js";import"./DeEbP9sG.js";import"./Ds4KxLLa.js";import"./OlYXjGCK.js";import"./CL1V9BUB.js";import"./D4lI5vpz.js";import"./OAVrZOa6.js";import"./Wv4Ty0OG.js";import"./D4b9WN8K.js";import"./CtlMGvom.js";import"./KQEr41HO.js";import"./CVx03s7S.js";import"./C723tzWh.js";import"./D53hIzv4.js";import"./CTpy3bpH.js";import"./DXGPjI4_.js";import"./Gl1UmUM-.js";import"./CV0dHcg-.js";import"./Dql81Gm-.js";import"./CQXxpFej.js";import"./CJzlme9J.js";import"./BoZA8JgY.js";import"./CaAbksje.js";import"./B1dhf47O.js";import"./Bwr9avpB.js";import"./BTMT_sH9.js";const F=x(({core:o,model:e})=>{return[new n({order:0,title:"Editor",items:[new n({title:"New",hotKey:{alt:!0,code:m.KEY_N,title:"N"},action:d}),new n({title:"Open…",hotKey:{alt:!0,code:m.KEY_O,title:"O"},action:v}),new n({title:"Save",hotKey:{alt:!0,code:m.KEY_S,title:"S"},action:u}),new n({title:"Save As…",action:i}),new B,new n({hotKey:{alt:!0,code:m.KEY_I,title:"I"},title:"Info",action(){return e.actions?.openInfo()}}),new n({title:"Close",action(){return e.actions?.close()}})]}),new n({order:1,title:"Document Settings",items:[new n({title:"Has Window Output",type:O.CHECKBOX,name:T.HAS_WINDOW_OUTPUT,model:e.value})]}),new n({order:1,title:"Run",hotKey:{code:m.KEY_R,title:"R"},action:w}),new n({order:2,title:"Preview",type:O.CHECKBOX,name:C.WEB_BASIC_SHOW_PREVIEW,model:o.config.observable,action({value:t}){return o.config.set(C.WEB_BASIC_SHOW_PREVIEW,t)}})];function d(){e.actions?.reset()}function u(){return p()}function i(){return p(!0)}async function p(t=!1){const r={...e.value,content:e.value[c.CONTENT].split(/\n/g)},a=await S(JSON.stringify(r));let l;if(!t&&e.fsItem)return l=await o.executeCommand(`editfile "${e.fsItem.getPath()}" --data="${a}"`),l?o.executeCommand('openDialog "File saved."'):o.executeCommand('openDialog "File could not be saved."');{const f=await o.executeCommand(`saveFileDialog --data="${a}" --extension="bs"`);return f?(e.fsItem=W(f),e.fsItem):null}}async function v(){const t=await o.executeCommand("openFileDialog");if(t)if(c.CONTENT in t.value){const r={...t.value,[c.CONTENT]:[].concat(t.value[c.CONTENT]).join(`
`)};e.fsItem=t.fsItem,e.value=r}else throw new Error("Can't read file content")}async function w(){const t=[];await o.modules.parser?.parseBasic(e.value[c.CONTENT].split(/\n/),async(r,a)=>{const l=await o.executeCommand(r,a);return a.message&&(Array.isArray(a.message)?t.push(...a.message):t.push(a.message)),l}),e.output=t.map(r=>h(r))}}),H={class:"wb-disks-extras13-web-basic"},k=b({__name:"WebBasic",props:{model:{}},emits:["refresh","update:value"],setup(o,{emit:e}){const d=K(null),u=e,i=o,{core:p}=y(),{setContextMenu:v,preserveContextMenu:w,parentFocused:t}=Y();v(F,{model:i.model}),w();const r=N(()=>i.model.value.content),a=N(()=>!!p.value?.config.observable[C.WEB_BASIC_SHOW_PREVIEW]);E(()=>i.model.value,()=>{I()}),E(()=>r.value,s=>{s&&(u("update:value",{...i.model.value,content:s}),_(()=>{d.value?.resetSelection(),u("refresh",{scroll:!0})}))}),E(()=>a.value,s=>{i.model.actions?.togglePreview(s)}),R(()=>{a.value&&_(()=>{i.model.actions?.togglePreview()})});function l(s){u("update:value",{...i.model.value,content:s})}function f(){I()}function I(){_(()=>{u("refresh",{scroll:!0})})}return(s,$)=>(A(),P("div",H,[V(g,{ref:"input","override-focused":D(t)||!1,"model-value":s.model.value.content,"onUpdate:modelValue":l,onRefresh:f},null,8,["override-focused","model-value"])]))}}),he=M(k,[["__scopeId","data-v-9b45f472"]]);export{he as default};
