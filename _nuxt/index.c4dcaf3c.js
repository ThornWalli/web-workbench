var rl=Object.defineProperty;var sl=(t,e,n)=>e in t?rl(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n;var p=(t,e,n)=>(sl(t,typeof e!="symbol"?e+"":e,n),n),Ji=(t,e,n)=>{if(!e.has(t))throw TypeError("Cannot "+n)};var c=(t,e,n)=>(Ji(t,e,"read from private field"),n?n.call(t):e.get(t)),g=(t,e,n)=>{if(e.has(t))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(t):e.set(t,n)},A=(t,e,n,r)=>(Ji(t,e,"write to private field"),r?r.call(t,n):e.set(t,n),n),Ie=(t,e,n,r)=>({set _(s){A(t,e,s,n)},get _(){return c(t,e,r)}});import{W as Ne,D as z,r as vt,U as il,X as zn,Y as al,Z as ol,$ as ll,c as $a,a0 as cl,o as ul,a1 as dl,a2 as hl,_ as j,k as y,l as C,C as Tn,v as Wa,z as U,s as Y,t as Ce,B,K as at,F as ei,O as Kt,a3 as Fa,m as S,L as Rn,x as Ai,y as Oi,f as R,q as N,H as V,M as Et,N as St,a4 as ml,G as tr,a5 as za,a6 as fl,a7 as ki,V as pl,E as k,u as gl}from"./entry.42952971.js";import{n as Ba,_ as Ti,a as ms,b as Dn,c as Ht,d as Nn,e as _l,f as Va,g as Fs,h as bl,i as yl,p as wl}from"./index.26bb4b3d.js";function Ua(t,e){var n=t.charAt(0),r=t.substr(1).toLowerCase();return e>0&&n>="0"&&n<="9"?"_"+n+r:""+n.toUpperCase()+r}function xl(t,e){return e===void 0&&(e={}),Ba(t,Ti({delimiter:"",transform:Ua},e))}function vl(t,e){return e===0?t.toLowerCase():Ua(t,e)}function en(t,e){return e===void 0&&(e={}),xl(t,Ti({transform:vl},e))}function El(t){return t.charAt(0).toUpperCase()+t.substr(1)}function Sl(t){return El(t.toLowerCase())}function ja(t,e){return e===void 0&&(e={}),Ba(t,Ti({delimiter:" ",transform:Sl},e))}function X(t){return typeof t=="function"}function Ri(t){var e=function(r){Error.call(r),r.stack=new Error().stack},n=t(e);return n.prototype=Object.create(Error.prototype),n.prototype.constructor=n,n}var zs=Ri(function(t){return function(n){t(this),this.message=n?n.length+` errors occurred during unsubscription:
`+n.map(function(r,s){return s+1+") "+r.toString()}).join(`
  `):"",this.name="UnsubscriptionError",this.errors=n}});function ti(t,e){if(t){var n=t.indexOf(e);0<=n&&t.splice(n,1)}}var Yr=function(){function t(e){this.initialTeardown=e,this.closed=!1,this._parentage=null,this._finalizers=null}return t.prototype.unsubscribe=function(){var e,n,r,s,i;if(!this.closed){this.closed=!0;var a=this._parentage;if(a)if(this._parentage=null,Array.isArray(a))try{for(var o=ms(a),l=o.next();!l.done;l=o.next()){var u=l.value;u.remove(this)}}catch(_){e={error:_}}finally{try{l&&!l.done&&(n=o.return)&&n.call(o)}finally{if(e)throw e.error}}else a.remove(this);var d=this.initialTeardown;if(X(d))try{d()}catch(_){i=_ instanceof zs?_.errors:[_]}var m=this._finalizers;if(m){this._finalizers=null;try{for(var h=ms(m),f=h.next();!f.done;f=h.next()){var v=f.value;try{ea(v)}catch(_){i=i??[],_ instanceof zs?i=Dn(Dn([],Ht(i)),Ht(_.errors)):i.push(_)}}}catch(_){r={error:_}}finally{try{f&&!f.done&&(s=h.return)&&s.call(h)}finally{if(r)throw r.error}}}if(i)throw new zs(i)}},t.prototype.add=function(e){var n;if(e&&e!==this)if(this.closed)ea(e);else{if(e instanceof t){if(e.closed||e._hasParent(this))return;e._addParent(this)}(this._finalizers=(n=this._finalizers)!==null&&n!==void 0?n:[]).push(e)}},t.prototype._hasParent=function(e){var n=this._parentage;return n===e||Array.isArray(n)&&n.includes(e)},t.prototype._addParent=function(e){var n=this._parentage;this._parentage=Array.isArray(n)?(n.push(e),n):n?[n,e]:e},t.prototype._removeParent=function(e){var n=this._parentage;n===e?this._parentage=null:Array.isArray(n)&&ti(n,e)},t.prototype.remove=function(e){var n=this._finalizers;n&&ti(n,e),e instanceof t&&e._removeParent(this)},t.EMPTY=function(){var e=new t;return e.closed=!0,e}(),t}(),Ga=Yr.EMPTY;function Ha(t){return t instanceof Yr||t&&"closed"in t&&X(t.remove)&&X(t.add)&&X(t.unsubscribe)}function ea(t){X(t)?t():t.unsubscribe()}var Ya={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1},ni={setTimeout:function(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];var s=ni.delegate;return s!=null&&s.setTimeout?s.setTimeout.apply(s,Dn([t,e],Ht(n))):setTimeout.apply(void 0,Dn([t,e],Ht(n)))},clearTimeout:function(t){var e=ni.delegate;return((e==null?void 0:e.clearTimeout)||clearTimeout)(t)},delegate:void 0};function Xa(t){ni.setTimeout(function(){throw t})}function ta(){}function os(t){t()}var Di=function(t){Nn(e,t);function e(n){var r=t.call(this)||this;return r.isStopped=!1,n?(r.destination=n,Ha(n)&&n.add(r)):r.destination=kl,r}return e.create=function(n,r,s){return new or(n,r,s)},e.prototype.next=function(n){this.isStopped||this._next(n)},e.prototype.error=function(n){this.isStopped||(this.isStopped=!0,this._error(n))},e.prototype.complete=function(){this.isStopped||(this.isStopped=!0,this._complete())},e.prototype.unsubscribe=function(){this.closed||(this.isStopped=!0,t.prototype.unsubscribe.call(this),this.destination=null)},e.prototype._next=function(n){this.destination.next(n)},e.prototype._error=function(n){try{this.destination.error(n)}finally{this.unsubscribe()}},e.prototype._complete=function(){try{this.destination.complete()}finally{this.unsubscribe()}},e}(Yr),Il=Function.prototype.bind;function Bs(t,e){return Il.call(t,e)}var Al=function(){function t(e){this.partialObserver=e}return t.prototype.next=function(e){var n=this.partialObserver;if(n.next)try{n.next(e)}catch(r){ns(r)}},t.prototype.error=function(e){var n=this.partialObserver;if(n.error)try{n.error(e)}catch(r){ns(r)}else ns(e)},t.prototype.complete=function(){var e=this.partialObserver;if(e.complete)try{e.complete()}catch(n){ns(n)}},t}(),or=function(t){Nn(e,t);function e(n,r,s){var i=t.call(this)||this,a;if(X(n)||!n)a={next:n??void 0,error:r??void 0,complete:s??void 0};else{var o;i&&Ya.useDeprecatedNextContext?(o=Object.create(n),o.unsubscribe=function(){return i.unsubscribe()},a={next:n.next&&Bs(n.next,o),error:n.error&&Bs(n.error,o),complete:n.complete&&Bs(n.complete,o)}):a=n}return i.destination=new Al(a),i}return e}(Di);function ns(t){Xa(t)}function Ol(t){throw t}var kl={closed:!0,next:ta,error:Ol,complete:ta},Ci=function(){return typeof Symbol=="function"&&Symbol.observable||"@@observable"}();function qa(t){return t}function Tl(t){return t.length===0?qa:t.length===1?t[0]:function(n){return t.reduce(function(r,s){return s(r)},n)}}var Ve=function(){function t(e){e&&(this._subscribe=e)}return t.prototype.lift=function(e){var n=new t;return n.source=this,n.operator=e,n},t.prototype.subscribe=function(e,n,r){var s=this,i=Dl(e)?e:new or(e,n,r);return os(function(){var a=s,o=a.operator,l=a.source;i.add(o?o.call(i,l):l?s._subscribe(i):s._trySubscribe(i))}),i},t.prototype._trySubscribe=function(e){try{return this._subscribe(e)}catch(n){e.error(n)}},t.prototype.forEach=function(e,n){var r=this;return n=na(n),new n(function(s,i){var a=new or({next:function(o){try{e(o)}catch(l){i(l),a.unsubscribe()}},error:i,complete:s});r.subscribe(a)})},t.prototype._subscribe=function(e){var n;return(n=this.source)===null||n===void 0?void 0:n.subscribe(e)},t.prototype[Ci]=function(){return this},t.prototype.pipe=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];return Tl(e)(this)},t.prototype.toPromise=function(e){var n=this;return e=na(e),new e(function(r,s){var i;n.subscribe(function(a){return i=a},function(a){return s(a)},function(){return r(i)})})},t.create=function(e){return new t(e)},t}();function na(t){var e;return(e=t??Ya.Promise)!==null&&e!==void 0?e:Promise}function Rl(t){return t&&X(t.next)&&X(t.error)&&X(t.complete)}function Dl(t){return t&&t instanceof Di||Rl(t)&&Ha(t)}function Cl(t){return X(t==null?void 0:t.lift)}function Zt(t){return function(e){if(Cl(e))return e.lift(function(n){try{return t(n,this)}catch(r){this.error(r)}});throw new TypeError("Unable to lift unknown Observable type")}}function Yt(t,e,n,r,s){return new Nl(t,e,n,r,s)}var Nl=function(t){Nn(e,t);function e(n,r,s,i,a,o){var l=t.call(this,n)||this;return l.onFinalize=a,l.shouldUnsubscribe=o,l._next=r?function(u){try{r(u)}catch(d){n.error(d)}}:t.prototype._next,l._error=i?function(u){try{i(u)}catch(d){n.error(d)}finally{this.unsubscribe()}}:t.prototype._error,l._complete=s?function(){try{s()}catch(u){n.error(u)}finally{this.unsubscribe()}}:t.prototype._complete,l}return e.prototype.unsubscribe=function(){var n;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){var r=this.closed;t.prototype.unsubscribe.call(this),!r&&((n=this.onFinalize)===null||n===void 0||n.call(this))}},e}(Di),Ll=Ri(function(t){return function(){t(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"}}),Me=function(t){Nn(e,t);function e(){var n=t.call(this)||this;return n.closed=!1,n.currentObservers=null,n.observers=[],n.isStopped=!1,n.hasError=!1,n.thrownError=null,n}return e.prototype.lift=function(n){var r=new ra(this,this);return r.operator=n,r},e.prototype._throwIfClosed=function(){if(this.closed)throw new Ll},e.prototype.next=function(n){var r=this;os(function(){var s,i;if(r._throwIfClosed(),!r.isStopped){r.currentObservers||(r.currentObservers=Array.from(r.observers));try{for(var a=ms(r.currentObservers),o=a.next();!o.done;o=a.next()){var l=o.value;l.next(n)}}catch(u){s={error:u}}finally{try{o&&!o.done&&(i=a.return)&&i.call(a)}finally{if(s)throw s.error}}}})},e.prototype.error=function(n){var r=this;os(function(){if(r._throwIfClosed(),!r.isStopped){r.hasError=r.isStopped=!0,r.thrownError=n;for(var s=r.observers;s.length;)s.shift().error(n)}})},e.prototype.complete=function(){var n=this;os(function(){if(n._throwIfClosed(),!n.isStopped){n.isStopped=!0;for(var r=n.observers;r.length;)r.shift().complete()}})},e.prototype.unsubscribe=function(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null},Object.defineProperty(e.prototype,"observed",{get:function(){var n;return((n=this.observers)===null||n===void 0?void 0:n.length)>0},enumerable:!1,configurable:!0}),e.prototype._trySubscribe=function(n){return this._throwIfClosed(),t.prototype._trySubscribe.call(this,n)},e.prototype._subscribe=function(n){return this._throwIfClosed(),this._checkFinalizedStatuses(n),this._innerSubscribe(n)},e.prototype._innerSubscribe=function(n){var r=this,s=this,i=s.hasError,a=s.isStopped,o=s.observers;return i||a?Ga:(this.currentObservers=null,o.push(n),new Yr(function(){r.currentObservers=null,ti(o,n)}))},e.prototype._checkFinalizedStatuses=function(n){var r=this,s=r.hasError,i=r.thrownError,a=r.isStopped;s?n.error(i):a&&n.complete()},e.prototype.asObservable=function(){var n=new Ve;return n.source=this,n},e.create=function(n,r){return new ra(n,r)},e}(Ve),ra=function(t){Nn(e,t);function e(n,r){var s=t.call(this)||this;return s.destination=n,s.source=r,s}return e.prototype.next=function(n){var r,s;(s=(r=this.destination)===null||r===void 0?void 0:r.next)===null||s===void 0||s.call(r,n)},e.prototype.error=function(n){var r,s;(s=(r=this.destination)===null||r===void 0?void 0:r.error)===null||s===void 0||s.call(r,n)},e.prototype.complete=function(){var n,r;(r=(n=this.destination)===null||n===void 0?void 0:n.complete)===null||r===void 0||r.call(n)},e.prototype._subscribe=function(n){var r,s;return(s=(r=this.source)===null||r===void 0?void 0:r.subscribe(n))!==null&&s!==void 0?s:Ga},e}(Me),Ka={now:function(){return(Ka.delegate||Date).now()},delegate:void 0},Pl=function(t){Nn(e,t);function e(n,r,s){n===void 0&&(n=1/0),r===void 0&&(r=1/0),s===void 0&&(s=Ka);var i=t.call(this)||this;return i._bufferSize=n,i._windowTime=r,i._timestampProvider=s,i._buffer=[],i._infiniteTimeWindow=!0,i._infiniteTimeWindow=r===1/0,i._bufferSize=Math.max(1,n),i._windowTime=Math.max(1,r),i}return e.prototype.next=function(n){var r=this,s=r.isStopped,i=r._buffer,a=r._infiniteTimeWindow,o=r._timestampProvider,l=r._windowTime;s||(i.push(n),!a&&i.push(o.now()+l)),this._trimBuffer(),t.prototype.next.call(this,n)},e.prototype._subscribe=function(n){this._throwIfClosed(),this._trimBuffer();for(var r=this._innerSubscribe(n),s=this,i=s._infiniteTimeWindow,a=s._buffer,o=a.slice(),l=0;l<o.length&&!n.closed;l+=i?1:2)n.next(o[l]);return this._checkFinalizedStatuses(n),r},e.prototype._trimBuffer=function(){var n=this,r=n._bufferSize,s=n._timestampProvider,i=n._buffer,a=n._infiniteTimeWindow,o=(a?1:2)*r;if(r<1/0&&o<i.length&&i.splice(0,i.length-o),!a){for(var l=s.now(),u=0,d=1;d<i.length&&i[d]<=l;d+=2)u=d;u&&i.splice(0,u+1)}},e}(Me),Ml=new Ve(function(t){return t.complete()}),Za=function(t){return t&&typeof t.length=="number"&&typeof t!="function"};function $l(t){return X(t==null?void 0:t.then)}function Wl(t){return X(t[Ci])}function Fl(t){return Symbol.asyncIterator&&X(t==null?void 0:t[Symbol.asyncIterator])}function zl(t){return new TypeError("You provided "+(t!==null&&typeof t=="object"?"an invalid object":"'"+t+"'")+" where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.")}function Bl(){return typeof Symbol!="function"||!Symbol.iterator?"@@iterator":Symbol.iterator}var Vl=Bl();function Ul(t){return X(t==null?void 0:t[Vl])}function jl(t){return _l(this,arguments,function(){var n,r,s,i;return Va(this,function(a){switch(a.label){case 0:n=t.getReader(),a.label=1;case 1:a.trys.push([1,,9,10]),a.label=2;case 2:return[4,Fs(n.read())];case 3:return r=a.sent(),s=r.value,i=r.done,i?[4,Fs(void 0)]:[3,5];case 4:return[2,a.sent()];case 5:return[4,Fs(s)];case 6:return[4,a.sent()];case 7:return a.sent(),[3,2];case 8:return[3,10];case 9:return n.releaseLock(),[7];case 10:return[2]}})})}function Gl(t){return X(t==null?void 0:t.getReader)}function Xr(t){if(t instanceof Ve)return t;if(t!=null){if(Wl(t))return Hl(t);if(Za(t))return Yl(t);if($l(t))return Xl(t);if(Fl(t))return Qa(t);if(Ul(t))return ql(t);if(Gl(t))return Kl(t)}throw zl(t)}function Hl(t){return new Ve(function(e){var n=t[Ci]();if(X(n.subscribe))return n.subscribe(e);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}function Yl(t){return new Ve(function(e){for(var n=0;n<t.length&&!e.closed;n++)e.next(t[n]);e.complete()})}function Xl(t){return new Ve(function(e){t.then(function(n){e.closed||(e.next(n),e.complete())},function(n){return e.error(n)}).then(null,Xa)})}function ql(t){return new Ve(function(e){var n,r;try{for(var s=ms(t),i=s.next();!i.done;i=s.next()){var a=i.value;if(e.next(a),e.closed)return}}catch(o){n={error:o}}finally{try{i&&!i.done&&(r=s.return)&&r.call(s)}finally{if(n)throw n.error}}e.complete()})}function Qa(t){return new Ve(function(e){Zl(t,e).catch(function(n){return e.error(n)})})}function Kl(t){return Qa(jl(t))}function Zl(t,e){var n,r,s,i;return bl(this,void 0,void 0,function(){var a,o;return Va(this,function(l){switch(l.label){case 0:l.trys.push([0,5,6,11]),n=yl(t),l.label=1;case 1:return[4,n.next()];case 2:if(r=l.sent(),!!r.done)return[3,4];if(a=r.value,e.next(a),e.closed)return[2];l.label=3;case 3:return[3,1];case 4:return[3,11];case 5:return o=l.sent(),s={error:o},[3,11];case 6:return l.trys.push([6,,9,10]),r&&!r.done&&(i=n.return)?[4,i.call(n)]:[3,8];case 7:l.sent(),l.label=8;case 8:return[3,10];case 9:if(s)throw s.error;return[7];case 10:return[7];case 11:return e.complete(),[2]}})})}function Ql(t,e,n,r,s){r===void 0&&(r=0),s===void 0&&(s=!1);var i=e.schedule(function(){n(),s?t.add(this.schedule(null,r)):this.unsubscribe()},r);if(t.add(i),!s)return i}var Ja=Ri(function(t){return function(){t(this),this.name="EmptyError",this.message="no elements in sequence"}});function nr(t,e){return Zt(function(n,r){var s=0;n.subscribe(Yt(r,function(i){r.next(t.call(e,i,s++))}))})}var Jl=Array.isArray;function ec(t,e){return Jl(e)?t.apply(void 0,Dn([],Ht(e))):t(e)}function tc(t){return nr(function(e){return ec(t,e)})}function nc(t,e,n,r,s,i,a,o){var l=[],u=0,d=0,m=!1,h=function(){m&&!l.length&&!u&&e.complete()},f=function(_){return u<r?v(_):l.push(_)},v=function(_){i&&e.next(_),u++;var E=!1;Xr(n(_,d++)).subscribe(Yt(e,function(L){s==null||s(L),i?f(L):e.next(L)},function(){E=!0},void 0,function(){if(E)try{u--;for(var L=function(){var T=l.shift();a?Ql(e,a,function(){return v(T)}):v(T)};l.length&&u<r;)L();h()}catch(T){e.error(T)}}))};return t.subscribe(Yt(e,f,function(){m=!0,h()})),function(){o==null||o()}}function eo(t,e,n){return n===void 0&&(n=1/0),X(e)?eo(function(r,s){return nr(function(i,a){return e(r,i,s,a)})(Xr(t(r,s)))},n):(typeof e=="number"&&(n=e),Zt(function(r,s){return nc(r,s,t,n)}))}var rc=["addListener","removeListener"],sc=["addEventListener","removeEventListener"],ic=["on","off"];function ri(t,e,n,r){if(X(n)&&(r=n,n=void 0),r)return ri(t,e,n).pipe(tc(r));var s=Ht(lc(t)?sc.map(function(o){return function(l){return t[o](e,l,n)}}):ac(t)?rc.map(sa(t,e)):oc(t)?ic.map(sa(t,e)):[],2),i=s[0],a=s[1];if(!i&&Za(t))return eo(function(o){return ri(o,e,n)})(Xr(t));if(!i)throw new TypeError("Invalid event target");return new Ve(function(o){var l=function(){for(var u=[],d=0;d<arguments.length;d++)u[d]=arguments[d];return o.next(1<u.length?u:u[0])};return i(l),function(){return a(l)}})}function sa(t,e){return function(n){return function(r){return t[n](e,r)}}}function ac(t){return X(t.addListener)&&X(t.removeListener)}function oc(t){return X(t.on)&&X(t.off)}function lc(t){return X(t.addEventListener)&&X(t.removeEventListener)}function lr(t,e){return Zt(function(n,r){var s=0;n.subscribe(Yt(r,function(i){return t.call(e,i,s++)&&r.next(i)}))})}function cc(t){return Zt(function(e,n){var r=!1;e.subscribe(Yt(n,function(s){r=!0,n.next(s)},function(){r||n.next(t),n.complete()}))})}function uc(t){return t<=0?function(){return Ml}:Zt(function(e,n){var r=0;e.subscribe(Yt(n,function(s){++r<=t&&(n.next(s),t<=r&&n.complete())}))})}function dc(t){return t===void 0&&(t=hc),Zt(function(e,n){var r=!1;e.subscribe(Yt(n,function(s){r=!0,n.next(s)},function(){return r?n.complete():n.error(t())}))})}function hc(){return new Ja}function mc(t,e){var n=arguments.length>=2;return function(r){return r.pipe(t?lr(function(s,i){return t(s,i,r)}):qa,uc(1),n?cc(e):dc(function(){return new Ja}))}}function Rt(t){t===void 0&&(t={});var e=t.connector,n=e===void 0?function(){return new Me}:e,r=t.resetOnError,s=r===void 0?!0:r,i=t.resetOnComplete,a=i===void 0?!0:i,o=t.resetOnRefCountZero,l=o===void 0?!0:o;return function(u){var d,m,h,f=0,v=!1,_=!1,E=function(){m==null||m.unsubscribe(),m=void 0},L=function(){E(),d=h=void 0,v=_=!1},T=function(){var M=d;L(),M==null||M.unsubscribe()};return Zt(function(M,ne){f++,!_&&!v&&E();var Q=h=h??n();ne.add(function(){f--,f===0&&!_&&!v&&(m=Vs(T,l))}),Q.subscribe(ne),!d&&f>0&&(d=new or({next:function(ee){return Q.next(ee)},error:function(ee){_=!0,E(),m=Vs(L,s,ee),Q.error(ee)},complete:function(){v=!0,E(),m=Vs(L,a),Q.complete()}}),Xr(M).subscribe(d))})(u)}}function Vs(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];if(e===!0){t();return}if(e!==!1){var s=new or({next:function(){s.unsubscribe(),t()}});return Xr(e.apply(void 0,Dn([],Ht(n)))).subscribe(s)}}function Ls(t){return Array.isArray(t)||ArrayBuffer.isView(t)}function to(t,e){let{x:n,y:r,z:s}=e,{x:i,y:a,z:o,w:l}=t,u=l*n+a*s-o*r,d=l*r+o*n-i*s,m=l*s+i*r-a*n,h=-i*n-a*r-o*s,f=u*l+h*-i+d*-o-m*-a,v=d*l+h*-a+m*-i-u*-o,_=m*l+h*-o+u*-a-d*-i;return new e.constructor(f,v,_)}var si=Math.PI,Us=Math.PI*2;function qr(t){let e=t%Us;return e<-si?e+=Us:e>si&&(e-=Us),e}function fc(t){return t>-1?t<1?Math.acos(t):0:si}function pc(t,[e,n,r]){let[s,i,a]=t;return new t.constructor(new s.constructor(s.x*e.x+i.x*e.y+a.x*e.z,s.y*e.x+i.y*e.y+a.y*e.z,s.z*e.x+i.z*e.y+a.z*e.z),new s.constructor(s.x*n.x+i.x*n.y+a.x*n.z,s.y*n.x+i.y*n.y+a.y*n.z,s.z*n.x+i.z*n.y+a.z*n.z),new s.constructor(s.x*r.x+i.x*r.y+a.x*r.z,s.y*r.x+i.y*r.y+a.y*r.z,s.z*r.x+i.z*r.y+a.z*r.z))}function gc(t,{x:e,y:n,z:r}){let[s,i,a]=t;return new s.constructor(s.x*e+i.x*n+a.x*r,s.y*e+i.y*n+a.y*r,s.z*e+i.z*n+a.z*r)}function _c(t,[e,n,r]){return new t.constructor(t.dot(e),t.dot(n),t.dot(r))}function At(t){return typeof t=="number"||(t==null?void 0:t.constructor)===Number}var bc=t=>{try{Ln(t),Zr(t,4)}catch(e){console.error("error while hijackDOMPoint"),console.error(e)}},Kr=0,Ni=1,Li=2,Pi=3,fs=9999999999999,ps=void 0,no=Symbol("vector length"),Ps=Symbol("get source"),ia=Symbol("checked"),De=ps,mt,Cn,yc=[0,1,2,6,24,120,720,5760,51840,518400,5702400,68428800,889574400,12454041600,186810624e3],ii=[],qn=-1,js=!1,aa=[];function Gs(t,e,n){De=t,qn=-1,Cn=1;let r=e(n);if(!At(r))throw new Error(`
      your assigned progress did not not return a primitive!
      calc() does not support logical operators (|| && ==) directly

      instead of calc(() => v1 || v2);
      use        calc(() => +v1 || +v2);

      instead of calc(() => v1);
      use        calc(v1);
      `);return r}function gs(t){let e=t[Ps];return e?e(t).length:t[no]||3}function wc(t,e){return gs(t)>gs(e)?t:e}function xc(t,e){if(Cn+=1,e===fs)return Cn;if(e>=gs(t))return 0;let n=t[Ps];if(n)return 1*n(t)[e];if(e===Kr)return 1*t.x;if(e===Ni)return 1*t.y;if(e===Li)return 1*t.z;if(e===Pi)return 1*t.w}function oa(t,e,n){let r=t[Ps];if(r){r(t)[e]=n;return}if(e===Kr){t.x=n;return}if(e===Ni){t.y=n;return}e===Li&&(t.z=n),e===Pi&&(t.w=n)}function Ee(t,e){if(typeof t!="function")throw new Error("no function assigned");if(De!==ps)throw new Error("something wrong, do you use calc() inside calc?");try{let n=typeof e>"u",r=typeof e=="function",s=!r&&!n?e:void 0,i=Gs(Kr,t,s);if(n&&typeof mt>"u")return i;let a=mt?gs(mt):0;if(a===fs){if(!t[ia]){let d=Gs(fs,t),m=yc[Cn];if(Math.abs(d-m)>Number.EPSILON)throw new Error(`
            algebraic multiplication works only in calls with *

            calc(() => v * m);
            calc(() => m * v);
            calc(() => m * m);
            calc(() => m * m * v);

            `);t[ia]=!0}let u=ii[0];for(let d=1;d<Cn-1;d+=1){let m=ii[d];if(!u.multiply)throw new Error(`cannot find method multiply() on ${u}`);u=u.multiply(m)}return u}let o=r?e.length:a;if(o||(o=a),o<a)throw new Error("Your assigned result Vector cant use higher space Operands than it has");let l=new Array(o);l[0]=i,s&&oa(s,De,l[0]);for(let u=1;u<o;u+=1){let d=Gs(u,t,s);l[u]=d,s&&oa(s,De,d)}return n?new mt.constructor(...l):r?e(...l):s}finally{De=ps,mt=void 0}}function Ln(t,e){let n=t.prototype;n[Ps]=e;let r=n[Symbol.toPrimitive]||function(s){return s==="string"?this.toString():this.valueOf()};n[Symbol.toPrimitive]=function(s){return De===Kr&&(mt=mt?wc(mt,this):this,ii[Cn-1]=this),De===ps?r.call(this,s):xc(this,De)}}function Mi(t){return function(...e){if(De===Kr){if(js)return t.apply(this,e);try{js=!0,qn+=1;let n=t.apply(this,e);return aa[qn]=n,n}finally{js=!1}}return De===Ni||De===Li||De===Pi?(qn+=1,aa[qn]):t.apply(this,e)}}function be(t,e){let n=t.prototype,r=n[e];n[e]=Mi(r)}function Ms(t,e){let n=t.prototype,r=Object.getOwnPropertyDescriptor(n,e);Object.defineProperty(n,e,{get:Mi(function(){return r.get.call(this)})})}function Zr(t,e){let n=t.prototype;Object.defineProperty(n,no,{value:e})}function ro(t){Zr(t,fs)}function $s(t){return Mi(t)}typeof DOMPoint<"u"&&bc(DOMPoint);function vc(t){let e="";return t&&(e=`${t}-`),e}function Qr(t,e,n={}){let r=vc(t);return Object.entries(e).forEach(([s,i])=>{n[`--${r}${s}`]=i}),n}var ai=0,oi=1,Pe=Symbol("axes");function Ec(t,e,n,r){let s=Math.atan2(t,e),i=Math.atan2(n,r);return qr(s-i)}function la(t){return t*t}var $e=class{constructor(t,e){typeof t=="function"?Ee(t,(n,r)=>{this[Pe]=[n,r]}):Ls(t)?this[Pe]=[...t]:t&&At(t.x)?this[Pe]=[t.x||0,t.y||0]:this[Pe]=[t||0,e||0]}valueOf(){throw new Error("valueOf() not implemented, looks like you try to calculate outside of calc")}normalize(){let{length:t}=this;return new this.constructor(this.x/t,this.y/t)}norm(){return this.normalize()}dot(t){return this.x*t.x+this.y*t.y}getRad(){return qr(Math.atan2(this.y,this.x))}angleTo(t){return Ec(this.y,this.x,t.y,t.x)}rotate(t){let e=Math.sin(t),n=Math.cos(t),r=this.x*n-this.y*e,s=this.x*e+this.y*n;return new this.constructor(r,s)}distance(t){return Math.sqrt(la(this.x-t.x)+la(this.y-t.y))}dist(t){return this.distance(t)}toArray(){return[this.x,this.y]}calc(t){throw new Error("calc() not implemented")}clone(){throw new Error("clone() not implemented")}equals(t){return this.x===t.x&&this.y===t.y}toJSON(){return{x:this.x,y:this.y}}toString(){return JSON.stringify(this.toJSON())}toCSSVars(t,e){return Qr(t,this.toJSON(),e)}get lengthSq(){return this.dot(this)}get length(){return Math.sqrt(this.lengthSq)}get lensq(){return this.lengthSq}get len(){return this.length}get x(){return this[Pe][ai]}set x(t){throw new Error("set x() not implemented")}get y(){return this[Pe][oi]}set y(t){throw new Error("set y() not implemented")}get z(){throw new Error("get z() not implemented")}set z(t){throw new Error("set z() not implemented")}[Symbol.iterator](){return this[Pe].values()}};Ln($e);Zr($e,2);be($e,"dot");be($e,"angleTo");be($e,"distance");be($e,"toArray");be($e,"getRad");Ms($e,"length");Ms($e,"lengthSq");var so=class io extends $e{set x(e){this[Pe][ai]=e}set y(e){this[Pe][oi]=e}get x(){return this[Pe][ai]}get y(){return this[Pe][oi]}calc(e){return Ee(e,this)}clone(){return new io(this.x,this.y)}},tn=class extends $e{toPoint(){return new so(this.x,this.y)}},Sc=$s((t,e)=>new so(t,e)),ao=(t,e)=>Sc(t,e),Ic=$s((t,e)=>new tn(t,e)),O=(t,e)=>Ic(t,e);O(0,0);O(0,-1);O(-1,0);var nn=0,rn=1,sn=2,q=Symbol("axes");function Hs(t){return t*t}var ye=class{constructor(t,e,n){typeof t=="function"?Ee(t,(r,s,i)=>{this[q]=[r,s,i]}):Ls(t)?this[q]=[...t]:t&&At(t.x)?this[q]=[t.x||0,t.y||0,t.z||0]:this[q]=[t||0,e||0,n||0]}valueOf(){throw new Error("valueOf() not implemented, looks like you try to calculate outside of calc")}normalize(){let{length:t}=this;return new this.constructor(this.x/t,this.y/t,this.z/t)}norm(){return this.normalize()}dot(t){return this.x*t.x+this.y*t.y+this.z*t.z}cross(t){return new this.constructor(this.y*t.z-this.z*t.y,this.z*t.x-this.x*t.z,this.x*t.y-this.y*t.x)}crossNormalize(t){let e=this.cross(t),{length:n}=e;return e[q][nn]/=n,e[q][rn]/=n,e[q][sn]/=n,e}cn(t){return this.crossNormalize(t)}toAngles(){return{theta:Math.atan2(this.z,this.x),phi:Math.asin(this.y/this.length)}}angleTo(t){return qr(fc(this.dot(t)/(this.length*t.length)))}multiply(t){return t.x===void 0?this.multiplyMat3(t):t.w===void 0?this.multiplyVec3(t):to(t,this)}multiplyMat3(t){return _c(this,t)}multiplyVec3({x:t,y:e,z:n}){return new this.constructor(this.x*t,this.y*e,this.z*n)}distance(t){return Math.sqrt(Hs(this.x-t.x)+Hs(this.y-t.y)+Hs(this.z-t.z))}dist(t){return this.distance(t)}toArray(){return[this.x,this.y,this.z]}swizzle(t){let e=t.split("").map(n=>this[n]);return e.length===2?new tn(e[0],e[1]):new this.constructor(e[0],e[1],e[2])}calc(t){throw new Error("calc() not implemented")}clone(){throw new Error("clone() not implemented")}equals(t){return this.x===t.x&&this.y===t.y&&this.z===t.z}toJSON(){return{x:this.x,y:this.y,z:this.z}}toString(){return JSON.stringify(this.toJSON())}toCSSVars(t,e){return Qr(t,this.toJSON(),e)}get lengthSq(){return this.dot(this)}set lengthSq(t){throw new Error("set lengthSq() not implemented")}get length(){return Math.sqrt(this.lengthSq)}set length(t){throw new Error("set length() not implemented")}get lensq(){return this.lengthSq}set lensq(t){throw new Error("set lensq() not implemented")}get len(){return this.length}set len(t){throw new Error("set len() not implemented")}get x(){return this[q][nn]}set x(t){throw new Error("set x() not implemented")}get y(){return this[q][rn]}set y(t){throw new Error("set y() not implemented")}get z(){return this[q][sn]}set z(t){throw new Error("set z() not implemented")}get xy(){return new tn(this[q][nn],this[q][rn])}set xy(t){throw new Error("set xz() not implemented")}get xz(){return new tn(this[q][nn],this[q][sn])}set xz(t){throw new Error("set xz() not implemented")}get yz(){return new tn(this[q][rn],this[q][sn])}set yz(t){throw new Error("set yz() not implemented")}[Symbol.iterator](){return this[q].values()}};Ln(ye);Zr(ye,3);be(ye,"dot");be(ye,"cross");be(ye,"crossNormalize");be(ye,"toAngles");be(ye,"angleTo");be(ye,"rotate");be(ye,"distance");be(ye,"toArray");Ms(ye,"length");Ms(ye,"lengthSq");var Ac=class oo extends ye{set x(e){this[q][nn]=e}set y(e){this[q][rn]=e}set z(e){this[q][sn]=e}get x(){return this[q][nn]}get y(){return this[q][rn]}get z(){return this[q][sn]}calc(e){return Ee(e,this)}clone(){return new oo(this.x,this.y,this.z)}},Oc=class extends ye{toVector(){return new Ac(this.x,this.y,this.z)}clone(){return this}},kc=$s((t,e,n)=>new Oc(t,e,n)),Ot=(t,e,n)=>kc(t,e,n);Ot(0,0,0);var lo=Ot(0,0,-1);Ot(0,0,1);var $i=Ot(-1,0,0);Ot(1,0,0);var co=Ot(0,1,0);Ot(0,-1,0);Ot(1,1,1);var Qe=Symbol("angle rad"),uo=Math.PI/180,_s=class ho{constructor(e){e instanceof ho?this[Qe]=e[Qe]:this[Qe]=qr(e*uo)}valueOf(){return this[Qe]}toJSON(){return{angle:this[Qe]}}toString(){return JSON.stringify(this.toJSON())}toCSSVars(e,n){return Qr(e,this.toJSON(),n)}},mo=class extends _s{set(t){t instanceof _s?this[Qe]=t[Qe]:this[Qe]=qr((t||0)*uo)}},Tc=class extends _s{toDegree(){return new mo(this[Qe])}};new Tc(0);function Rc(t){return new mo(t)}function Dc(t){return At(t)||t instanceof _s}var Je=0,et=1,tt=2,nt=3,ae=Symbol("axes"),Cc=Symbol("forward cache"),Nc=Symbol("left cache"),Lc=Symbol("up cache"),Pc=Symbol("inverse cache");function Mc([t,e,n,r]){return Math.sqrt(t*t+e*e+n*n+r*r)}function fo(t){let e=Mc(t);t[Je]/=e,t[et]/=e,t[tt]/=e,t[nt]/=e}function $c(t,e){let n=t.normalize(),r=e.crossNormalize(n),s=n.crossNormalize(r),i=r.x,a=r.y,o=r.z,l=s.x,u=s.y,d=s.z,m=n.x,h=n.y,f=n.z,v=i+u+f,_=new Array(4);if(v>0){let T=Math.sqrt(v+1);return _[nt]=T*.5,T=.5/T,_[Je]=(d-h)*T,_[et]=(m-o)*T,_[tt]=(a-l)*T,_}if(i>=u&&i>=f){let T=Math.sqrt(1+i-u-f),M=.5/T;return _[Je]=.5*T,_[et]=(a+l)*M,_[tt]=(o+m)*M,_[nt]=(d-h)*M,_}if(u>f){let T=Math.sqrt(1+u-i-f),M=.5/T;return _[Je]=(l+a)*M,_[et]=.5*T,_[tt]=(h+d)*M,_[nt]=(m-o)*M,_}let E=Math.sqrt(1+f-i-u),L=.5/E;return _[Je]=(m+o)*L,_[et]=(h+d)*L,_[tt]=.5*E,_[nt]=(a-l)*L,_}function Wc(t,e){let n=new Array(4),r=e*.5,s=Math.sin(r),i=Math.cos(r);return n[Je]=s*t.x,n[et]=s*t.y,n[tt]=s*t.z,n[nt]=i,n}function li(t,e,n,r){if(At(t))return[t,e,n,r];if(Ls(t))return[...t];if(Dc(e))return Wc(t,e);if(t&&e)return $c(t,e)}function po(t,e,n,r){return t&&At(t.w)?li(t.x,t.y,t.z,t.w):li(t,e,n,r)||[0,0,0,1]}var cr=class{constructor(t,e,n,r){this[ae]=po(t,e,n,r),fo(this[ae])}set(t,e,n,r){throw new Error("set x() not implemented")}multiply(t,e,n,r){if(At(t.w))return this.multiplyQuaternion(t);let s=li(t,e,n,r);return s?this.multiplyQuaternion(new this.constructor(s)):this.multiplyVector(t)}multiplyVector(t){return to(this,t)}multiplyQuaternion(t){let e=this.x,n=this.y,r=this.z,s=this.w,i=t.x,a=t.y,o=t.z,l=t.w,u=s*i+e*l+n*o-r*a,d=s*a+n*l+r*i-e*o,m=s*o+r*l+e*a-n*i,h=s*l-e*i-n*a-r*o;return new this.constructor(u,d,m,h)}mul(t,e,n,r){return this.multiply(t,e,n,r)}get inverse(){let{x:t,y:e,z:n,w:r}=this;return this.constructor(t*-1,e*-1,n*-1,r)}get inv(){return this.inverse}equals(t){return this.x===t.x&&this.y===t.y&&this.z===t.z&&this.w===t.w}get left(){return this.multiplyVector($i)}get dir(){return this.multiplyVector(lo)}get up(){return this.multiplyVector(co)}get 0(){return this.left}get 1(){return this.dir}get 2(){return this.up}get x(){return this[ae][Je]}set x(t){throw new Error("set x() not implemented")}get y(){return this[ae][et]}set y(t){throw new Error("set y() not implemented")}get z(){return this[ae][tt]}set z(t){throw new Error("set z() not implemented")}get w(){return this[ae][nt]}set w(t){throw new Error("set w() not implemented")}toJSON(){let{x:t,y:e,z:n,w:r}=this;return{x:t,y:e,z:n,w:r,a1:1-e*e*2-n*n*2,a2:t*e*2-n*r*2,a3:t*n*2+e*r*2,b1:t*e*2+n*r*2,b2:1-t*t*2-n*n*2,b3:e*n*2-t*r*2,c1:t*n*2-e*r*2,c2:e*n*2+t*r*2,c3:1-t*t*2-e*e*2}}toString(){return JSON.stringify(this.toJSON())}toCSSVars(t,e){return Qr(t,this.toJSON(),e)}};Ln(cr);ro(cr);var Fc=class extends cr{set(t,e,n,r){t instanceof cr?this[ae]=[...t[ae]]:(this[ae]=po(t,e,n,r),fo(this[ae]))}set x(t){this[ae][Je]=t}set y(t){this[ae][et]=t}set z(t){this[ae][tt]=t}set w(t){this[ae][nt]=t}get x(){return this[ae][Je]}get y(){return this[ae][et]}get z(){return this[ae][tt]}get w(){return this[ae][nt]}};function rs(t,e,n){let r=t[e];return r||(r=n(),t[e]=r),r}var go=class extends cr{get left(){return rs(this,Nc,()=>this.multiplyVector($i))}get dir(){return rs(this,Cc,()=>this.multiplyVector(lo))}get up(){return rs(this,Lc,()=>this.multiplyVector(co))}get inverse(){return rs(this,Pc,()=>{let{x:t,y:e,z:n,w:r}=this;return this.constructor(t*-1,e*-1,n*-1,r)})}};new Fc;var zc=$s((t,e,n,r)=>new go(t,e,n,r)),Bc=(t,e,n,r)=>zc(t,e,n,r);new go($i,Rc(90));Bc(0,0,0,1);var Vc=0,Uc=1,jc=2,Gc=3,Ue=Symbol("axes"),Wi=class{constructor(t,e,n,r){typeof t=="function"?Ee(t,(s,i,a,o)=>{this[Ue]=[s,i,a,o]}):Ls(t)?this[Ue]=[...t]:t&&At(t.x)?this[Ue]=[t.x||0,t.y||0,t.z||0,t.w||0]:this[Ue]=[t||0,e||0,n||0,r||0]}dot(t){return this.x*t.x+this.y*t.y+this.z*t.z+this.w*t.w}valueOf(){throw new Error("valueOf() not implemented, looks like you try to calculate outside of calc")}toArray(){return[this.x,this.y,this.z,this.w]}calc(t){throw new Error("calc() not implemented")}clone(){throw new Error("clone() not implemented")}equals(t){return this.x===t.x&&this.y===t.y&&this.z===t.z&&this.w===t.w}toJSON(){return{x:this.x,y:this.y,z:this.z,w:this.w}}toString(){return JSON.stringify(this.toJSON())}toCSSVars(t,e){return Qr(t,this.toJSON(),e)}get x(){return this[Ue][Vc]}set x(t){throw new Error("set x() not implemented")}get y(){return this[Ue][Uc]}set y(t){throw new Error("set y() not implemented")}get z(){return this[Ue][jc]}set z(t){throw new Error("set z() not implemented")}get w(){return this[Ue][Gc]}set w(t){throw new Error("set w() not implemented")}[Symbol.iterator](){return this[Ue].values()}};Ln(Wi);Zr(Wi,4);be(Wi,"toArray");var Bn=Symbol("data"),_o=class bo{constructor(...e){this[Bn]=e}get 0(){return this[Bn][0]}set 0(e){throw new Error("set [0] not implemented")}get 1(){return this[Bn][1]}set 1(e){throw new Error("set [1] not implemented")}get 2(){return this[Bn][2]}set 2(e){throw new Error("set [2] not implemented")}multiplyMat(e){return pc(this,e)}multiplyVec(e){return gc(this,e)}multiply(e){if(e instanceof bo)return this.multiplyMat(e);let{x:n,y:r,z:s}=e;if(n===void 0||r===void 0||s===void 0)throw new Error(`multiply only works with mat3 and vec3, not supported ${e}`);return this.multiplyVec(e)}[Symbol.iterator](){return this[Bn].values()}};Ln(_o);ro(_o);class Hc{constructor(e){p(this,"items",[]);p(this,"itemsMapping",new Map);p(this,"key");this.key=e}add(e){e.forEach(n=>{[].concat(n[this.key]).forEach(r=>{this.itemsMapping.set(r,n)})}),this.items.push(...e)}remove(e){e.forEach(n=>{this.items.splice(this.items.indexOf(n),1)})}has(e){return this.itemsMapping.has(e)}get(e){return this.itemsMapping.get(e)}}class Yc extends Hc{constructor(){super("name")}}const Dt=new Yc;var hr,mr,ln,fr;class Xc{constructor({name:e,description:n,args:r,action:s}){g(this,hr,void 0);g(this,mr,void 0);g(this,ln,[]);g(this,fr,void 0);A(this,hr,[].concat(e)),A(this,mr,n),A(this,ln,r||c(this,ln)),A(this,fr,s)}action(...e){return c(this,fr).call(this,...e)}get description(){return c(this,mr)}get name(){return c(this,hr)}get args(){return c(this,ln)}}hr=new WeakMap,mr=new WeakMap,ln=new WeakMap,fr=new WeakMap;function yo(t){return t.map(e=>new Xc(e))}function qc(t,e){return t.args.reduce((n,r)=>{const s=[].concat(r.name);s.length<1&&(s.push=`argument-${r.index}`);const i=en(r.name[0]);if("index"in r&&r.index!==void 0&&Number(r.index)in e.args){const a=r.index;let o=e.args[Number(a)];o=o===void 0?!0:o,n[Number(a)]=o,n.unresolved[Number(a)]=e.unresolved.args[Number(a)],n[String(i)]=o,n.unresolved[String(i)]=e.unresolved.args[Number(a)]}return s.forEach(a=>{if(a in e.kwargs){const o=e.kwargs[String(a)];n[String(i)]=o===void 0?!0:o,n.unresolved[String(i)]=e.kwargs[String(a)]===void 0?!0:o}}),n},{unresolved:{}})}var pr,gr,_r,br;class x{constructor({name:e,index:n,flag:r,description:s}){g(this,pr,void 0);g(this,gr,void 0);g(this,_r,void 0);g(this,br,void 0);A(this,pr,[].concat(e)),A(this,gr,n),A(this,_r,r),A(this,br,s)}get name(){return c(this,pr)}get index(){return c(this,gr)}get flag(){return c(this,_r)}get description(){return c(this,br)}}pr=new WeakMap,gr=new WeakMap,_r=new WeakMap,br=new WeakMap;let ss;const Kc=new Uint8Array(16);function Zc(){if(!ss&&(ss=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!ss))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return ss(Kc)}const oe=[];for(let t=0;t<256;++t)oe.push((t+256).toString(16).slice(1));function Qc(t,e=0){return(oe[t[e+0]]+oe[t[e+1]]+oe[t[e+2]]+oe[t[e+3]]+"-"+oe[t[e+4]]+oe[t[e+5]]+"-"+oe[t[e+6]]+oe[t[e+7]]+"-"+oe[t[e+8]]+oe[t[e+9]]+"-"+oe[t[e+10]]+oe[t[e+11]]+oe[t[e+12]]+oe[t[e+13]]+oe[t[e+14]]+oe[t[e+15]]).toLowerCase()}const Jc=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),ca={randomUUID:Jc};function Pn(t,e,n){if(ca.randomUUID&&!e&&!t)return ca.randomUUID();t=t||{};const r=t.random||(t.rng||Zc)();if(r[6]=r[6]&15|64,r[8]=r[8]&63|128,e){n=n||0;for(let s=0;s<16;++s)e[n+s]=r[s];return e}return Qc(r)}const We={DEFAULT:0,CHECKBOX:1,RADIO:2};class ua{constructor({type:e=We.DEFAULT,model:n,options:r,action:s,command:i,url:a,order:o=-1,title:l=null,items:u=[],name:d=null,value:m=null,hotKey:h,keyCode:f,separator:v=!1,onInit:_}){p(this,"options",{disabled:!1,checked:!1});this.id=Pn(),this.type=e,this.model=n,this.options=Object.assign(r||{},this.options,Object.assign({},r)),e===We.RADIO&&(this.options.checked=this.options.checked=this.options.checked?m:!1),this.action=s,this.command=i,this.url=a,this.name=d,this.value=m,this.order=o,this.title=l,this.items=wo(u),this.hotKey=h,this.keyCode=f,this.separator=v,_&&_(this)}}function wo(t){return t.map(e=>e instanceof ua?e:new ua(e))}class Xt{constructor(e,n){p(this,"id",Pn());p(this,"items",[]);e&&(this.items=wo(e(n)))}add(e){e instanceof Xt&&this.items.push(...e.items)}}class Ws{constructor({config:e={},commands:n,contextMenu:r=null,core:s}){p(this,"commands",[]);p(this,"contextMenu",[]);p(this,"config",{});p(this,"core");this.core=s,this.config=e,this.commands=n,this.contextMenu=r}beforeSetup(){const e=this.core;e.config.setDefaults(this.config),typeof this.commands=="function"&&(this.commands=yo(this.commands({core:e,module:this})),Dt.add(this.commands)),typeof this.contextMenu=="function"&&(this.contextMenu=new Xt(this.contextMenu,{core:e,module:this}),this.core.modules.windows.contextMenu.addDefaultItems(this.contextMenu))}setup(e){this.log(this.name)}destroy(){this.core.removeCommands(this.commands)}log(e){this.core.logger.add(e,{namespace:this.constructor.NAME})}get name(){return this.constructor.NAME}}const xo="default",Kn={default:{title:"Theme Default",colors:["#FFFFFF","#000","#FFAA55","#0055AA"],filter:"invert(100%)"},theme1:{title:"Theme 1",colors:["#000000","#FFFFFF","#4466aa","#919191"],filter:"invert(100%)"},theme2:{title:"Theme 2",colors:["#FFFFFF","#000000","#dd99aa","#8080a0"],filter:"invert(100%)"},theme3:{title:"Theme 3",colors:["#FFFFFF","#000000","#a8a0a0","#406080"],filter:"invert(100%)"},theme4:{title:"Theme 4",colors:["#FFFFFF","#50473f","#a08070","#b0a090"],filter:"invert(100%)"},themeAmber:{title:"Theme Amber",colors:["#FFB000","#805800","#805800","#000000"],filter:"brightness(50%)"},themeGreen:{title:"Theme Green",colors:["#00f900","#008f11","#00Bb00","#000000"],filter:"brightness(50%)"},themeRed:{title:"Theme Red",colors:["#ee0000","#660000","#990000","#330000"],filter:"brightness(50%)"}};function vo(t){return t=t||["#FFF","#000","#FFAA55","#0055AA"],{boot:{sequence_error:"#000",sequence_ready:t[3],sequence_no_disk:"#fff",sequence_0:"#000",sequence_1:"#ccc",sequence_2:"#fff",sequence_3:t[3]},symbol:{primary:t[0],secondary:t[1],tertiary:t[2],quaternary:t[3]},screen:{background:t[3]},header:{background:t[0],coverBackground:t[0],coverTitle:t[3],title:t[3]},windowHeader:{background:t[0],stripes:t[3],title:t[3],buttonBackground:t[3],buttonPrimary:t[0],buttonSecondary:t[1]},contextMenu:{border:t[3]},contextMenuItem:{background:t[0],label:t[3],indicatorContext:t[3],hotkey:t[3]},contextMenuSeparator:{background:t[3]},window:{text:t[0],background:t[3],border:t[0],borderScaling:t[2],helper__scaleBackground:t[0],helper__scaleIcon:t[3],helper__scaleIconActive:t[1]},storageBar:{background:t[1],border:t[0],sizeHelper:t[2],icon:t[0]},scrollContent:{scrollbarCorner:t[0],scrollbarSpacer:t[0],scrollbarBackground:t[3],scrollbarHelperBackground:t[0],scrollbarHelper:t[3],scrollbarHelperActive:t[1],scrollbarRange:t[0]},symbolWrapperItem:{text:t[0]},button:{label:t[0],primary:{label:t[3],background:t[0],border:t[0],outline:t[3]},secondary:{label:t[0],background:t[3],border:t[0]},dialog:{label:t[3],background:t[0],border:t[2],outline:t[3]}},checkboxGroupItem:{disabled:{icon:t[0],background:t[0]},background:t[3],checkbox:{icon:t[0]},radio:{icon:t[0]}},rangeSlider:{background:t[3],border:t[0],thumbBackground:t[0]},textbox:{text:t[0],background:t[3],border:t[3],outline:t[0],dialog:{text:t[3],background:t[0],border:t[0],outline:t[3]},disabledReadonlyText:t[3],disabledReadonlyBackground:t[0]},textarea:{text:t[0],background:t[3],border:t[3],outline:t[0],resizeBackground:t[3],resizeIcon:t[0]},dropdown:{disabled:{text:t[3],background:t[0]},text:t[0],background:t[3],border:t[3],outline:t[0],scrollbarPrimary:t[0],scrollbarSecondary:t[3],expander:{icon:t[3],border:t[3],background:t[0]}},itemSelect:{border:t[0]},itemSelectItem:{border:t[0],background:t[3],disabledLabelText:t[0],disabledLabelbackground:t[1]},inputText:{selected:t[3],pointer:t[2]},markdown:{typo:{selection:t[1],headlinePrimary:t[0],headlineSecondary:t[2],strong:t[2],strongEm:t[0],link:t[2],linkHover:t[0],del:t[1],line:t[0],blockquoteBackground:t[2],blockquoteText:t[1],codeBackground:t[0],codeText:t[1],codeSelection:t[2]}},dialogContent:{backgroundPrimary:t[0],backgroundSecondary:t[0],text:t[3]},form:{fieldsetBorder:t[2]},console:{text:t[0],typo:{fieldsetBorder:t[2],line:t[0],strong:t[2],strongEm:t[0]}},core:{text:t[0]},workbench13:{calculator:{background:t[1],button:{text:t[0],border:t[0]},result:{border:t[0]}}}}}function Eo(t){return{default:t||"invert(100%)"}}class eu{constructor(e,n){p(this,"name","wb13");const{colors:r,filters:s}=Object.assign({colors:{},filters:{}},n);this.name=e||this.name,this.colors=Object.assign(vo(),r),this.filters=Object.assign(Eo(),s)}toCSSVars(){return Object.assign({},ci(Object.assign({color:this.colors,filter:this.filters})),ci())}}const tu="-";function ci(t,e="",n={}){return typeof t=="object"?(Object.keys(t).map(r=>ci(t[String(r)],(e?e+tu:"")+r,n)),n):(n[`--${wl(e)}`]=t,n)}class nu extends eu{constructor(e,n){const{colors:r,filter:s}=Object.assign({colors:null,filter:null},n);super(e,{colors:vo(r),filters:Eo(s)})}}const zp=2e3,Bp={NO_DISK:"no-disk",ERROR:"error",READY:"ready",SEQUENCE_1:0,SEQUENCE_2:1,SEQUENCE_3:2},$={SCREEN_1084_FRAME:"core_screen1084Frame",SCREEN_REAL_LOOK:"core_screenRealLook",SCREEN_SCAN_LINES:"core_screenScanlines",SCREEN_ACTIVE_ANIMATION:"core_screenActiveAnimation",BOOT_WITH_SEQUENCE:"core_bootWithSequence",BOOT_WITH_WEBDOS:"core_bootWithWebDos",THEME:"core_theme",FILE_EXTENSION_ASSIGNMENT:"core_fileExtensionAssignment"},da={[$.SCREEN_1084_FRAME]:!0,[$.SCREEN_REAL_LOOK]:!0,[$.SCREEN_SCAN_LINES]:!0,[$.SCREEN_ACTIVE_ANIMATION]:!0,[$.BOOT_WITH_SEQUENCE]:!0,[$.BOOT_WITH_WEBDOS]:!0,[$.THEME]:Kn[String(xo)],[$.FILE_EXTENSION_ASSIGNMENT]:[["md","DF0:DocumentReader.app"],["bas","DF1:WebBasic.app"],["basic","DF1:WebBasic.app"]]},ru="web_workbench_CONFIG",Vp=new Promise(t=>{/complete|interactive|loaded/.test(document.readyState)?t():document.addEventListener("DOMContentLoaded",t,!1)});var yr;class su{constructor(){g(this,yr,void 0);window.requestAnimationFrame(()=>{document.documentElement.style.overflowY="scroll",A(this,yr,window.innerWidth-document.body.offsetWidth),document.documentElement.style.overflowY=null})}get size(){return c(this,yr)}}yr=new WeakMap;const Up=new su;function iu(t,e){return t===e?!0:t.parentElement?t.parentElement!==e?iu(t.parentElement,e):!0:!1}window.requestAnimationFrame(()=>{document.documentElement.style.overflowY="scroll",window.innerWidth-document.body.offsetWidth,document.documentElement.style.overflowY=null});function ls(t){if(t.touches&&t.touches.length>0){const e=t.touches[0];t.clientX=e.clientX,t.clientY=e.clientY}return"x"in t||(t.x=t.clientX,t.y=t.clientY),t}class G{constructor(e,n){this.name=e,this.value=n}}const au=O(0,0);var pt;class ur{constructor({title:e,sidebarComponent:n,sidebarComponentData:r,component:s,componentData:i,options:a,symbolWrapper:o,wrapper:l,layout:u}){g(this,pt,new Me);p(this,"id",Pn());p(this,"component");p(this,"componentData");p(this,"sidebarComponent");p(this,"sidebarComponentData");p(this,"options",Ne({title:"Unnamed",scale:!0,scrollX:!0,scrollY:!0,clampX:!0,clampY:!1,freeze:!1,focused:!1,center:!0,close:!0,overlay:!0,embed:!1,borderless:!1,hideRootHeader:!1,sidebar:!0}));p(this,"symbolWrapper",null);p(this,"group",null);p(this,"wrapper",null);p(this,"layout",Ne({focused:!1,position:O(0,0),size:au,scrollOffset:O(0,0)}));this.options.title=e,n&&(this.sidebarComponent=z(n)),r&&(this.sidebarComponentData=z(r)),this.component=z(s),this.componentData={...i,window:this},o&&(this.symbolWrapper=z(o)),l&&(this.wrapper=z(l)),this.options=Object.assign(this.options,a),this.layout=Object.assign(this.layout,u)}ready(){this.options.ready=!0,c(this,pt).next(new G("ready"))}focus(){this.options.focused=!0,c(this,pt).next(new G("focus"))}unfocus(){this.options.focused=!1,c(this,pt).next(new G("unfocus"))}close(e){this.wrapper&&(c(this,pt).next(new G("close",e)),this.wrapper.remove(this.id),this.wrapper=null)}setWrapper(e){this.wrapper=z(e)}setGroup(e){this.group=e}get events(){return c(this,pt)}}pt=new WeakMap;var cn;class ou{constructor(){g(this,cn,new Map)}get items(){return c(this,cn)}add(e,n){Array.isArray(e)?e.forEach(r=>{this.add(...r)}):c(this,cn).set(e,[].concat(n))}get(...e){const n=e.shift();return c(this,cn).get(n).map(r=>e.reduce((s,i)=>s.replace(/%\d+/,i),r))}}cn=new WeakMap;const P=new ou;P.add("bad_args","Bad args");P.add("cant_find","Can't find %1");const lu="/",Ys="ROOT",cu="CLOUD";function Oe(t){return typeof t=="object"&&"id"in t?t.id:t.replace(/.*[\\/:]{1,1}([^:\\/]+)$/,"$1")}function uu(t){return/^[a-zA-Z0-9_-]+:/.test(t)}function Fi(...t){return t.reduce((e,n)=>(e.push(...n.replace(/[\\/]+/,"/").replace(/^\//,"").replace(/\/$/,"").split("/")),e),[]).join("/").replace(/\/$/,"")}function du(t){return t.replace(/(.*)[:/]([^\\/:]+)/,"$1")}function hu(t){return t.replace(/(.*)\/([^\\/]+)/,"$2")}function Vn(t){return t.replace(/(.*[\\/:]{1,1})[^:\\/]+$/,"$1")}function cs(t){return t.length&&/^[\w .\\/:-]+$/.test(t)}function mu(t){return cs(t)&&!!(t.includes("/")||t.match(/^([^:]+):.*/))}function fu(t){return t*1e3}function zi(t){return t.replace(/^(.*)\.[^.]+$/,"$1")}function dr(t){const e=t.match(/^.*\.([^.]*)$/);return e?e[1]:""}function So(t){return t.replace(/[^.a-zA-Z0-9_-]/g,"_")}function bs(t,e){return e?`${zi(t)}.${e}`:t}function Io(t,e,n){let r=t;return e.hasItem(bs(r,n))?(r=`copy_${t}`,e.hasItem(bs(r,n))?Io(r,e,n):r):r}function je(t){if(t.getStorageItem()){if(t.getStorageItem().locked)throw P.get("FileSystem_permissionsNeeded");return t}return t}async function _e(t,e){return(e||t.getStorageItem())&&(await t.save(),await(e||t.getStorageItem()).save()),t}async function pu(t,e){const n=await e.remove(t);return Array.isArray(n)?n:[n]}const w={DEFAULT:"default",DIRECTORY:"directory",DIRECTORY_PREFS:"directory_prefs",CLOUD_DISK:"cloud_disk",HARD_DISK:"hard_disk",RAM_DISK:"ram_disk",TMP_DISK:"tmp_disk",DISK_1:"disk_1",DISK_2:"disk_2",DISK_WORKBENCH13:"disk_workbench13",DISK_MARKDOWN:"disk_markdown",DISK_BASIC:"disk_basic",WORK:"work",CONSOLE:"console",SETTINGS:"settings",TRASHCAN:"trashcan",COMPUTER_1:"computer_1",TELEPHONE:"telephone",CURSOR:"cursor",PREFERENCE:"preference",WEB_BASIC:"web_basic",WEB_PAINTING:"web_painting",COLORS:"colors",PRINT_1:"print_1",PRINT_2:"print_2",NOTEPAD:"notepad",BASIC:"basic",IMAGE:"image",NOTE:"note",NOTE_BLANK:"note_blank",LARGE_NOTE:"large_note",LARGE_NOTE_RICH:"large_note_rich",FULLSCREEN:"fullscreen",CALCULATOR:"calculator",CLOCK:"clock",KEYBOARD_QUESTION:"keyboard_question",LARGE_NOTEPAD:"large_notepad",LARGE_NOTEPAD_HELP:"large_notepad_help",RABBIT:"rabbit",MORE:"more",SAY:"say",GITHUB:"github",LAMMPEE:"lammpee",CUBY:"cuby",NUXT:"nuxt",CLOWN:"clown",DISALLOW_1:"disallow_1",COPY_1:"copy_1",COPY_2:"copy_2",DISPLAY_KEYBOARD:"display_keyboard",PALETTE:"palette",SIGN_1:"sign_1",DOCUMENT_EDITOR:"document_editor",DOCUMENT_READER:"document_reader"};function Ao(t){return/^"([^"]*)"$/.test(t)}function gu(t){return Ao(t)?t:(t=Z(t),`"${t}"`)}function ha(t){return t.replace(/[ ]*(.+)[ ]+/)}function Z(t){return typeof t!="string"?t:t.replace(/^[ ]*"(.*)"[ ]*$/,"$1").replace(/\\"/g,'"')}function Zn(t){return!isNaN(t)}let Bi;Bi=Promise.resolve({atob:t=>window.decodeURIComponent(window.atob(t)),btoa:t=>window.btoa(window.encodeURIComponent(t))});async function ui(t){const{atob:e}=await Bi;return e(t)}async function _u(t){const{btoa:e}=await Bi;return e(t)}const b={SYMBOL:"symbol",VISIBLE:"visible",POSITION:"position",WINDOW_SYMBOL_REARRANGE:"window_symbol_rearrange",WINDOW_SIZE:"window_size",WINDOW_POSITION:"window_position",WINDOW_SCALE:"window_scale",WINDOW_SCROLL_X:"window_scroll_x",WINDOW_SCROLL_Y:"window_scroll_y",WINDOW_FULL_SIZE:"window_full_size",WINDOW_SIDEBAR:"window_sidebar",WEB_URL:"web_url",IGNORE_SYMBOL_REARRANGE:"ignore_symbol_rearrange"},bu={basic:w.BASIC,bas:w.BASIC,markdown:w.DISK_MARKDOWN,md:w.DISK_MARKDOWN,image:w.IMAGE,img:w.IMAGE};function yu(t,e=w.NOTE_BLANK){const n=dr(t).toLowerCase();return bu[String(n)]||e}var wr,un,Nt,dn,hn,Fe,Lt,mn,ze,xr;const ir=class{constructor({locked:e=!1,id:n=null,name:r=null,meta:s=[],data:i=null,action:a=null,createdDate:o=Date.now(),editedDate:l=null}){g(this,wr,void 0);g(this,un,!1);g(this,Nt,null);g(this,dn,void 0);g(this,hn,void 0);g(this,Fe,void 0);g(this,Lt,void 0);g(this,mn,void 0);g(this,ze,void 0);g(this,xr,void 0);if(A(this,wr,new Me),A(this,dn,o),A(this,hn,l||o),A(this,un,e),A(this,Fe,n),A(this,Lt,r),A(this,mn,new Map([[b.SYMBOL,yu(n||"",this.constructor.SYMBOL)],[b.VISIBLE,!0]].concat(s||[]))),typeof i=="string")try{i=JSON.parse(i)}catch(u){throw console.log(i),new Error(u)}A(this,xr,a),this.data=i||{}}async remove(e){const{silent:n}=Object.assign({silent:!1},e);let r;const s=this.isLocked();if(!s)r={type:this.constructor.NAME,id:this.id,name:this.name,path:await this.getPath(),size:this.size,storage:this.getStorageItem()};else if(!n)return P.get("FileSystemItem_itemLocked",await this.getPath());return(n||!s)&&(this.events.next(new G("remove",this)),this.events.unsubscribe(),this.parent.removeItem(this)),r}isLocked(e){return e?!1:this.parent&&this.parent.locked&&this.parent.id!==Ys?!0:c(this,un)}getStorageItem(){return"storage"in this?this:this.parent?this.parent.getStorageItem():null}async copy(){const e=this.constructor;let n=await this.export({encodeData:!1});return n=new e(n),Promise.resolve(n)}rename(e,n){const{name:r=!1,ignore:s=!1}=Object.assign({name:!1,ignore:!1},n);if(!this.isLocked(s)){if(r)return this.name=e,this;{const i=this.id;A(this,Fe,So(e)),this.parent&&i!==this.id&&this.parent.changeItemId(this,i,this.id)}this.events.next(new G("rename",{name:r,id:e}))}return this}save(){this.events.next(new G("save",this))}get type(){return this.constructor.NAME}async export(e){const{encodeData:n}=Object.assign({encodeData:!0},e),r=new Map(c(this,mn));return Array.from(r.keys()).forEach(s=>{r.get(s)instanceof tn&&r.set(s,r.get(s).toJSON())}),{type:this.type,id:c(this,Fe),name:c(this,Lt),createdDate:c(this,dn),editedDate:c(this,hn),data:n?await _u(c(this,ze)):c(this,ze),meta:Array.from(r)}}get createdDate(){return c(this,dn)}get editedDate(){return c(this,hn)}get data(){if(typeof c(this,ze)=="string")try{return JSON.parse(c(this,ze))}catch{return{data:c(this,ze)}}return c(this,ze)}set data(e){typeof e=="object"&&(e=JSON.stringify(e)),A(this,ze,e)}get action(){return c(this,xr)}get events(){return c(this,wr)}get parent(){return c(this,Nt)}setId(e){A(this,Fe,e)}setParent(e){A(this,Nt,e)}get locked(){return c(this,Nt)?c(this,Nt).locked:c(this,un)}get id(){return c(this,Fe)}get name(){return c(this,Lt)||c(this,Fe)}set name(e){A(this,Lt,e)}get extension(){return dr(c(this,Fe))}get meta(){return c(this,mn)}get size(){return new Blob([Object.values(this.data)]).size}get maxSize(){return new Blob([Object.values(this.data)]).size}getBase(){return ir.getBaseRecursive({item:this},!1)}getPath(){return ir.getBaseRecursive({item:this})}static getBaseRecursive({item:e,path:n=[]},r=!0){if(r&&n.push(e.id),e.parent)return ir.getBaseRecursive({item:e.parent,path:n});if(n=n.reverse(),n[0]===Ys&&n.shift(),n.length>0){let s=n[0];return/\./.test(s)||(s+=":"),`${s}${n.slice(1,n.length).join(lu)}`}else return Ys}};let me=ir;wr=new WeakMap,un=new WeakMap,Nt=new WeakMap,dn=new WeakMap,hn=new WeakMap,Fe=new WeakMap,Lt=new WeakMap,mn=new WeakMap,ze=new WeakMap,xr=new WeakMap;P.add([["FileSystemItem_itemLocked",["Item Locked","Item is locked, can't be edit %1"]]]);const dt={CENTER:0,ORDER_HORIZONTAL:1,ORDER_VERTICAL:2,ORDER_DIAGONAL_LEFT:3,ORDER_DIAGONAL_RIGHT:4,SPLIT_HORIZONTAL:5,SPLIT_VERTICAL:6,FULL:7};class ma{constructor(e,n=[]){p(this,"events",new Me);p(this,"id",Pn());p(this,"core");p(this,"layout",{size:O(0,0),position:O(0,0)});p(this,"groups",new Map);p(this,"modelMap",new Map);p(this,"models",vt([]));this.core=e,n.forEach(r=>this.add(r))}getActiveWindow(){return this.models.value.find(e=>e.options.focused)}setActiveWindow(e){this.models.value.forEach(n=>{n.options.focused=e===n.id,e===n.id&&this.events.next(new G("setActiveWindow",n))})}hasEmbbedWindow(){return!!this.models.value.find(e=>e.options.embed)}isHeaderVsible(){return!this.models.value.find(e=>e.options.embed&&e.options.hideRootHeader)}add(e,n){const{full:r,active:s,group:i}={full:!1,active:!0,group:null,...n};if(e instanceof ur||(e=new ur(e)),e.setWrapper(this),r&&(e.layout.size=this.layout.size),i){let a;this.groups.has(i)?(a=this.groups.get(i),a.windows.push(e)):(a={primary:e,windows:[],name:i},this.groups.set(i,a)),e.setGroup(a)}return e.layout.zIndex=this.models.value.length,this.models.value.push(e),this.events.next(new G("add",e)),this.modelMap.set(e.id,e),s&&this.setActiveWindow(e.id),e}remove(e){typeof e=="string"&&(e=this.get(e)),e.group&&(e.group.primary===e?(e.group.windows.forEach(n=>n.close()),this.groups.delete(e.group.name)):e.group.primary.focus()),this.models.value.splice(this.models.value.indexOf(e),1),this.modelMap.delete(e.id)}get(e){return this.modelMap.get(e)}clear(){this.models=vt([].splice(0,this.models.value.length)),this.modelMap.clear()}setWindowUpDown(e,n){const r=this.models.value,s=Array.from(r).sort((l,u)=>l.layout.zIndex-u.layout.zIndex).map(il),i=this.get(e),a=s.indexOf(i),o=s[n?a-1:a+1];if(o){const l=i.layout.zIndex;i.layout.zIndex=o.layout.zIndex,o.layout.zIndex=l}}centerWindow(e){typeof e=="string"&&(e=this.get(e)),di(e,this.layout)}setWindowPositions(e,n=[]){switch(n.length<1&&n.push(...this.models.value),e){case dt.FULL:n.forEach(r=>{wu(r,this.layout)});break;case dt.CENTER:n.forEach(r=>{di(r,this.layout)});break;case dt.ORDER_DIAGONAL_LEFT:case dt.ORDER_DIAGONAL_RIGHT:xu(n,this.layout,dt.ORDER_DIAGONAL_RIGHT===e);break;case dt.SPLIT_HORIZONTAL:case dt.SPLIT_VERTICAL:vu(n,this.layout,dt.SPLIT_VERTICAL===e);break}}saveSize(e,n){if(this.get(e).symbolWrapper&&this.get(e).symbolWrapper.fsItem){const r=this.get(e).symbolWrapper.fsItem;r.meta.set(b.WINDOW_SIZE,n),this.core.modules.files.fs.saveItem(r)}}savePosition(e,n){if(this.get(e).symbolWrapper&&this.get(e).symbolWrapper.fsItem){const r=this.get(e).symbolWrapper.fsItem;r.meta.set(b.WINDOW_POSITION,n),this.core.modules.files.fs.saveItem(r)}}}function wu(t,e){t.layout.size=e.size}function di(t,e){t.layout.position=O(()=>(e.size-t.layout.size)/2)}function xu(t,e,n){const r=1/t.length;t.forEach((s,i)=>{di(s,e),i=-Math.floor(t.length/2)+i;const a=O(s.layout.position.x+(n?-1:1)*(r*s.layout.size.x)*i,s.layout.position.y+r*s.layout.size.y*i),o=O(()=>e.size-s.layout.size);s.layout.position=O(()=>Math.max(Math.min(a,o),0))})}function vu(t,e,n){let r;const s=t.length;n?(r=O(e.size.x,e.size.y/s),t.forEach((i,a)=>{i.layout.position=O(0,a*r.y),i.layout.size=r})):(r=O(e.size.x/s,e.size.y),t.forEach((i,a)=>{i.layout.position=O(a*r.x,0),i.layout.size=r}))}var gt;class Eu{constructor(){g(this,gt,new Map);p(this,"capsLockActive",!1);p(this,"shiftLeftActive",!1);p(this,"shiftRightActive",!1);p(this,"cmdLeftActive",!1);p(this,"cmdRightActive",!1);p(this,"altLeftActive",!1);p(this,"altRightActive",!1);p(this,"pointerDown",null);p(this,"pointerUp",null);p(this,"pointerMove",null);p(this,"keyDown",null);p(this,"keyUp",null);this.resize=this.get("resize",window).pipe(Rt()),this.pointerDown=this.getPointerDown(),this.pointerUp=this.getPointerUp(),this.pointerMove=this.getPointerMove(),this.keypress=this.get("keypress").pipe(Rt()),this.keydown=this.keyDown=this.get("keydown").pipe(Rt()),this.keyup=this.keyUp=this.get("keyup").pipe(Rt()),this.keyDown.subscribe(({keyCode:e,location:n})=>{switch(e){case 91:this.cmdLeftActive=!0;break;case 93:this.cmdRightActive=!0;break;case 16:n===2?this.shiftRightActive=!0:this.shiftLeftActive=!0;break;case 18:n===2?this.altRightActive=!0:this.altLeftActive=!0;break;case 20:this.capsLockActive=!this.capsLockActive;break}}),this.keyUp.subscribe(({keyCode:e,location:n})=>{switch(e){case 91:this.cmdLeftActive=!1;break;case 93:this.cmdRightActive=!1;break;case 16:n===2?this.shiftRightActive=!1:this.shiftLeftActive=!1;break;case 18:n===2?this.altRightActive=!1:this.altLeftActive=!1;break}})}getPointerDown(e){return this.get("pointerdown",e).pipe(nr(n=>ls(n))).pipe(Rt())}getPointerUp(e){return this.get("pointerup",e).pipe(nr(n=>ls(n))).pipe(Rt())}getPointerMove(e){return this.get("pointermove",e).pipe(nr(n=>ls(n))).pipe(Rt())}get(e,n){n=n||document,c(this,gt).has(n)||c(this,gt).set(n,new Map);const r=c(this,gt).get(n);if(!r.has(e)){const s={passive:!0,capture:!1};r.set(e,ri(n,e,s))}return r.get(e)}reset(){Array.from(c(this,gt).values).forEach(e=>e.unsubscribe()),c(this,gt).reset()}get cmdActive(){return this.cmdLeftActive||this.cmdRightActive}get altActive(){return this.altLeftActive||this.altRightActive}get shiftActive(){return this.shiftLeftActive||this.shiftRightActive}}gt=new WeakMap;let fa;const Xs=fa||(fa=new Eu),Su={DOCUMENT_EDITOR_SHOW_PREVIEW:"workbench13_DOCUMENT_EDITOR_SHOW_PREVIEW"},jp={[Su.DOCUMENT_EDITOR_SHOW_PREVIEW]:!0},Un={OUTPUT_TYPE:"type",OPEN_MAXIMIZED:"openMaximized",CONTENT:"content",FONT_FAMILY:"fontFamily",FONT_SIZE:"fontSize"},Gp={BuiltIn:"Built-In",Serif:"Serif",SansSerif:"Sans-Serif",Monospace:"Monospace"},Qn={BuiltIn:{"Amiga Topaz 13":'"Amiga Topaz 13"',"Amiga Topaz 13 Console":'"Amiga Topaz 13 Console", "Amiga Topaz 13", sans-serif'},Serif:{Georgia:"Georgia, serif","Palatino Linotype":'"Palatino Linotype", "Book Antiqua", Palatino, serif',"Times New Roman":'"Times New Roman", Times, serif'},SansSerif:{Arial:"Arial, Helvetica, sans-serif","Arial Black":'"Arial Black", Gadget, sans-serif',"Comic Sans MS":'"Comic Sans MS", cursive, sans-serif',Impact:"Impact, Charcoal, sans-serif","Lucida Sans Unicode":'"Lucida Sans Unicode", "Lucida Grande", sans-serif',Tahoma:"Tahoma, Geneva, sans-serif","Trebuchet MS":'"Trebuchet MS", Helvetica, sans-serif',Verdana:"Verdana, Geneva, sans-serif"},Monospace:{"Courier New":'"Courier New", Courier, monospace',"Lucida Console":'"Lucida Console", Monaco, monospace'}},Hp=[8,10,12,14,16,18,20,22,24,26,28,30,32,34,36],Iu=Qn.BuiltIn["Amiga Topaz 13"],Oo=16;function Yp(){return{[Un.OPEN_MAXIMIZED]:!1,[Un.OUTPUT_TYPE]:"markdown",[Un.CONTENT]:"",[Un.FONT_FAMILY]:Iu,[Un.FONT_SIZE]:Oo}}var Au=({onlyFirst:t=!1}={})=>{const e=["[\\u001B\\u009B][[\\]()#;?]*(?:(?:(?:(?:;[-a-zA-Z\\d\\/#&.:=?%@~_]+)*|[a-zA-Z\\d]+(?:;[-a-zA-Z\\d\\/#&.:=?%@~_]*)*)?\\u0007)","(?:(?:\\d{1,4}(?:;\\d{0,4})*)?[\\dA-PR-TZcf-ntqry=><~]))"].join("|");return new RegExp(e,t?void 0:"g")};const Ou=Au;var ku=t=>typeof t=="string"?t.replace(Ou(),""):t,Vi={exports:{}},ko={exports:{}};(function(t){var e=function(){function n(l,u,d,m){typeof u=="object"&&(d=u.depth,m=u.prototype,u.filter,u=u.circular);var h=[],f=[],v=typeof zn.Buffer<"u";typeof u>"u"&&(u=!0),typeof d>"u"&&(d=1/0);function _(E,L){if(E===null)return null;if(L==0)return E;var T,M;if(typeof E!="object")return E;if(n.__isArray(E))T=[];else if(n.__isRegExp(E))T=new RegExp(E.source,o(E)),E.lastIndex&&(T.lastIndex=E.lastIndex);else if(n.__isDate(E))T=new Date(E.getTime());else{if(v&&zn.Buffer.isBuffer(E))return zn.Buffer.allocUnsafe?T=zn.Buffer.allocUnsafe(E.length):T=new zn.Buffer(E.length),E.copy(T),T;typeof m>"u"?(M=Object.getPrototypeOf(E),T=Object.create(M)):(T=Object.create(m),M=m)}if(u){var ne=h.indexOf(E);if(ne!=-1)return f[ne];h.push(E),f.push(T)}for(var Q in E){var ee;M&&(ee=Object.getOwnPropertyDescriptor(M,Q)),!(ee&&ee.set==null)&&(T[Q]=_(E[Q],L-1))}return T}return _(l,d)}n.clonePrototype=function(u){if(u===null)return null;var d=function(){};return d.prototype=u,new d};function r(l){return Object.prototype.toString.call(l)}n.__objToStr=r;function s(l){return typeof l=="object"&&r(l)==="[object Date]"}n.__isDate=s;function i(l){return typeof l=="object"&&r(l)==="[object Array]"}n.__isArray=i;function a(l){return typeof l=="object"&&r(l)==="[object RegExp]"}n.__isRegExp=a;function o(l){var u="";return l.global&&(u+="g"),l.ignoreCase&&(u+="i"),l.multiline&&(u+="m"),u}return n.__getRegExpFlags=o,n}();t.exports&&(t.exports=e)})(ko);var Tu=ko.exports,Ru=Tu,Du=function(t,e){return t=t||{},Object.keys(e).forEach(function(n){typeof t[n]>"u"&&(t[n]=Ru(e[n]))}),t},Cu=[[768,879],[1155,1158],[1160,1161],[1425,1469],[1471,1471],[1473,1474],[1476,1477],[1479,1479],[1536,1539],[1552,1557],[1611,1630],[1648,1648],[1750,1764],[1767,1768],[1770,1773],[1807,1807],[1809,1809],[1840,1866],[1958,1968],[2027,2035],[2305,2306],[2364,2364],[2369,2376],[2381,2381],[2385,2388],[2402,2403],[2433,2433],[2492,2492],[2497,2500],[2509,2509],[2530,2531],[2561,2562],[2620,2620],[2625,2626],[2631,2632],[2635,2637],[2672,2673],[2689,2690],[2748,2748],[2753,2757],[2759,2760],[2765,2765],[2786,2787],[2817,2817],[2876,2876],[2879,2879],[2881,2883],[2893,2893],[2902,2902],[2946,2946],[3008,3008],[3021,3021],[3134,3136],[3142,3144],[3146,3149],[3157,3158],[3260,3260],[3263,3263],[3270,3270],[3276,3277],[3298,3299],[3393,3395],[3405,3405],[3530,3530],[3538,3540],[3542,3542],[3633,3633],[3636,3642],[3655,3662],[3761,3761],[3764,3769],[3771,3772],[3784,3789],[3864,3865],[3893,3893],[3895,3895],[3897,3897],[3953,3966],[3968,3972],[3974,3975],[3984,3991],[3993,4028],[4038,4038],[4141,4144],[4146,4146],[4150,4151],[4153,4153],[4184,4185],[4448,4607],[4959,4959],[5906,5908],[5938,5940],[5970,5971],[6002,6003],[6068,6069],[6071,6077],[6086,6086],[6089,6099],[6109,6109],[6155,6157],[6313,6313],[6432,6434],[6439,6440],[6450,6450],[6457,6459],[6679,6680],[6912,6915],[6964,6964],[6966,6970],[6972,6972],[6978,6978],[7019,7027],[7616,7626],[7678,7679],[8203,8207],[8234,8238],[8288,8291],[8298,8303],[8400,8431],[12330,12335],[12441,12442],[43014,43014],[43019,43019],[43045,43046],[64286,64286],[65024,65039],[65056,65059],[65279,65279],[65529,65531],[68097,68099],[68101,68102],[68108,68111],[68152,68154],[68159,68159],[119143,119145],[119155,119170],[119173,119179],[119210,119213],[119362,119364],[917505,917505],[917536,917631],[917760,917999]],Nu=Du,jn=Cu,To={nul:0,control:0};Vi.exports=function(e){return Ro(e,To)};Vi.exports.config=function(t){return t=Nu(t||{},To),function(n){return Ro(n,t)}};function Ro(t,e){if(typeof t!="string")return pa(t,e);for(var n=0,r=0;r<t.length;r++){var s=pa(t.charCodeAt(r),e);if(s<0)return-1;n+=s}return n}function pa(t,e){return t===0?e.nul:t<32||t>=127&&t<160?e.control:Lu(t)?0:1+(t>=4352&&(t<=4447||t==9001||t==9002||t>=11904&&t<=42191&&t!=12351||t>=44032&&t<=55203||t>=63744&&t<=64255||t>=65040&&t<=65049||t>=65072&&t<=65135||t>=65280&&t<=65376||t>=65504&&t<=65510||t>=131072&&t<=196605||t>=196608&&t<=262141))}function Lu(t){var e=0,n=jn.length-1,r;if(t<jn[0][0]||t>jn[n][1])return!1;for(;n>=e;)if(r=Math.floor((e+n)/2),t>jn[r][1])e=r+1;else if(t<jn[r][0])n=r-1;else return!0;return!1}var Pu=Vi.exports,Mu=ku,$u=Pu,Do=function(t){return $u(Mu(t))},Qt={},it=Do;function ys(t,e){return Array.apply(null,{length:e+1}).join(t).slice(0,e)}function Wu(t,e,n){t=t??"",t=String(t);var r=e-it(t);return r<=0?t:t+ys(n||" ",r)}function Fu(t,e,n){t=t??"",t=String(t);var r=e-it(t);if(r<=0)return t;var s=Math.floor(r/2),i=r-s;return ys(n||" ",s)+t+ys(n||" ",i)}function zu(t,e,n){t=t??"",t=String(t);var r=e-it(t);return r<=0?t:ys(n||" ",r)+t}function Bu(t,e){function n(r,s){return r.trim().split(" ").reduce(function(i,a){var o=i[i.length-1];return o&&it(o.join(" "))+it(a)<s?i[i.length-1].push(a):i.push([a]),i},[]).map(function(i){return i.join(" ")})}return t.split(`
`).map(function(r){return n(r,e)}).reduce(function(r,s){return r.concat(s)},[])}function Vu(t,e,n){t=t.trim();for(var r=[],s=t.split(" "),i="",a=it(n);i||s.length;){if(i){var o=i;i=""}else var o=s.shift();if(it(o)>e){for(var l=0,u=0,d=e-a;l<o.length;){var m=it(o.charAt(l));if(m+u>d)break;u+=m,++l}i=o.slice(l),o=o.slice(0,l),o+=n}r.push(o)}return r.join(" ")}function Uu(t,e){if(t=t??"",t=String(t),e==1/0)return t;for(var n=0,r=0;n<t.length;){var s=it(t.charAt(n));if(s+r>e)break;r+=s,++n}return t.slice(0,n)}Qt.padRight=Wu;Qt.padCenter=Fu;Qt.padLeft=zu;Qt.splitIntoLines=Bu;Qt.splitLongWords=Vu;Qt.truncateString=Uu;var qs=Do,Mn=Qt,ju=Mn.padRight,Gu=Mn.padCenter,Hu=Mn.padLeft,ga=Mn.splitIntoLines,Yu=Mn.splitLongWords,Xu=Mn.truncateString,Co=function(e){return e.toUpperCase()},qu=function(e,n,r){return e},Ku=Object.freeze({maxWidth:1/0,minWidth:0,columnSplitter:" ",truncate:!1,truncateMarker:"",preserveNewLines:!1,paddingChr:" ",showHeaders:!0,headingTransform:Co,dataTransform:qu}),Zu=function(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=e.config||{};delete e.config;var r=e.maxLineWidth||1/0;r==="auto"&&(r=ol.stdout.columns||1/0),delete e.maxLineWidth,e=_a({},Ku,e),e.config=e.config||Object.create(null),e.spacing=e.spacing||`
`,e.preserveNewLines=!!e.preserveNewLines,e.showHeaders=!!e.showHeaders,e.columns=e.columns||e.include;var s=e.columns||[];t=td(t,s),s.length||t.forEach(function(l){for(var u in l)s.indexOf(u)===-1&&s.push(u)});var i=s.reduce(function(l,u){var d=Object.create(e);return l[u]=_a(d,n[u]),l},Object.create(null));s.forEach(function(l){var u=i[l];u.name=l,u.maxWidth=Math.ceil(u.maxWidth),u.minWidth=Math.ceil(u.minWidth),u.truncate=!!u.truncate,u.align=u.align||"left"}),t=t.map(function(l){var u=Object.create(null);return s.forEach(function(d){u[d]=l[d]!=null?l[d]:"",u[d]=""+u[d],i[d].preserveNewLines?u[d]=u[d].replace(/[^\S\n]/gmi," "):u[d]=u[d].replace(/\s/gmi," ")}),u}),s.forEach(function(l){var u=i[l];t=t.map(function(d,m){var h=Object.create(u);d[l]=u.dataTransform(d[l],h,m);var f=Object.keys(h);if(f.indexOf("name")!==-1){if(u.headingTransform!==Co)return;u.headingTransform=function(v){return v}}return f.forEach(function(v){return u[v]=h[v]}),d})});var a={};e.showHeaders&&(s.forEach(function(l){var u=i[l];if(!u.showHeaders){a[l]="";return}a[l]=u.headingTransform(u.name)}),t.unshift(a)),s.forEach(function(l){var u=i[l];u.width=t.map(function(d){return d[l]}).reduce(function(d,m){return d>=u.maxWidth?d:Math.max(d,Math.min(u.maxWidth,Math.max(u.minWidth,qs(m))))},0)}),s.forEach(function(l){var u=i[l];t=t.map(function(d){return d[l]=Yu(d[l],u.width,u.truncateMarker),d})}),s.forEach(function(l){var u=i[l];t=t.map(function(d,m){var h=d[l];if(d[l]=ga(h,u.width),u.truncate&&d[l].length>1){d[l]=ga(h,u.width-qs(u.truncateMarker));var f=d[l][0];ed(f,u.truncateMarker)||(d[l][0]+=u.truncateMarker),d[l]=d[l].slice(0,1)}return d})}),s.forEach(function(l){var u=i[l];u.width=t.map(function(d){return d[l].reduce(function(m,h){return m>=u.maxWidth?m:Math.max(m,Math.min(u.maxWidth,Math.max(u.minWidth,qs(h))))},0)}).reduce(function(d,m){return d>=u.maxWidth?d:Math.max(d,Math.min(u.maxWidth,Math.max(u.minWidth,m)))},0)});var o=Qu(t,i,s,e.paddingChr);return o.reduce(function(l,u){return l.concat(u.reduce(function(d,m){return d.concat(m.join(e.columnSplitter))},[]))},[]).map(function(l){return Xu(l,r)}).join(e.spacing)};function Qu(t,e,n,r){return t.map(function(s){var i=[],a=0;n.forEach(function(u){a=Math.max(a,s[u].length)});for(var o=function(d){i[d]=i[d]||[],n.forEach(function(m){var h=e[m],f=s[m][d]||"";h.align==="right"?i[d].push(Hu(f,h.width,r)):h.align==="center"||h.align==="centre"?i[d].push(Gu(f,h.width,r)):i[d].push(ju(f,h.width,r))})},l=0;l<a;l++)o(l);return i})}function _a(){return Object.assign?Object.assign.apply(Object,arguments):Ju.apply(void 0,arguments)}function Ju(t,e){if(t==null)throw new TypeError("Cannot convert first argument to object");for(var n=Object(t),r=!1,s,i=1;i<arguments.length;i++){var a=arguments[i];if(a!=null){for(var o=Object.keys(Object(a)),l=0,u=o.length;l<u;l++){var d=o[l];try{var m=Object.getOwnPropertyDescriptor(a,d);m!==void 0&&m.enumerable&&(n[d]=a[d])}catch(h){r||(r=!0,s=h)}}if(r)throw s}}return n}function ed(t,e,n){n=n||t.length,n=n-e.length;var r=t.lastIndexOf(e);return r!==-1&&r===n}function td(t,e){if(Array.isArray(t))return t;var n=[];for(var r in t){var s={};s[e[0]||"key"]=r,s[e[1]||"value"]=t[r],n.push(s)}return n}const hi=al(Zu);var vr,Er,Sr,fn;class jt{constructor(e){g(this,vr,0);g(this,Er,!0);g(this,Sr,[]);g(this,fn,[]);const{showHeader:n,headerPadding:r,columns:s}=Object.assign({showHeader:!0,headerPadding:0,columns:[]},e);A(this,Er,n),A(this,vr,r),this.addColumn(s)}addColumn(e){Array.isArray(e)?c(this,fn).push(...[].concat(e)):c(this,fn).push(Object.assign({value:null,align:"left",minWidth:0,maxWidth:0,spacerChar:" "},e))}addRow(e){c(this,Sr).push(...[].concat(e))}static createSpacer(e,n,r){if(e.length<n){n=n-e.length;for(let s=0;s<n;s++)e+=r}return e}get columns(){return c(this,fn)}get rows(){return c(this,Sr)}get showHeader(){return c(this,Er)}get headerPadding(){return c(this,vr)}toColumnify(){const e=this.columns.map(s=>s.value),n=this.rows.reduce((s,i,a)=>(a<1&&this.showHeader&&this.headerPadding&&s.push(...Array(this.headerPadding).fill("")),s.push(this.columns.reduce((o,l,u)=>(o[l.value]=i[Number(u)],o),{})),s),[]),r=this.columns.reduce((s,i)=>(s[i.value]={},i.align&&(s[i.value].align=i.align),i.minWidth&&(s[i.value].minWidth=i.minWidth),i.maxWidth&&(s[i.value].maxWidth=i.maxWidth),s[i.value].headingTransform=a=>a,s),{});return hi(n,{showHeaders:this.showHeader,preserveNewLines:!0,config:r,columns:e}).replace(/\xC2/g," ")}}vr=new WeakMap,Er=new WeakMap,Sr=new WeakMap,fn=new WeakMap;class nd{constructor(e){p(this,"core");p(this,"debug",!1);p(this,"consoleInterface");const{core:n,debug:r,consoleInterface:s}=Object.assign({core:null,debug:!1,consoleInterface:null},e);this.core=n,this.debug=r,this.consoleInterface=s}add(e,n){}}const Os=class extends nd{constructor(n){const{silent:r,color:s}=n=Object.assign({silent:!1,color:!1},n);super(n);p(this,"silent");p(this,"entries",[]);p(this,"color",!1);this.silent=r,this.color=s}add(n,r){const{namespace:s,type:i}=Object.assign({namespace:null,type:Os.TYPE.INFO},r);this.entries.push(n),!this.silent&&i!==Os.TYPE.DEBUG&&(s?this.color?console.log("%c[ %s ]%c[ %s ]","background: #000; color: #008000",i,"background: #000; color: #90ee90",s,n):console.log(`[ ${i.toUpperCase()} ][ ${s} ]`,n):n instanceof jt?this.consoleInterface.table(n):this.consoleInterface.log(n))}};let an=Os;p(an,"TYPE",{DEBUG:"debug",INFO:"info",OUTPUT:"output"});var pn,Pt,Ir,He,La;let Ui=(La=class{constructor(e){g(this,pn,!1);g(this,Pt,void 0);g(this,Ir,void 0);g(this,He,{});e=Object.assign({locked:c(this,pn),storage:void 0,name:void 0},e),A(this,pn,e.locked),A(this,Pt,e.storage),A(this,Ir,e.name)}get locked(){return c(this,pn)}get name(){return c(this,Ir)}get storage(){return c(this,Pt)}get data(){return c(this,He)}set data(e){A(this,He,e)}mount(){return new Promise(e=>{e(this)})}unmount(){return new Promise(e=>{e(this)})}load(){if(!c(this,Pt))throw new Error("no storage");return Promise.resolve(c(this,He))}save(e){if(!c(this,Pt))throw new Error("no storage");return A(this,He,e||c(this,He)),Promise.resolve(c(this,He))}},pn=new WeakMap,Pt=new WeakMap,Ir=new WeakMap,He=new WeakMap,La);var Mt;class No{constructor(){g(this,Mt,new Map)}getItem(e){return c(this,Mt).get(e)}setItem(e,n){c(this,Mt).set(e,n)}removeItem(e){c(this,Mt).delete(e)}clear(){c(this,Mt).clear()}}Mt=new WeakMap;class rd extends Ui{constructor(e){e=Object.assign({storage:new No},e),super(e)}}class Lo extends Ui{mount(){return new Promise(e=>{try{let n;try{if(n=this.storage.getItem(this.name),n){if(n=JSON.parse(n),!n||!(n instanceof Object))throw new Error("json invalid")}else throw new Error("json invalid")}catch{n={}}this.storage.setItem(this.name,JSON.stringify(n)),e(this)}catch(n){throw new Error(n)}})}load(){return new Promise(e=>{if(this.storage)try{this.data=JSON.parse(this.storage.getItem(this.name)),e(this.data)}catch(n){throw new Error(n)}})}save(e){return new Promise(n=>{if(this.storage)try{this.data=e||this.data,this.storage.setItem(this.name,JSON.stringify(this.data)),n(this.data)}catch(r){throw new Error(r)}})}}class sd extends Lo{constructor(e){e=Object.assign({storage:window.localStorage},e),super(e)}}class id extends Lo{constructor(e){e=Object.assign({storage:window.sessionStorage||new No},e),super(e)}}class Po extends Ui{}const ce={NONE:0,AUTO:1,TEMP:3,LOCAL:4,SESSION:5,CLOUD:6};function Mo(t){switch(t){case ce.TEMP:return rd;case ce.LOCAL:return sd;case ce.SESSION:return id;case ce.CLOUD:return Po;default:return Storage}}var Le,$t,gn,Ar;class ad{constructor(e,n){g(this,Le,new Map);g(this,$t,Ne({}));g(this,gn,void 0);g(this,Ar,void 0);A(this,gn,new(Mo(n||ce.NONE))({name:e})),A(this,Ar,c(this,gn).load().then(r=>(A(this,Le,new Map(r)),Object.assign(c(this,$t),Object.fromEntries(c(this,Le))),this)).catch(r=>{throw r}))}setDefaults(e){Object.keys(e).forEach(n=>{this.has(n)||this.set(n,e[String(n)])})}get(e){return c(this,Le).get(e)}has(e){return c(this,Le).has(e)}set(e,n){return typeof e=="object"&&!(e instanceof Map)?Object.keys(e).forEach(r=>{n=e[String(r)],c(this,Le).set(r,n),c(this,$t)[String(r)]=n}):(c(this,Le).set(e,n),c(this,$t)[String(e)]=n),c(this,gn).save(Array.from(c(this,Le)))}get observable(){return c(this,$t)}get entries(){return c(this,Le)}get ready(){return c(this,Ar)}}Le=new WeakMap,$t=new WeakMap,gn=new WeakMap,Ar=new WeakMap;class od{constructor(e){p(this,"core");this.core=e}ready(){}prompt(e){}log(...e){console.log(...e)}clear(...e){}destroy(){}}class ld extends od{prompt(e){const n=["openDialog","--prompt"];return e&&n.push(`--message="${Z(e)}"`),this.core.executeCommand(n.join(" "))}}var Or,kr;class cd{constructor(e){g(this,Or,void 0);g(this,kr,[]);A(this,Or,e)}command(e,n){c(this,kr).push({value:e,targetValue:n})}run(){return Promise.all(c(this,kr).map(({value:e,targetValue:n})=>c(this,Or).executeCommand(e).then(r=>{const s=r===n;return s||console.warn(`[ ${e} ]; ${r} === ${n}`),{value:e,targetValue:n,result:r,success:s}})))}async start(){const e=await this.run();return[[e.length,"Tests processed"],[e.filter(n=>n.success).length,"Tests success"],[e.filter(n=>!n.success).length,"Tests failed"]]}}Or=new WeakMap,kr=new WeakMap;function lt(t,e={}){const n=ll(t),{id:r,parentFocused:s,core:i,window:a}=n,o=vt(),l=vt(),u=$a(()=>a.value.options.embedded),d=(v,_={})=>{l.value=new Xt(v,{core:i.value,..._})},m=vt(!1),h=(v=!0)=>{m.value=v},f=v=>{l.value&&(v?o.value=i.value.modules.windows.setActiveContextMenu(l.value):!m.value&&i.value.modules.windows.getActiveContextMenu()===o.value&&!u.value&&i.value.modules.windows.setActiveContextMenu(null))};return cl(s,v=>f(v)),ul(()=>{dl(()=>{e.emit("ready"),f(!0)})}),hl(()=>{l.value&&i.value.modules.windows.isContextMenu(o.value)&&i.value.modules.windows.setActiveContextMenu(null)}),{id:r,parentFocused:s,core:i,window:a,setContextMenu:d,preserveContextMenu:h,contextMenu:l,currentContextMenu:o}}const ct={id:{type:String,default:""},parentFocused:{type:Boolean,default:!1},core:{type:Object,required:!0},window:{type:Object,required:!0}},ut=["ready"];function ud(t,e,n){return"#"+((1<<24)+(t<<16)+(e<<8)+n).toString(16).slice(1)}function ba(t){return t=t.replace(/ /g,""),t.length===7?["0x"+t[1]+t[2]|0,"0x"+t[3]+t[4]|0,"0x"+t[5]+t[6]|0]:["0x"+t[1]+t[1]|0,"0x"+t[2]+t[2]|0,"0x"+t[3]+t[3]|0]}const dd={__name:"Form",emits:["submit"],setup(t,{emit:e}){const n=r=>{r.preventDefault(),e("submit",r)};return(r,s)=>(y(),C("form",{class:"wb-env-molecule-form",onSubmit:n},[Tn(r.$slots,"default",{},()=>[Wa("Form Content")],!0)],32))}},$n=j(dd,[["__scopeId","data-v-560fd99a"]]);const hd={props:{labelTop:{type:Boolean,default:!1},tag:{type:String,default:"div"},label:{type:String,default:"FormField Label"}},computed:{styleClasses(){return{"label-top":this.labelTop}}}},md={key:0,class:"label"};function fd(t,e,n,r,s,i){return y(),U(ei(n.tag),{class:at(["wb-env-atom-form-field",i.styleClasses])},{default:Y(()=>[n.label?(y(),C("span",md,[Tn(t.$slots,"label",{},()=>[Wa(Ce(n.label),1)],!0)])):B("",!0),Tn(t.$slots,"default",{},void 0,!0)]),_:3},8,["class"])}const Wn=j(hd,[["render",fd],["__scopeId","data-v-1965e8a2"]]);const pd={props:{model:{type:[Array,Object],default(){return{value:0}}},min:{type:Number,default(){return 0}},max:{type:Number,default(){return 1}},step:{type:Number,default(){return .1}},name:{type:String,default:"value"},handleSize:{type:Number,default(){return .2}},styleType:{type:String,default:"window"},directionVertical:{type:Boolean,default:!1}},data(){return{positions:{start:O(),move:O(),current:O()}}},computed:{style(){const t={"--value":this.model[this.name]/this.max,"--direction":this.directionVertical?1:0};return t["--size"]=this.handleSize*100+"%",t},styleClasses(){return{"direction-x":!this.directionVertical,"direction-y":this.directionVertical,[`type-${this.styleType}`]:this.styleType}}}},gd=t=>(Ai("data-v-e4419394"),t=t(),Oi(),t),_d=["orient","min","max","step"],bd=gd(()=>S("i",null,null,-1));function yd(t,e,n,r,s,i){return y(),C("div",{class:at(["wb-env-atom-range-slider",i.styleClasses]),style:Rn(i.style)},[Kt(S("input",{"onUpdate:modelValue":e[0]||(e[0]=a=>n.model[n.name]=a),orient:n.directionVertical?"vertical":"horizontal",type:"range",min:n.min,max:n.max,step:n.step},null,8,_d),[[Fa,n.model[n.name]]]),bd],6)}const wd=j(pd,[["render",yd],["__scopeId","data-v-e4419394"]]),xd={components:{WbEnvAtomFormField:Wn,WbEnvAtomRangeSlider:wd},props:{model:{type:[Array,Object],default(){return{}}},id:{type:String,default:null},name:{type:String,default:null},readonly:{type:Boolean,default:!1},min:{type:Number,default:null},max:{type:Number,default:null},step:{type:Number,default:null},handleSize:{type:Number,default:null},disabled:{type:Boolean,default:!1},directionVertical:{type:Boolean,default:!1}},computed:{currentModel:{get(){return this.name?this.model[this.name]:this.model.value},set(t){this.name?this.model[this.name]=t:this.model.value=t}},rangeSlider(){return{name:this.name,min:this.min,max:this.max,step:this.step,handleSize:this.handleSize,readonly:this.readonly,disabled:this.disabled,directionVertical:this.directionVertical}}}};function vd(t,e,n,r,s,i){const a=R("wb-env-atom-range-slider"),o=R("wb-env-atom-form-field");return y(),U(o,V({tag:"div",class:"wb-env-atom-form-range-slider"},t.$attrs),{default:Y(()=>[Tn(t.$slots,"before"),N(a,V(i.rangeSlider,{model:n.model,"style-type":"form-field"}),null,16,["model"]),Tn(t.$slots,"after")]),_:3},16)}const Ed=j(xd,[["render",vd]]),Sd={xmlns:"http://www.w3.org/2000/svg",width:"10",height:"6"},Id=S("g",{class:"primary"},[S("path",{d:"M0 0h2v2H0zM2 2h2v2H2zM8 0h2v2H8zM4 4h2v2H4zM6 2h2v2H6z"})],-1),Ad=[Id];function Od(t,e){return y(),C("svg",Sd,Ad)}const kd={render:Od};const Td={components:{SvgControlTinyArrayDown:kd,WbEnvAtomFormField:Wn},props:{model:{type:Object,default(){return{value:"option-1"}}},label:{type:String,default:"Select Label"},id:{type:String,default:null},name:{type:String,default:null},size:{type:Number,default:null},multiple:{type:Boolean,default:!1},readonly:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},options:{type:Array,default(){return[{title:"Option 1.",value:"option-1"},{title:"Option 2.",value:"option-2"},{title:"Option 3.",value:"option-3"},{title:"Option 4.",value:"option-4"},{title:"Option 5.",value:"option-5"}]}}},computed:{currentModel:{get(){return this.name?this.model[this.name]:this.model.value},set(t){this.name?this.model[this.name]=t:this.model.value=t}},input(){return{id:this.id,size:this.size>1?this.size:null,multiple:this.multiple,readonly:this.readonly,disabled:this.disabled}}}},Rd={class:"wrapper"},Dd=["value"],Cd={key:0,class:"select-expander"};function Nd(t,e,n,r,s,i){const a=R("svg-control-tiny-array-down"),o=R("wb-env-atom-form-field");return y(),U(o,{tag:"label",class:"wb-env-atom-form-field-dropdown",label:n.label},{default:Y(()=>[S("div",Rd,[Kt(S("select",V({"onUpdate:modelValue":e[0]||(e[0]=l=>i.currentModel=l)},i.input),[(y(!0),C(Et,null,St(n.options,(l,u)=>(y(),C("option",{key:u,value:l.value},Ce(l.title),9,Dd))),128))],16),[[ml,i.currentModel]]),!n.disabled&&!n.readonly?(y(),C("span",Cd,[N(a)])):B("",!0)])]),_:1},8,["label"])}const ji=j(Td,[["render",Nd],["__scopeId","data-v-801eaf8b"]]);const Ld={props:{disabled:{type:Boolean,default:!1},accept:{type:String,default:"application/json"},type:{type:String,default(){return"button"}},styleType:{type:String,default(){return"primary"}},id:{type:String,required:!1,default:null},name:{type:String,required:!1,default:null},label:{type:String,required:!1,default:"Primary Button"}},emits:["upload","click"],computed:{upload(){return this.type==="upload"},styleClasses(){return{disabled:this.disabled,upload:this.upload,["type-"+this.styleType]:this.styleType}}},methods:{onInput(t){this.$emit("upload",t.target.files)},onClick(){this.$emit("click")}}},Pd={class:"label"},Md=["id","name","accept","disabled"],$d=["type","disabled"],Wd={class:"label"};function Fd(t,e,n,r,s,i){return i.upload?(y(),C("label",{key:0,class:at(["wb-env-atom-button",i.styleClasses])},[S("span",Pd,Ce(n.label),1),S("input",{id:n.id,name:n.name,type:"file",accept:n.accept,disabled:n.disabled,onInput:e[0]||(e[0]=(...a)=>i.onInput&&i.onInput(...a))},null,40,Md)],2)):(y(),C("button",{key:1,type:n.type,class:at(["wb-env-atom-button",i.styleClasses]),disabled:n.disabled,onClick:e[1]||(e[1]=(...a)=>i.onClick&&i.onClick(...a))},[S("span",Wd,Ce(n.label),1)],10,$d))}const kt=j(Ld,[["render",Fd],["__scopeId","data-v-93551418"]]);const zd={props:{full:{type:Boolean,required:!1,default:!1},align:{type:String,required:!1,validate:t=>["center","left","right","outer"].includes(t),default:"left"},direction:{type:String,required:!1,validate:t=>["horizontal","vertical"].includes(t),default:"horizontal"}},computed:{styleClasses(){return{[`direction-${this.direction}`]:!0,[`align-${this.align}`]:!0,full:this.full}}}};function Bd(t,e,n,r,s,i){return y(),C("div",{class:at(["wb-env-molecule-button-wrapper",i.styleClasses])},[S("div",null,[Tn(t.$slots,"default",{},void 0,!0)])],2)}const Tt=j(zd,[["render",Bd],["__scopeId","data-v-51d133b7"]]);const Vd={components:{WbForm:$n,WbFormField:Wn,WbFormFieldRangeSlider:Ed,WbFormFieldDropdown:ji,WbButton:kt,WbButtonWrapper:Tt},props:{...ct},emits:[...ut,"close"],setup(t,e){return lt(t,e)},data(){const t=this.core.config.get($.THEME)||Kn[String(xo)];return{screenModule:this.core.modules.screen,selectedColor:t.colors[1],colors:ba(t.colors[1]),saveLabel:"Save",resetLabel:"Reset",model:t,preset:"",fields:{presets:{name:"preset",model:this,label:"Presets",options:[{title:"Select Theme",value:""},...Object.keys(Kn).map(e=>({title:Kn[String(e)].title,value:e}))]},colorPrimary:{name:"0",type:"color",label:"Primary"},colorSecondary:{name:"1",type:"color",label:"Secondary"},colorTertiary:{name:"2",type:"color",label:"Tertiary"},colorQuaternary:{name:"3",type:"color",label:"Quaternary"},filter:{name:"filter",label:"Filter",options:[{title:"Invert",value:"invert(100%)"},{title:"Brightness",value:"brightness(50%)"}]}}}},watch:{preset(t){const e=Kn[String(t)];this.model={name:e.name,colors:e.colors,filter:e.filter},this.selectedColor=this.model.colors[0]},selectedColor(t){this.colors=ba(t)},colors:{deep:!0,handler(t){this.selectedColor=this.model.colors[this.model.colors.indexOf(this.selectedColor)]=ud(...Object.values(t).map(e=>Number(e)))}}},methods:{onSubmit(t){const e=this.model;this.core.config.set($.THEME,e),this.core.modules.screen.setTheme(new nu("custom",e)),this.$emit("close")}}},Ud={class:"wb-module-core-color-settings"},jd={class:"col-1"},Gd=["value"],Hd={class:"col-1 colors"},Yd={class:"color-controls"},Xd={class:"color-preview"};function qd(t,e,n,r,s,i){const a=R("wb-form-field-dropdown"),o=R("wb-form-field"),l=R("wb-form-field-range-slider"),u=R("wb-button"),d=R("wb-button-wrapper"),m=R("wb-form");return y(),C("div",Ud,[N(m,{class:"form",onSubmit:i.onSubmit},{default:Y(()=>[S("div",null,[S("div",jd,[N(a,tr(za(s.fields.presets)),null,16),N(o,{label:"Colors",class:"color-select"},{default:Y(()=>[(y(!0),C(Et,null,St(s.model.colors,(h,f)=>(y(),C("label",{key:f,style:Rn({"--color":h})},[Kt(S("input",{"onUpdate:modelValue":e[0]||(e[0]=v=>s.selectedColor=v),type:"radio",name:"color",value:h},null,8,Gd),[[fl,s.selectedColor]])],4))),128))]),_:1}),N(a,V(s.fields.filter,{model:s.model}),null,16,["model"])]),S("div",Hd,[S("div",Yd,[S("div",Xd,[S("i",{style:Rn(`background-color: rgb(${s.colors.join(", ")});`)},null,4)]),S("div",null,[S("div",null,[N(l,{"style-type":"color-select",label:"Red",class:"color-slider",model:s.colors,name:"0",max:255,min:0,step:1,"handle-size":.2},{after:Y(()=>[S("span",null,Ce(s.colors[0].toString(16).toUpperCase()),1)]),_:1},8,["model"])]),S("div",null,[N(l,{"style-type":"color-select",label:"Green",class:"color-slider",model:s.colors,name:"1",max:255,min:0,step:1,"handle-size":.2},{after:Y(()=>[S("span",null,Ce(s.colors[1].toString(16).toUpperCase()),1)]),_:1},8,["model"])]),S("div",null,[N(l,{"style-type":"color-select",label:"Blue",class:"color-slider",model:s.colors,name:"2",max:255,min:0,step:1,"handle-size":.2},{after:Y(()=>[S("span",null,Ce(s.colors[2].toString(16).toUpperCase()),1)]),_:1},8,["model"])])])])])]),N(d,{align:"outer",full:""},{default:Y(()=>[s.saveLabel?(y(),U(u,{key:0,"style-type":"primary",label:s.saveLabel,type:"submit"},null,8,["label"])):B("",!0)]),_:1})]),_:1},8,["onSubmit"])])}const Kd=j(Vd,[["render",qd],["__scopeId","data-v-7bf7e342"]]),Zd={xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16"},Qd=S("path",{d:"M0 0v16h16V0H0zm14 14H2V2h12v12z",class:"svg-primary"},null,-1),Jd=S("path",{d:"M4 6v4h2v2h2v-2h2V8h2V4h-2v2H8v2H6V6z",class:"svg-secondary"},null,-1),eh=[Qd,Jd];function th(t,e){return y(),C("svg",Zd,eh)}const nh={render:th},rh={xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16"},sh=S("path",{d:"M0 0v16h16V0H0zm14 14H2V2h12v12z",class:"svg-primary"},null,-1),ih=S("path",{d:"M4 4h8v8H4z",class:"svg-secondary"},null,-1),ah=[sh,ih];function oh(t,e){return y(),C("svg",rh,ah)}const lh={render:oh};const ch={components:{SvgControlInputCheckbox:nh,SvgControlInputRadio:lh},props:{label:{type:String,default:"Item Label"},model:{type:Object,default(){return{value:null}}},name:{type:String,default:null},value:{type:[String,Number],default:null},radio:{type:Boolean,default:!1},readonly:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1}},computed:{currentModel:{get(){return this.name?this.model[this.name]:this.model.value},set(t){this.name?this.model[this.name]=t:this.model.value=t}},styleClasses(){return{radio:this.radio,checkbox:!this.radio}},input(){return{name:this.name,readonly:this.readonly,disabled:this.disabled,type:this.radio?"radio":"checkbox"}}}},uh=["value"],dh={key:2,class:"label"};function hh(t,e,n,r,s,i){const a=R("svg-control-input-checkbox"),o=R("svg-control-input-radio");return y(),C("label",{class:at(["wb-env-atom-form-field-checkbox-group-item",i.styleClasses])},[Kt(S("input",V({"onUpdate:modelValue":e[0]||(e[0]=l=>i.currentModel=l)},i.input,{value:n.value}),null,16,uh),[[ki,i.currentModel]]),n.radio?B("",!0):(y(),U(a,{key:0})),n.radio?(y(),U(o,{key:1})):B("",!0),n.label?(y(),C("span",dh,Ce(n.label),1)):B("",!0)],2)}const mh=j(ch,[["render",hh],["__scopeId","data-v-2c48743d"]]);const fh={components:{WbEnvAtomFormField:Wn,WbEnvAtomFormFieldCheckboxGroupItem:mh},props:{label:{type:String,default:"Checkbox Group Title"},name:{type:String,default:"value"},radio:{type:Boolean,default:!1},readonly:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},read:{type:Boolean,default:!1},model:{type:Object,default(){return{item1:!1,item2:!1}}},items:{type:Array,default(){return[{label:"Item 1",name:"item1"},{label:"Item 2",name:"item2"}]}}}};function ph(t,e,n,r,s,i){const a=R("wb-env-atom-form-field-checkbox-group-item"),o=R("wb-env-atom-form-field");return y(),U(o,{class:"wb-env-atom-form-field-checkbox-group",label:n.label,"label-top":""},{default:Y(()=>[S("ul",null,[(y(!0),C(Et,null,St(n.items,(l,u)=>(y(),C("li",{key:u},[N(a,V({radio:n.radio,name:l.name||n.name,model:n.model,readonly:l.readonly||n.readonly,disabled:l.disabled||n.disabled},l),null,16,["radio","name","model","readonly","disabled"])]))),128))])]),_:1},8,["label"])}const $o=j(fh,[["render",ph],["__scopeId","data-v-9e05e970"]]),gh={xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16"},_h=S("path",{d:"M2 14v2h14V2h-2v12",class:"svg-primary"},null,-1),bh=S("path",{d:"M6 10v2h6V6h-2v4",class:"svg-primary"},null,-1),yh=[_h,bh];function wh(t,e){return y(),C("svg",gh,yh)}const xh={render:wh};const vh={components:{SvgControlTextareaResize:xh,WbEnvAtomFormField:Wn},props:{labelTop:{type:Boolean,default:!1},model:{type:Object,default(){return{}}},label:{type:String,default:"Textarea Label"},id:{type:String,default:null},name:{type:String,default:null},placeholder:{type:String,default:"Textarea Placeholder"},rows:{type:Number,default:null},wrap:{type:Boolean,default:!0},resize:{type:String,validate:t=>["both","horizontal","vertical",null].includes(t),default:"both"},readonly:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},autocomplete:{type:Boolean,default:!1}},computed:{currentModel:{get(){return this.name?this.model[this.name]:this.model.value},set(t){this.name?this.model[this.name]=t:this.model.value=t}},styleClasses(){return{resize:this.resize,[`resize-${this.resize}`]:this.resize}},input(){return{id:this.id,name:this.name,placeholder:this.placeholder,rows:this.rows,wrap:this.wrap?"on":"off",resize:this.resize,readonly:this.readonly,disabled:this.disabled,autocomplete:this.autocomplete?"on":"off"}}}},Eh={class:"wrapper"},Sh={class:"helper resize"};function Ih(t,e,n,r,s,i){const a=R("svg-control-textarea-resize"),o=R("wb-env-atom-form-field");return y(),U(o,{tag:"label",class:at(["wb-env-atom-form-field-textarea",i.styleClasses]),label:n.label,"label-top":n.labelTop},{default:Y(()=>[S("span",Eh,[S("span",null,[Kt(S("textarea",V({"onUpdate:modelValue":e[0]||(e[0]=l=>i.currentModel=l)},i.input),null,16),[[Fa,i.currentModel]]),S("span",Sh,[N(a)])])])]),_:1},8,["label","class","label-top"])}const Ah=j(vh,[["render",Ih],["__scopeId","data-v-6b6f2a1f"]]);const Oh={components:{WbForm:$n,WbButton:kt,WbButtonWrapper:Tt,WbFormFieldCheckboxGroup:$o,WbFormFieldTextarea:Ah},props:{...ct},emits:[...ut,"close"],setup(t,e){return lt(t,e)},data(){return{saveLabel:"Save",model:{[$.SCREEN_1084_FRAME]:this.core.config.get($.SCREEN_1084_FRAME)||!1,[$.SCREEN_REAL_LOOK]:this.core.config.get($.SCREEN_REAL_LOOK)||!1,[$.SCREEN_SCAN_LINES]:this.core.config.get($.SCREEN_SCAN_LINES)||!1,[$.SCREEN_ACTIVE_ANIMATION]:this.core.config.get($.SCREEN_ACTIVE_ANIMATION)||!1,[$.BOOT_WITH_SEQUENCE]:this.core.config.get($.BOOT_WITH_SEQUENCE)||!1,[$.BOOT_WITH_WEBDOS]:this.core.config.get($.BOOT_WITH_WEBDOS)||!1,[$.FILE_EXTENSION_ASSIGNMENT]:(this.core.config.get($.FILE_EXTENSION_ASSIGNMENT)||[]).map(e=>e.join(" ")).join(`
`)}}},computed:{fileTypeAssignment(){return{model:this.model,name:$.FILE_EXTENSION_ASSIGNMENT,label:"File Extension assignment to Application",placeholder:"e.g. md openPreview"}},generalSettings(){return{model:this.model,label:null,items:[]}},screenSettings(){return{model:this.model,label:"Screen - Settings",items:[{label:"Use 1084 Frame with 640x480",name:$.SCREEN_1084_FRAME},{label:"Screen with Real-Look",name:$.SCREEN_REAL_LOOK},{label:"Screen with Scan-Lines",name:$.SCREEN_SCAN_LINES},{label:"Screen with On/Off Animation",name:$.SCREEN_ACTIVE_ANIMATION}]}},bootSettings(){return{model:this.model,label:"BOOT - Settings",items:[{label:"Boot with Sequence?",name:$.BOOT_WITH_SEQUENCE},{label:"Boot with WebDos?",name:$.BOOT_WITH_WEBDOS}]}}},methods:{onSubmit(){this.model[String($.FILE_EXTENSION_ASSIGNMENT)]=this.model[String($.FILE_EXTENSION_ASSIGNMENT)].split(`
`).map(t=>t.match(/^([^ ]+) +(.*)$/).slice(1,3)),this.core.config.set(this.model),this.$emit("close")}}},kh={class:"wb-module-core-settings"},Th={class:"cols"},Rh={class:"col-2"},Dh={class:"col-2"};function Ch(t,e,n,r,s,i){const a=R("wb-form-field-checkbox-group"),o=R("wb-form-field-textarea"),l=R("wb-button"),u=R("wb-button-wrapper"),d=R("wb-form");return y(),C("div",kh,[N(d,{onSubmit:i.onSubmit},{default:Y(()=>[S("div",Th,[S("div",Rh,[i.generalSettings.items.length>0?(y(),U(a,tr(V({key:0},i.generalSettings)),null,16)):B("",!0),i.screenSettings.items.length>0?(y(),U(a,tr(V({key:1},i.screenSettings)),null,16)):B("",!0),i.bootSettings.items.length>0?(y(),U(a,tr(V({key:2},i.bootSettings)),null,16)):B("",!0)]),S("div",Dh,[N(o,V(i.fileTypeAssignment,{"label-top":"",rows:10,resize:null}),null,16)])]),N(u,{align:"outer",full:""},{default:Y(()=>[s.saveLabel?(y(),U(l,{key:0,"style-type":"primary",label:s.saveLabel,type:"submit"},null,8,["label"])):B("",!0)]),_:1})]),_:1},8,["onSubmit"])])}const Nh=j(Oh,[["render",Ch],["__scopeId","data-v-14e1b615"]]),Lh=({core:t})=>[{name:["execute"],description:"Execute file.",args:[new x({index:0,name:"path",description:"Path to the file"})],async action({path:e}){const n=new Map(t.config.get($.FILE_EXTENSION_ASSIGNMENT));if(!e)throw P.get("bad_args");let r;if(n.has(dr(e))?r=await t.modules.files.fs.get(n.get(dr(e))):(r=await t.modules.files.fs.get(e),e=null),typeof r.action=="function")return r.action(t,e);if("type"in r.data){const s=[`openPreview "${r.getPath()}"`];return r.data.openMaximized&&s.push("-maximized"),t.executeCommand(s.join(" "))}}},{name:["openColorSettings"],action(){t.modules.windows.addWindow({title:"Color Settings",component:Kd,componentData:{},options:{scale:!1,prompt:!1,scrollX:!1,scrollY:!1}})}},{name:["openSettings"],action(){t.modules.windows.addWindow({title:"Settings",component:Nh,componentData:{},options:{scale:!1,prompt:!1,scrollX:!1,scrollY:!1}})}},{name:["echo","print"],args:[new x({name:["newline","n"],flag:!0})],async action({newline:e},n){const r=s=>Z(s).replace(/\\"/g,'"').replace(/\\n/g,`
`);if(e)n.message(n.commandArgs.map(s=>r(s)));else{let s=await n.core.executeCommand(n.commandValue);typeof s=="object"&&(s=JSON.stringify(s)),n.message(`${Z(r(s))}`)}}},{name:"commands",action(e,n){const r=new jt({headerPadding:1});return r.addColumn([{value:"Command(s)",align:"left",maxWidth:20},{value:"Description/Arguments",align:"left",maxWidth:60}]),r.addRow(Dt.items.reduce((s,i)=>{const a=i.args||[],o=[];i.description&&(o.push(i.description),o.push("")),a.length&&(o.push("Arguments:"),o.push(""));const{flagNames:l,kwargNames:u}=a.reduce((m,h)=>{const f=h.name.join(", ");return h.flag?m.flagNames.push({name:`-${f}`,description:h.description}):m.kwargNames.push({name:`--${f}`,description:h.description}),m},{flagNames:[],kwargNames:[]}),d={paddingChr:"",showHeaders:!1,config:{name:{minWidth:15},description:{minWidth:10,maxWidth:30}}};return o.push(hi(l,Object.assign({},d))),l.length>0&&u.length>0&&o.push(""),o.push(hi(u,Object.assign({},d))),s.push([i.name.join(", "),o.join(`
`)]),s},[])),n.message(["Commands:",r]),Promise.resolve()}},{name:["CLS","CLEAR"],action(){t.consoleInterface.clear()}},{name:["prompt","input","PROMPT","INPUT"],args:[new x({index:0,name:"text",description:"Text from prompt."}),new x({index:1,name:"variable",description:"Variable"})],action:({text:e,variable:n,unresolved:r},s)=>(r.text&&!r.variable?(n=r.text,e=null):n=r.variable,t.consoleInterface.prompt(e).then(i=>(Zn(i)&&(i=Number(i)),n&&t.modules.parser.memory.set(n,i),i)))},{name:["confirm","CONFIRM"],args:[new x({index:0,name:"text",description:"Text from confirm."})],action({text:e}){return t.consoleInterface.confirm(e)}},{name:["selfCheck"],async action(e,n){const r=new jt;r.addColumn([{value:"Count",align:"left",minWidth:8},{value:"Description",align:"left",minWidth:15}]),r.addRow(await Ph(t)),n.message(["Command Tests:",r])}}];function Ph(t){const e=new cd(t);return e.command('"foo" +"bar"','"foobar"'),e.command("(-3+-6)+1",-3+-6+1),e.command("(-3-+6)+1",-3-6+1),e.command("(-3*-6)+1",-3*-6+1),e.command("(-3/-6)+1",-3/-6+1),e.command("(-3+6)+1",-3+6+1),e.command("(-3-6)+1",-3-6+1),e.command("(-3*6) + 1",-3*6+1),e.command("(-3/6)+1",-3/6+1),e.command("INT(PI)",3),e.command("(POW(2,2)+1)",5),e.command('ASC("D")',68),e.command("CHR$(68)",'"D"'),e.command('LEN("ABC")',3),e.command('"a" + "b"','"ab"'),e.command("STRING$(3,0)",'"000"'),e.command("SQRT(2,2)",Math.sqrt(2,2)),e.command("128 >> (256 + 5)",128>>256+5),e.command("-2+4+SQRT(2,2)",-2+4+Math.sqrt(2,2)),e.command("-2- 2 * 2",-2-2*2),e.command("(1+1)",1+1),e.command("2*2",2*2),e.command("1+2+3+(POW(2,2)+1)+5*8-(50/2)",1+2+3+(2**2+1)+5*8-50/2),e.start()}const{version:Mh}=pl().public;var ks,Tr,Rr,Dr,Wt,Cr,Nr,Lr;const ar=class{constructor(){g(this,ks,new Me);g(this,Tr,new Me);g(this,Rr,!1);g(this,Dr,new Pl(0));g(this,Wt,{});g(this,Cr,new ld(this));g(this,Nr,new an({core:this,debug:!1,consoleInterface:c(this,Cr)}));p(this,"executionCounter",vt(0));g(this,Lr,new ad(ru,ce.SESSION,da));this.log(`${ar.NAME}; ${ar.VERSION}`)}get version(){return ar.VERSION}addExecution(){return this.executionCounter.value++,()=>{this.executionCounter.value--}}get events(){return c(this,ks)}async setup(){if(c(this,Rr))return console.warn("Setup is complete!"),this;A(this,Rr,!0),Dt.add(yo(Lh({core:this}))),await c(this,Lr).ready,this.config.setDefaults(da);const e=Object.values(c(this,Wt));return await Promise.all(e.map(n=>Promise.resolve(n.beforeSetup()))),await Promise.all(e.map(n=>Promise.resolve(n.setup()))),await $h(this.modules.files.fs),c(this,Dr).next(this),this}destroy(){Dt.clear()}addModule(e,n){const r=new e(Object.assign({core:this},n));c(this,Wt)[en(r.constructor.NAME)]=r}async removeModule(e){await e.destroy(),delete c(this,Wt)[e.constructor.NAME]}executeCommands(e){if(e.length>0){const n=e.shift();return this.executeCommand(n).then(()=>this.executeCommands(e))}}async executeCommand(e,n){typeof e=="string"&&(e=e.replace(/(.*[^\\])\n(\S*)/gm,"$1\\n$2")),n=Object.assign({show:!1,commandBucket:Dt,core:this,logger:this.logger},n);const r=[];n.message&&r.push(...r.concat(n.message));const s=n.show;n.message=a=>{s&&r.push(...[].concat(a))};let i;try{if(e){const a=await this.modules.parser.parseCommand(e);n.commandBucket.has(a.command)?i=await ya(e,a,n.commandBucket,n):Dt.has(a.command)?i=await ya(e,a,Dt,n):this.modules.parser.isMathValue(e)?i=await this.modules.parser.parseMath(e):/^\w+$/.test(e)&&console.warn(`can\\'t use variable or method "${e}"`)}}catch(a){let o=a;Array.isArray(a)&&(o=new Error(a[a.length-1])),c(this,Tr).next(o)}return i!==void 0&&i!=="undefined"&&typeof i=="string"&&n.show&&r.length<1&&r.push(i),r.forEach(a=>n.logger.add(a,{type:an.TYPE.OUTPUT})),i}log(e){c(this,Nr).add(e,{namespace:"Core"})}get consoleInterface(){return c(this,Cr)}get errorObserver(){return c(this,Tr)}get ready(){return c(this,Dr)}get config(){return c(this,Lr)}get logger(){return c(this,Nr)}get modules(){return c(this,Wt)}};let Jn=ar;ks=new WeakMap,Tr=new WeakMap,Rr=new WeakMap,Dr=new WeakMap,Wt=new WeakMap,Cr=new WeakMap,Nr=new WeakMap,Lr=new WeakMap,p(Jn,"VERSION",Mh||"0.0.0"),p(Jn,"NAME","web-workbench");async function ya(t,e,n,r){const s=n.get(e.command),i=r.show,a=await s.action(qc(s,e),Object.assign({command:e.command,commandValue:e.commandValue,commandArgs:e.args},r));return i&&r.showCommand&&r.logger.add("> "+t,{type:an.TYPE.OUTPUT}),a}async function $h(t){const[e,n,r]=(await Promise.all([k(()=>import("./CHANGELOG.6ee95500.js"),[],import.meta.url),k(()=>import("./imprint.4596c064.js"),[],import.meta.url),k(()=>import("./disclaimer.ed39e2a0.js"),[],import.meta.url)])).map(a=>a.default||a);await t.createRootFile("Cuby_Generator.link","Cuby Generator",null,{meta:[[b.POSITION,{x:236,y:394}],[b.IGNORE_SYMBOL_REARRANGE,!0],[b.WEB_URL,"https://cuby.lammpee.de"],[b.SYMBOL,w.CUBY]]}),await t.createRootFile("Github.link","Github",null,{meta:[[b.POSITION,{x:159,y:386}],[b.IGNORE_SYMBOL_REARRANGE,!0],[b.WEB_URL,"https://github.com/ThornWalli/web-workbench"],[b.SYMBOL,w.GITHUB]]});const s=[{id:"Imprint.md",name:"Imprint",content:n,position:{x:0,y:390},fontFamily:Qn.Monospace["Courier New"],fontSize:14},{id:"Disclaimer.md",name:"Disclaimer",content:r,position:{x:80,y:390},fontFamily:Qn.Monospace["Courier New"],fontSize:14},{id:"Changelog.md",name:"Changelog",content:e,position:{x:0,y:305},fontFamily:Qn.Monospace["Courier New"],fontSize:14}];return(await t.createRootDir("Press","Press",{meta:[[b.WINDOW_SIDEBAR,!1],[b.WINDOW_SCALE,!1],[b.WINDOW_SCROLL_X,!1],[b.WINDOW_SCROLL_Y,!1],[b.POSITION,{x:80,y:320}],[b.WINDOW_SIZE,{x:100,y:120}],[b.IGNORE_SYMBOL_REARRANGE,!0]]})).addItems([{id:"Amiga-News.link",name:"Amiga-News.de",meta:[[b.WEB_URL,"https://www.amiga-news.de/de/news/AN-2022-07-00094-DE.html"],[b.SYMBOL,w.LARGE_NOTE_RICH],[b.POSITION,{x:10,y:10}]]}]),Promise.all(s.map(({id:a,name:o,content:l,position:u,fontFamily:d,fontSize:m})=>t.createRootFile(a,o,{openMaximized:!0,type:"markdown",content:l,fontFamily:d||Qn.SansSerif.Arial,fontSize:m||Oo},{meta:[[b.POSITION,u],[b.IGNORE_SYMBOL_REARRANGE,!0],[b.SYMBOL,w.LARGE_NOTE_RICH]]}))).catch(a=>{throw new Error(a)})}function qp(t){const e={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#039;","\n":`&nbsp;
`," ":"&nbsp;"};return t.replace(/[&<>"'\n ]/g,function(n){return e[String(n)]})}function mi(t,e,n,r=" "){if(t.length<e)for(let s=t.length;s<=e-1;s++)n?t=r+t:t=t+r;return t}function er(t){return t>2e3?(t=parseInt(t/1e3),t>1e3?(t=parseInt(t/1e3),t>1e3?(t=parseInt(t/1e3),`${t}g`):`${t}m`):`${t}k`):`${t}b`}function fi(t,e){const n=new Date(e),r=[[/y/g,`${n.getFullYear()}`.slice(2)],[/Y/g,n.getFullYear()],[/dd/g,wa(n.getDate())],[/d/g,n.getDate()],[/DD/g,wa(n.getDate())],[/D/g,Gn(n.getDate())],[/mm/g,xa(n.getMonth(),!0)],[/m/g,n.getMonth()+1],[/MM/g,xa(n.getMonth()+1,!1)],[/M/g,Gn(n.getMonth()+1)],[/h/g,n.getHours()],[/H/g,Gn(n.getHours())],[/i/g,n.getMinutes()],[/I/g,Gn(n.getMinutes())],[/s/g,n.getSeconds()],[/S/g,Gn(n.getSeconds())]];return r.forEach((s,i)=>{t=t.replace(s[0],`%${i}%`)}),r.forEach((s,i)=>{t=t.replace(`%${i}%`,s[1])}),t}const Wh=[["Sunday","Sun"],["Monday","Mon"],["Tuesday","Tue"],["Wednesday","Wed"],["Thursday","Thu"],["Friday","Fri"],["Saturday","Sat"]];function wa(t,e){return Wh[String(t)]}const Fh=[["Januar","Jan"],["February","Feb"],["March","Mar"],["April","Apr"],["May"],["June"],["July"],["August","Aug"],["September","Sept"],["October","Oct"],["November","Nov"],["December","Dec"]];function xa(t,e){return t=Fh[t-1],t.length>1?e?t[1]:t[0]:t}function Gn(t){return t=String(t),t.length<2?`0${t}`:t}function Wo(t,e){return e<=0?"":e>String(t).length?t:String(t).substring(0,e)}function zh(t,e){if(e<=0)return"";if(e>String(t).length)return t;{const n=String(t).length;return String(t).substring(n,n-e)}}function va(t,e=" "){return Array(parseInt(t)).fill(e).join("")}const ke=class{static parse(e,n=[],r=0){let s=e;const i=Uh();let a=!1,o=0;for(;e.length>=o;){const l=e[Number(o-1)],u=e[Number(o+1)],d=e[Number(o)];if(d==="("&&i.clamp!==!1&&i.clamp++,/(^[$]{6}\d+\$)/.test(e.slice(o,e.length))&&!ht(i)){const[m]=e.slice(o,e.length).match(/(^[$]{6}\d+\$)/);o+=m.length-1}else if(/(^[$]{3}\d+)/.test(e.slice(o,e.length))&&!ht(i)){const[m]=e.slice(o,e.length).match(/(^[$]{3}\d+)/);i.startRecord=o,o+=m.length,i.stopRecord=o}else d==="-"&&(u==="-"||ke.REGEX_CHAR_WORD_NON_DIGIT.test(u))&&!ht(i)?(i.parameter=!0,i.startRecord=o):d==="("&&!ht(i)?(i.clamp=0,i.startRecord=o):ke.REGEX_NUMERIC.test(d)&&!ht(i)?(i.numeric=!0,i.startRecord=o):ke.REGEX_CHAR_WORD_NON_DIGIT.test(d)&&!ht(i)?(i.char=!0,i.startRecord=o):d==='"'&&!ht(i)?(i.doubleQuote=!0,i.startRecord=o):d==="'"&&!ht(i)?(i.singleQuote=!0,i.startRecord=o):i.startRecord!==!1&&(i.parameter?(d==="="||!ke.REGEX_CHAR_WORD_NON_DIGIT.test(u))&&(d==="="?(i.parameter=!1,i.char=!1,i.startOverride=i.startRecord):u!=="="&&!ke.REGEX_CHAR_WORD_NON_DIGIT.test(u)&&u!=="-"&&(i.stopRecord=o+1)):i.clamp!==!1?d===")"&&(i.clamp===0?i.stopRecord=o+1:i.clamp--):i.numeric?ke.REGEX_NUMERIC.test(l)&&!ke.REGEX_NUMERIC.test(d)&&(i.stopRecord=o):i.char?ke.REGEX_CHAR_WORD_NON_DIGIT.test(l)&&!(ke.REGEX_CHAR_WORD_NON_DIGIT.test(d)&&!/[$%]/.test(d))&&(/[ ]*\(/.test(e.slice(o,e.length))?(i.char=!1,i.clamp=0):i.stopRecord=o+1):i.doubleQuote?l!=="\\"&&d==='"'&&(i.stopRecord=o+1):i.singleQuote&&l!=="\\"&&d==="'"&&(i.stopRecord=o+1));if(!i.stopRecord&&o+1>e.length&&(i.stopRecord=o+1,a=!0),i.stopRecord&&i.startRecord===!1&&o+1!==e.length)a=!0;else if(i.stopRecord){let m=i.startRecord;i.startOverride!==void 0&&(m=i.startOverride),s=s.slice(0,m)+Vh(n,s.slice(m,i.stopRecord))+s.slice(i.stopRecord,s.length),ke.DEBUG&&console.log("result",s),a||(this.parse(s,n,r),a=!0)}if(a)break;o++}return n.length>0?n.filter(l=>l.length>0):[e]}};let ft=ke;p(ft,"REGEX_CHAR_WORD_NON_DIGIT",/^[^\d\W$%]|[.].$/),p(ft,"REGEX_NUMERIC",/^[\d+\-*\\/.<>]$/),p(ft,"DEBUG",!1);function Bh(t){return`$$$$$$${t}$`}function Vh(t,e){return t.push(e),Bh(t.length-1)}function ht(t){return t.singleQuote||t.doubleQuote||t.clamp!==!1||t.char||t.numeric||t.parameter}function Uh(){return{dollarCount:0,startRecord:!1,stopRecord:!1,char:!1,numeric:!1,singleQuote:!1,doubleQuote:!1,clamp:!1,parameter:!1}}var Pr;const fe=class{constructor(e){g(this,Pr,void 0);A(this,Pr,e)}async parse(e){const n=e;let r=e;const s=e.match(fe.REGEX_COMMAND_REPLACE);s&&(r=s[1],e=s[2]);const i=e;let a=[],o={},l;if(r!==e){const u=this.parseParameter(e);l=u.unresolved,a=await Promise.all(u.args),o=u.kwargs,await Promise.all(Object.keys(o).map(d=>o[String(d)].then(m=>o[String(d)]=m)))}return{origin:n,unresolved:l,args:a,kwargs:o,command:r,commandValue:i}}parseParameter(e){return ft.parse(e).reduce((r,s)=>{if(fe.REGEX_PARAM_KWARG.test(s)){const[,i,a]=s.match(fe.REGEX_PARAM_KWARG);r.kwargs[en(String(i))]=this.parseValue(a),r.unresolved.kwargs[en(String(i))]=ha(a)}else fe.REGEX_PARAM_ARG.test(s)?(r.kwargs[en(String(s.replace(fe.REGEX_PARAM_ARG,"$1")))]=Promise.resolve(!0),r.unresolved.kwargs[en(String(s.replace(fe.REGEX_PARAM_ARG,"$1")))]=Promise.resolve(!0)):(r.args.push(this.parseValue(s)),r.unresolved.args.push(ha(s)));return r},{unresolved:{kwargs:{},args:[]},kwargs:{},args:[]})}parseValue(e){return/.*(true|false).*/.test(e)?Promise.resolve(e.replace(/.*(true|false).*/,"$1")==="true"):/^".*"$/.test(e)?Promise.resolve(Z(e)):/^\d+$/.test(e)?Promise.resolve(Number(e)):typeof e=="string"&&/ *([a-zA-Z_-]+) */.test(e)?c(this,Pr).parse(e.replace(/ *([a-zA-Z_-]+) */,"$1")):Promise.resolve(e)}static extractStrings(e,n=" "){let r=!1,s;const i=[];let a=!1;for(let l=e.length-1;l>=0;l--){const u=e[Number(l)],d=e[l-1];!a&&u==='"'&&d!=="\\"?r?(r=!1,i.push(e.slice(l,s+1))):(a=!1,r=!0,s=l):(!r&&a||a)&&u==="'"&&d!=="\\"&&(r?(a=!1,r=!1,i.push(e.slice(l,s+1))):(a=!0,r=!0,s=l))}if(r)throw new Error("can't extract values; "+e);return{result:i.reduce((l,u,d)=>l.replace(u,fe.resolveKey(d)),e),values:i}}static extractValues(e,n=" "){let r=!1,s;const i=[];let a=!1;for(let l=e.length-1;l>=0;l--){const u=e[Number(l)],d=e[l-1];!a&&u==='"'&&d!=="\\"?r?(r=!1,i.push(e.slice(l,s+1))):(a=!1,r=!0,s=l):(!r&&a||a)&&u==="'"&&d!=="\\"&&(r?(a=!1,r=!1,i.push(e.slice(l,s+1))):(a=!0,r=!0,s=l))}if(r)throw new Error("can't extract values; "+e);return i.forEach((l,u)=>{e=e.replace(l,fe.resolveKey(u))}),{params:e.split(n).filter(l=>l),values:i}}static resolveKey(e){return`$$$$$$${e}`}static resolveValues({params:e,values:n}){return e.map(r=>fe.resolveValue(r,n))}static valueUnresolved(e){return fe.REGEX_VALUE_RESOLVE.test(e)}static resolveValue(e,n){if(fe.valueUnresolved(e)){if(e=e.match(/[$]{3}(\d+)/g).reduce((r,s)=>r.replace(s,n[Number(s.replace(fe.REGEX_VALUE_RESOLVE,"$1"))]),e),/[\w]+[$%]?[ ]*\(/.test(e))return e;if(typeof e=="string"){if(e==="undefined")return;if(Gh(e))return e;if(jh(e))return Number(e);if(!e.startsWith('"'))return gu(e)}}return e}};let K=fe;Pr=new WeakMap,p(K,"REGEX_VALUE_RESOLVE",/[$]{3}(\d+)/),p(K,"REGEX_COMMAND_REPLACE",/^([a-zA-Z]+[a-zA-Z0-9_]+) (.*)$/),p(K,"REGEX_PARAM_KWARG",/^[-]{0,2}([\\-\w]+)=(.*)$/),p(K,"REGEX_PARAM_ARG",/^[-]{1,2}([\\-\w]+)$/);function jh(t){return!isNaN(t)}function Gh(t){return!isNaN(parseInt(t))}var Mr,_n,bn,yn;class Fo{constructor(e,n,r,s){g(this,Mr,void 0);g(this,_n,void 0);g(this,bn,!1);g(this,yn,!1);A(this,Mr,e),A(this,_n,n),A(this,bn,r||c(this,bn)),A(this,yn,s||c(this,yn))}get name(){return c(this,Mr)}get value(){return c(this,_n)}set value(e){this.readonly||A(this,_n,e)}get global(){return c(this,bn)}get readonly(){return c(this,yn)}}Mr=new WeakMap,_n=new WeakMap,bn=new WeakMap,yn=new WeakMap;class Hh extends Fo{constructor(e,n,r){super(e,n,r,!0)}execute(e){return this.value.apply(this,e)}}class Ea extends Fo{}var le,_t,pe;class Gi{constructor(){g(this,le,new Map);g(this,_t,new Map);g(this,pe,[])}reset(){this.resetPrefixStack(),c(this,le).clear(),c(this,_t).clear()}resetPrefixStack(){A(this,pe,[])}get prefixStack(){return c(this,pe)}get currentPrefixStack(){return c(this,pe)[c(this,pe).length-1]}has(e){return e=e.replace(/(.*[^ ])[ ]+$/,"$1"),e=e.replace(/[$%]$/,""),(!c(this,le).get(e)||c(this,le).get(e)&&!c(this,le).get(e).global)&&(e=this.prepareName(e)),c(this,le).has(e)}add(e,n,r=!1,s=!1){e=e.replace(/(.*[^ ])[ ]+$/,"$1"),/\$$/.test(e)?n===void 0&&(n=""):/\\%$/.test(e)&&n===void 0&&(n=0),e=e.replace(/[$%]$/,""),e=this.prepareName(e),this.has(e)||c(this,le).set(e,new Ea(e,n,r,s))}get(e){e=e.replace(/(.*[^ ])[ ]+$/,"$1");const n=e;e=e.replace(/[$%]$/,""),(!c(this,le).get(e)||c(this,le).get(e)&&!c(this,le).get(e).global)&&(e=this.prepareName(e));let r=c(this,le).get(e);return r?(r=r.value,/\$$/.test(n)?r=String(r):/\\%$/.test(n)||/^\d+$/.test(r)?r=parseInt(r):/^[\d.]+$/.test(r)&&(r=parseFloat(r)),r):null}set(e,n,r=!1,s=!1){if(e=e.replace(/(.*[^ ])[ ]+$/,"$1"),typeof n!="object"&&(/[$]$/.test(e)?n===void 0?n="":n=String(n):/[%]$/.test(e)&&(n===void 0?n=0:n=parseInt(n))),e=e.replace(/[$%]$/,""),e=this.prepareName(e),this.has(e)){const i=c(this,le).get(e);i instanceof Ea&&i&&(i.value=n)}else this.add(e,n,r,s)}addSub(e,n){e=this.prepareName(e,!1),this.has(e)||c(this,_t).set(e,new Hh(e,n))}executeSub(e,n,r=!1){return e=this.prepareName(e,!1),c(this,pe).push({name:`${parseInt(Math.random()*1e4)}`,global:r}),c(this,_t).get(e).execute(n).then(s=>(c(this,le).forEach(i=>{RegExp(`[$]{3}${c(this,pe)[c(this,pe).length-1].name}$`).test(i.name)&&c(this,le).delete(i.name)}),c(this,pe).pop(),s))}hasSub(e){return e=this.prepareName(e,!1),c(this,_t).has(e)}prepareName(e,n=!0){return typeof e=="string"&&(e=e.replace(/ /g,"")),n&&c(this,pe).length&&!/[$]{3}/.test(e)&&(e=`${e}$$$${c(this,pe)[c(this,pe).length-1].name}`),e}get dims(){return c(this,le)}get subs(){return c(this,_t)}}le=new WeakMap,_t=new WeakMap,pe=new WeakMap;var Ft,$r,re,we,Ye,Wr,Fr,xe,zr,zt,Xe,ge,bt,se,ie,Pa;let Yh=(Pa=class{constructor(e,n,r,s=null,i=null){g(this,Ft,void 0);g(this,$r,void 0);g(this,re,void 0);g(this,we,void 0);g(this,Ye,void 0);g(this,Wr,9999999999);g(this,Fr,0);g(this,xe,null);g(this,zr,[]);g(this,zt,0);g(this,Xe,[]);g(this,ge,-1);g(this,bt,[]);g(this,se,[]);g(this,ie,-1);A(this,Ye,e),A(this,we,n),A(this,re,r||new Gi),A(this,Ft,s),A(this,$r,i)}get memory(){return c(this,re)}get lines(){return c(this,Ye)}parse(e){e=e||[].concat(c(this,Ye));const n=e.shift().trim();return new Promise(r=>{if(c(this,xe)&&n!=="END SUB"){c(this,xe).lines.push(n),r();return}if(c(this,Wr)>0&&c(this,Fr)>c(this,Wr))throw new Error("BASIC INTERPRETER OVERFLOW");if(Ie(this,Fr)._++,c(this,ie)>=0){if(c(this,se).forEach(s=>{c(this,se)[c(this,ie)].count===0&&s.count===0&&s.lines.push(n)}),n==="WEND"||/NEXT /.test(n))return c(this,se)[c(this,ie)].condition().then(async s=>{if(c(this,se)[c(this,ie)].tmpLines=c(this,se)[c(this,ie)].tmpLines||e,s){const i=c(this,se)[c(this,ie)].lines;return c(this,se)[c(this,ie)].count++,"step"in c(this,se)[c(this,ie)]&&await c(this,se)[c(this,ie)].step(),i.length>0?this.parse([].concat(i)):(c(this,se)[c(this,ie)]=!1,Ie(this,ie)._--,c(this,se).pop(),null)}else return c(this,se)[c(this,ie)]=!1,Ie(this,ie)._--,c(this,se).pop(),null}).then(r);r()}else r()}).then(()=>{if(!c(this,xe)&&c(this,ge)>=-1&&(c(this,bt)[c(this,ge)]!==void 0&&c(this,Xe)[c(this,ge)]===void 0&&c(this,Xe).push(!c(this,bt)[c(this,ge)]),n==="ELSE"&&c(this,zt)<1&&(c(this,Xe)[c(this,ge)]=!c(this,Xe)[c(this,ge)])),c(this,Xe)[c(this,ge)])/^IF (\((.*)\)|(.*)) THEN$/.test(n)&&Ie(this,zt)._++;else return this.parseLine(n,e);return null}).then(()=>(c(this,ge)>-1&&(n==="ENDIF"||n==="END IF")&&(c(this,zt)<1?(Ie(this,ge)._--,c(this,bt).pop(),c(this,Xe).pop()):Ie(this,zt)._--),e.length?this.parse(e):c(this,zr)))}parseLine(e,n){return new Promise((r,s)=>{if(e=(e||"").replace(/^[ \t]+/g,""),/^ *[#/]+/.test(e)){r();return}if(/^SUB (.*) STATIC$/.test(e)){const i=e.match(/^SUB (.*) STATIC$/);return this.commandSubStatic(i[1]).then(r)}else{if(e==="END SUB")return this.commandEndSub().then(r);if(c(this,xe)){r();return}}if(/^IF (\((.*)\)|(.*)) THEN$/.test(e)){const i=e.match(/^IF (\((.*)\)|(.*)) THEN$/),a=i[3]||i[2];return this.commandIfThen(a).then(r)}else if(e==="ELSE"||e==="ENDIF"||e==="END IF"){r();return}if(/^WHILE (.*)$/.test(e)){const i=e.match(/^WHILE (.*)$/);return this.commandWhile(i[1]).then(r)}else if(e==="WEND"){r();return}if(/^FOR (.*)$/.test(e)){const i=e.match(/^FOR (.*)$/);return this.commandFor(i[1]).then(r)}else if(e.startsWith("NEXT ")){r();return}if(/^([\w\d]+):$/.test(e)){r();return}if(/^GOTO +([\w\d]+)$/.test(e)){const i=e.match(/^GOTO +([\w\d]+)$/);this.commandGoto(n,i[1])}if(/^DIM( SHARED)? +(.*)$/.test(e)){const i=e.match(/^DIM( SHARED)? +(.*)$/);return this.commandDimShared(i[2],!!i[1]).then(r)}if(/^LET +([\w,$%]+)(\((.*)\))? *= *(.*)$/.test(e)){const i=e.match(/^LET +([\w,$%]+)(\((.*)\))? *= *(.*)$/);return this.commandLet(i[1],i[4],i[3]).then(()=>r())}if(/^READ +([\w, $%]+)$/.test(e)){const i=e.match(/^READ +([\w, $%]+)$/);return this.commandRead(i[1]).then(r)}if(/^END[ ]*$/.test(e))return this.commandEnd().then(r);if(/^(PAUSE|SLEEP) +(.+)/.test(e)){const a=e.match(/^(PAUSE|SLEEP) +(.+)/)[2];return this.commandPause(a).then(r)}if(/^CALL *(.*)/.test(e)){const i=e.match(/^CALL *(.*)/);return this.commandCall(i[1],n).then(r)}if(/^EXECUTE *(FILE|EVAL) *(.*)/.test(e)){const i=e.match(/^EXECUTE *(FILE|EVAL) *(.*)/);return this.commandExecute(i[1],i[2]).then(r).catch(s)}if(/^PRINT +USING +(.*);(.*)$/.test(e)){const i=e.match(/^PRINT +USING +(.*);(.*)$/);return this.commandPrintUsing(i[1],i[2]).then(r)}if(/^PRINT +(.*)$/.test(e)){const i=e.match(/^PRINT +(.*)$/);return this.commandPrint(i[1]).then(r)}if(/^DATA +(.*)$/.test(e)){const i=e.match(/^DATA +(.*)$/);return this.commandDataVar(i[1]).then(r)}c(this,we)?c(this,we).call(this,e,{show:!0}).then(i=>{i&&c(this,zr).push(i)}).then(r).catch(s):r()})}async setReadStack(e,n){let r=await this.parseValue(n,!0);return is(r)&&(r=parseFloat(r)),c(this,re).set(e,r,!0)}async addDataStack(e){let n=await this.parseValue(e,!0);return is(n)&&(n=parseFloat(n)),c(this,Ft).push(n)}async setStack({name:e,value:n,index:r,global:s}){let i=await this.parseValue(n,!0);return is(i)&&(i=parseFloat(i)),r!==void 0?(r=await this.parseValue(r,!0),c(this,re).get(e)[r-1]=i):c(this,re).set(e,i,s)}async setGotoMarkStack(e,n){c(this,$r).set(e,await this.parseValue(n,!0))}parseValue(e,n=!0,r=!1){if(e===void 0)return Promise.resolve(e);if(Ao(e))return Promise.resolve(e);if(Array.isArray(e))return Promise.resolve(e);if(typeof e=="boolean"||/^ *(true|false|TRUE|FALSE) *$/.test(e))return typeof e!="boolean"&&(e=e.toLowerCase()==="true"),Promise.resolve(e);if(/^ *@"((.|\n)*)" *$/.test(e))return Promise.resolve(e.replace(/^ *@"((.|\n)*)" *$/,'"$1"'));if(/^ *"((\\"|[^"])*)" *$/.test(e))return Promise.resolve(e.replace(/^ *"((\\"|[^"])*)" *$/,'"$1"'));if(/^ *[\d]+ *$/.test(e))return Promise.resolve(parseFloat(e));if(/^ *([\\-]?[\d.]+(e[-+]?\d+)?) *$/.test(e))return Promise.resolve(parseFloat(e));if(e&&/^[^"]?(.*)[^"]? *$/.test(e.replace(/ /g,""))){if(e=e.replace(/^ */g,""),c(this,re).has(e.replace(/ /g,"")))return e=e.replace(/ /g,""),this.parseValue(c(this,re).get(e),!0);if(r)throw new Error("test");return c(this,we).call(this,e,{message:n?void 0:e}).then(s=>s)}return Promise.resolve(null)}async executeCondition(e,n,r){return e=await this.parseValue(e,!0),r=await this.parseValue(r,!0),/^[=]?==$/.test(n)?e===r:n==="<>"?e!==r:/^([<>][=]|[<>])?$/.test(n)?Xh(e,n,r):/^!=[=]?$/.test(n)?e!==r:null}commandIfThen(e){const n=e.match(/([^<>]*) *(<>|<=|>=|<|>|[=!]{2,3}) *([^<>].*)/);return n?this.executeCondition(n[1],n[2],n[3]).then(r=>(c(this,bt).push(r),Ie(this,ge)._++,r)):this.parseValue(e[1],!0).then(r=>(c(this,bt).push("value"in r?r.value:r),Ie(this,ge)._++,r))}commandWhile(e){const n=e.match(/([^<>]*) *(<>|<=|>=|<|>|[=!]{2,3}) *([^<>].*)/);return n?this.executeCondition(n[1],n[2],n[3]).then(r=>{if(r)return c(this,se).push({count:0,lines:[],condition:()=>this.executeCondition(n[1],n[2],n[3])}),Ie(this,ie)._++,r}):Promise.resolve()}async commandFor(e){const n=e.match(/(.*) *= *(.*) +TO +(.*) +STEP[ ](.*)/)||e.match(/(.*) *= *(.*) +TO +(.*)/);if(n){const r=await this.parseValue(n[2],!0),s=await this.parseValue(n[3],!0);c(this,re).set(n[1],r),Ie(this,ie)._++;const i=async(a=!0)=>{let o=1;return n[4]&&(o=await this.parseValue(n[4],!0)),a&&c(this,re).set(n[1],c(this,re).get(n[1])+o),o};return c(this,se).push({step:i,count:0,lines:[],condition:async()=>{const a=await i(!1);return a===0?!1:this.executeCondition(`(${n[1]}  )`,a<0?">":"<",s)}})}}commandSubStatic(e){const n=e.match(/^([\w,$%]+)(\((.*)\))?$/),r=n[1],s=K.resolveValues(K.extractValues(n[3]||"",","));return A(this,xe,{name:r,lines:[],args:s}),Promise.resolve()}commandEndSub(){if(c(this,xe)){const e=c(this,xe).lines,n=c(this,xe).args;c(this,re).addSub(c(this,xe).name,async(...r)=>{(await Promise.all(n.map((i,a)=>this.parseValue(r[Number(a)]).then(o=>({arg:i,value:o}))))).forEach(({arg:i,value:a})=>{c(this,re).add(i,a)}),await this.parse([].concat(e))}),A(this,xe,null)}else throw new Error("has no active SUB");return Promise.resolve()}commandGoto(e,n){return e.splice(0,e.length),this.parse(c(this,Ye).slice(c(this,Ye).indexOf(`${n}:`),c(this,Ye).length))}commandDimShared(e,n){return K.resolveValues(K.extractValues(e,",")).reduce((s,i)=>(i=i.match(/^([\w, $%]+)?(\((.*)\))?$/),c(this,re).has(i[1])||(i[3]&&(s=s.then(()=>this.parseValue(i[3],!0))),s=s.then(a=>this.setStack({name:i[1],value:a?Array(a):void 0,global:n}))),s),Promise.resolve())}commandLet(e,n,r){if(c(this,re).has(e))return this.setStack({name:e,value:n,index:r});throw new Error(`Variable ${e} not defined`)}async commandPrintUsing(e,n){const r=await this.parseValue(e,!0);try{n=await Promise.all(K.resolveValues(K.extractValues(n.trim(),",")).map(i=>this.parseValue(i,!0,!0)))}catch{n=[await this.parseValue(n,!0)]}const s=n.reduce((i,a)=>{const o=r.match(/((#+)(\.(#+))?)/);return a=String(a),/[\d.]+/.test(a)&&(a=a.split(/\./),o[4]&&a.length>1?a[1]=Wo(mi(String(a[1]),o[4].length,!1,"0"),o[4].length):a.splice(1,1),a[0]=mi(String(a[0]),o[2].length,!0," "),a=a.join(".")),i.replace(/(#+(\.#+)?)/,Z(a))},r);return c(this,we).call(this,null,{message:`"${Z(s)}"`})}commandDataVar(e){if(c(this,Ft).length===0)return Promise.all(e.split(",").map(n=>this.addDataStack(n)));throw new Error("DATA has already been declared")}async commandPrint(e){if(/^((".*"|[^"]*);([^;]*))$/.test(e)){const n=e.match(/(.*);(.*)$/),r=await this.parseValue(n[1],!0);let s=await Promise.all(K.resolveValues(K.extractValues(n[2]," ")).reduce((i,a)=>(i.push(this.parseValue(a,!0)),i),[]));return s=s.map(i=>`${Z(r)}${Z(i)}`).join(" "),c(this,we).call(this,null,{message:`"${s}"`})}else{let n=await this.parseValue(e);return n=await Promise.all(K.resolveValues(K.extractValues(String(n)," ")).map(r=>this.parseValue(r,!0))),n=n.map(r=>Z(r)),n=n.join(""),c(this,we).call(this,null,{message:is(n)?n:`"${n}"`})}}commandEnd(){return Promise.resolve()}async commandPause(e){const n=await this.parseValue(e);return new Promise(r=>window.setTimeout(()=>{r()},n))}commandRead(e){const n=e.split(",");return Promise.all(n.map(r=>{const s=c(this,Ft).shift();return this.setReadStack(r,s),Promise.resolve()}))}commandCall(e,n){const s=e.match(/([^(]+)\(.*\)/)[1];if(c(this,re).hasSub(s))return this.parseLine(e,n);throw new Error(`SUB ${s} NOT FOUND`)}async commandExecute(e,n){if(!c(this,we))throw new Error("No callback available for readfile");console.log("READFILE",e,n);let r;switch(e){case"FILE":try{r=await c(this,we).call(this,`READFILE ${n}`,{show:!1})}catch(s){throw new Error(s)}if(console.log("READFILE",r),r!==void 0)try{return c(this,we).call(this,r.value,{show:!0})}catch(s){throw new Error(s)}else throw new Error("File Content is empty");case"EVAL":try{return this.parseValue(n,{show:!0})}catch(s){throw new Error(s)}}}},Ft=new WeakMap,$r=new WeakMap,re=new WeakMap,we=new WeakMap,Ye=new WeakMap,Wr=new WeakMap,Fr=new WeakMap,xe=new WeakMap,zr=new WeakMap,zt=new WeakMap,Xe=new WeakMap,ge=new WeakMap,bt=new WeakMap,se=new WeakMap,ie=new WeakMap,Pa);function Xh(t,e,n){switch(e.match(/^([<>][=]|[<>])$/)[1]){case"<":return parseFloat(t)<parseFloat(n);case">":return parseFloat(t)>parseFloat(n);case"<=":return parseFloat(t)<=parseFloat(n);case">=":return parseFloat(t)>=parseFloat(n);default:return null}}function is(t){return!isNaN(parseFloat(t))&&isFinite(t)}var wn,Ts,Rs,xn;class qh{constructor(e,n){g(this,wn,new Map);g(this,Ts,new Map);g(this,Rs,[]);g(this,xn,void 0);A(this,xn,n),A(this,wn,e)}get callback(){return c(this,xn)}get memory(){return c(this,wn)}async parse(e,n,r){if(e.length===0)return;e.length>1&&await this.readData(e);const s=[];return new Yh(e,async(a,o)=>{o=Object.assign({},o,r);const l=await(n||c(this,xn))(a,o);return o.show&&typeof l=="string"&&l!=="undefined"&&s.push(l),l},c(this,wn),c(this,Rs),c(this,Ts)).parse().then(()=>s)}readData(e){let n=e.find(r=>/^[ ]*DATA[ +]/.test(r));return n?(n=e.splice(e.indexOf(n),1),this.parse(n)):Promise.resolve()}}wn=new WeakMap,Ts=new WeakMap,Rs=new WeakMap,xn=new WeakMap;function Ae(...t){if(t.includes(void 0))throw new Error("invalid arguments")}let pi,gi,_i,bi,yi,wi,xi,zo;try{pi=/([^\w$%]?)\(([^\\(\\)]+)\)/,gi=/^\((.*)\)$/,_i=new RegExp("[^\\d$\\-\\w]?(?<a>([+-]?[\\w.]+e\\+\\d+)|([+-]?[\\w$%.]+)|(^[+-]?[\\w$%.]+)|([\\w$%.]+)|([$]{3}\\d+))[ ]*(?<operator>[\\^*%\\/]|MOD|XOR|AND|OR|<<|>>|>>>)[ ]*(?<b>([-]?[\\w.]+e\\+\\d+)|([-]?[\\w$%.]+)|(^[+-]?[\\w$%.]+)|([\\w$%.]+)|([$]{3}\\d+))"),bi=/([+-]?[\w.]+e\+\d+|[+-]?[\w$%.]+|[$]{3}\d+)[ ]*([+-])[ ]*([+-]?[\w.]+e\+\d+|[+-]?[\w$%.]+|[$]{3}\d+)/,yi=/([\w]+[a-zA-Z0-9_.]+[$%]?)[ ]*\(([^\\(\\)]*)\)/,wi=/^([\w]+[a-zA-Z0-9_.]+[$%]?)[ ]*\(([^\\(\\)]*)\)/,xi=/^([\w]+[a-zA-Z0-9_.]?[$%]?)/,zo=/^([+-]?[\d.]+e\+\d+|[+-]?[\d.])+($|$)/}catch{}var te;class Kh{constructor(e){g(this,te,void 0);this.createMemory(e)}createMemory(e){A(this,te,e||new Gi),c(this,te).addSub("RND",()=>Promise.resolve(Math.random())),c(this,te).addSub("PI",()=>Promise.resolve(Math.PI)),c(this,te).addSub("POW",(n,r)=>(Ae(n,r),Promise.resolve(n**(r||2)))),c(this,te).addSub("SQRT",(n,r)=>(Ae(n,r),Promise.resolve(Math.sqrt(n,r||2)))),c(this,te).addSub("INT",n=>(Ae(n),this.parse(Z(n)).then(r=>parseInt(r)))),c(this,te).addSub("SPC",n=>(Ae(n),Promise.resolve(`"${va(n)}"`))),c(this,te).addSub("LEN",n=>(Ae(n),Promise.resolve(Z(String(n)).length))),c(this,te).addSub("ASC",n=>(Ae(n),Promise.resolve(Z(n).charCodeAt(0)))),c(this,te).addSub("CHR$",n=>(Ae(n),Promise.resolve(String.fromCharCode(n)))),c(this,te).addSub("LEFT$",(n,r)=>(Ae(n,r),Promise.resolve(`"${Wo(Z(n),parseInt(r))}"`))),c(this,te).addSub("RIGHT$",(n,r)=>(Ae(n,r),Promise.resolve(`"${zh(Z(n),parseInt(r))}"`))),c(this,te).addSub("STRING$",(n,r)=>(Ae(n,r),Promise.resolve(`"${va(Z(n),Z(r))}"`))),c(this,te).addSub("TIME%",()=>Promise.resolve(Date.now())),c(this,te).addSub("HEX_ENC$",n=>(Ae(n),n=Number(Z(n)).toString(16),Promise.resolve(n))),c(this,te).addSub("HEX_DEC$",n=>(Ae(n),n=parseInt(Z(n),16),Promise.resolve(n)))}parse(e){return new Qh(this).parse(e)}validInput(e){return/[/*\-+^()]?/.test(e)}get memory(){return c(this,te)}}te=new WeakMap;const Zh=5e3;var de,qe,Br;class Qh{constructor(e){g(this,de,void 0);g(this,qe,[]);g(this,Br,0);A(this,de,e)}get parser(){return c(this,de)}get parsedValues(){return c(this,qe)}async parse(e){if(c(this,Br)>Zh)throw new Error(`Can't parse ${e}`);Ie(this,Br)._++;const{result:n,values:r}=K.extractStrings(String(e));let s=ft.parse(n);A(this,qe,c(this,qe).concat(r)),s=s.map(o=>/^MOD|XOR|AND|OR$/.test(o)?` ${o} `:o);let i=s.join("");Zn(i)&&(i=Number(i));const a=i;return i=await this.action(i),i!==a&&!/^".*"$/.test(i)?this.parse(i):this.$v(i)}async action(e){if(gi.test(e)){const[n,r]=e.match(gi);e=e.replace(n,r)}if(yi.test(e)){const[n,r,s,i]=e.match(yi),a=r||i;let o=ft.parse(s||"");const l=s.includes(",")&&o.join("")!==s;if(l&&(o=s.split(",")),o=await Promise.all(o.map(u=>this.parse(u))),o=l?o:[await this.parse(o.join(""))],c(this,de).memory.has(a))return e.replace(n,c(this,de).memory.get(a)[Number(o[0])-1]);if(c(this,de).memory.hasSub(a))return e.replace(n,this.cacheValue(await c(this,de).memory.executeSub(a,o)))}if(pi.test(e)){const[n,r,s]=e.match(pi);return e.replace(n,r+await this.parse(s))}return _i.test(e)?this.operation(e,_i):bi.test(e)?this.operation(e,bi):this.$v(e)}async operation(e,n){const r=e.match(n);let s,i,a;const o=r[0];"groups"in r&&r.groups?(s=r.groups.a,i=r.groups.b,a=r.groups.operator):(s=r[1],a=r[2],i=r[3]);let l=e,u=await this.parse(s);Zn(u)||(u=Z(u));let d=await this.parse(i);switch(Zn(d)||(d=Z(d)),a){case"+":l=u+d;break;case"-":l=u-d;break;case"*":l=u*d;break;case"/":l=u/d;break;case">":l=u>d;break;case"<":l=u<d;break;case"^":l=u^d;break;case"%":l=u%d;break;case"MOD":l=u%d;break;case"AND":l=u&d;break;case"OR":l=u|d;break;case"XOR":l=u^d;break;case"<<":l=u<<d;break;case">>":l=u>>d;break;case">>>":l=u>>>d;break}return Zn(l)||(l=`"${l}"`),e.replace(o,o.replace(RegExp(`[${s}]{${String(s).length}}[ ]*[${a}]{${String(a).length}}[ ]*[${i}]{${String(i).length}}`),"")+this.cacheValue(l))}$v(e){if(K.valueUnresolved(e))return e=K.resolveValue(e,c(this,qe)),Promise.resolve(e);if(typeof e=="string"&&(e=e.replace(/^[ ]*([^ ].*[^ ])[ ]*$/,"$1")),zo.test(e))return Promise.resolve(Number(e));if(wi.test(String(e))){const[,n,r]=e.match(wi);if(c(this,de).memory.hasSub(n))return c(this,de).memory.executeSub(n,K.resolveValues(K.extractValues(r,",")));throw new Error(`can't find sub "${n}" in memory`)}else if(xi.test(String(e))){const n=e.replace(xi,"$1");if(c(this,de).memory.hasSub(n))return c(this,de).memory.executeSub(n);if(c(this,de).memory.has(n))return Promise.resolve(c(this,de).memory.get(n))}return Promise.resolve(e)}cacheValue(e){return c(this,qe).push(e),K.resolveKey(c(this,qe).length-1)}}de=new WeakMap,qe=new WeakMap,Br=new WeakMap;const Jh=["CLS","READ max","DIM fib%(max)","LET fib(1) = 1","LET fib(2) = 2","FOR i=3 TO max","LET fib(i) = fib(i - 2) + fib(i -1)","NEXT i","FOR i=1 TO max","PRINT fib(i)","NEXT i","DATA 10","END"],em=["CLS","DIM w%,h%,a%","LET w%=12","LET h%=4","LET a%=w%*h%",'PRINT "With the width " + w%','PRINT " and the height " + h%','PRINT " you have the area " + a%'],tm=["CLS","DIM r,a","LET r=5","READ pi","LET a=r*r*pi",'PRINT USING "With the radius ##.##"; r','PRINT USING "we have the area ##.##"; a',"DATA 3.14","END"],nm=["GuessTheNumber","CLS","READ max%","DIM number%, guess%, guesses%",'PRINT "The number is between 1-1000."',"LET number% = INT(RND * max%) + 1","LET guess% = 1","LET guesses% = 0","WHILE guess%<>number%",'PRINT "Guess the number"',"INPUT guess%","IF (guess%<>number%) THEN","IF (guess%>number%) THEN",'PRINT "Your guess was too high"',"ELSE",'PRINT "Your guess was too low"',"ENDIF","ENDIF","LET guesses% = guesses% + 1","WEND",'PRINT USING "You found the number in # tries"; guesses%',"DATA 1000","END"],rm=["DIM result",'PRINT "Calculate the factorial of"',"INPUT n","LET result = 1","FOR i = n TO 1 STEP -1","LET result = result * i","NEXT i",'PRINT USING "#! = #"; n, result',"END"],sm=["CLS","DIM stars$",'PRINT "Enter the height of the pyramid"',"INPUT height",'LET stars$ = ""',"FOR i = 1 TO height",'LET stars$ = ""',"FOR j = 1 TO (i+i-1)",'LET stars$ = stars$ + "*"',"NEXT j","PRINT SPC(height - i) + stars","NEXT i","END"],im=['PRINT "Step 1"','PRINT "Step 2"','PRINT "Step 3"',"GOTO ignore",'PRINT "Step 4"',"ignore:",'PRINT "Step 5"'],am=["DIM A, B","LET A = 2000",'LET B = "Hello World"','PRINT USING "A: #"; A','PRINT USING "B: #"; B'],om=["DIM A, B","LET A = 1","LET B = 2","IF A == B THEN",'PRINT "true"',"ELSE",'PRINT "false"',"END","IF (A < B) THEN",'PRINT "true"',"END"],lm=["DIM i%","FOR i% = 1 TO 5",'PRINT USING "For Number #"; i%',"NEXT i%"],cm=["DIM i%","LET i%=0","WHILE i% < 5",'PRINT USING "While Number #"; i%',"LET i% = i% + 1","WEND"],um=["DIM duration","LET duration = 2500",'PRINT USING "Start with Pause #ms"; duration',"PAUSE duration",'PRINT "End Pause"','PRINT USING "Start with Sleep #ms"; duration',"PAUSE duration",'PRINT "End Sleep"'],dm={Fibonacci:Jh,Area:em,Circle:tm,"Your Name":["CLS",'PRINT "What is your name?"',"INPUT n$",'PRINT "What is your shoe size?"',"INPUT size",'PRINT "Hello "; n$','PRINT USING "your shoe size is ##.##"; size',"END"],GuessTheNumber:nm,Factorial:rm,Pyramid:sm,"Bubble Sort":["CLS","READ max","DIM SHARED numbers(max)","SUB CreateList(max) STATIC","FOR i=1 TO max","LET numbers(i) = INT(RND * 100)","NEXT i","END SUB","SUB PrintList(max) STATIC","FOR i=1 TO max","PRINT numbers(i)","NEXT i","END SUB","SUB SwapValues(i%, j%) STATIC","LET numbers(i%) = numbers(i%) XOR numbers(j%)","LET numbers(j%) = numbers(i%) XOR numbers(j%)","LET numbers(i%) = numbers(i%) XOR numbers(j%)","END SUB","SUB Sort(max) STATIC","FOR i%=1 TO (max - 1)","FOR j%=i% TO max","IF numbers(i%)>numbers(j%) THEN","CALL SwapValues(i%, j%)","END IF","NEXT j%","NEXT i%","END SUB","CreateList(max)","Sort(max)","PrintList(max)","DATA 10","END"],Goto:im,Vars:am,If:om,For:lm,"For Step":["CLS","FOR i% = 0 TO 6 STEP 2",'PRINT "For Step Number #"; i%',"NEXT i%"],While:cm,Pause:um},hm=({module:t,core:e})=>{const{fileSystem:n}=e.modules.files;return[{name:["basic"],args:[new x({index:0,name:"path",description:"Path to basic script"})],async action({path:r},s){if(!r)throw P.get("bad_args");const i=await n.get(r);if("type"in i.data&&i.data.type==="basic"&&Array.isArray(i.data.content))return t.parseBasic(i.data.content,null,{logger:s.logger});throw new TypeError(`Can't read file ${r}`)}},{name:["basicExamples"],args:[new x({index:0,name:"name",description:"Name from example"})],action({name:r}){return t.parseBasic(dm[String(r)])}}]};var vn,En,Sn,Ds;class Bo extends Ws{constructor({core:n}){super({commands:(...r)=>[...hm(...r)],core:n});g(this,vn,void 0);g(this,En,new Gi);g(this,Sn,new Kh(c(this,En)));g(this,Ds,new K(c(this,Sn)));A(this,vn,new qh(c(this,En),n.executeCommand.bind(n)))}get memory(){return c(this,En)}parse(...n){return c(this,vn).parse(...n)}parseBasic(...n){return c(this,vn).parse(...n)}parseCommand(...n){return c(this,Ds).parse(...n)}parseMath(...n){return c(this,Sn).parse(...n)}isMathValue(...n){return c(this,Sn).validInput(...n)}}vn=new WeakMap,En=new WeakMap,Sn=new WeakMap,Ds=new WeakMap,p(Bo,"NAME","Parser");var he,Bt;const Cs=class extends me{constructor(n){n=Object.assign({},n);super(n);g(this,he,new Map);g(this,Bt,fu(1));this.addItems(n.items||c(this,he)),A(this,Bt,n.maxSize||c(this,Bt))}async export(...n){const r=await me.prototype.export.apply(this,...n);return delete r.data,r.items=await Promise.all(Array.from(c(this,he).values()).map(s=>s.export())),r}async addItems(n,r=!1){return n instanceof Map&&(n=Array.from(n.values())),n=await Promise.all(n.map(async s=>(typeof s.data=="string"&&(s.data=await ui(s.data)),s))),n=this.parseItems(n),Promise.all(n.map(s=>this.addItem(s,r)))}static normalizeItemData(n){return"info"in n&&(n.meta=[n.info],delete n.info),"items"in n&&(n.items instanceof Map||(n.items=new Map(n.items.map(r=>[r.id,r])))),"extension"in n&&(n.id+="."+n.extension,delete n.extension),"createTime"in n&&(n.createdDate=n.createTime,delete n.createTime),"editTime"in n&&(n.editedDate=n.editTime,delete n.editTime),"icon"in n&&delete n.icon,n}parseItems(n){return n.map(r=>{r=Cs.normalizeItemData(r);let s;return r.type?s=Ks(r.type):r.items?s=Ks("Directory"):s=Ks(),new s(r)})}async addItem(n,r=!1){const s=n.parent;if(!r&&this.hasItem(n.id))throw new Error(`File ${n.id} exists`);if(s&&await s.removeItem(n),r){const i=dr(n.id),a=zi(n.id);n.setId(bs(Io(a,this,i),i))}return c(this,he).set(n.id,n),n.setParent(this),n.events.next(new G("move",{item:n,lastParent:s})),this.events.next(new G("addItem",n)),n}removeItem(n){return n.setParent(null),c(this,he).delete(n.id),this.events.next(new G("removeItem",n)),Promise.resolve()}async remove(n){const{recursive:r}=Object.assign({recursive:!1},n);if(r){let s=await this.getItems();return s=await Promise.all(Array.from(s.values()).map(i=>i.remove(n))),s=s.reduce((i,a)=>i.concat(a),[]),s.push(await me.prototype.remove.apply(this,[n])),s}else{if((await this.getItems()).size>0)throw new Error(P.get("FileSystemItem_itemContainerNotEmpty",await this.getPath()));return[await me.prototype.remove.apply(this,arguments)]}}changeItemId(n,r,s){c(this,he).delete(r),c(this,he).set(s,n),this.parent&&console.log("changeItemId by parent",r,s,c(this.parent,he))}getItems(){return Promise.resolve(c(this,he))}getItem(n){return c(this,he).get(n)}hasItem(n){return c(this,he).has(n)}get items(){return c(this,he)}get size(){return Array.from(c(this,he).values()).reduce(function(n,r){return r instanceof Cs||(n+=r.size),n},0)}get maxSize(){return n(this);function n(r){return r.parent&&c(r,Bt)?n(r.parent):c(r,Bt)}}};let H=Cs;he=new WeakMap,Bt=new WeakMap;P.add([["FileSystemItem_itemContainerNotEmpty",["ItemWrapp Not Empty","ItemContainer not empty %1"]]]);class Hi extends H{constructor(e){e=Object.assign({},e,{locked:!0,id:"ROOT"}),super(e)}}p(Hi,"NAME","Root");var Js,Ke;let ot=(Js=class extends H{constructor(n){n=Object.assign({storage:null},n,{locked:!0});super(n);g(this,Ke,void 0);A(this,Ke,n.storage)}get storage(){return c(this,Ke)}get locked(){return c(this,Ke).locked}mount(...n){return c(this,Ke).mount(...n)}unmount(...n){return c(this,Ke).unmount(...n)}async save(){return c(this,Ke).save(await this.export())}},Ke=new WeakMap,p(Js,"NAME","Storage"),Js);class ws extends ot{constructor(...e){super(...e),this.meta.set(b.VISIBLE,!1)}}p(ws,"NAME","TmpDisk"),p(ws,"SYMBOL",w.TMP_DISK);class xs extends ot{}p(xs,"NAME","RamDisk"),p(xs,"SYMBOL",w.RAM_DISK);class Yi extends H{}p(Yi,"NAME","FloppyDisk");class vs extends ot{}p(vs,"NAME","HardDisk"),p(vs,"SYMBOL",w.HARD_DISK);class Es extends ot{isLogged(){return this.storage.storage.isLogged()}}p(Es,"NAME","CloudDisk"),p(Es,"SYMBOL",w.CLOUD_DISK);class It extends H{constructor(...e){super(...e),[b.WINDOW_SCALE,b.WINDOW_SCROLL_X,b.WINDOW_SCROLL_Y].forEach(n=>{this.meta.has(n,!0)||this.meta.set(n,!0)})}}p(It,"NAME","Directory"),p(It,"SYMBOL",w.DIRECTORY);class Re extends H{}p(Re,"NAME","Trashcan"),p(Re,"SYMBOL",w.TRASHCAN);class Jr extends me{}p(Jr,"NAME","File");var In;class Xi extends me{constructor(n){n=Object.assign({refPath:null},n);super(n);g(this,In,void 0);A(this,In,n.refPath)}get refPath(){return c(this,In)}set refPath(n){A(this,In,n)}}In=new WeakMap,p(Xi,"NAME","Link");var Vr,Be,ve,Ur,An;const Te=class{constructor(e){g(this,Vr,void 0);g(this,Be,void 0);g(this,ve,void 0);g(this,Ur,new Map);g(this,An,new Me);A(this,Vr,e),this.setup()}get root(){return c(this,Be)}setup(){A(this,Be,new Hi),A(this,ve,c(this,Be));const e=[this.addStorage(Te.RAM_DISK_TITLE,ce.SESSION,{id:Te.RAM_DISK_NAME}),this.addStorage(Te.HARD_DISK_NAME,ce.LOCAL,{trashcan:!0}),this.addStorage(Te.TMP_DISK_TITLE,ce.TEMP,{id:Te.TMP_DISK_NAME,trashcan:!1})];return Promise.all(e).catch(n=>{throw n})}createTmpFile(e,n,r,s){return this.createRootFile(`TMP:${e}`,n,r,s)}createRootDir(e,n,r){const s=`${e}`;return this.makedir(s,n,Object.assign({},r,{override:!0}))}createRootFile(e,n,r,s){typeof n=="object"&&(r=n,n=null);const i=`${e}`;return this.makefile(i,n,r,Object.assign({},s,{override:!0}))}async get(e,n){if(e instanceof me)return e;if(cs(e))try{return await this.parsePath(e)}catch(r){if(n)return new me({name:Oe(e)});throw r}else throw P.get("FileSystem_pathInvalid",Oe(e),Vn(e))}async parsePath(e){let n=e,r=c(this,ve);const s=e.match(/^([^:\\/]+):(.*)$/);if(s?(r=c(this,Be).getItem(s[1]),n=s[2]):n[0]==="/"?(n=n.slice(1),r=c(this,ve).getStorageItem()):n==="ROOT"&&(r=c(this,Be),n=""),n&&n.length>0&&(r=vi(n.split("/"),r)),r)return r;throw P.get("FileSystem_pathInvalid",e,await c(this,ve).getBase())}async addFloppyDisk(e){typeof e=="function"&&(e=e());const n=await e;return this.addStorage(n)}async removeFloppyDisk(e){await e.remove(!0)}async addStorage(e,n=ce.NONE,r){r=Object.assign({id:null},r);let s;typeof n=="function"&&(s=n,n=ce.CLOUD);const i={id:this.getFreeSlot(Te.PREFIX.FLOPPY_DISK),itemClass:Yi};let a={};if(typeof e=="object"){const o=e;i.name=o.name,i.items=o.items,i.meta=Array.from(new Map([[b.SYMBOL,w.DISK_1]].concat(o.meta||[])))}else{switch(n){case ce.SESSION:i.id=Te.PREFIX.RAM,i.itemClass=xs;break;case ce.TEMP:i.id=Te.PREFIX.TMP,i.itemClass=ws;break;case ce.LOCAL:i.id=this.getFreeSlot(Te.PREFIX.HARD_DISK),i.itemClass=vs;break;case ce.CLOUD:i.id=this.getFreeSlot(Te.PREFIX.CLOUD_DISK),i.itemClass=Es;break}i.id=r.id||i.id,s=await this.registerStorage(i.id,s||n).mount(r);const o=await s.load();a=H.normalizeItemData(o),i.storage=s,ce.NONE!==n&&(i.name=a.name||e)}return(i.meta=i.meta||[]).push(...a.meta||[]),this.addDisk(Object.assign(a,i),r)}removeStorage(e){return e.unmount().then(()=>(c(this,An).next(new G("removeStorage",{itemStorage:e})),e))}registerStorage(e,n){let r;typeof n=="function"?r=n:r=Mo(n);const s=`${c(this,Vr)}_${e}`,i=new r({id:e,name:s});return c(this,Ur).set(s,i),i}connect(e,n){return this.addStorage(cu,e,n).then(r=>r).catch(r=>{throw r})}async disconnect(e){return e=await this.removeStorage(e),e.remove({silent:!0,recursive:!0}),e}addDisk({id:e,name:n,meta:r,items:s,itemClass:i,storage:a},o){o=Object.assign({trashcan:!1},o),o.trashcan&&(!s||s&&!s.has(Re.NAME))&&(s=s||new Map,s.set(Re.NAME,{type:Re.NAME,id:Re.NAME,name:Re.NAME}));const l=i;if(!l)throw new Error("ItemClass is empty!");const u=new l({id:e,name:n,meta:r,items:s,storage:a});return c(this,Be).addItem(u),c(this,An).next(new G("addDisk",{id:e,item:u})),u}get currentItem(){return c(this,ve)}get events(){return c(this,An)}get storages(){return c(this,Ur)}getFreeSlot(e){let n=0;for(;c(this,Be).hasItem(`${e}${n}`);)n++;return`${e}${n}`}async exist(e){try{return!!await this.get(e)}catch{return!1}}async changeDirectory(e){const n=await this.get(e);return A(this,ve,n),this.events.next(new G("changeDirectory",n)),n}async makedir(e,n,r){const{ignore:s,meta:i}=Object.assign({ignore:!1,override:!1,meta:[]},r);let a;e&&mu(e)&&e!==n?a=await this.get(Vn(e)):a=c(this,ve);const o=new It({id:Oe(e),name:n||"",createdDate:Date.now(),meta:i});if(await je(a),s||!a.getItem(o.id))a.addItem(o,s),this.events.next(new G("writeItem",o));else throw P.get("FileSystem_fileExist",o.id);return await _e(a),o}async makefile(e,n,r,s){const{override:i,meta:a}=Object.assign({override:!1,meta:[]},s),o=new Jr({id:Oe(e),name:n,data:r,meta:a,createdDate:Date.now()});if(!cs(e))throw P.get("FileSystem_invalidPath",e);let l=du(e);const u=hu(e);l===u&&(l=".");let d;if(uu(l)?d=await this.get(l):c(this,ve).id!=="ROOT"?d=await this.get(Fi(await c(this,ve).getPath(),l)):d=await this.get(l),d.hasItem(u))if(i)await d.getItem(u).remove(),d.addItem(o);else throw P.get("FileSystem_fileExist",o.id);else d.addItem(o),this.events.next(new G("writeItem",o));return await _e(d),o}async editfile(e,n){const r=await this.get(e).then(je);return await je(r),r.data=n,_e(r)}async editfileMeta(e,n,r){const s=await this.get(e);return Array.isArray(n)?n.map(i=>({name:i[0],value:i[1]})):s.meta.set(n,r),_e(s)}async saveItem(e){const n=await this.get(e);return _e(n)}async makelink(e,n=null){const r=await this.get(e);await je(r);const s=c(this,ve),i=new Xi({id:zi(r.id)+".ref",name:`${n||r.name}`,refPath:await r.getPath(),createdDate:Date.now()});return await s.addItem(i),await _e(r),i}async editlink(e,n){const r=await this.get(e);await je(r);const s=await this.get(n);return r.refPath=await s.getPath(),_e(r)}async rename(e,n,{name:r=!1,removeName:s=!1}){let i;if(e instanceof me)i=e;else if(cs(e)||typeof e=="string")i=await this.get(e);else throw P.get("FileSystem_pathInvalid",Vn(e),e);return await je(i),s&&(r=!0,n=null),await i.rename(n,{ignore:!0,name:r}),_e(i)}async copy(e,n,r){const{ignore:s}=Object.assign({ignore:!1},r);let i,a,o;if(e instanceof me?(a=e,i=e.id):(a=await this.get(e),i=Oe(e)),n instanceof me)n instanceof H||(n=n.parent),o=n;else{i=Oe(n);const u=await this.get(n,!0);if(u instanceof H?i=Oe(e):u.parent?o=u.parent:o=await this.get(Vn(n)),!(o instanceof H))throw new TypeError("no ItemContainer")}await je(a);const l=await a.copy();if(s||!o.getItem(i))l.rename(i),o.addItem(l,s),this.events.next(new G("copyItem",l));else throw P.get("FileSystem_fileExist",i);return _e(l)}async move(e,n,{override:r=!1}){let s,i,a;if(e instanceof me)i=e,s=e.id;else{if(i=await this.get(e),i instanceof ot)throw P.get("FileSystem_cantMoveStorage",i.displayName);s=Oe(e)}if(n instanceof me)n instanceof H||(n=n.parent),a=n;else{if(s=Oe(n),a=await this.get(n),a instanceof H)s=Oe(e);else return this.get(Vn(n));if(!(a instanceof H))throw new TypeError("no ItemContainer")}let o;if(await je(i),r||!await a.getItem(s))o=i.getStorageItem(),await i.rename(s),await a.addItem(i,r),this.events.next(new G("moveItem",i));else throw P.get("FileSystem_fileExist",i.id,s);return await _e(i),o?o.save().then(()=>i):i}async remove(e,n,r){const{ignore:s}=Object.assign({ignore:!1},r),i=await this.get(e);await je(i);try{const a=await pu(n,i);return a[a.length-1].storage&&await a[a.length-1].storage.save(),a}catch(a){if(!s)throw new Error(a)}}};let Ge=Te;Vr=new WeakMap,Be=new WeakMap,ve=new WeakMap,Ur=new WeakMap,An=new WeakMap,p(Ge,"PREFIX",{FLOPPY_DISK:"DF",TMP:"TMP",RAM:"RAM",HARD_DISK:"HD",CLOUD_DISK:"CD"}),p(Ge,"TMP_DISK_NAME","TMP"),p(Ge,"TMP_DISK_TITLE","TMP DISK"),p(Ge,"RAM_DISK_NAME","RAM"),p(Ge,"RAM_DISK_TITLE","RAM DISK"),p(Ge,"HARD_DISK_NAME","HARD DISK");function vi(t,e){const n=t.shift();if(n===void 0)return e;if(n===".."){if(e.parent)return e.parent}else if(n==="."||n==="")return vi(t,e);if(e){const r=e.getItem(n);return t.length>0&&r instanceof H?vi(t,r):r}}const mm=[It,Re,ot,ws,xs,vs,Yi,Es,Xi,Jr].reduce((t,e)=>(t[e.NAME]=e,t),{});function Ks(t){return mm[String(t)]||Jr}P.add([["FileSystem_invalidPath",["Invalid File",'Invalid path "%1"']],["FileSystem_invalidFile",["Invalid File",'Invalid file "%1"']],["FileSystem_fileExist",["File Ready",'File already exists "%1"']],["FileSystem_pathInvalid",["Path Invalid",'Path invalid "%1"; base: "%2"']],["FileSystem_itemInvalid",["Item Invalid",'Item id invalid "%1" from "%2"']],["FileSystem_cantMoveStorage",["Can't Move",`Can't move Storage "%1"`]],["FileSystem_permissionsNeeded",["Permissions needed","Permissions needed"]]]);const Zs={WEB_BASIC_SHOW_PREVIEW:"extras13_web_basic_show_preview",WEB_PAINTING_DISPLAY_BACKGROUND:"extras13_web_painting_display_background",WEB_PAINTING_DISPLAY_FOREGROUND:"extras13_web_painting_display_foreground"},Qp={[Zs.WEB_BASIC_SHOW_PREVIEW]:!0,[Zs.WEB_PAINTING_DISPLAY_BACKGROUND]:"#CCCCCC",[Zs.WEB_PAINTING_DISPLAY_FOREGROUND]:"#FFFFFF"},us={HAS_WINDOW_OUTPUT:"has_window_output",CONTENT:"content",OUTPUT_TYPE:"type"};function Jp(){return{[us.HAS_WINDOW_OUTPUT]:!1,[us.CONTENT]:"",[us.OUTPUT_TYPE]:"basic"}}const fm={props:{label:{type:String,default:"Item Label"},model:{type:Object,default(){return{value:null}}},name:{type:String,default:null},value:{type:[String,Number],default:null},multiple:{type:Boolean,default:!1},readonly:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1}},computed:{currentModel:{get(){return this.name?this.model[this.name]:this.model.value},set(t){this.name?this.model[this.name]=t:this.model.value=t}},input(){return{name:this.name,readonly:this.readonly,disabled:this.disabled,type:this.multiple?"checkbox":"radio"}}}},pm={class:"wb-env-atom-form-field-item-select-item"},gm=["value"],_m=["innerHTML"];function bm(t,e,n,r,s,i){return y(),C("label",pm,[Kt(S("input",V({"onUpdate:modelValue":e[0]||(e[0]=a=>i.currentModel=a)},i.input,{value:n.value}),null,16,gm),[[ki,i.currentModel]]),S("span",{class:"label",innerHTML:n.label||""},null,8,_m)])}const ym=j(fm,[["render",bm],["__scopeId","data-v-6f76d05d"]]);const wm={components:{WbEnvAtomFormFieldFieldItemSelectItem:ym},props:{title:{type:String,default:"Item Select Title"},multiple:{type:Boolean,default:!1},name:{type:String,default:"value"},readonly:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},model:{type:Object,default(){return{value:{}}}},items:{type:Array,required:!1,default(){return[{label:"Item 1",value:"item-1"},{label:"Item 2",value:"item-2"}]}}}},xm={class:"wb-env-atom-form-field-item-select"},vm={key:0,class:"title"};function Em(t,e,n,r,s,i){const a=R("wb-env-atom-form-field-field-item-select-item");return y(),C("div",xm,[n.title?(y(),C("div",vm,Ce(n.title),1)):B("",!0),S("ul",null,[(y(!0),C(Et,null,St(n.items,(o,l)=>(y(),C("li",{key:l},[N(a,V(o,{name:o.name||n.name,model:n.model,multiple:n.multiple,readonly:o.readonly||n.readonly,disabled:o.disabled||n.disabled}),null,16,["name","model","multiple","readonly","disabled"])]))),128))])])}const Sm=j(wm,[["render",Em],["__scopeId","data-v-c017a51c"]]);const Im={components:{WbButton:kt,WbButtonWrapper:Tt,WbItemSelect:Sm},props:{fileSystem:{type:Object,default(){return null}},fsItem:{type:Object,default(){return null}},name:{type:String,default(){return"fsItem"}},model:{type:Object,default(){return{fsItem:null}}},backLabel:{type:String,default(){return"../"}},upLabel:{type:String,default(){return"Up"}},downLabel:{type:String,default(){return"Down"}},maxVisibleItems:{type:Number,default(){return 5}}},emits:["select","refresh"],data(){return{currentFsItem:this.fsItem||z(this.fileSystem.root),fsItems:[],currentIndex:0}},computed:{disableds(){return{back:!this.currentFsItem.parent,up:this.currentIndex-1<0,down:this.currentIndex+1>this.fsItems.length-this.maxVisibleItems}},currentPath(){return this.model[this.name]},items(){const t=this.fsItems.slice(this.currentIndex,this.currentIndex+this.maxVisibleItems).map(e=>({label:e.id,value:e.getPath()})).concat(Array(Math.max(this.maxVisibleItems-this.fsItems.length,0)).fill({label:"&nbsp;",disabled:!0}));return this.fsItems.length<1&&(t[Math.floor(t.length/2)]={label:"Empty",disabled:!0}),t}},watch:{async currentPath(){this.currentFsItem=z(await this.fileSystem.get(this.model[this.name])),this.currentFsItem instanceof H&&(this.fsItems=Array.from((await this.currentFsItem.getItems()).values()).map(z),this.currentIndex=0),this.$emit("select",this.currentFsItem)}},async mounted(){this.fsItems=Array.from((await this.currentFsItem.getItems()).values()).map(z),this.$nextTick(()=>{this.$emit("refresh",{reset:!0,resize:!1,scroll:!1})})},methods:{onClicBack(){this.currentFsItem instanceof H?this.model[this.name]=this.currentFsItem.parent.getPath():this.model[this.name]=this.currentFsItem.parent.parent.getPath()},onClickUp(){this.currentIndex=Math.max(this.currentIndex-1,0)},onClickDown(){this.currentIndex=Math.min(this.currentIndex+1,this.fsItems.length-this.maxVisibleItems)}}},Am={class:"wb-module-files-atoms-file-select"};function Om(t,e,n,r,s,i){const a=R("wb-item-select"),o=R("wb-button"),l=R("wb-button-wrapper");return y(),C("div",Am,[S("div",null,[N(a,{title:null,items:i.items,name:n.name,model:n.model},null,8,["items","name","model"])]),S("div",null,[N(l,{align:"outer",full:"",direction:"vertical"},{default:Y(()=>[N(o,{"style-type":"secondary",label:n.backLabel,disabled:i.disableds.back,onClick:i.onClicBack},null,8,["label","disabled","onClick"]),N(o,{"style-type":"secondary",label:n.upLabel,disabled:i.disableds.up,onClick:i.onClickUp},null,8,["label","disabled","onClick"]),n.downLabel?(y(),U(o,{key:0,"style-type":"secondary",label:n.downLabel,disabled:i.disableds.down,onClick:i.onClickDown},null,8,["label","disabled","onClick"])):B("",!0)]),_:1})])])}const Vo=j(Im,[["render",Om],["__scopeId","data-v-78b3680c"]]);const km={components:{WbEnvAtomFormField:Wn},props:{model:{type:[Array,Object],default(){return{}}},type:{type:String,default:"text"},id:{type:String,default:null},name:{type:String,default:null},placeholder:{type:String,default:"Placeholder"},pattern:{type:String,default:null},readonly:{type:Boolean,default:!1},min:{type:Number,default:null},max:{type:Number,default:null},disabled:{type:Boolean,default:!1},autocomplete:{type:Boolean,default:!1}},computed:{currentModel:{get(){return this.name?this.model[this.name]:this.model.value},set(t){this.name?this.model[this.name]=t:this.model.value=t}},styleClasses(){return{["type-"+this.type]:!0}},input(){return{name:this.name,type:this.type,placeholder:this.placeholder,pattern:this.pattern,min:this.min,max:this.max,readonly:this.readonly,disabled:this.disabled,autocomplete:this.autocomplete?"on":"off"}}}};function Tm(t,e,n,r,s,i){const a=R("wb-env-atom-form-field");return y(),U(a,V({tag:"div",class:"wb-env-atom-form-textbox"},t.$attrs,{class:i.styleClasses}),{default:Y(()=>[Kt(S("input",V({ref:"input","onUpdate:modelValue":e[0]||(e[0]=o=>i.currentModel=o)},i.input),null,16),[[ki,i.currentModel]])]),_:1},16,["class"])}const es=j(km,[["render",Tm],["__scopeId","data-v-3ea2af39"]]);const Rm={components:{WbForm:$n,WbButton:kt,WbButtonWrapper:Tt,WbFormFieldTextbox:es,WbFileSelect:Vo},props:{...ct,fsItem:{type:Object,default(){return null}},id:{type:String,default(){return null}},model:{type:Object,default(){return Ne({path:null,filename:null,file:null})}}},emits:[...ut,"close"],setup(t,e){return lt(t,e)},data(){return{filesModule:z(this.core.modules.files),cancelLabel:"Cancel",saveLabel:"Save",fields:{path:{name:"path",label:null,placeholder:"Path"},filesSelect:{title:null,name:"item"},filename:{name:"filename",label:null,placeholder:"Filename"}},currentFsItem:this.fsItem||z(this.core.modules.files.fs.root)}},computed:{fileSelectFsItem(){return this.fsItem||z(this.core.modules.files.fs.root)},isLocked(){return this.currentFsItem?this.currentFsItem.locked:!1},saveDisabled(){return!this.model.filename}},mounted(){this.id&&(this.model.filename=this.id)},methods:{onSelect(t){this.currentFsItem=t,t instanceof H?this.model.path=t.getPath():(this.model.path=t.getBase(),this.model.filename=t.id)},onClickCancel(){this.$emit("close")},onSubmit(t){const e=Fi(this.model.path,this.model.filename);this.$emit("close",e)}}},Dm={class:"wb-module-files-save"};function Cm(t,e,n,r,s,i){const a=R("wb-form-field-textbox"),o=R("wb-file-select"),l=R("wb-button"),u=R("wb-button-wrapper"),d=R("wb-form");return y(),C("div",Dm,[N(d,{onSubmit:i.onSubmit},{default:Y(()=>[N(a,V(s.fields.path,{model:n.model,readonly:""}),null,16,["model"]),N(o,{"file-system":s.filesModule.fileSystem,"fs-item":i.fileSelectFsItem,model:n.model,name:"file",onSelect:i.onSelect},null,8,["file-system","fs-item","model","onSelect"]),N(a,V(s.fields.filename,{model:n.model}),null,16,["model"]),N(u,{align:"outer",full:""},{default:Y(()=>[s.cancelLabel?(y(),U(l,{key:0,"style-type":"secondary",label:s.cancelLabel,onClick:i.onClickCancel},null,8,["label","onClick"])):B("",!0),s.saveLabel?(y(),U(l,{key:1,"style-type":"primary",label:s.saveLabel,type:"submit",disabled:i.isLocked||i.saveDisabled},null,8,["label","disabled"])):B("",!0)]),_:1})]),_:1},8,["onSubmit"])])}const Nm=j(Rm,[["render",Cm],["__scopeId","data-v-c743b284"]]);const Lm={components:{WbForm:$n,WbButton:kt,WbButtonWrapper:Tt,WbFormFieldTextbox:es,WbFileSelect:Vo},props:{...ct,fsItem:{type:Object,default(){return null}},model:{type:Object,default(){return Ne({path:null})}}},emits:[...ut,"close"],setup(t,e){return lt(t,e)},data(){return{filesModule:z(this.core.modules.files),cancelLabel:"Cancel",openLabel:"Open",fields:{path:{name:"path",label:null,placeholder:"Path"},fileSelect:{name:"path"},filename:{name:"filename",label:null,placeholder:"Filename"}},currentFsItem:this.fsItem||z(this.core.modules.files.fs.root)}},computed:{isItemContainer(){return this.currentFsItem instanceof H},fileSelectFsItem(){return this.fsItem||z(this.core.modules.files.fs.root)}},methods:{onSelect(t){this.currentFsItem=z(t),t instanceof H&&(this.model.path=t.getPath())},onClickCancel(){this.$emit("close")},onSubmit(t){this.$emit("close",this.model.path)}}},Pm={class:"wb-module-files-open"};function Mm(t,e,n,r,s,i){const a=R("wb-form-field-textbox"),o=R("wb-file-select"),l=R("wb-button"),u=R("wb-button-wrapper"),d=R("wb-form");return y(),C("div",Pm,[N(d,{onSubmit:i.onSubmit},{default:Y(()=>[N(a,V(s.fields.path,{model:n.model,readonly:""}),null,16,["model"]),N(o,V(s.fields.fileSelect,{"file-system":s.filesModule.fileSystem,"fs-item":i.fileSelectFsItem,model:n.model,onSelect:i.onSelect}),null,16,["file-system","fs-item","model","onSelect"]),N(u,{align:"outer",full:""},{default:Y(()=>[s.cancelLabel?(y(),U(l,{key:0,"style-type":"secondary",label:s.cancelLabel,onClick:i.onClickCancel},null,8,["label","onClick"])):B("",!0),s.openLabel?(y(),U(l,{key:1,"style-type":"primary",label:s.openLabel,type:"submit",disabled:i.isItemContainer},null,8,["label","disabled"])):B("",!0)]),_:1})]),_:1},8,["onSubmit"])])}const $m=j(Lm,[["render",Mm],["__scopeId","data-v-b9d5c422"]]);var Wm=(t,e,n)=>{if(!e.has(t))throw TypeError("Cannot "+n)},Sa=(t,e,n)=>{if(e.has(t))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(t):e.set(t,n)},Ei=(t,e,n)=>(Wm(t,e,"access private method"),n);function qi(){return{async:!1,baseUrl:null,breaks:!1,extensions:null,gfm:!0,headerIds:!0,headerPrefix:"",highlight:null,hooks:null,langPrefix:"language-",mangle:!0,pedantic:!1,renderer:null,sanitize:!1,sanitizer:null,silent:!1,smartypants:!1,tokenizer:null,walkTokens:null,xhtml:!1}}var Jt=qi();function Uo(t){Jt=t}var jo=/[&<>"']/,Fm=new RegExp(jo.source,"g"),Go=/[<>"']|&(?!(#\d{1,7}|#[Xx][a-fA-F0-9]{1,6}|\w+);)/,zm=new RegExp(Go.source,"g"),Bm={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},Ia=t=>Bm[t];function ue(t,e){if(e){if(jo.test(t))return t.replace(Fm,Ia)}else if(Go.test(t))return t.replace(zm,Ia);return t}var Vm=/&(#(?:\d+)|(?:#x[0-9A-Fa-f]+)|(?:\w+));?/ig;function Ho(t){return t.replace(Vm,(e,n)=>(n=n.toLowerCase(),n==="colon"?":":n.charAt(0)==="#"?n.charAt(1)==="x"?String.fromCharCode(parseInt(n.substring(2),16)):String.fromCharCode(+n.substring(1)):""))}var Um=/(^|[^\[])\^/g;function F(t,e){t=typeof t=="string"?t:t.source,e=e||"";const n={replace:(r,s)=>(s=typeof s=="object"&&"source"in s?s.source:s,s=s.replace(Um,"$1"),t=t.replace(r,s),n),getRegex:()=>new RegExp(t,e)};return n}var jm=/[^\w:]/g,Gm=/^$|^[a-z][a-z0-9+.-]*:|^[?#]/i;function Aa(t,e,n){if(t){let r;try{r=decodeURIComponent(Ho(n)).replace(jm,"").toLowerCase()}catch{return null}if(r.indexOf("javascript:")===0||r.indexOf("vbscript:")===0||r.indexOf("data:")===0)return null}e&&!Gm.test(n)&&(n=qm(e,n));try{n=encodeURI(n).replace(/%25/g,"%")}catch{return null}return n}var as={},Hm=/^[^:]+:\/*[^/]*$/,Ym=/^([^:]+:)[\s\S]*$/,Xm=/^([^:]+:\/*[^/]*)[\s\S]*$/;function qm(t,e){as[" "+t]||(Hm.test(t)?as[" "+t]=t+"/":as[" "+t]=ds(t,"/",!0)),t=as[" "+t];const n=t.indexOf(":")===-1;return e.substring(0,2)==="//"?n?e:t.replace(Ym,"$1")+e:e.charAt(0)==="/"?n?e:t.replace(Xm,"$1")+e:t+e}var Ss={exec:()=>null};function Oa(t,e){const n=t.replace(/\|/g,(i,a,o)=>{let l=!1,u=a;for(;--u>=0&&o[u]==="\\";)l=!l;return l?"|":" |"}),r=n.split(/ \|/);let s=0;if(r[0].trim()||r.shift(),r.length>0&&!r[r.length-1].trim()&&r.pop(),r.length>e)r.splice(e);else for(;r.length<e;)r.push("");for(;s<r.length;s++)r[s]=r[s].trim().replace(/\\\|/g,"|");return r}function ds(t,e,n){const r=t.length;if(r===0)return"";let s=0;for(;s<r;){const i=t.charAt(r-s-1);if(i===e&&!n)s++;else if(i!==e&&n)s++;else break}return t.slice(0,r-s)}function Km(t,e){if(t.indexOf(e[1])===-1)return-1;const n=t.length;let r=0,s=0;for(;s<n;s++)if(t[s]==="\\")s++;else if(t[s]===e[0])r++;else if(t[s]===e[1]&&(r--,r<0))return s;return-1}function Zm(t,e){!t||t.silent||(e&&console.warn("marked(): callback is deprecated since version 5.0.0, should not be used and will be removed in the future. Read more here: https://marked.js.org/using_pro#async"),(t.sanitize||t.sanitizer)&&console.warn("marked(): sanitize and sanitizer parameters are deprecated since version 0.7.0, should not be used and will be removed in the future. Read more here: https://marked.js.org/#/USING_ADVANCED.md#options"),(t.highlight||t.langPrefix!=="language-")&&console.warn("marked(): highlight and langPrefix parameters are deprecated since version 5.0.0, should not be used and will be removed in the future. Instead use https://www.npmjs.com/package/marked-highlight."),t.mangle&&console.warn("marked(): mangle parameter is enabled by default, but is deprecated since version 5.0.0, and will be removed in the future. To clear this warning, install https://www.npmjs.com/package/marked-mangle, or disable by setting `{mangle: false}`."),t.baseUrl&&console.warn("marked(): baseUrl parameter is deprecated since version 5.0.0, should not be used and will be removed in the future. Instead use https://www.npmjs.com/package/marked-base-url."),t.smartypants&&console.warn("marked(): smartypants parameter is deprecated since version 5.0.0, should not be used and will be removed in the future. Instead use https://www.npmjs.com/package/marked-smartypants."),t.xhtml&&console.warn("marked(): xhtml parameter is deprecated since version 5.0.0, should not be used and will be removed in the future. Instead use https://www.npmjs.com/package/marked-xhtml."),(t.headerIds||t.headerPrefix)&&console.warn("marked(): headerIds and headerPrefix parameters enabled by default, but are deprecated since version 5.0.0, and will be removed in the future. To clear this warning, install  https://www.npmjs.com/package/marked-gfm-heading-id, or disable by setting `{headerIds: false}`."))}function ka(t,e,n,r){const s=e.href,i=e.title?ue(e.title):null,a=t[1].replace(/\\([\[\]])/g,"$1");if(t[0].charAt(0)!=="!"){r.state.inLink=!0;const o={type:"link",raw:n,href:s,title:i,text:a,tokens:r.inlineTokens(a)};return r.state.inLink=!1,o}return{type:"image",raw:n,href:s,title:i,text:ue(a)}}function Qm(t,e){const n=t.match(/^(\s+)(?:```)/);if(n===null)return e;const r=n[1];return e.split(`
`).map(s=>{const i=s.match(/^\s+/);if(i===null)return s;const[a]=i;return a.length>=r.length?s.slice(r.length):s}).join(`
`)}var Is=class{constructor(t){this.options=t||Jt}space(t){const e=this.rules.block.newline.exec(t);if(e&&e[0].length>0)return{type:"space",raw:e[0]}}code(t){const e=this.rules.block.code.exec(t);if(e){const n=e[0].replace(/^ {1,4}/gm,"");return{type:"code",raw:e[0],codeBlockStyle:"indented",text:this.options.pedantic?n:ds(n,`
`)}}}fences(t){const e=this.rules.block.fences.exec(t);if(e){const n=e[0],r=Qm(n,e[3]||"");return{type:"code",raw:n,lang:e[2]?e[2].trim().replace(this.rules.inline._escapes,"$1"):e[2],text:r}}}heading(t){const e=this.rules.block.heading.exec(t);if(e){let n=e[2].trim();if(/#$/.test(n)){const r=ds(n,"#");(this.options.pedantic||!r||/ $/.test(r))&&(n=r.trim())}return{type:"heading",raw:e[0],depth:e[1].length,text:n,tokens:this.lexer.inline(n)}}}hr(t){const e=this.rules.block.hr.exec(t);if(e)return{type:"hr",raw:e[0]}}blockquote(t){const e=this.rules.block.blockquote.exec(t);if(e){const n=e[0].replace(/^ *>[ \t]?/gm,""),r=this.lexer.state.top;this.lexer.state.top=!0;const s=this.lexer.blockTokens(n);return this.lexer.state.top=r,{type:"blockquote",raw:e[0],tokens:s,text:n}}}list(t){let e=this.rules.block.list.exec(t);if(e){let n,r,s,i,a,o,l,u,d,m,h,f,v=e[1].trim();const _=v.length>1,E={type:"list",raw:"",ordered:_,start:_?+v.slice(0,-1):"",loose:!1,items:[]};v=_?`\\d{1,9}\\${v.slice(-1)}`:`\\${v}`,this.options.pedantic&&(v=_?v:"[*+-]");const L=new RegExp(`^( {0,3}${v})((?:[	 ][^\\n]*)?(?:\\n|$))`);for(;t&&(f=!1,!(!(e=L.exec(t))||this.rules.block.hr.test(t)));){if(n=e[0],t=t.substring(n.length),u=e[2].split(`
`,1)[0].replace(/^\t+/,M=>" ".repeat(3*M.length)),d=t.split(`
`,1)[0],this.options.pedantic?(i=2,h=u.trimLeft()):(i=e[2].search(/[^ ]/),i=i>4?1:i,h=u.slice(i),i+=e[1].length),o=!1,!u&&/^ *$/.test(d)&&(n+=d+`
`,t=t.substring(d.length+1),f=!0),!f){const M=new RegExp(`^ {0,${Math.min(3,i-1)}}(?:[*+-]|\\d{1,9}[.)])((?:[ 	][^\\n]*)?(?:\\n|$))`),ne=new RegExp(`^ {0,${Math.min(3,i-1)}}((?:- *){3,}|(?:_ *){3,}|(?:\\* *){3,})(?:\\n+|$)`),Q=new RegExp(`^ {0,${Math.min(3,i-1)}}(?:\`\`\`|~~~)`),ee=new RegExp(`^ {0,${Math.min(3,i-1)}}#`);for(;t&&(m=t.split(`
`,1)[0],d=m,this.options.pedantic&&(d=d.replace(/^ {1,4}(?=( {4})*[^ ])/g,"  ")),!(Q.test(d)||ee.test(d)||M.test(d)||ne.test(t)));){if(d.search(/[^ ]/)>=i||!d.trim())h+=`
`+d.slice(i);else{if(o||u.search(/[^ ]/)>=4||Q.test(u)||ee.test(u)||ne.test(u))break;h+=`
`+d}!o&&!d.trim()&&(o=!0),n+=m+`
`,t=t.substring(m.length+1),u=d.slice(i)}}E.loose||(l?E.loose=!0:/\n *\n *$/.test(n)&&(l=!0)),this.options.gfm&&(r=/^\[[ xX]\] /.exec(h),r&&(s=r[0]!=="[ ] ",h=h.replace(/^\[[ xX]\] +/,""))),E.items.push({type:"list_item",raw:n,task:!!r,checked:s,loose:!1,text:h}),E.raw+=n}E.items[E.items.length-1].raw=n.trimRight(),E.items[E.items.length-1].text=h.trimRight(),E.raw=E.raw.trimRight();const T=E.items.length;for(a=0;a<T;a++)if(this.lexer.state.top=!1,E.items[a].tokens=this.lexer.blockTokens(E.items[a].text,[]),!E.loose){const M=E.items[a].tokens.filter(Q=>Q.type==="space"),ne=M.length>0&&M.some(Q=>/\n.*\n/.test(Q.raw));E.loose=ne}if(E.loose)for(a=0;a<T;a++)E.items[a].loose=!0;return E}}html(t){const e=this.rules.block.html.exec(t);if(e){const n={type:"html",block:!0,raw:e[0],pre:!this.options.sanitizer&&(e[1]==="pre"||e[1]==="script"||e[1]==="style"),text:e[0]};if(this.options.sanitize){const r=this.options.sanitizer?this.options.sanitizer(e[0]):ue(e[0]),s=n;s.type="paragraph",s.text=r,s.tokens=this.lexer.inline(r)}return n}}def(t){const e=this.rules.block.def.exec(t);if(e){const n=e[1].toLowerCase().replace(/\s+/g," "),r=e[2]?e[2].replace(/^<(.*)>$/,"$1").replace(this.rules.inline._escapes,"$1"):"",s=e[3]?e[3].substring(1,e[3].length-1).replace(this.rules.inline._escapes,"$1"):e[3];return{type:"def",tag:n,raw:e[0],href:r,title:s}}}table(t){const e=this.rules.block.table.exec(t);if(e){const n={type:"table",header:Oa(e[1]).map(r=>({text:r})),align:e[2].replace(/^ *|\| *$/g,"").split(/ *\| */),rows:e[3]&&e[3].trim()?e[3].replace(/\n[ \t]*$/,"").split(`
`):[]};if(n.header.length===n.align.length){n.raw=e[0];let r=n.align.length,s,i,a,o;for(s=0;s<r;s++)/^ *-+: *$/.test(n.align[s])?n.align[s]="right":/^ *:-+: *$/.test(n.align[s])?n.align[s]="center":/^ *:-+ *$/.test(n.align[s])?n.align[s]="left":n.align[s]=null;for(r=n.rows.length,s=0;s<r;s++)n.rows[s]=Oa(n.rows[s],n.header.length).map(l=>({text:l}));for(r=n.header.length,i=0;i<r;i++)n.header[i].tokens=this.lexer.inline(n.header[i].text);for(r=n.rows.length,i=0;i<r;i++)for(o=n.rows[i],a=0;a<o.length;a++)o[a].tokens=this.lexer.inline(o[a].text);return n}}}lheading(t){const e=this.rules.block.lheading.exec(t);if(e)return{type:"heading",raw:e[0],depth:e[2].charAt(0)==="="?1:2,text:e[1],tokens:this.lexer.inline(e[1])}}paragraph(t){const e=this.rules.block.paragraph.exec(t);if(e){const n=e[1].charAt(e[1].length-1)===`
`?e[1].slice(0,-1):e[1];return{type:"paragraph",raw:e[0],text:n,tokens:this.lexer.inline(n)}}}text(t){const e=this.rules.block.text.exec(t);if(e)return{type:"text",raw:e[0],text:e[0],tokens:this.lexer.inline(e[0])}}escape(t){const e=this.rules.inline.escape.exec(t);if(e)return{type:"escape",raw:e[0],text:ue(e[1])}}tag(t){const e=this.rules.inline.tag.exec(t);if(e)return!this.lexer.state.inLink&&/^<a /i.test(e[0])?this.lexer.state.inLink=!0:this.lexer.state.inLink&&/^<\/a>/i.test(e[0])&&(this.lexer.state.inLink=!1),!this.lexer.state.inRawBlock&&/^<(pre|code|kbd|script)(\s|>)/i.test(e[0])?this.lexer.state.inRawBlock=!0:this.lexer.state.inRawBlock&&/^<\/(pre|code|kbd|script)(\s|>)/i.test(e[0])&&(this.lexer.state.inRawBlock=!1),{type:this.options.sanitize?"text":"html",raw:e[0],inLink:this.lexer.state.inLink,inRawBlock:this.lexer.state.inRawBlock,block:!1,text:this.options.sanitize?this.options.sanitizer?this.options.sanitizer(e[0]):ue(e[0]):e[0]}}link(t){const e=this.rules.inline.link.exec(t);if(e){const n=e[2].trim();if(!this.options.pedantic&&/^</.test(n)){if(!/>$/.test(n))return;const i=ds(n.slice(0,-1),"\\");if((n.length-i.length)%2===0)return}else{const i=Km(e[2],"()");if(i>-1){const o=(e[0].indexOf("!")===0?5:4)+e[1].length+i;e[2]=e[2].substring(0,i),e[0]=e[0].substring(0,o).trim(),e[3]=""}}let r=e[2],s="";if(this.options.pedantic){const i=/^([^'"]*[^\s])\s+(['"])(.*)\2/.exec(r);i&&(r=i[1],s=i[3])}else s=e[3]?e[3].slice(1,-1):"";return r=r.trim(),/^</.test(r)&&(this.options.pedantic&&!/>$/.test(n)?r=r.slice(1):r=r.slice(1,-1)),ka(e,{href:r&&r.replace(this.rules.inline._escapes,"$1"),title:s&&s.replace(this.rules.inline._escapes,"$1")},e[0],this.lexer)}}reflink(t,e){let n;if((n=this.rules.inline.reflink.exec(t))||(n=this.rules.inline.nolink.exec(t))){let r=(n[2]||n[1]).replace(/\s+/g," ");if(r=e[r.toLowerCase()],!r){const s=n[0].charAt(0);return{type:"text",raw:s,text:s}}return ka(n,r,n[0],this.lexer)}}emStrong(t,e,n=""){let r=this.rules.inline.emStrong.lDelim.exec(t);if(!r||r[3]&&n.match(/[\p{L}\p{N}]/u))return;if(!(r[1]||r[2]||"")||!n||this.rules.inline.punctuation.exec(n)){const i=r[0].length-1;let a,o,l=i,u=0;const d=r[0][0]==="*"?this.rules.inline.emStrong.rDelimAst:this.rules.inline.emStrong.rDelimUnd;for(d.lastIndex=0,e=e.slice(-1*t.length+i);(r=d.exec(e))!=null;){if(a=r[1]||r[2]||r[3]||r[4]||r[5]||r[6],!a)continue;if(o=a.length,r[3]||r[4]){l+=o;continue}else if((r[5]||r[6])&&i%3&&!((i+o)%3)){u+=o;continue}if(l-=o,l>0)continue;o=Math.min(o,o+l+u);const m=t.slice(0,i+r.index+o+1);if(Math.min(i,o)%2){const f=m.slice(1,-1);return{type:"em",raw:m,text:f,tokens:this.lexer.inlineTokens(f)}}const h=m.slice(2,-2);return{type:"strong",raw:m,text:h,tokens:this.lexer.inlineTokens(h)}}}}codespan(t){const e=this.rules.inline.code.exec(t);if(e){let n=e[2].replace(/\n/g," ");const r=/[^ ]/.test(n),s=/^ /.test(n)&&/ $/.test(n);return r&&s&&(n=n.substring(1,n.length-1)),n=ue(n,!0),{type:"codespan",raw:e[0],text:n}}}br(t){const e=this.rules.inline.br.exec(t);if(e)return{type:"br",raw:e[0]}}del(t){const e=this.rules.inline.del.exec(t);if(e)return{type:"del",raw:e[0],text:e[2],tokens:this.lexer.inlineTokens(e[2])}}autolink(t,e){const n=this.rules.inline.autolink.exec(t);if(n){let r,s;return n[2]==="@"?(r=ue(this.options.mangle?e(n[1]):n[1]),s="mailto:"+r):(r=ue(n[1]),s=r),{type:"link",raw:n[0],text:r,href:s,tokens:[{type:"text",raw:r,text:r}]}}}url(t,e){let n;if(n=this.rules.inline.url.exec(t)){let r,s;if(n[2]==="@")r=ue(this.options.mangle?e(n[0]):n[0]),s="mailto:"+r;else{let i;do i=n[0],n[0]=this.rules.inline._backpedal.exec(n[0])[0];while(i!==n[0]);r=ue(n[0]),n[1]==="www."?s="http://"+n[0]:s=n[0]}return{type:"link",raw:n[0],text:r,href:s,tokens:[{type:"text",raw:r,text:r}]}}}inlineText(t,e){const n=this.rules.inline.text.exec(t);if(n){let r;return this.lexer.state.inRawBlock?r=this.options.sanitize?this.options.sanitizer?this.options.sanitizer(n[0]):ue(n[0]):n[0]:r=ue(this.options.smartypants?e(n[0]):n[0]),{type:"text",raw:n[0],text:r}}}},D={newline:/^(?: *(?:\n|$))+/,code:/^( {4}[^\n]+(?:\n(?: *(?:\n|$))*)?)+/,fences:/^ {0,3}(`{3,}(?=[^`\n]*(?:\n|$))|~{3,})([^\n]*)(?:\n|$)(?:|([\s\S]*?)(?:\n|$))(?: {0,3}\1[~`]* *(?=\n|$)|$)/,hr:/^ {0,3}((?:-[\t ]*){3,}|(?:_[ \t]*){3,}|(?:\*[ \t]*){3,})(?:\n+|$)/,heading:/^ {0,3}(#{1,6})(?=\s|$)(.*)(?:\n+|$)/,blockquote:/^( {0,3}> ?(paragraph|[^\n]*)(?:\n|$))+/,list:/^( {0,3}bull)([ \t][^\n]+?)?(?:\n|$)/,html:"^ {0,3}(?:<(script|pre|style|textarea)[\\s>][\\s\\S]*?(?:</\\1>[^\\n]*\\n+|$)|comment[^\\n]*(\\n+|$)|<\\?[\\s\\S]*?(?:\\?>\\n*|$)|<![A-Z][\\s\\S]*?(?:>\\n*|$)|<!\\[CDATA\\[[\\s\\S]*?(?:\\]\\]>\\n*|$)|</?(tag)(?: +|\\n|/?>)[\\s\\S]*?(?:(?:\\n *)+\\n|$)|<(?!script|pre|style|textarea)([a-z][\\w-]*)(?:attribute)*? */?>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n *)+\\n|$)|</(?!script|pre|style|textarea)[a-z][\\w-]*\\s*>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n *)+\\n|$))",def:/^ {0,3}\[(label)\]: *(?:\n *)?([^<\s][^\s]*|<.*?>)(?:(?: +(?:\n *)?| *\n *)(title))? *(?:\n+|$)/,table:Ss,lheading:/^((?:(?!^bull ).|\n(?!\n|bull ))+?)\n {0,3}(=+|-+) *(?:\n+|$)/,_paragraph:/^([^\n]+(?:\n(?!hr|heading|lheading|blockquote|fences|list|html|table| +\n)[^\n]+)*)/,text:/^[^\n]+/};D._label=/(?!\s*\])(?:\\.|[^\[\]\\])+/;D._title=/(?:"(?:\\"?|[^"\\])*"|'[^'\n]*(?:\n[^'\n]+)*\n?'|\([^()]*\))/;D.def=F(D.def).replace("label",D._label).replace("title",D._title).getRegex();D.bullet=/(?:[*+-]|\d{1,9}[.)])/;D.listItemStart=F(/^( *)(bull) */).replace("bull",D.bullet).getRegex();D.list=F(D.list).replace(/bull/g,D.bullet).replace("hr","\\n+(?=\\1?(?:(?:- *){3,}|(?:_ *){3,}|(?:\\* *){3,})(?:\\n+|$))").replace("def","\\n+(?="+D.def.source+")").getRegex();D._tag="address|article|aside|base|basefont|blockquote|body|caption|center|col|colgroup|dd|details|dialog|dir|div|dl|dt|fieldset|figcaption|figure|footer|form|frame|frameset|h[1-6]|head|header|hr|html|iframe|legend|li|link|main|menu|menuitem|meta|nav|noframes|ol|optgroup|option|p|param|section|source|summary|table|tbody|td|tfoot|th|thead|title|tr|track|ul";D._comment=/<!--(?!-?>)[\s\S]*?(?:-->|$)/;D.html=F(D.html,"i").replace("comment",D._comment).replace("tag",D._tag).replace("attribute",/ +[a-zA-Z:_][\w.:-]*(?: *= *"[^"\n]*"| *= *'[^'\n]*'| *= *[^\s"'=<>`]+)?/).getRegex();D.lheading=F(D.lheading).replace(/bull/g,D.bullet).getRegex();D.paragraph=F(D._paragraph).replace("hr",D.hr).replace("heading"," {0,3}#{1,6} ").replace("|lheading","").replace("|table","").replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",D._tag).getRegex();D.blockquote=F(D.blockquote).replace("paragraph",D.paragraph).getRegex();D.normal={...D};D.gfm={...D.normal,table:"^ *([^\\n ].*\\|.*)\\n {0,3}(?:\\| *)?(:?-+:? *(?:\\| *:?-+:? *)*)(?:\\| *)?(?:\\n((?:(?! *\\n|hr|heading|blockquote|code|fences|list|html).*(?:\\n|$))*)\\n*|$)"};D.gfm.table=F(D.gfm.table).replace("hr",D.hr).replace("heading"," {0,3}#{1,6} ").replace("blockquote"," {0,3}>").replace("code"," {4}[^\\n]").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",D._tag).getRegex();D.gfm.paragraph=F(D._paragraph).replace("hr",D.hr).replace("heading"," {0,3}#{1,6} ").replace("|lheading","").replace("table",D.gfm.table).replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",D._tag).getRegex();D.pedantic={...D.normal,html:F(`^ *(?:comment *(?:\\n|\\s*$)|<(tag)[\\s\\S]+?</\\1> *(?:\\n{2,}|\\s*$)|<tag(?:"[^"]*"|'[^']*'|\\s[^'"/>\\s]*)*?/?> *(?:\\n{2,}|\\s*$))`).replace("comment",D._comment).replace(/tag/g,"(?!(?:a|em|strong|small|s|cite|q|dfn|abbr|data|time|code|var|samp|kbd|sub|sup|i|b|u|mark|ruby|rt|rp|bdi|bdo|span|br|wbr|ins|del|img)\\b)\\w+(?!:|[^\\w\\s@]*@)\\b").getRegex(),def:/^ *\[([^\]]+)\]: *<?([^\s>]+)>?(?: +(["(][^\n]+[")]))? *(?:\n+|$)/,heading:/^(#{1,6})(.*)(?:\n+|$)/,fences:Ss,lheading:/^(.+?)\n {0,3}(=+|-+) *(?:\n+|$)/,paragraph:F(D.normal._paragraph).replace("hr",D.hr).replace("heading",` *#{1,6} *[^
]`).replace("lheading",D.lheading).replace("blockquote"," {0,3}>").replace("|fences","").replace("|list","").replace("|html","").getRegex()};var I={escape:/^\\([!"#$%&'()*+,\-./:;<=>?@\[\]\\^_`{|}~])/,autolink:/^<(scheme:[^\s\x00-\x1f<>]*|email)>/,url:Ss,tag:"^comment|^</[a-zA-Z][\\w:-]*\\s*>|^<[a-zA-Z][\\w-]*(?:attribute)*?\\s*/?>|^<\\?[\\s\\S]*?\\?>|^<![a-zA-Z]+\\s[\\s\\S]*?>|^<!\\[CDATA\\[[\\s\\S]*?\\]\\]>",link:/^!?\[(label)\]\(\s*(href)(?:\s+(title))?\s*\)/,reflink:/^!?\[(label)\]\[(ref)\]/,nolink:/^!?\[(ref)\](?:\[\])?/,reflinkSearch:"reflink|nolink(?!\\()",emStrong:{lDelim:/^(?:\*+(?:((?!\*)[punct])|[^\s*]))|^_+(?:((?!_)[punct])|([^\s_]))/,rDelimAst:/^[^_*]*?__[^_*]*?\*[^_*]*?(?=__)|[^*]+(?=[^*])|(?!\*)[punct](\*+)(?=[\s]|$)|[^punct\s](\*+)(?!\*)(?=[punct\s]|$)|(?!\*)[punct\s](\*+)(?=[^punct\s])|[\s](\*+)(?!\*)(?=[punct])|(?!\*)[punct](\*+)(?!\*)(?=[punct])|[^punct\s](\*+)(?=[^punct\s])/,rDelimUnd:/^[^_*]*?\*\*[^_*]*?_[^_*]*?(?=\*\*)|[^_]+(?=[^_])|(?!_)[punct](_+)(?=[\s]|$)|[^punct\s](_+)(?!_)(?=[punct\s]|$)|(?!_)[punct\s](_+)(?=[^punct\s])|[\s](_+)(?!_)(?=[punct])|(?!_)[punct](_+)(?!_)(?=[punct])/},code:/^(`+)([^`]|[^`][\s\S]*?[^`])\1(?!`)/,br:/^( {2,}|\\)\n(?!\s*$)/,del:Ss,text:/^(`+|[^`])(?:(?= {2,}\n)|[\s\S]*?(?:(?=[\\<!\[`*_]|\b_|$)|[^ ](?= {2,}\n)))/,punctuation:/^((?![*_])[\spunctuation])/};I._punctuation="\\p{P}$+<=>`^|~";I.punctuation=F(I.punctuation,"u").replace(/punctuation/g,I._punctuation).getRegex();I.blockSkip=/\[[^[\]]*?\]\([^\(\)]*?\)|`[^`]*?`|<[^<>]*?>/g;I.anyPunctuation=/\\[punct]/g;I._escapes=/\\([punct])/g;I._comment=F(D._comment).replace("(?:-->|$)","-->").getRegex();I.emStrong.lDelim=F(I.emStrong.lDelim,"u").replace(/punct/g,I._punctuation).getRegex();I.emStrong.rDelimAst=F(I.emStrong.rDelimAst,"gu").replace(/punct/g,I._punctuation).getRegex();I.emStrong.rDelimUnd=F(I.emStrong.rDelimUnd,"gu").replace(/punct/g,I._punctuation).getRegex();I.anyPunctuation=F(I.anyPunctuation,"gu").replace(/punct/g,I._punctuation).getRegex();I._escapes=F(I._escapes,"gu").replace(/punct/g,I._punctuation).getRegex();I._scheme=/[a-zA-Z][a-zA-Z0-9+.-]{1,31}/;I._email=/[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+(@)[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)+(?![-_])/;I.autolink=F(I.autolink).replace("scheme",I._scheme).replace("email",I._email).getRegex();I._attribute=/\s+[a-zA-Z:_][\w.:-]*(?:\s*=\s*"[^"]*"|\s*=\s*'[^']*'|\s*=\s*[^\s"'=<>`]+)?/;I.tag=F(I.tag).replace("comment",I._comment).replace("attribute",I._attribute).getRegex();I._label=/(?:\[(?:\\.|[^\[\]\\])*\]|\\.|`[^`]*`|[^\[\]\\`])*?/;I._href=/<(?:\\.|[^\n<>\\])+>|[^\s\x00-\x1f]*/;I._title=/"(?:\\"?|[^"\\])*"|'(?:\\'?|[^'\\])*'|\((?:\\\)?|[^)\\])*\)/;I.link=F(I.link).replace("label",I._label).replace("href",I._href).replace("title",I._title).getRegex();I.reflink=F(I.reflink).replace("label",I._label).replace("ref",D._label).getRegex();I.nolink=F(I.nolink).replace("ref",D._label).getRegex();I.reflinkSearch=F(I.reflinkSearch,"g").replace("reflink",I.reflink).replace("nolink",I.nolink).getRegex();I.normal={...I};I.pedantic={...I.normal,strong:{start:/^__|\*\*/,middle:/^__(?=\S)([\s\S]*?\S)__(?!_)|^\*\*(?=\S)([\s\S]*?\S)\*\*(?!\*)/,endAst:/\*\*(?!\*)/g,endUnd:/__(?!_)/g},em:{start:/^_|\*/,middle:/^()\*(?=\S)([\s\S]*?\S)\*(?!\*)|^_(?=\S)([\s\S]*?\S)_(?!_)/,endAst:/\*(?!\*)/g,endUnd:/_(?!_)/g},link:F(/^!?\[(label)\]\((.*?)\)/).replace("label",I._label).getRegex(),reflink:F(/^!?\[(label)\]\s*\[([^\]]*)\]/).replace("label",I._label).getRegex()};I.gfm={...I.normal,escape:F(I.escape).replace("])","~|])").getRegex(),_extended_email:/[A-Za-z0-9._+-]+(@)[a-zA-Z0-9-_]+(?:\.[a-zA-Z0-9-_]*[a-zA-Z0-9])+(?![-_])/,url:/^((?:ftp|https?):\/\/|www\.)(?:[a-zA-Z0-9\-]+\.?)+[^\s<]*|^email/,_backpedal:/(?:[^?!.,:;*_'"~()&]+|\([^)]*\)|&(?![a-zA-Z0-9]+;$)|[?!.,:;*_'"~)]+(?!$))+/,del:/^(~~?)(?=[^\s~])([\s\S]*?[^\s~])\1(?=[^~]|$)/,text:/^([`~]+|[^`~])(?:(?= {2,}\n)|(?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)|[\s\S]*?(?:(?=[\\<!\[`*~_]|\b_|https?:\/\/|ftp:\/\/|www\.|$)|[^ ](?= {2,}\n)|[^a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-](?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)))/};I.gfm.url=F(I.gfm.url,"i").replace("email",I.gfm._extended_email).getRegex();I.breaks={...I.gfm,br:F(I.br).replace("{2,}","*").getRegex(),text:F(I.gfm.text).replace("\\b_","\\b_| {2,}\\n").replace(/\{2,\}/g,"*").getRegex()};function Jm(t){return t.replace(/---/g,"").replace(/--/g,"").replace(/(^|[-\u2014/(\[{"\s])'/g,"$1").replace(/'/g,"").replace(/(^|[-\u2014/(\[{\u2018\s])"/g,"$1").replace(/"/g,"").replace(/\.{3}/g,"")}function Ta(t){let e="",n,r;const s=t.length;for(n=0;n<s;n++)r=t.charCodeAt(n),Math.random()>.5&&(r="x"+r.toString(16)),e+="&#"+r+";";return e}var rt=class{constructor(t){this.tokens=[],this.tokens.links=Object.create(null),this.options=t||Jt,this.options.tokenizer=this.options.tokenizer||new Is,this.tokenizer=this.options.tokenizer,this.tokenizer.options=this.options,this.tokenizer.lexer=this,this.inlineQueue=[],this.state={inLink:!1,inRawBlock:!1,top:!0};const e={block:D.normal,inline:I.normal};this.options.pedantic?(e.block=D.pedantic,e.inline=I.pedantic):this.options.gfm&&(e.block=D.gfm,this.options.breaks?e.inline=I.breaks:e.inline=I.gfm),this.tokenizer.rules=e}static get rules(){return{block:D,inline:I}}static lex(t,e){return new rt(e).lex(t)}static lexInline(t,e){return new rt(e).inlineTokens(t)}lex(t){t=t.replace(/\r\n|\r/g,`
`),this.blockTokens(t,this.tokens);let e;for(;e=this.inlineQueue.shift();)this.inlineTokens(e.src,e.tokens);return this.tokens}blockTokens(t,e=[]){this.options.pedantic?t=t.replace(/\t/g,"    ").replace(/^ +$/gm,""):t=t.replace(/^( *)(\t+)/gm,(a,o,l)=>o+"    ".repeat(l.length));let n,r,s,i;for(;t;)if(!(this.options.extensions&&this.options.extensions.block&&this.options.extensions.block.some(a=>(n=a.call({lexer:this},t,e))?(t=t.substring(n.raw.length),e.push(n),!0):!1))){if(n=this.tokenizer.space(t)){t=t.substring(n.raw.length),n.raw.length===1&&e.length>0?e[e.length-1].raw+=`
`:e.push(n);continue}if(n=this.tokenizer.code(t)){t=t.substring(n.raw.length),r=e[e.length-1],r&&(r.type==="paragraph"||r.type==="text")?(r.raw+=`
`+n.raw,r.text+=`
`+n.text,this.inlineQueue[this.inlineQueue.length-1].src=r.text):e.push(n);continue}if(n=this.tokenizer.fences(t)){t=t.substring(n.raw.length),e.push(n);continue}if(n=this.tokenizer.heading(t)){t=t.substring(n.raw.length),e.push(n);continue}if(n=this.tokenizer.hr(t)){t=t.substring(n.raw.length),e.push(n);continue}if(n=this.tokenizer.blockquote(t)){t=t.substring(n.raw.length),e.push(n);continue}if(n=this.tokenizer.list(t)){t=t.substring(n.raw.length),e.push(n);continue}if(n=this.tokenizer.html(t)){t=t.substring(n.raw.length),e.push(n);continue}if(n=this.tokenizer.def(t)){t=t.substring(n.raw.length),r=e[e.length-1],r&&(r.type==="paragraph"||r.type==="text")?(r.raw+=`
`+n.raw,r.text+=`
`+n.raw,this.inlineQueue[this.inlineQueue.length-1].src=r.text):this.tokens.links[n.tag]||(this.tokens.links[n.tag]={href:n.href,title:n.title});continue}if(n=this.tokenizer.table(t)){t=t.substring(n.raw.length),e.push(n);continue}if(n=this.tokenizer.lheading(t)){t=t.substring(n.raw.length),e.push(n);continue}if(s=t,this.options.extensions&&this.options.extensions.startBlock){let a=1/0;const o=t.slice(1);let l;this.options.extensions.startBlock.forEach(u=>{l=u.call({lexer:this},o),typeof l=="number"&&l>=0&&(a=Math.min(a,l))}),a<1/0&&a>=0&&(s=t.substring(0,a+1))}if(this.state.top&&(n=this.tokenizer.paragraph(s))){r=e[e.length-1],i&&r.type==="paragraph"?(r.raw+=`
`+n.raw,r.text+=`
`+n.text,this.inlineQueue.pop(),this.inlineQueue[this.inlineQueue.length-1].src=r.text):e.push(n),i=s.length!==t.length,t=t.substring(n.raw.length);continue}if(n=this.tokenizer.text(t)){t=t.substring(n.raw.length),r=e[e.length-1],r&&r.type==="text"?(r.raw+=`
`+n.raw,r.text+=`
`+n.text,this.inlineQueue.pop(),this.inlineQueue[this.inlineQueue.length-1].src=r.text):e.push(n);continue}if(t){const a="Infinite loop on byte: "+t.charCodeAt(0);if(this.options.silent){console.error(a);break}else throw new Error(a)}}return this.state.top=!0,e}inline(t,e=[]){return this.inlineQueue.push({src:t,tokens:e}),e}inlineTokens(t,e=[]){let n,r,s,i=t,a,o,l;if(this.tokens.links){const u=Object.keys(this.tokens.links);if(u.length>0)for(;(a=this.tokenizer.rules.inline.reflinkSearch.exec(i))!=null;)u.includes(a[0].slice(a[0].lastIndexOf("[")+1,-1))&&(i=i.slice(0,a.index)+"["+"a".repeat(a[0].length-2)+"]"+i.slice(this.tokenizer.rules.inline.reflinkSearch.lastIndex))}for(;(a=this.tokenizer.rules.inline.blockSkip.exec(i))!=null;)i=i.slice(0,a.index)+"["+"a".repeat(a[0].length-2)+"]"+i.slice(this.tokenizer.rules.inline.blockSkip.lastIndex);for(;(a=this.tokenizer.rules.inline.anyPunctuation.exec(i))!=null;)i=i.slice(0,a.index)+"++"+i.slice(this.tokenizer.rules.inline.anyPunctuation.lastIndex);for(;t;)if(o||(l=""),o=!1,!(this.options.extensions&&this.options.extensions.inline&&this.options.extensions.inline.some(u=>(n=u.call({lexer:this},t,e))?(t=t.substring(n.raw.length),e.push(n),!0):!1))){if(n=this.tokenizer.escape(t)){t=t.substring(n.raw.length),e.push(n);continue}if(n=this.tokenizer.tag(t)){t=t.substring(n.raw.length),r=e[e.length-1],r&&n.type==="text"&&r.type==="text"?(r.raw+=n.raw,r.text+=n.text):e.push(n);continue}if(n=this.tokenizer.link(t)){t=t.substring(n.raw.length),e.push(n);continue}if(n=this.tokenizer.reflink(t,this.tokens.links)){t=t.substring(n.raw.length),r=e[e.length-1],r&&n.type==="text"&&r.type==="text"?(r.raw+=n.raw,r.text+=n.text):e.push(n);continue}if(n=this.tokenizer.emStrong(t,i,l)){t=t.substring(n.raw.length),e.push(n);continue}if(n=this.tokenizer.codespan(t)){t=t.substring(n.raw.length),e.push(n);continue}if(n=this.tokenizer.br(t)){t=t.substring(n.raw.length),e.push(n);continue}if(n=this.tokenizer.del(t)){t=t.substring(n.raw.length),e.push(n);continue}if(n=this.tokenizer.autolink(t,Ta)){t=t.substring(n.raw.length),e.push(n);continue}if(!this.state.inLink&&(n=this.tokenizer.url(t,Ta))){t=t.substring(n.raw.length),e.push(n);continue}if(s=t,this.options.extensions&&this.options.extensions.startInline){let u=1/0;const d=t.slice(1);let m;this.options.extensions.startInline.forEach(h=>{m=h.call({lexer:this},d),typeof m=="number"&&m>=0&&(u=Math.min(u,m))}),u<1/0&&u>=0&&(s=t.substring(0,u+1))}if(n=this.tokenizer.inlineText(s,Jm)){t=t.substring(n.raw.length),n.raw.slice(-1)!=="_"&&(l=n.raw.slice(-1)),o=!0,r=e[e.length-1],r&&r.type==="text"?(r.raw+=n.raw,r.text+=n.text):e.push(n);continue}if(t){const u="Infinite loop on byte: "+t.charCodeAt(0);if(this.options.silent){console.error(u);break}else throw new Error(u)}}return e}},As=class{constructor(t){this.options=t||Jt}code(t,e,n){const r=(e||"").match(/\S*/)[0];if(this.options.highlight){const s=this.options.highlight(t,r);s!=null&&s!==t&&(n=!0,t=s)}return t=t.replace(/\n$/,"")+`
`,r?'<pre><code class="'+this.options.langPrefix+ue(r)+'">'+(n?t:ue(t,!0))+`</code></pre>
`:"<pre><code>"+(n?t:ue(t,!0))+`</code></pre>
`}blockquote(t){return`<blockquote>
${t}</blockquote>
`}html(t,e){return t}heading(t,e,n,r){if(this.options.headerIds){const s=this.options.headerPrefix+r.slug(n);return`<h${e} id="${s}">${t}</h${e}>
`}return`<h${e}>${t}</h${e}>
`}hr(){return this.options.xhtml?`<hr/>
`:`<hr>
`}list(t,e,n){const r=e?"ol":"ul",s=e&&n!==1?' start="'+n+'"':"";return"<"+r+s+`>
`+t+"</"+r+`>
`}listitem(t,e,n){return`<li>${t}</li>
`}checkbox(t){return"<input "+(t?'checked="" ':"")+'disabled="" type="checkbox"'+(this.options.xhtml?" /":"")+"> "}paragraph(t){return`<p>${t}</p>
`}table(t,e){return e&&(e=`<tbody>${e}</tbody>`),`<table>
<thead>
`+t+`</thead>
`+e+`</table>
`}tablerow(t){return`<tr>
${t}</tr>
`}tablecell(t,e){const n=e.header?"th":"td";return(e.align?`<${n} align="${e.align}">`:`<${n}>`)+t+`</${n}>
`}strong(t){return`<strong>${t}</strong>`}em(t){return`<em>${t}</em>`}codespan(t){return`<code>${t}</code>`}br(){return this.options.xhtml?"<br/>":"<br>"}del(t){return`<del>${t}</del>`}link(t,e,n){if(t=Aa(this.options.sanitize,this.options.baseUrl,t),t===null)return n;let r='<a href="'+t+'"';return e&&(r+=' title="'+e+'"'),r+=">"+n+"</a>",r}image(t,e,n){if(t=Aa(this.options.sanitize,this.options.baseUrl,t),t===null)return n;let r=`<img src="${t}" alt="${n}"`;return e&&(r+=` title="${e}"`),r+=this.options.xhtml?"/>":">",r}text(t){return t}},Ki=class{strong(t){return t}em(t){return t}codespan(t){return t}del(t){return t}html(t){return t}text(t){return t}link(t,e,n){return""+n}image(t,e,n){return""+n}br(){return""}},Zi=class{constructor(){this.seen={}}serialize(t){return t.toLowerCase().trim().replace(/<[!\/a-z].*?>/ig,"").replace(/[\u2000-\u206F\u2E00-\u2E7F\\'!"#$%&()*+,./:;<=>?@[\]^`{|}~]/g,"").replace(/\s/g,"-")}getNextSafeSlug(t,e){let n=t,r=0;if(this.seen.hasOwnProperty(n)){r=this.seen[t];do r++,n=t+"-"+r;while(this.seen.hasOwnProperty(n))}return e||(this.seen[t]=r,this.seen[n]=0),n}slug(t,e={}){const n=this.serialize(t);return this.getNextSafeSlug(n,e.dryrun)}},st=class{constructor(t){this.options=t||Jt,this.options.renderer=this.options.renderer||new As,this.renderer=this.options.renderer,this.renderer.options=this.options,this.textRenderer=new Ki,this.slugger=new Zi}static parse(t,e){return new st(e).parse(t)}static parseInline(t,e){return new st(e).parseInline(t)}parse(t,e=!0){let n="",r,s,i,a,o,l,u,d,m,h,f,v,_,E,L,T,M,ne,Q;const ee=t.length;for(r=0;r<ee;r++){if(h=t[r],this.options.extensions&&this.options.extensions.renderers&&this.options.extensions.renderers[h.type]&&(Q=this.options.extensions.renderers[h.type].call({parser:this},h),Q!==!1||!["space","hr","heading","code","table","blockquote","list","html","paragraph","text"].includes(h.type))){n+=Q||"";continue}switch(h.type){case"space":continue;case"hr":{n+=this.renderer.hr();continue}case"heading":{n+=this.renderer.heading(this.parseInline(h.tokens),h.depth,Ho(this.parseInline(h.tokens,this.textRenderer)),this.slugger);continue}case"code":{n+=this.renderer.code(h.text,h.lang,!!h.escaped);continue}case"table":{for(d="",u="",a=h.header.length,s=0;s<a;s++)u+=this.renderer.tablecell(this.parseInline(h.header[s].tokens),{header:!0,align:h.align[s]});for(d+=this.renderer.tablerow(u),m="",a=h.rows.length,s=0;s<a;s++){for(l=h.rows[s],u="",o=l.length,i=0;i<o;i++)u+=this.renderer.tablecell(this.parseInline(l[i].tokens),{header:!1,align:h.align[i]});m+=this.renderer.tablerow(u)}n+=this.renderer.table(d,m);continue}case"blockquote":{m=this.parse(h.tokens),n+=this.renderer.blockquote(m);continue}case"list":{for(f=h.ordered,v=h.start,_=h.loose,a=h.items.length,m="",s=0;s<a;s++)L=h.items[s],T=L.checked,M=L.task,E="",L.task&&(ne=this.renderer.checkbox(!!T),_?L.tokens.length>0&&L.tokens[0].type==="paragraph"?(L.tokens[0].text=ne+" "+L.tokens[0].text,L.tokens[0].tokens&&L.tokens[0].tokens.length>0&&L.tokens[0].tokens[0].type==="text"&&(L.tokens[0].tokens[0].text=ne+" "+L.tokens[0].tokens[0].text)):L.tokens.unshift({type:"text",text:ne}):E+=ne),E+=this.parse(L.tokens,_),m+=this.renderer.listitem(E,M,!!T);n+=this.renderer.list(m,f,v);continue}case"html":{n+=this.renderer.html(h.text,h.block);continue}case"paragraph":{n+=this.renderer.paragraph(this.parseInline(h.tokens));continue}case"text":{for(m=h.tokens?this.parseInline(h.tokens):h.text;r+1<ee&&t[r+1].type==="text";)h=t[++r],m+=`
`+(h.tokens?this.parseInline(h.tokens):h.text);n+=e?this.renderer.paragraph(m):m;continue}default:{const Fn='Token with "'+h.type+'" type was not found.';if(this.options.silent)return console.error(Fn),"";throw new Error(Fn)}}}return n}parseInline(t,e){e=e||this.renderer;let n="",r,s,i;const a=t.length;for(r=0;r<a;r++){if(s=t[r],this.options.extensions&&this.options.extensions.renderers&&this.options.extensions.renderers[s.type]&&(i=this.options.extensions.renderers[s.type].call({parser:this},s),i!==!1||!["escape","html","link","image","strong","em","codespan","br","del","text"].includes(s.type))){n+=i||"";continue}switch(s.type){case"escape":{n+=e.text(s.text);break}case"html":{n+=e.html(s.text);break}case"link":{n+=e.link(s.href,s.title,this.parseInline(s.tokens,e));break}case"image":{n+=e.image(s.href,s.title,s.text);break}case"strong":{n+=e.strong(this.parseInline(s.tokens,e));break}case"em":{n+=e.em(this.parseInline(s.tokens,e));break}case"codespan":{n+=e.codespan(s.text);break}case"br":{n+=e.br();break}case"del":{n+=e.del(this.parseInline(s.tokens,e));break}case"text":{n+=e.text(s.text);break}default:{const o='Token with "'+s.type+'" type was not found.';if(this.options.silent)return console.error(o),"";throw new Error(o)}}}return n}},rr=class{constructor(t){this.options=t||Jt}preprocess(t){return t}postprocess(t){return t}};rr.passThroughHooks=new Set(["preprocess","postprocess"]);var hs,Si,Qi,Yo,ef=class{constructor(...t){Sa(this,hs),Sa(this,Qi),this.defaults=qi(),this.options=this.setOptions,this.parse=Ei(this,hs,Si).call(this,rt.lex,st.parse),this.parseInline=Ei(this,hs,Si).call(this,rt.lexInline,st.parseInline),this.Parser=st,this.parser=st.parse,this.Renderer=As,this.TextRenderer=Ki,this.Lexer=rt,this.lexer=rt.lex,this.Tokenizer=Is,this.Slugger=Zi,this.Hooks=rr,this.use(...t)}walkTokens(t,e){let n=[];for(const r of t)switch(n=n.concat(e.call(this,r)),r.type){case"table":{for(const s of r.header)n=n.concat(this.walkTokens(s.tokens,e));for(const s of r.rows)for(const i of s)n=n.concat(this.walkTokens(i.tokens,e));break}case"list":{n=n.concat(this.walkTokens(r.items,e));break}default:this.defaults.extensions&&this.defaults.extensions.childTokens&&this.defaults.extensions.childTokens[r.type]?this.defaults.extensions.childTokens[r.type].forEach(s=>{n=n.concat(this.walkTokens(r[s],e))}):r.tokens&&(n=n.concat(this.walkTokens(r.tokens,e)))}return n}use(...t){const e=this.defaults.extensions||{renderers:{},childTokens:{}};return t.forEach(n=>{const r={...n};if(r.async=this.defaults.async||r.async||!1,n.extensions&&(n.extensions.forEach(s=>{if(!s.name)throw new Error("extension name required");if("renderer"in s){const i=e.renderers[s.name];i?e.renderers[s.name]=function(...a){let o=s.renderer.apply(this,a);return o===!1&&(o=i.apply(this,a)),o}:e.renderers[s.name]=s.renderer}if("tokenizer"in s){if(!s.level||s.level!=="block"&&s.level!=="inline")throw new Error("extension level must be 'block' or 'inline'");e[s.level]?e[s.level].unshift(s.tokenizer):e[s.level]=[s.tokenizer],s.start&&(s.level==="block"?e.startBlock?e.startBlock.push(s.start):e.startBlock=[s.start]:s.level==="inline"&&(e.startInline?e.startInline.push(s.start):e.startInline=[s.start]))}"childTokens"in s&&s.childTokens&&(e.childTokens[s.name]=s.childTokens)}),r.extensions=e),n.renderer){const s=this.defaults.renderer||new As(this.defaults);for(const i in n.renderer){const a=s[i];s[i]=(...o)=>{let l=n.renderer[i].apply(s,o);return l===!1&&(l=a.apply(s,o)),l}}r.renderer=s}if(n.tokenizer){const s=this.defaults.tokenizer||new Is(this.defaults);for(const i in n.tokenizer){const a=s[i];s[i]=(...o)=>{let l=n.tokenizer[i].apply(s,o);return l===!1&&(l=a.apply(s,o)),l}}r.tokenizer=s}if(n.hooks){const s=this.defaults.hooks||new rr;for(const i in n.hooks){const a=s[i];rr.passThroughHooks.has(i)?s[i]=o=>{if(this.defaults.async)return Promise.resolve(n.hooks[i].call(s,o)).then(u=>a.call(s,u));const l=n.hooks[i].call(s,o);return a.call(s,l)}:s[i]=(...o)=>{let l=n.hooks[i].apply(s,o);return l===!1&&(l=a.apply(s,o)),l}}r.hooks=s}if(n.walkTokens){const s=this.defaults.walkTokens;r.walkTokens=function(i){let a=[];return a.push(n.walkTokens.call(this,i)),s&&(a=a.concat(s.call(this,i))),a}}this.defaults={...this.defaults,...r}}),this}setOptions(t){return this.defaults={...this.defaults,...t},this}};hs=new WeakSet;Si=function(t,e){return(n,r,s)=>{typeof r=="function"&&(s=r,r=null);const i={...r},a={...this.defaults,...i},o=Ei(this,Qi,Yo).call(this,!!a.silent,!!a.async,s);if(typeof n>"u"||n===null)return o(new Error("marked(): input parameter is undefined or null"));if(typeof n!="string")return o(new Error("marked(): input parameter is of type "+Object.prototype.toString.call(n)+", string expected"));if(Zm(a,s),a.hooks&&(a.hooks.options=a),s){const l=a.highlight;let u;try{a.hooks&&(n=a.hooks.preprocess(n)),u=t(n,a)}catch(h){return o(h)}const d=h=>{let f;if(!h)try{a.walkTokens&&this.walkTokens(u,a.walkTokens),f=e(u,a),a.hooks&&(f=a.hooks.postprocess(f))}catch(v){h=v}return a.highlight=l,h?o(h):s(null,f)};if(!l||l.length<3||(delete a.highlight,!u.length))return d();let m=0;this.walkTokens(u,h=>{h.type==="code"&&(m++,setTimeout(()=>{l(h.text,h.lang,(f,v)=>{if(f)return d(f);v!=null&&v!==h.text&&(h.text=v,h.escaped=!0),m--,m===0&&d()})},0))}),m===0&&d();return}if(a.async)return Promise.resolve(a.hooks?a.hooks.preprocess(n):n).then(l=>t(l,a)).then(l=>a.walkTokens?Promise.all(this.walkTokens(l,a.walkTokens)).then(()=>l):l).then(l=>e(l,a)).then(l=>a.hooks?a.hooks.postprocess(l):l).catch(o);try{a.hooks&&(n=a.hooks.preprocess(n));const l=t(n,a);a.walkTokens&&this.walkTokens(l,a.walkTokens);let u=e(l,a);return a.hooks&&(u=a.hooks.postprocess(u)),u}catch(l){return o(l)}}};Qi=new WeakSet;Yo=function(t,e,n){return r=>{if(r.message+=`
Please report this to https://github.com/markedjs/marked.`,t){const s="<p>An error occurred:</p><pre>"+ue(r.message+"",!0)+"</pre>";if(e)return Promise.resolve(s);if(n){n(null,s);return}return s}if(e)return Promise.reject(r);if(n){n(r);return}throw r}};var qt=new ef;function W(t,e,n){return qt.parse(t,e,n)}W.options=W.setOptions=function(t){return qt.setOptions(t),W.defaults=qt.defaults,Uo(W.defaults),W};W.getDefaults=qi;W.defaults=Jt;W.use=function(...t){return qt.use(...t),W.defaults=qt.defaults,Uo(W.defaults),W};W.walkTokens=function(t,e){return qt.walkTokens(t,e)};W.parseInline=qt.parseInline;W.Parser=st;W.parser=st.parse;W.Renderer=As;W.TextRenderer=Ki;W.Lexer=rt;W.lexer=rt.lex;W.Tokenizer=Is;W.Slugger=Zi;W.Hooks=rr;W.parse=W;W.options;W.setOptions;W.use;W.walkTokens;W.parseInline;st.parse;rt.lex;const tf=["innerHTML"],nf={__name:"Markdown",props:{content:{type:String,required:!1,default:"# Headline  <p>Hello World</p>"},fontFamily:{type:String,required:!1,default:null}},setup(t){const e=t;W.use({mangle:!1});const n=$a(()=>W(e.content));return(r,s)=>(y(),C("div",{class:"wb-env-atom-markdown",innerHTML:n.value},null,8,tf))}},Xo=j(nf,[["__scopeId","data-v-9d25c83d"]]);const rf={components:{WbMarkdown:Xo},props:{...ct,type:{type:String,default:null},content:{type:[String,Array],default:null}},emits:[...ut],setup(t,e){return lt(t,e)},data(){return{lines:[]}},mounted(){this.type==="basic"&&window.requestAnimationFrame(()=>{this.lines=[],this.core.modules.parser.parseBasic(this.content,async(t,e)=>{const n=await this.core.executeCommand(t,e);return e.message&&this.lines.push(Z(e.message)),n})})}},sf={class:"wb-module-files-preview"},af={key:0,class:"basic"},of=["innerHTML"],lf=["src"];function cf(t,e,n,r,s,i){const a=R("wb-markdown");return y(),C("div",sf,[n.type==="basic"?(y(),C("ul",af,[(y(!0),C(Et,null,St(s.lines,(o,l)=>(y(),C("li",{key:l},Ce(o),1))),128))])):B("",!0),n.type==="markdown"?(y(),U(a,{key:1,content:n.content},null,8,["content"])):B("",!0),n.type==="html"?(y(),C("div",{key:2,innerHTML:n.content},null,8,of)):B("",!0),n.type==="image"?(y(),C("img",{key:3,src:n.content},null,8,lf)):B("",!0)])}const uf=j(rf,[["render",cf],["__scopeId","data-v-869a66b7"]]);async function df(t,e,n){const r=await t.executeCommand(`exist "${e}"`);let s=!1;r&&(s=await t.executeCommand('openDialog "File exist, overwrite?" --confirm'));const i=[`makefile "${e}"`];return n&&i.push(`--data="${n}"`),s?i.push("--override"):i.push("--ignore"),t.executeCommand(i.join(" "))}async function hf(t,e){const n=await t.modules.files.fs.get(e),r=await t.executeCommand(`readfile "${e}"`);return{fsItem:n,value:r}}const mf=({module:t,core:e})=>{const n=e.modules.windows,{fileSystem:r}=t;return[{name:"openPreview",args:[new x({index:0,name:"path",description:"Path to the file"}),new x({name:"maximized",description:"If set, window is maximized."})],async action({path:s,maximized:i}){const a=await r.get(s),{type:o,content:l,openMaximized:u}=a.data;o==="basic"&&!a.data[us.HAS_WINDOW_OUTPUT]?await e.modules.parser.parseBasic(l,async(d,m)=>await e.executeCommand(d,m)):n.addWindow({title:a.name,component:uf,componentData:{type:o,content:l},options:{scale:!0,scrollX:!0,scrollY:!0},layout:{size:O(420,360)}},{full:u||i||!1})}},{name:"saveFileDialog",args:[new x({index:0,name:"data",description:"File Content"}),new x({index:1,name:"id",description:"File Id"}),new x({index:2,name:"extension",description:"File Extension"})],action({data:s,id:i,extension:a}){const o=n.addWindow({title:"Save File",component:Nm,componentData:{fsItem:z(r.root),id:i},options:{scale:!1,scrollX:!1,scrollY:!1}});return new Promise(l=>{o.events.pipe(lr(({name:u})=>u==="close")).subscribe(async({name:u,value:d})=>{if(d){const m=bs(d,a);d=await df(e,m,s)}l(d)})})}},{name:"openFileDialog",args:[],action({data:s}){const i=n.addWindow({title:"Open File",component:$m,componentData:{fsItem:z(r.root)},options:{scale:!1,scrollX:!1,scrollY:!1}});return new Promise(a=>{i.events.pipe(lr(({name:o})=>o==="close")).subscribe(({name:o,value:l})=>{l&&(l=hf(e,l)),a(l)})})}},{name:"fileinfo",description:"Get info from File or Directory",args:[new x({index:0,name:"path",description:"Path to the file"}),new x({index:1,name:"name",description:"Name from the Info"}),new x({index:2,name:["list","ls"],flag:!0,description:"List all Infos"})],async action({path:s,name:i,list:a},o){const l=await r.itemMeta(s,i,a);if(Array.isArray(l)){const u=new jt;u.addColumn({value:"Name",align:"left",minWidth:20}),u.addColumn({value:"Value",align:"left",minWidth:20}),u.addRow(l.map(d=>{let m=d.value;return Array.isArray(m)&&(m=m.join(" ")),[d.name,m]})),o.message([u])}return l}},{name:["info","i"],args:[new x({index:0,name:"path",description:"Path to the file"})],async action({path:s},i){let a=r.root;s&&(a=await r.get(s)),a instanceof H||(a=a.parent);let o=await a.getItems();const l=new jt;l.addColumn([{value:"Unit",align:"left",minWidth:8},{value:"Size",align:"right",minWidth:6},{value:"Used",align:"right",minWidth:6},{value:"Free",align:"right",minWidth:6},{value:"Full",minWidth:4},{value:"Errs",align:"center",minWidth:4},{value:"Status",align:"center",minWidth:10},{value:"Name",align:"right",minWidth:14}]),o=Array.from(o.values()).filter(d=>d instanceof ot),l.addRow(o.map(d=>{let m=0;return(d.size>0||d.maxSize>0)&&(m=parseInt(d.size/d.maxSize*100)),[`${d.id}:`,er(d.maxSize),er(d.size),er(d.maxSize-d.size),`${m}%`,"0",d.locked?"Read":"Read/Write",`${d.name||""}`]}));const u=["","Mounted disks:",l,"","Volumes available:"];o.forEach(d=>{u.push(`${d.name}: [Mounted]`)}),u.push(""),i.message(u)}},{name:["list","ls"],args:[new x({index:0,name:"path",description:"Path to the file"}),new x({name:"dir-size",flag:!0,description:"Show Directory Size."})],async action({path:s,dirSize:i},a){let o=r.currentItem;s&&(o=await r.get(s));const l=Array.from((await o.getItems()).values()),u=new jt;u.addColumn({value:"Name",align:"left",minWidth:13}),u.addColumn({value:"Size",align:"right",minWidth:8}),u.addColumn({value:"Access",align:"center",minWidth:12}),u.addColumn({value:"Date / Time",align:"center",minWidth:18}),u.addRow(l.reduce((h,f)=>{let v;f instanceof H&&!i?v="DIR":v=mi(er(f.size),8,!0,"0");const _=f.isLocked()?"Read":"Read/Write";return h.push([`${f.id}:`,v,_,f.createdDate?fi("D-mm-y H:I:S",f.createdDate):""]),h},[]));const d=l.reduce((h,f)=>(f instanceof It&&h++,h),0),m=l.reduce((h,f)=>(h+=f.size,h),0);return a.message([u,`${l.length} files - ${d} directories - ${m} blocks used`]),Promise.resolve()}}]};const ff={components:{WbForm:$n,WbButton:kt,WbButtonWrapper:Tt,WbFormFieldTextbox:es,WbFormFieldDropdown:ji,WbFormFieldCheckboxGroup:$o},props:{...ct,fsItem:{type:Object,default(){return null}},model:{type:Object,default(){return{actions:{save(){}},id:null,name:null,symbol:null,visible:!1}}}},emits:[...ut,"close"],setup(t,e){return lt(t,e)},data(){const t=this.fsItem.locked;return{cancelLabel:"Cancel",saveLabel:"Save",fields:{id:{disabled:t,label:"Id",name:"id"},name:{disabled:t,label:"Name",name:"name"},checkboxes:{disabled:t,label:"Others",name:null,items:[{label:"Symbol Visible",name:b.VISIBLE},{label:"Ignore Symbol Rearrange ",name:b.IGNORE_SYMBOL_REARRANGE}]},windowSettings:{disabled:t,label:"Window Settings",name:null,items:[{label:"Has Scale ?",name:b.WINDOW_SCALE},{label:"Has Scroll-X ?",name:b.WINDOW_SCROLL_X},{label:"Has Scroll-Y ?",name:b.WINDOW_SCROLL_Y},{label:"Is Full-Size ?",name:b.WINDOW_FULL_SIZE},{label:"Sort Symbols (Directory)",name:b.WINDOW_SYMBOL_REARRANGE},{label:"Has Sidebar?",name:b.WINDOW_SIDEBAR}]},symbol:{disabled:t,label:"Symbol",name:"symbol",options:Object.keys(w).map(e=>({title:ja(e),value:w[String(e)]}))}}}},methods:{onClickCancel(){this.$emit("close")},async onSubmit(){this.locked||await this.model.actions.save(this.model,this.fsItem),this.$emit("close")}}},pf={class:"wb-module-files-edit"},gf={class:"cols"},_f={class:"col-2"},bf={class:"col-2"};function yf(t,e,n,r,s,i){const a=R("wb-form-field-textbox"),o=R("wb-form-field-dropdown"),l=R("wb-form-field-checkbox-group"),u=R("wb-button"),d=R("wb-button-wrapper"),m=R("wb-form");return y(),C("div",pf,[N(m,{class:"form",onSubmit:i.onSubmit},{default:Y(()=>[S("div",null,[N(a,V(s.fields.id,{model:n.model}),null,16,["model"]),N(a,V(s.fields.name,{model:n.model}),null,16,["model"]),N(o,V(s.fields.symbol,{model:n.model}),null,16,["model"]),S("div",gf,[S("div",_f,[N(l,V(s.fields.checkboxes,{model:n.model}),null,16,["model"])]),S("div",bf,[N(l,V(s.fields.windowSettings,{model:n.model}),null,16,["model"])])])]),N(d,{align:"outer",full:""},{default:Y(()=>[s.cancelLabel?(y(),U(u,{key:0,"style-type":"secondary",label:s.cancelLabel,onClick:i.onClickCancel},null,8,["label","onClick"])):B("",!0),s.saveLabel?(y(),U(u,{key:1,"style-type":"primary",label:s.saveLabel,type:"submit"},null,8,["label"])):B("",!0)]),_:1})]),_:1},8,["onSubmit"])])}const wf=j(ff,[["render",yf],["__scopeId","data-v-5d011381"]]);const xf={components:{WbForm:$n,WbButton:kt,WbButtonWrapper:Tt,WbFormFieldTextbox:es,WbFormFieldDropdown:ji},props:{...ct,fsItem:{type:Object,default(){return null}},model:{type:Object,default(){return{actions:{save:()=>{}},name:null,url:null,symbol:null}}}},emits:[...ut,"close"],setup(t,e){return lt(t,e)},data(){const t=(this.fsItem||{}).locked;return{cancelLabel:"Cancel",saveLabel:"Save",fields:{name:{disabled:t,placeholder:"Name",label:"Name",name:"name"},url:{disabled:t,placeholder:"http://",label:"Url",name:"url"},symbol:{disabled:t,label:"Symbol",name:"symbol",options:Object.keys(w).map(e=>({title:ja(e),value:w[String(e)]}))}}}},computed:{disabledSave(){return!this.model.name||!this.model.url||!this.model.symbol}},methods:{onClickCancel(){this.$emit("close")},async onSubmit(){await this.model.actions.save(this.model,this.fsItem)&&this.$emit("close")}}},vf={class:"wb-module-files-web-link"};function Ef(t,e,n,r,s,i){const a=R("wb-form-field-textbox"),o=R("wb-form-field-dropdown"),l=R("wb-button"),u=R("wb-button-wrapper"),d=R("wb-form");return y(),C("div",vf,[N(d,{onSubmit:i.onSubmit},{default:Y(()=>[N(a,V(s.fields.name,{model:n.model}),null,16,["model"]),N(a,V(s.fields.url,{model:n.model,type:"url"}),null,16,["model"]),N(o,V(s.fields.symbol,{model:n.model}),null,16,["model"]),N(u,{align:"outer",full:""},{default:Y(()=>[s.cancelLabel?(y(),U(l,{key:0,"style-type":"secondary",label:s.cancelLabel,onClick:i.onClickCancel},null,8,["label","onClick"])):B("",!0),s.saveLabel?(y(),U(l,{key:1,"style-type":"primary",label:s.saveLabel,type:"submit",disabled:i.disabledSave},null,8,["label","disabled"])):B("",!0)]),_:1})]),_:1},8,["onSubmit"])])}const Ra=j(xf,[["render",Ef],["__scopeId","data-v-f8ae51c0"]]);const Sf={components:{},props:{...ct,fsItem:{type:Object,default(){return null}}},emits:[...ut],setup(t,e){return lt(t,e)},computed:{meta(){return Array.from(this.fsItem.meta).map(([t,e])=>{if(typeof e=="object")try{e=JSON.stringify(e)}catch{}return{title:t,value:e}})},items(){return[{title:"Id",value:this.fsItem.id},{title:"Name",value:this.fsItem.name},{title:"Type",value:this.fsItem.constructor.NAME},{title:"Path",value:this.fsItem.getPath()},{title:"Size",value:er(this.fsItem.size)},{title:"Locked",value:this.fsItem.locked?"Yes":"No"},{title:"Created Date",value:`<nobr>${fi("H:I:S D.M.Y",this.fsItem.createdDate)}</nobr>`},{title:"Modified Date",value:`<nobr>${fi("H:I:S D.M.Y",this.fsItem.editedDate)}</nobr>`}]}}},If=t=>(Ai("data-v-101cab4d"),t=t(),Oi(),t),Af={class:"wb-module-files-info"},Of=["innerHTML"],kf=If(()=>S("legend",null,"Meta:",-1)),Tf=["innerHTML"];function Rf(t,e,n,r,s,i){return y(),C("div",Af,[S("table",null,[(y(!0),C(Et,null,St(i.items,({title:a,value:o},l)=>(y(),C("tr",{key:l},[S("td",null,Ce(a)+":",1),S("td",{innerHTML:o},null,8,Of)]))),128))]),S("fieldset",null,[kf,S("table",null,[(y(!0),C(Et,null,St(i.meta,({title:a,value:o},l)=>(y(),C("tr",{key:l},[S("td",null,Ce(a)+":",1),S("td",{innerHTML:o},null,8,Tf)]))),128))])])])}const Df=j(Sf,[["render",Rf],["__scopeId","data-v-101cab4d"]]),Cf=({core:t})=>{const{windows:e,symbols:n}=t.modules,r=Ne({open:{disabled:!1},edit:{disabled:!1},duplicate:{disabled:!1},container:{disabled:!1},emptyTrashcan:{disabled:!1},discard:{disabled:!1},info:{disabled:!1},webLink:{disabled:!1},webLinkNew:{disabled:!1},webLinkEdit:{disabled:!1}});function s(){const m=n.getSelectedItems(),h=n.getPrimaryWrapper();r.info.disabled=m.length<1,r.open.disabled=m.length<1,r.edit.disabled=m.length<1||m.find(f=>f.locked||f instanceof Re),r.duplicate.disabled=m.length<1||m.find(({fsItem:f})=>f.locked||f instanceof Re||f instanceof ot),r.container.disabled=!r.open.disabled||h&&h.fsItem&&(h.fsItem instanceof Hi||h.fsItem.locked)||!h,r.webLinkEdit.disabled=m.length<1||m.find(f=>!f.fsItem.meta.get(b.WEB_URL)),r.webLinkNew.disabled=r.container.disabled,r.webLink.disabled=r.webLinkNew.disabled&&r.webLinkEdit.disabled,r.emptyTrashcan.disabled=m.length<1||m.find(f=>!(f.fsItem instanceof Re)),r.discard.disabled=m.length<1||m.find(({fsItem:f})=>f.locked||f instanceof Re||f instanceof ot)}return n.events.subscribe(()=>s()),s(),[{order:1,title:"File",items:[{title:"Open",options:r.open,action:i},{title:"Edit",options:r.edit,action:u},{separator:!0},{title:"Web Link",options:r.webLink,items:[{title:"New",options:r.webLinkNew,action:o},{title:"Edit",options:r.webLinkEdit,action:l}]},{separator:!0},{title:"Duplicate",options:r.duplicate,action(){const m=n.getSelectedItems();return Promise.all(m.filter(h=>h.fsItem).map(async({fsItem:h})=>{const f=await h.getPath();return t.executeCommand(`copy "${f}" "${f}" -ignore`)}))}},{title:"Make Dir",options:r.container,async action(){const m=n.getPrimaryWrapper().fsItem,h=Fi(await m.getPath(),"Directory");return console.log(`makedir "${h}" -ignore`),t.executeCommand(`makedir "${h}" -ignore`)}},{separator:!0},{title:"Discard",options:r.discard,action(){const m=n.getSelectedItems();return Promise.all(m.filter(h=>h.fsItem).map(async({fsItem:h})=>{const f=await h.getPath();return t.executeCommand(`remove "${f}" -r`)}))}},{title:"Empty Trashcan",options:r.emptyTrashcan,action(){const m=n.getSelectedItems();return Promise.all(m.filter(h=>h.fsItem).map(async({fsItem:h})=>Promise.all(Array.from((await h.getItems()).values()).map(async f=>{const v=await f.getPath();return t.executeCommand(`remove "${v}" -r -ignore`)}))))}},{separator:!0},{title:"Info",options:r.info,action(){n.getSelectedItems().filter(h=>h.fsItem).forEach(h=>{e.addWindow({title:`Info File ${h.fsItem.name}`,component:Df,componentData:{fsItem:z(h.fsItem)},layout:{size:O(460,280)},options:{scale:!0,prompt:!1,scrollX:!0,scrollY:!0}})})}}]}];function i(){n.getSelectedItems().filter(h=>h.fsItem).forEach(h=>{if(h.command){const f={showCommand:!1,show:!0};return t.executeCommand(h.command,f)}})}async function a({name:m,url:h,symbol:f},v){if(v||(v=await t.executeCommand(`saveFileDialog --id="${So(m)}"`)),v){const _=t.addExecution();try{const E=v.getPath();await t.executeCommand(`rename "${E}" "${m}" -n`),await t.executeCommand(`editfilemeta "${E}" "${b.WEB_URL}" "${h}"`),await t.executeCommand(`editfilemeta "${E}" "${b.SYMBOL}" "${f}"`)}catch(E){throw _(),new Error(E)}return _(),!0}return!1}function o(){const m=e.addWindow({title:"Make Link",component:Ra,componentData:{model:{actions:{save:a},name:null,url:null,symbol:null}},options:{scale:!1,prompt:!1,scrollX:!1,scrollY:!1}});return new Promise(h=>{m.events.pipe(lr(({name:f})=>f==="close")).subscribe(h)})}function l(){n.getSelectedItems().filter(h=>h.fsItem).forEach(h=>{const f=h.fsItem;e.addWindow({title:"Edit Link",component:Ra,componentData:{fsItem:f,model:{actions:{save:a},name:f.name,url:f.meta.get(b.WEB_URL),symbol:f.meta.get(b.SYMBOL)}},options:{scale:!1,prompt:!1,scrollX:!1,scrollY:!1}})})}function u(){n.getSelectedItems().filter(h=>h.fsItem).forEach(h=>{const f=h.fsItem,v=Ne({actions:{save:d},id:f.id,name:f.name});[b.SYMBOL,b.VISIBLE,b.IGNORE_SYMBOL_REARRANGE,b.WINDOW_SCALE,b.WINDOW_SCROLL_X,b.WINDOW_SCROLL_Y,b.WINDOW_FULL_SIZE,b.WINDOW_SYMBOL_REARRANGE,b.WINDOW_SIDEBAR].forEach(_=>{v[String(_)]=f.meta.has(_)?f.meta.get(_):!1}),e.addWindow({title:`Edit File ${f.name}`,component:wf,componentData:{fsItem:z(f),model:v},options:{scale:!1,prompt:!1,scrollX:!1,scrollY:!1}})})}async function d(m,h){const{id:f,name:v}=m,_=h.getPath();if(!f)throw new Error("Id is emoty!");let E;const L=t.addExecution();try{await Promise.all([b.SYMBOL,b.VISIBLE,b.IGNORE_SYMBOL_REARRANGE,b.WINDOW_SCALE,b.WINDOW_SCROLL_X,b.WINDOW_SCROLL_Y,b.WINDOW_FULL_SIZE,b.WINDOW_SYMBOL_REARRANGE,b.WINDOW_SIDEBAR].map(T=>{let M=m[String(T)];return typeof M=="string"&&(M=`"${M}"`),t.executeCommand(`editfilemeta "${_}" "${T}" ${M}`)})),v&&f!==v?await t.executeCommand(`rename "${_}" "${v}" -n`):E=t.executeCommand(`rename "${_}" "${f}" -rn`),E=t.executeCommand(`rename "${_}" "${f}"`)}catch(T){throw L(),new Error(T)}return L(),E}},Nf=({module:t})=>{const{fileSystem:e}=t,n=t.core;return[{name:["mountDisk"],description:"Mount Disk",args:[new x({index:0,name:"id",description:"Disk ID"})],async action({id:r},s){const i=n.addExecution(),o=await(await await k(()=>import("./index.c2b1ce9f.js"),["./index.c2b1ce9f.js","./entry.42952971.js"],import.meta.url).then(u=>u.default))(r),l=await e.addFloppyDisk(o({core:n}));s.message(`Mount Disk <strong>${l.name}</strong> <strong>(${l.id})</strong> successful!`),i()}},{name:["changeDirectory","cd"],description:"cd %path%",args:[new x({index:0,name:"path",description:"Directory path"})],async action({path:r}){if(!r)throw P.get("bad_args");try{await e.changeDirectory(r)}catch{throw P.get("cant_find",r)}}},{name:["exist"],description:"Check if file exists.",args:[new x({index:0,name:"path",description:"Filename"})],async action({path:r},s){if(!r)throw P.get("bad_args");const i=Oe(r),a=await e.exist(r);return a?s.message(`File ${i} exists`):s.message(`File ${i} does not exist`),a}},{name:["makedir","mkdir"],args:[new x({index:0,name:"path",description:"Filename"}),new x({index:1,name:"name",description:"Name"}),new x({name:"ignore",flag:!0,description:"Ignore file exist."})],async action({path:r,name:s,ignore:i},a){if(!r)throw P.get("bad_args");const o=await e.makedir(r,s||Oe(r),{ignore:i});return a.message(`Directory "${o.name}" created`),o}},{name:["remove","rm"],args:[new x({index:0,name:"path",description:"Filename"}),new x({name:["recursive","r"],flag:!0,description:"Remove Directory Items and Directories."}),new x({name:["ignore"],flag:!0,description:"Ignore the specified file is deleted."})],async action({path:r,recursive:s,ignore:i},a){if(!r)throw P.get("bad_args");const o=await e.remove(r,s,{ignore:i});return[].concat(o).map(l=>{const u=l.type===It.NAME?"Directory":"File";return a.message(`Removed ${u}: ${l.name}`),l})}},{name:["readfile","getfile"],description:"Get file content",args:[new x({index:0,name:"path",description:"Filename"})],async action({path:r},s){if(!r)throw P.get("bad_args");return(await e.get(r)).data}},{name:["makefile","mkfile"],description:"Creates a file with the specified attributes.",args:[new x({index:0,name:"path",description:"Filename"}),new x({index:1,name:"name",description:"Name"}),new x({index:3,name:"data",description:"Data"}),new x({name:"override",flag:!0,description:"Deletes existing file and recreates."})],async action({path:r,name:s,data:i,override:a=!1,encode:o},l){if(!r)throw P.get("bad_args");typeof i=="string"&&(i=await ui(i));const u=await e.makefile(r,s,i,{override:a});return l.message(`File "${u.name}" created`),u}},{name:["editfile"],description:"Edits file with specified attributes.",args:[new x({index:0,name:"path",description:"Filename"}),new x({index:1,name:"data",description:"Data"})],async action({path:r,data:s},i){if(!r)throw P.get("bad_args");typeof s=="string"&&(s=await ui(s));const a=await e.editfile(r,s);return i.message(`File "${a.name}" edited`),a}},{name:["editfilemeta"],description:"Edits file with specified attributes.",args:[new x({index:0,name:"path",description:"Filename"}),new x({index:1,name:"name",description:"Name"}),new x({index:2,name:"value",description:"Value"})],async action({path:r,name:s,value:i},a){if(!r)throw P.get("bad_args");const o=await e.editfileMeta(r,s,i);return a.message(`File  "${o.name}" Meta edited`),o}},{name:["makelink","mklink"],description:"Creates a link to the specified path.",args:[new x({index:0,name:"ref",description:"Reference path with id (example.ext)."}),new x({index:1,name:"name",description:"Displayed Name"}),new x({index:2,name:"dest",description:"Destination directory."})],async action({ref:r,name:s,dest:i},a){if(!r)throw P.get("bad_args");i=i||".";const o=await e.get(r),l=await e.makelink(o,s);return await e.get(i)!==e.currentItem&&await e.move(l,i,{ignore:!0}),a.message(`Created link "${s}" with "${await o.getPath()}"`),l}},{name:["editlink"],description:"",args:[new x({index:0,name:"path",description:"Reference filepath with id (example.ext)."}),new x({index:1,name:"ref",description:"Destination directory."})],async action({path:r,ref:s},i){if(!(r&&s))throw P.get("bad_args");const a=await e.get(s),o=await e.editlink(r,a);return i.message(`Edited link "${name}" with "${await a.getPath()}"`),o}},{name:"rename",description:"Renamed a file",args:[new x({index:0,name:"path",description:"Filepath with id (example.ext)."}),new x({index:1,name:"value",description:"Value for id or displayed name."}),new x({name:["name","n"],flag:!0,description:"When set, changes the display name."}),new x({name:["removeName","rn"],flag:!0,description:"When set, removes the display name."})],async action({path:r,value:s,name:i,removeName:a},o){if(!a&&(!r||!s))throw P.get("bad_args");const l=await e.get(r),u=i?l.name:l.id;return await e.rename(r,s,{name:i,removeName:a}),o.message(`Renamed from "${u}" to "${s}"`),l}},{name:["cp","copy"],args:[new x({index:0,name:"from",description:"Source Filepath with id (example.ext)."}),new x({index:1,name:"dest",description:"Destination Filepath with id (example.ext)."}),new x({name:["ignore","i"],flag:!0,description:"When sets, creates a new file if exists."})],async action({from:r,dest:s,ignore:i},a){let o=s;if(!o&&i&&(o=r),!o||!r)throw P.get("bad_args");const l=await e.copy(r,o,{ignore:i});return a.message(`Copied from "${r}" to "${o}"`),l}},{name:["mv","move"],description:"move %from% %to%",args:[new x({index:0,name:"from",description:"From path"}),new x({index:1,name:"to",description:"To path"}),new x({index:2,name:"item-position",description:"Sets the position in the Icon view. (x,y)"})],async action({from:r,to:s,itemPosition:i},a){if(!s||!r)throw P.get("bad_args");const o=new Map;i&&o.set("itemPosition",[0,0].map((d,m)=>{const h=i.split(",");return parseInt(h[Number(m)]||0)}));const l=await e.move(r,s,{meta:o});let u;return l instanceof It?u="Directory":u="File",a.message(`${u} moved ${l.name}`),l}},{name:["executeFile"],description:"Execute file.",args:[new x({index:0,name:"path",description:"Path to the file"})],async action({path:r},s){if(!r)throw P.get("bad_args");const i=await e.get(r);if(typeof i.action=="function")return i.action(n);throw P.get("cant_find_action",r)}}]};P.add("cant_find_action","Can't find action %1");var jr,Ma;const Lf=new(Ma=class{constructor(){g(this,jr,void 0)}get(){return c(this,jr)||A(this,jr,(()=>this.getImports())())}getImports(){return Promise.all([k(()=>import("./index.esm.b7162a5d.js"),["./index.esm.b7162a5d.js","./index.esm2017.f7924fe5.js","./entry.42952971.js"],import.meta.url),k(()=>import("./index.esm.20215942.js"),["./index.esm.20215942.js","./index.esm2017.f7924fe5.js","./entry.42952971.js","./index.26bb4b3d.js"],import.meta.url),k(()=>import("./index.esm.5cd0610d.js"),["./index.esm.5cd0610d.js","./entry.42952971.js","./index.esm2017.f7924fe5.js"],import.meta.url)]).then(([e,n,r])=>({app:e.default||e,auth:n.default||n,database:r.default||r}))}},jr=new WeakMap,Ma),Qs=new Map;class Pf{constructor(){p(this,"services");p(this,"app");p(this,"firebase")}get name(){return this.app.name}async connect(e,{apiKey:n,url:r}){if(this.services=await Lf.get(),this.firebase=this.services.app,this.app)Qs.has(e)&&(this.app=Qs.get(e));else{const s=this.services.app.initializeApp({apiKey:n,databaseURL:r},e);Qs.set(s.name,s),this.app=s}return this.app}async disconnect(){if(!this.app)throw P.get("FirebaseWrapper_noApp");Hn(this),await this.logout(),await this.services.app.deleteApp(this.app),this.app=null}get locked(){return!!this.app&&!this.isLogged()}get currentUser(){const{getAuth:e}=this.services.auth;return e(this.app).currentUser}isLogged(){return!!this.app&&!!this.currentUser}login(e,n){const{getAuth:r,signInWithEmailAndPassword:s}=this.services.auth,i=r(this.app);return Hn(this),s(i,e,n)}logout(){if(this.app){const{getAuth:e,signOut:n}=this.services.auth,r=e(this.app);return n(r)}else throw P.get("FirebaseWrapper_notConnected")}remove(e){Hn(this);const{remove:n,ref:r,getDatabase:s}=this.services.database,i=s(this.app),a=r(i,e);return n(a)}get(e){Hn(this);const{ref:n,onValue:r,getDatabase:s}=this.services.database,i=s(this.app),a=n(i,e);return new Promise(o=>{r(a,l=>o(l.val()))})}async set(e,n){Hn(this);const{ref:r,set:s,getDatabase:i}=this.services.database,a=i(this.app),o=r(a,e);return await s(o,n),n}}function Hn(t){if(!t.app)throw P.get("FirebaseWrapper_notConnected")}P.add([["FirebaseWrapper_notConnected",["Not connected","Not connected"]],["FirebaseWrapper_noApp",["No app available","No app available"]],["FirebaseWrapper_hasApp",["App already available",'App "%1" already available']]]);class Mf extends Po{constructor(e){e=Object.assign({storage:new Pf},e),super(e)}mount(e){return e.onDisconnect=()=>{this.unmount()},this.storage.connect(e.id,e).then(()=>this)}unmount(){return this.storage.disconnect().then(()=>this)}async load(){try{let e=await this.storage.get(this.name);return!e&&(e={},!this.storage.locked)?this.storage.set(this.name,e).then(n=>n):(this.data=e,e)}catch(e){throw new Error(e)}}save(e){return e=qo(e),this.data=e||this.data,this.storage.set(this.name,e).then((n,r)=>this.data)}get locked(){return this.storage.locked}}function qo(t){return Object.keys(t).reduce((e,n)=>{const r=e[String(n)];return r&&typeof r=="object"&&qo(r),(r==null||r==="")&&delete e[String(n)],e},t)}const Yn=new Map,$f=({module:t,core:e})=>{const{fileSystem:n}=t;return[{name:"cloudList",args:[new x({name:"json",flag:!0,description:"Get JSON Export"})],action({json:r},s){const i=Array.from(Yn.values());if(r)return Promise.resolve(i);{const a=new jt;return a.addColumn({value:"Storage (Id)",align:"left",minWidth:15}),a.addColumn({value:"Name",align:"left",minWidth:15}),a.addColumn({value:"Logged In",align:"center",minWidth:9}),a.addRow(i.reduce((o,l)=>(o.push([l.id,l.name,l.storage.storage.isLogged()?"yes":"no"]),o),[])),s.message([a]),Promise.resolve()}}},{name:"cloudMount",args:[new x({index:0,name:"id",flag:!0,description:"Id from Storage."}),new x({index:1,name:"apiKey",description:"Firebase Api-Key."}),new x({index:2,name:"url",description:"Firebase Database-Url."})],async action({id:r,apiKey:s,url:i},a){if(!s||!i)throw P.get("bad_args");const o=e.addExecution(),l=await n.connect(Mf,{id:r,apiKey:s,url:i});return Yn.set(l.id,l),a.message(`Mount <strong>${l.name}</strong> <strong>(${l.id})</strong> successful!`),o(),l}},{name:"cloudUnmount",args:[new x({index:0,name:"id",flag:!0,description:"Id from Storage."})],async action({id:r},s){if(!r)throw P.get("bad_args");const i=e.addExecution();try{const a=Yn.get(r);await n.disconnect(a),Yn.delete(a.id),s.message(`Unmount "${a.name}" successful!`),i()}catch(a){throw i(),new Error(a)}}},{name:"cloudAuth",args:[new x({name:"login",flag:!0,description:"Storage Login"}),new x({name:"logout",flag:!0,description:"Logout from Storage."}),new x({name:"email",description:"Email for Login."}),new x({name:"password",description:"Password for Login."}),new x({name:"storage",description:"Specifies which drive is logged on."})],async action({email:r,password:s,storage:i,login:a,logout:o},l){const u=i;if(!u)throw P.get("bad_args");const d=e.addExecution(),m=Yn.get(u);let h;if(m)try{if(a){if(!r||!s)throw P.get("bad_args");h=await m.storage.storage.login(r,s),l.message(`Login with ${m.id} (${m.id}) successful!`)}else o&&(h=await m.storage.storage.logout(),l.message(`Logout from ${m.id} (${m.id}) successful!`))}catch(f){switch(d(),f.code){case"auth/user-not-found":case"auth/wrong-password":return f}throw new Error(f)}else throw new Error(`${u} is not mounted.`);return d(),h}}]},Da=new Ge("web_workbench_FS");class Ko extends Ws{constructor({core:e}){super({commands:(...n)=>[...mf(...n),...Nf(...n),...$f(...n)],contextMenu:Cf,core:e})}get fileSystem(){return Da}get fs(){return Da}}p(Ko,"NAME","Files");class Wf{constructor(e){p(this,"defaultItems",new Xt);p(this,"activeItems");p(this,"core",null);this.core=e,this.activeItems=this.defaultItems}addDefaultItems(e){this.defaultItems.add(e)}getActiveItems(){return this.activeItems}setActiveItems(e){return this.activeItems=e||this.defaultItems}}const Ff={components:{AtomMarkdown:Xo},props:{...ct},emits:[...ut],setup(t,e){const n=gl().versions;return{...lt(t,e),versions:n}},data(){return{content:`# Web-Workbench 1.3
<nobr>Created by Thorn-Welf Walli</nobr><br>Email: lammpee@gmail.com<br>Homepage: [lammpee.de](https://lammpee.de)<br><br>Version: <strong>${this.core.version}</strong><br>Nuxt: <strong>${this.versions.nuxt}</strong><br>Vue: <strong>${this.versions.vue}</strong>`}}},zf={class:"wb-module-core-info"};function Bf(t,e,n,r,s,i){const a=R("atom-markdown");return y(),C("div",zf,[N(a,{content:s.content},null,8,["content"])])}const Vf=j(Ff,[["render",Bf],["__scopeId","data-v-f4ec2acb"]]),Uf=({core:t})=>{const{windows:e}=t.modules;return[{order:0,title:"Web-Workbench",items:[{title:"Settings",action(){return t.executeCommand("openSettings")}},{separator:!0},{hotKey:"I",keyCode:73,title:"Info",action(){e.addWindow({title:"Info",component:Vf,componentData:{},options:{scale:!1,prompt:!1,scrollX:!1,scrollY:!1}})}},{separator:!0},{title:"Imprint",action(){return t.executeCommand('execute "Imprint.md"')}},{title:"Disclaimer",action(){return t.executeCommand('execute "Disclaimer.md"')}}]}]},Xn={CENTER:0,ORDER_HORIZONTAL:1,ORDER_VERTICAL:2,ORDER_DIAGONAL_LEFT:3,ORDER_DIAGONAL_RIGHT:4,SPLIT_HORIZONTAL:5,SPLIT_VERTICAL:6},Ii={SHOW_STORAGE_SPACE:"windowsShowStorageSpace"},jf={[Ii.SHOW_STORAGE_SPACE]:!0},Gf=({core:t})=>[{order:10,title:"Window",items:[{type:We.CHECKBOX,title:"Show Disk Space",model:t.config.observable,name:Ii.SHOW_STORAGE_SPACE,action(e){return t.config.set(Ii.SHOW_STORAGE_SPACE,e)}},{separator:!0},{title:"Order",items:[{title:"Center",action(){t.modules.windows.contentWrapper.setWindowPositions(Xn.CENTER)}},{separator:!0},{title:"Diagonal (Left to right)",action(){t.modules.windows.contentWrapper.setWindowPositions(Xn.ORDER_DIAGONAL_RIGHT)}},{title:"Diagonal (Right to left)",action(){t.modules.windows.contentWrapper.setWindowPositions(Xn.ORDER_DIAGONAL_LEFT)}},{separator:!0},{title:"Split (Horizontal)",action(){t.modules.windows.contentWrapper.setWindowPositions(Xn.SPLIT_HORIZONTAL)}},{title:"Split (Vertical)",action(){t.modules.windows.contentWrapper.setWindowPositions(Xn.SPLIT_VERTICAL)}}]}]}],Hf={xmlns:"http://www.w3.org/2000/svg",width:"6",height:"10",viewBox:"0.5 50.5 6 10"},Yf=S("path",{fill:"#020203",d:"M.5 50.5h6v2h-4v2h2v2h-2v4h-2z"},null,-1),Xf=[Yf];function qf(t,e){return y(),C("svg",Hf,Xf)}const Kf={render:qf},Zf={xmlns:"http://www.w3.org/2000/svg",width:"6",height:"10"},Qf=S("path",{d:"M0 10h6V8H2V6h2V4H2V2h4V0H0z"},null,-1),Jf=[Qf];function ep(t,e){return y(),C("svg",Zf,Jf)}const tp={render:ep};const np={components:{SvgStorageBarFull:Kf,SvgStorageBarEmpty:tp},props:{visible:{type:Boolean,default:!0},value:{type:Number,default:.8}},computed:{style(){return{"--bar-height":Math.min(this.value,1)}}}},rp=t=>(Ai("data-v-11422e3b"),t=t(),Oi(),t),sp={class:"icon full"},ip=rp(()=>S("span",{class:"size"},[S("span",{class:"helper"})],-1)),ap={class:"icon empty"};function op(t,e,n,r,s,i){const a=R("svg-storage-bar-full"),o=R("svg-storage-bar-empty");return n.visible?(y(),C("div",{key:0,class:"wb-env-atom-storage-bar",style:Rn(i.style)},[S("div",null,[S("div",sp,[N(a)]),ip,S("div",ap,[N(o)])])],4)):B("",!0)}const lp=j(np,[["render",op],["__scopeId","data-v-11422e3b"]]),Se={NAME:0,TYPE:1,CREATED_DATE:2,EDITED_DATE:3},Ct={ASCENDING:0,DESCENDING:1},J={SHOW_INVISIBLE_SYMBOLS:"symbolWrapper_showInvisibleItems",ORDER_TYPE:"symbolWrapper_iconsOrderType",ORDER_DIRECTION:"symbolWrapper_iconsOrderDirection"},cp={[J.SHOW_INVISIBLE_SYMBOLS]:!1,[J.ORDER_TYPE]:Se.NAME,[J.ORDER_DIRECTION]:Ct.ASCENDING};class Ca{constructor({fsItem:e=null,command:n,model:r,layout:s}){p(this,"type",null);p(this,"id",Pn());p(this,"layout",Ne({position:O(0,0),size:O(0,0)}));p(this,"ignoreRearrange",!1);p(this,"model",Ne({title:"Item Title",symbol:w.DEFAULT,used:!1,visible:!0}));if(this.command=n,this.model=Object.assign(this.model,r),this.layout=Object.assign(this.layout,s),this.fsItem=e,this.fsItem){const i=this.fsItem;this.type=up(i),this.setProperties(i),this.fsItem.events.subscribe(({name:a,value:o})=>{a!=="addItem"&&a!=="removeItem"&&this.setProperties(e)})}}setProperties(e){if(this.model.title=e.name,this.layout.position=O(e.meta.get(b.POSITION)||O(0,0)),this.model.visible=!!e.meta.get(b.VISIBLE),this.model.symbol=e.meta.get(b.SYMBOL),this.model.url=e.meta.get(b.WEB_URL),this.model.ignoreRearrange=e.meta.get(b.IGNORE_SYMBOL_REARRANGE),e instanceof H){const n=[`openDirectory "${e.getPath()}"`];e.meta.get(b.WINDOW_SYMBOL_REARRANGE)&&n.push("-sort-symbols");const r=O(e.meta.get(b.WINDOW_POSITION)||O(0,0));r.length>0&&n.push(`--window-position="${O(r).toArray().join(",")}"`);const s=O(e.meta.get(b.WINDOW_SIZE)||O(0,0));s.length>0&&n.push(`--window-size="${O(s).toArray().join(",")}"`),e.meta.has(b.WINDOW_SCALE)&&n.push(`--window-scale=${e.meta.get(b.WINDOW_SCALE)}`),e.meta.has(b.WINDOW_SCROLL_X)&&n.push(`--window-scroll-x=${e.meta.get(b.WINDOW_SCROLL_X)}`),e.meta.has(b.WINDOW_SCROLL_Y)&&n.push(`--window-scroll-y=${e.meta.get(b.WINDOW_SCROLL_Y)}`),e.meta.has(b.WINDOW_SIDEBAR)&&n.push(`--window-sidebar=${e.meta.get(b.WINDOW_SIDEBAR)}`),e.meta.has(b.WINDOW_FULL_SIZE)&&n.push(`--window-full-size=${e.meta.get(b.WINDOW_FULL_SIZE)}`),this.command=n.join(" ")}else this.model.url||(this.command=`execute "${e.getPath()}"`)}}function Na(t){return t.map(e=>e instanceof Ca?e:new Ca(e))}function up(t){return t instanceof H?"container":t.meta.get(b.WEB_URL)?"link":"default"}var yt,Ns,wt,Gr;class Gt{constructor(e,n=[],r=!1){g(this,yt,new Me);g(this,Ns,Pn());g(this,wt,void 0);p(this,"items",vt([]));p(this,"selectedItems",vt([]));g(this,Gr,!1);p(this,"layout",Ne({size:O(0,0),position:O(0,0)}));p(this,"size",O(0,0));p(this,"parentSize",O(0,0));A(this,Gr,r||!1),A(this,wt,e),this.items.value=Na(n||[])}get(e){return this.items.value.find(n=>n.id===e)}has(e){return!!this.items.value.find(n=>n.id===e)}add(...e){const n=Na(e);this.items.value.push(...n.map(z)),c(this,yt).next(new G("add",{wrapper:this,items:n}))}remove(e){typeof e!="object"&&(e=this.get(e)),this.unselectItem(e.id),this.items.value.splice(this.items.value.indexOf(e),1),c(this,yt).next(new G("remove",{wrapper:this,item:e}))}setup(){return Promise.resolve()}moveItem(e,n){const r=this.get(e);return n.add(r),this.remove(r),Promise.resolve()}moveItemToItem(){return Promise.resolve()}savePosition(e,n){return Promise.resolve()}isSelectedItem(e){return this.selectedItems.value.includes(e)}selectItem(e){this.isSelectedItem(e)||(this.selectedItems.value.push(e),c(this,yt).next(new G("selectItem",{wrapper:this,id:e})))}unselectItem(e){this.isSelectedItem(e)&&(this.selectedItems.value=this.selectedItems.value.filter(n=>n!==e),c(this,yt).next(new G("unselectItem",{wrapper:this,id:e})))}clearSelectedItems(){[].concat(this.selectedItems.value).forEach(e=>this.unselectItem(e))}get root(){return c(this,Gr)}get events(){return c(this,yt)}get id(){return c(this,Ns)}get core(){return c(this,wt)}rearrangeIcons(e){e=Object.assign({orderType:c(this,wt).config.get(J.ORDER_TYPE),orderDirection:c(this,wt).config.get(J.ORDER_DIRECTION),onlyVisible:!c(this,wt).config.get(J.SHOW_INVISIBLE_SYMBOLS),root:!1,margin:10},e);let n=this.items.value;switch(e.root&&(e.orderType=Se.NAME,e.orderDirection=Ct.DESCENDING),e.onlyVisible&&(n=n.filter(o=>o.model.visible)),n=n.filter(o=>!o.model.ignoreRearrange),e.orderType){case Se.TYPE:n=n.sort((o,l)=>o.type.localeCompare(l.type));break;case Se.CREATED_DATE:n=n.sort((o,l)=>o.createDate===l.createDate?0:o.createDate>l.createDate?1:-1);break;case Se.EDITED_DATE:n=n.sort((o,l)=>o.editedDate===l.editedDate?0:o.editedDate>l.editedDate?1:-1);break;default:n=n.sort((o,l)=>o.model.title.localeCompare(o.model.title))}switch(e.orderDirection){case Ct.ASCENDING:n.reverse();break}const r=e.margin;let s,i=r;const a=ao(0,0);return e.root?s=this.size.x:s=r,n.forEach(o=>{e.root?(o.layout.position=O(s-o.layout.size.x,i),o.layout.size.x>a.x&&(a.x=o.layout.size.x),i+o.layout.size.y<this.parentSize.y?i+=o.layout.size.y+r:(s-=a.x+r,i=r)):(o.layout.size.y>a.y&&(a.y=o.layout.size.y),o.layout.position=O(s,i),s+o.layout.size.x<this.parentSize.x||(s=r,i+=a.y+r,o.layout.position=O(s,i)),s+=o.layout.size.x+r)}),Promise.all(n.map(({id:o,layout:l})=>this.savePosition(o,l.position)))}}yt=new WeakMap,Ns=new WeakMap,wt=new WeakMap,Gr=new WeakMap;class sr extends Gt{constructor(){super(...arguments);p(this,"fsItem");p(this,"usedMemory",0)}async setup(n){this.fsItem=n;const r=Array.from((await n.getItems()).values());await Promise.all(r.map(async s=>this.add(await sr.fsItemToSymbol(s)))),n.events.subscribe(this.onEventItem.bind(this))}async moveItemToItem(n,r){if(n.locked)throw new Error("Items are locked!");if(r.locked)throw new Error("Destination is locked!");n.meta.set(b.POSITION,O(0,0)),await this.core.modules.files.fs.saveItem(n),await this.core.modules.files.fs.move(n,r,{override:!0})}async moveItem(n,r){const s=this.get(n);if(s.fsItem instanceof Jr||s.fsItem instanceof It)try{return await this.moveItemToItem(s.fsItem,r.fsItem),!0}catch(i){return console.warn(i),!1}return Promise.resolve(!1)}savePosition(n,r){const s=this.get(n);s.fsItem.meta.set(b.POSITION,r),this.core.modules.files.fs.saveItem(s.fsItem)}hasFsItem(n){return this.items.value.find(r=>r.fsItem.id===n.id)}async onEventItem({name:n,value:r}){let s;switch(n){case"addItem":s=await sr.fsItemToSymbol(r),this.hasFsItem(r)||this.add(s);break;case"removeItem":this.remove(this.items.value.find(i=>i.fsItem===r));break}this.usedMemory=this.fsItem.size/this.fsItem.maxSize}static getItemsFromItem(n){return Promise.all(Array.from(n.items.values()).map(sr.fsItemToSymbol))}static async fsItemToSymbol(n){const r=await n.getPath(),s={fsItem:n,model:{title:n.name}};return typeof n.action=="function"&&(s.command=`executeFile "${r}"`),n.meta.has(b.WEB_URL)&&(s.url=n.meta.get(b.WEB_URL)),s}}const dp={xmlns:"http://www.w3.org/2000/svg",width:"31",height:"30",class:"wb_symbol_disk_1"},hp=S("path",{d:"M0 0h25v2h2v2h2v2h2v24H0z",class:"svg-secondary"},null,-1),mp=S("path",{fill:"#FFF",d:"M2 2v26h27V6h-2V4h-2V2",class:"svg-primary"},null,-1),fp=S("path",{fill:"#FA5",d:"M7 2h13v10H7z",class:"svg-tertiary"},null,-1),pp=S("path",{d:"M11 2h5v8h-5z",class:"svg-secondary"},null,-1),gp=[hp,mp,fp,pp];function Zo(t,e){return y(),C("svg",dp,gp)}const Qo={render:Zo},_p=Object.freeze(Object.defineProperty({__proto__:null,default:Qo,render:Zo},Symbol.toStringTag,{value:"Module"}));const bp={props:{parentLayout:{type:Object,default(){return null}},clampGlobal:{type:Boolean,default:!1},container:{type:Boolean,default(){return!1}},command:{type:String,default:null},id:{type:String,default:null},model:{type:Object,default(){return{title:"Item Title",url:null,symbol:Qo,used:!1,visible:!0}}},layout:{type:Object,default(){return{position:O(0,0),size:O(50,50)}}},scrollOffset:{type:Object,default(){return O(0,0)}},wrapper:{type:Object,default(){return z(new Gt)}}},emits:["click"],setup(t){return{wrapperItems:t.wrapper.items,wrapperSelectedItems:t.wrapper.selectedItems}},data(){return{globalPosition:null,moving:!1,positions:{start:null,move:null},subscription:new Yr,parentEl:null,screenModul:on.modules.screen}},computed:{linkTag(){return this.model.url?"a":"span"},linkBind(){return this.model.url?{href:this.model.url,target:this.model.url?"_blank":null,title:this.model.title}:{}},contentLayout(){return this.screenModul.contentLayout},selected(){return this.wrapperSelectedItems.includes(this.id)},styleClasses(){return{moving:this.moving,selected:this.selected,"symbol-used":this.model.used}},symbolsModule(){return on.modules.symbols}},watch:{model:{deep:!0,handler(){this.onRefresh()}}},mounted(){this.parentEl=this.$el.parentElement,this.onRefresh()},unmounted(){this.subscription.unsubscribe(),this.wrapper.unselectItem(this.id)},methods:{onRefresh(){this.layout.size=O(200,200),window.requestAnimationFrame(()=>{this.layout.size=O(this.$el.children[0].offsetWidth,this.$el.children[0].offsetHeight)})},getRootBounds(){const{width:t,height:e,left:n,top:r}=this.parentEl.getBoundingClientRect();return{position:O(n,r),size:O(t,e)}},onPointerDown(t){ls(t);const e=this.id;if(!(this.model.url&&this.selected)&&(t.preventDefault(),!this.model.used)){if(this.command&&this.selected){const n={showCommand:!1,show:!0};return this.wrapper.unselectItem(e),this.model.used=!0,on.executeCommand(this.command,n).then(()=>this.model.used=!1)}Xs.shiftActive?this.wrapper.isSelectedItem(e)?this.wrapper.unselectItem(e):this.wrapper.selectItem(e):(this.symbolsModule.getSelectedItems().length>0&&this.symbolsModule.clearSelectedItems(),this.wrapper.selectItem(e)),this.startMove(O(t)),this.$emit("click",this)}},onPointerUp(){const t=this.symbolsModule.getSelectedItems().filter(n=>n.id!==this.id),e=this.wrapper.get(this.id);t.length>0&&e.fsItem instanceof H&&t.forEach(n=>this.wrapper.moveItemToItem(n.fsItem,e.fsItem))},startMove(t){const e=this.getRootBounds();this.positions.lastPosition=O(this.layout.position),this.positions.scrollOffset=O(this.scrollOffset),this.positions.start=t,this.positions.offset=O(()=>this.positions.start-this.layout.position),this.setPosition(t,e,!0),this.moving=!0;let n=t;const r=Xs.pointerMove.subscribe(s=>{n=O(s),this.setPosition(O(s),e,!0)});this.subscription.add(Xs.pointerUp.pipe(mc()).subscribe(()=>{if(r.unsubscribe(),this.symbolsModule.getSecondaryWrapper().id!==this.wrapper.id)return this.wrapper.moveItem(this.id,this.symbolsModule.getSecondaryWrapper()).then(s=>(s||(this.layout.position=O(this.positions.lastPosition)),this.globalPosition=null,this.moving=!1,s));if(this.moving=!1,this.setPosition(n,e),!this.layout.position.equals(Ee(()=>this.positions.start-this.positions.offset)))return this.wrapper.savePosition(this.id,this.layout.position)}))},setPosition(t,e,n=!1){const r={min:O(0,0),max:Ee(()=>e.size-this.layout.size)};this.positions.move=Ee(()=>t-this.positions.start);let s=Ee(()=>Math.round(this.positions.start+this.positions.move-this.positions.offset));n?(r.min=e.position,r.max=Ee(()=>r.max+this.contentLayout.position),s=Ee(()=>Math.round(s+r.min)),this.clampGlobal?this.globalPosition=O(()=>Math.max(Math.min(s,this.contentLayout.position+this.wrapper.size-this.layout.size),r.min)):this.globalPosition=s):(this.wrapper.root?this.layout.position=Ee(()=>Math.max(Math.min(s,this.wrapper.size-this.layout.size),0)):this.layout.position=Ee(()=>Math.max(s,0)),this.globalPosition=null)}}},yp=["data-id"],wp=["innerHTML"];function xp(t,e,n,r,s,i){return y(),C("figure",{"data-id":n.id,class:at(["wb-env-atom-symbol-wrapper-item",i.styleClasses]),style:Rn([n.layout.size.toCSSVars("item-size"),(s.globalPosition||n.layout.position).toCSSVars("item-position")]),"touch-action":"none",onPointerdown:e[0]||(e[0]=(...a)=>i.onPointerDown&&i.onPointerDown(...a)),onPointerup:e[1]||(e[1]=(...a)=>i.onPointerUp&&i.onPointerUp(...a))},[(y(),U(ei(i.linkTag),tr(za(i.linkBind)),{default:Y(()=>[S("i",null,[(y(),U(ei(i.symbolsModule.symbols.get(n.model.symbol))))]),S("figcaption",{innerHTML:n.model.title},null,8,wp)]),_:1},16))],46,yp)}const vp=j(bp,[["render",xp],["__scopeId","data-v-23466add"]]);const Ep={components:{WbEnvAtomSymbolWrapperItem:vp},props:{parentLayout:{type:Object,default(){return{size:O(window.innerWidth,window.innerHeight)}}},parentScrollable:{type:Boolean,default:!0},parentFocused:{type:Boolean,default:!1},clampSymbols:{type:Boolean,default:!1},wrapper:{type:Gt,default(){return z(new Gt(on,[{layout:{position:O(100,0)},model:{title:"Item 1",symbol:w.DIRECTORY}},{layout:{position:O(0,0)},model:{title:"Item 2",symbol:w.DEFAULT}},{layout:{position:O(0,0)},model:{title:"Item 3",symbol:w.DEFAULT}}]))}}},emits:["ready","refresh"],setup(t){return{wrapperItems:t.wrapper.items,wrapperSelectedItems:t.wrapper.selectedItems}},data(){const t=on;return{core:z(t),webWorkbenchConfig:z(t.config.observable),symbolsModule:z(t.modules.symbols),selectedItems:[],layout:{size:O(0,0),position:O(0,0)}}},computed:{styleClasses(){return{"parent-scrollable":this.parentScrollable,active:(this.core.modules.symbols.primaryWrapper||{}).id===this.wrapper.id}},scrollOffset(){return this.parentLayout&&"scrollOffset"in this.parentLayout?this.parentLayout.scrollOffset:O(0,0)},style(){const t=[this.scrollOffset.toCSSVars("symbol-wrapper-scroll-offset")];return this.parentScrollable?t.push(this.size.toCSSVars("symbol-wrapper-size")):t.push(this.layout.size.toCSSVars("symbol-wrapper-size")),t},size(){return this.visibleItems.map(t=>({item:t,index:this.wrapperSelectedItems.indexOf(t.id)+1})).sort((t,e)=>t.index>e.index?1:t.index<e.index?-1:0).reduce((t,{item:e})=>{const n=e.layout.position.x+e.layout.size.x,r=e.layout.position.y+e.layout.size.y;return t.x=t.x<n?n:t.x,t.y=t.y<r?r:t.y,t},ao(0,0))},showInvisibleItems(){return this.webWorkbenchConfig[J.SHOW_INVISIBLE_SYMBOLS]},visibleItems(){return this.wrapperItems.filter(this.isItemVisible)},parentLayoutSize(){return(this.parentLayout||{}).size}},watch:{parentFocused(t){this.setFocused(t)},wrapper(){this.onResize()},parentLayoutSize(t){this.onResize()},size(){this.$nextTick(()=>{this.$emit("refresh",{scroll:!0})})}},mounted(){this.$nextTick(()=>{this.onResize(),this.setFocused(this.parentFocused),this.$emit("ready")})},unmounted(){this.core.modules.symbols.getPrimaryWrapper()&&this.core.modules.symbols.getPrimaryWrapper().id===this.wrapper.id&&this.core.modules.symbols.setPrimaryWrapper(null),this.core.modules.symbols.getSecondaryWrapper()&&this.core.modules.symbols.getSecondaryWrapper().id===this.wrapper.id&&this.core.modules.symbols.setSecondaryWrapper(null)},methods:{setFocused(t){t?this.symbolsModule.setPrimaryWrapper(this.wrapper):this.symbolsModule.getPrimaryWrapper()&&this.symbolsModule.getPrimaryWrapper().id===this.wrapper.id&&this.symbolsModule.setPrimaryWrapper(null)},onResize(){const{left:t,top:e}=this.$el.getBoundingClientRect();this.wrapper.layout=this.layout={position:O(t,e),size:this.parentLayout.size},this.wrapper.size=O(this.$el.offsetWidth,this.$el.offsetHeight),this.wrapper.parentSize=this.parentLayout.size},isItemVisible(t){return this.showInvisibleItems||!this.showInvisibleItems&&t.model.visible},onPointerMove(){this.core.modules.symbols.setSecondaryWrapper(this.wrapper)},onPointerDown(t){(t.target===this.$refs.helper||t.target===this.$refs.items)&&this.wrapper.clearSelectedItems()}}},Sp={ref:"helper",class:"helper"},Ip={ref:"items",class:"items"};function Ap(t,e,n,r,s,i){const a=R("wb-env-atom-symbol-wrapper-item");return y(),C("div",{class:at(["wb-env-symbol-wrapper",i.styleClasses]),style:Rn(i.style),onPointerdown:e[0]||(e[0]=(...o)=>i.onPointerDown&&i.onPointerDown(...o)),onPointermove:e[1]||(e[1]=(...o)=>i.onPointerMove&&i.onPointerMove(...o))},[S("div",Sp,null,512),S("div",Ip,[(y(!0),C(Et,null,St(i.visibleItems,(o,l)=>(y(),U(a,V({key:l,"clamp-global":n.clampSymbols},o,{wrapper:n.wrapper,"parent-layout":s.layout,"scroll-offset":i.scrollOffset}),null,16,["clamp-global","wrapper","parent-layout","scroll-offset"]))),128))],512)],38)}const Op=j(Ep,[["render",Ap],["__scopeId","data-v-bd4d4e0c"]]);const kp={components:{WbButton:kt,WbFormFieldTextbox:es,WbButtonWrapper:Tt},props:{message:{type:String,default(){return"Dialog Message"}},confirm:{type:Boolean,default:!1},prompt:{type:Boolean,default:!1},password:{type:Boolean,default:!1},apply:{type:Function,default(){return null}},abort:{type:Function,default(){return null}},applyLabel:{type:String,default(){return"Continue"}},abortLabel:{type:String,default(){return"Cancel"}},yesLabel:{type:String,default(){return"Yes"}},noLabel:{type:String,default(){return"No"}}},emits:["apply","abort"],data(){return{inputModel:{value:""}}},computed:{formattedMessage(){return this.message.replace(/\\n|\n/g,"<br>")}},methods:{onClickApply(){const t=this.inputModel.value||!0;typeof this.apply=="function"?this.apply(t):this.$emit("apply",t)},onClickAbort(){typeof this.abort=="function"?this.abort():this.$emit("abort")}}},Tp={class:"wb-env-molecule-dialog-content"},Rp=["innerHTML"],Dp={key:1,class:"input"};function Cp(t,e,n,r,s,i){const a=R("wb-form-field-textbox"),o=R("wb-button"),l=R("wb-button-wrapper");return y(),C("div",Tp,[S("div",null,[n.message?(y(),C("p",{key:0,innerHTML:i.formattedMessage},null,8,Rp)):B("",!0),n.prompt?(y(),C("div",Dp,[N(a,{ref:"dialogInput",model:s.inputModel,placeholder:null,type:n.password?"password":"text",label:null},null,8,["model","type"])])):B("",!0),N(l,{align:n.abortLabel?"outer":"center",class:"buttons"},{default:Y(()=>[n.applyLabel||n.confirm&&n.yesLabel?(y(),U(o,{key:0,"style-type":"dialog",label:n.confirm?n.yesLabel:n.applyLabel,onClick:i.onClickApply},null,8,["label","onClick"])):B("",!0),n.abortLabel||n.confirm&&n.noLabel?(y(),U(o,{key:1,"style-type":"dialog",label:n.confirm?n.noLabel:n.abortLabel,onClick:i.onClickAbort},null,8,["label","onClick"])):B("",!0)]),_:1},8,["align"])])])}const Jo=j(kp,[["render",Cp],["__scopeId","data-v-bfd95096"]]),tg=Object.freeze(Object.defineProperty({__proto__:null,default:Jo},Symbol.toStringTag,{value:"Module"})),Np=({module:t,core:e})=>{const{files:n,windows:r,symbols:s}=e.modules,i=n.fs;return[{name:["openDirectory","openDir"],description:"Opens the specified directory.",args:[new x({index:0,name:"path",description:"Path to the directory."}),new x({name:"sortSymbols",description:"Sort Symbols",flag:!0}),new x({name:"windowSize",description:"Window Size"}),new x({name:"windowPosition",description:"Window Position"}),new x({name:"windowScale",description:"Window Scale"}),new x({name:"windowScrollX",description:"Window Scroll-X"}),new x({name:"windowScrollY",description:"Window Scroll-Y"}),new x({name:"windowSidebar",description:"Window Sidebar"}),new x({name:"windowFullSize",description:"Window Full-Size"})],async action({path:a,sortSymbols:o,windowSize:l,windowPosition:u,windowScale:d,windowScrollX:m,windowScrollY:h,windowSidebar:f,windowFullSize:v}){if(!a)throw P.get("bad_args");const _=await i.get(a),E=await s.addFileSystemWrapper(_),L=s.symbolWrappers.get(E),T=Ne({value:_.size/_.maxSize}),M=r.addWindow({title:_.name,layout:{size:O(...(l||"400,200").split(",").map(ee=>Number(ee))),position:O(...(u||"0,0").split(",").map(ee=>Number(ee)))},symbolWrapper:L,sidebarComponent:lp,sidebarComponentData:T,component:Op,componentData:{wrapper:L,parentScrollable:m||h},options:{sidebar:f!==void 0?f:!0,scale:d!==void 0?d:!0,scrollX:m!==void 0?m:!0,scrollY:h!==void 0?h:!0,center:!u}},{active:!0,full:v}),ne=()=>{T.value=_.size/_.maxSize},Q=[L.events.subscribe(ne)];return new Promise(ee=>{M.events.subscribe(({name:Fn})=>{Fn==="ready"&&o?window.requestAnimationFrame(()=>{L.rearrangeIcons()}):Fn==="close"?(Q.forEach(nl=>nl.unsubscribe()),s.removeWrapper(E),ee()):ne()})})}},{name:["openDialog"],description:"Open a Dialog.",args:[new x({index:0,name:["message"],description:"Message from Dialog."}),new x({index:1,name:["title"],description:"Title from Dialog."}),new x({name:["apply"],description:"Title from apply button."}),new x({name:["abort"],description:"Title from abort button."}),new x({name:["confirm"],flag:!0,description:"Defines the confirm dialog"}),new x({name:["prompt"],flag:!0,description:"Defines the prompt dialog"}),new x({name:["secret"],flag:!1,description:"Input is illegible."})],action:({title:a=null,message:o=null,apply:l=null,abort:u=null,confirm:d=!1,prompt:m=!1,secret:h=!1},f)=>{let v;const _=T=>{v(T)},E=()=>{v(!1)},L=t.addWindow(new ur({title:a,component:Jo,componentData:{title:a,message:o,secret:h,confirm:d,prompt:m,applyLabel:l||"Continue",abortLabel:u,apply:_,abort:E},options:{scale:!1,scrollX:!1,scrollY:!1,close:!1}}));return L.events.pipe(lr(({name:T})=>T==="close")).subscribe(()=>{E()}),new Promise(T=>{v=T}).then(T=>(L.close(),T))}}]};var On;class el extends Ws{constructor(n){const{core:r}=Object.assign({core:null},n);super({config:jf,commands:Np,core:r});g(this,On,new Map);p(this,"contentWrapper");p(this,"globalWrapper");p(this,"contextMenu",Ne(new Wf(this)));this.contentWrapper=this.getWrapper(this.addWrapper(new ma(r))),this.globalWrapper=this.getWrapper(this.addWrapper(new ma(r)))}addWindow(n,r){return n instanceof ur||(n=new ur(n)),n.componentData&&(n.componentData.core=z(this.core)),r=Object.assign({global:!1},r),r.global?n=this.globalWrapper.add(n,r):n=this.contentWrapper.add(n,r),n}getWrapper(n){return c(this,On).get(n)}addWrapper(n){return c(this,On).set(n.id,n),n.id}removeWrapper(n){typeof n!="string"&&(n=n.id),c(this,On).delete(n)}isContextMenu(n){return n.id===this.getActiveContextMenu().id}setup(){this.contextMenu.addDefaultItems(new Xt(Uf,{core:this.core})),this.contextMenu.addDefaultItems(new Xt(Gf,{core:this.core}))}clear(){this.contentWrapper.clear(),this.globalWrapper.clear()}getActiveContextMenu(){return this.contextMenu.getActiveItems()}setActiveContextMenu(n){return this.contextMenu.setActiveItems(n)}}On=new WeakMap,p(el,"NAME","Windows");const Lp={[w.DEFAULT]:()=>k(()=>import("./default.47113847.js"),["./default.47113847.js","./entry.42952971.js"],import.meta.url).then(t=>t.default),[w.DIRECTORY]:()=>k(()=>import("./directory.552bd9fc.js"),["./directory.552bd9fc.js","./entry.42952971.js"],import.meta.url).then(t=>t.default),[w.DIRECTORY_PREFS]:()=>k(()=>import("./directory_prefs.3a818b88.js"),["./directory_prefs.3a818b88.js","./entry.42952971.js"],import.meta.url).then(t=>t.default),[w.CLOUD_DISK]:()=>k(()=>import("./cloud_disk.75b6f5d9.js"),["./cloud_disk.75b6f5d9.js","./entry.42952971.js"],import.meta.url).then(t=>t.default),[w.HARD_DISK]:()=>k(()=>import("./hard_disk.dddc2df2.js"),["./hard_disk.dddc2df2.js","./entry.42952971.js"],import.meta.url).then(t=>t.default),[w.RAM_DISK]:()=>k(()=>import("./ram_disk.7fca1389.js"),["./ram_disk.7fca1389.js","./entry.42952971.js"],import.meta.url).then(t=>t.default),[w.TMP_DISK]:()=>k(()=>import("./tmp_disk.7fca1389.js"),["./tmp_disk.7fca1389.js","./entry.42952971.js"],import.meta.url).then(t=>t.default),[w.DISK_1]:()=>k(()=>Promise.resolve().then(()=>_p),void 0,import.meta.url).then(t=>t.default),[w.DISK_2]:()=>k(()=>import("./disk_2.d24fac8c.js"),["./disk_2.d24fac8c.js","./entry.42952971.js"],import.meta.url).then(t=>t.default),[w.DISK_WORKBENCH13]:()=>k(()=>import("./disk_workbench13.0f5979ef.js"),["./disk_workbench13.0f5979ef.js","./entry.42952971.js"],import.meta.url).then(t=>t.default),[w.DISK_MARKDOWN]:()=>k(()=>import("./disk_markdown.e941b3f2.js"),["./disk_markdown.e941b3f2.js","./entry.42952971.js"],import.meta.url).then(t=>t.default),[w.DISK_BASIC]:()=>k(()=>import("./disk_basic.753e165d.js"),["./disk_basic.753e165d.js","./entry.42952971.js"],import.meta.url).then(t=>t.default),[w.WORK]:()=>k(()=>import("./work.f322e49d.js"),["./work.f322e49d.js","./entry.42952971.js"],import.meta.url).then(t=>t.default),[w.CONSOLE]:()=>k(()=>import("./console.4476776a.js"),["./console.4476776a.js","./entry.42952971.js"],import.meta.url).then(t=>t.default),[w.SETTINGS]:()=>k(()=>import("./settings.d817f0c8.js"),["./settings.d817f0c8.js","./entry.42952971.js"],import.meta.url).then(t=>t.default),[w.TRASHCAN]:()=>k(()=>import("./trashcan.47f7959f.js"),["./trashcan.47f7959f.js","./entry.42952971.js"],import.meta.url).then(t=>t.default),[w.COMPUTER_1]:()=>k(()=>import("./computer_1.17ac48c6.js"),["./computer_1.17ac48c6.js","./entry.42952971.js"],import.meta.url).then(t=>t.default),[w.TELEPHONE]:()=>k(()=>import("./telephone.524ea3eb.js"),["./telephone.524ea3eb.js","./entry.42952971.js"],import.meta.url).then(t=>t.default),[w.CURSOR]:()=>k(()=>import("./cursor.f5fab48e.js"),["./cursor.f5fab48e.js","./entry.42952971.js"],import.meta.url).then(t=>t.default),[w.PREFERENCE]:()=>k(()=>import("./preference.304f3dbd.js"),["./preference.304f3dbd.js","./entry.42952971.js"],import.meta.url).then(t=>t.default),[w.WEB_BASIC]:()=>k(()=>import("./web_basic.077630db.js"),["./web_basic.077630db.js","./entry.42952971.js"],import.meta.url).then(t=>t.default),[w.WEB_PAINTING]:()=>k(()=>import("./web_painting.9c6c95cd.js"),["./web_painting.9c6c95cd.js","./entry.42952971.js"],import.meta.url).then(t=>t.default),[w.COLORS]:()=>k(()=>import("./colors.7c13aec0.js"),["./colors.7c13aec0.js","./entry.42952971.js"],import.meta.url).then(t=>t.default),[w.PRINT_1]:()=>k(()=>import("./print_1.5ad8efea.js"),["./print_1.5ad8efea.js","./entry.42952971.js"],import.meta.url).then(t=>t.default),[w.PRINT_2]:()=>k(()=>import("./print_2.abafc88f.js"),["./print_2.abafc88f.js","./entry.42952971.js"],import.meta.url).then(t=>t.default),[w.NOTEPAD]:()=>k(()=>import("./notepad.950688a5.js"),["./notepad.950688a5.js","./entry.42952971.js"],import.meta.url).then(t=>t.default),[w.BASIC]:()=>k(()=>import("./basic.8d494ba0.js"),["./basic.8d494ba0.js","./entry.42952971.js"],import.meta.url).then(t=>t.default),[w.IMAGE]:()=>k(()=>import("./image.67b3df89.js"),["./image.67b3df89.js","./entry.42952971.js"],import.meta.url).then(t=>t.default),[w.NOTE]:()=>k(()=>import("./note.c35a0d20.js"),["./note.c35a0d20.js","./entry.42952971.js"],import.meta.url).then(t=>t.default),[w.NOTE_BLANK]:()=>k(()=>import("./note_blank.a0d8a801.js"),["./note_blank.a0d8a801.js","./entry.42952971.js"],import.meta.url).then(t=>t.default),[w.LARGE_NOTE]:()=>k(()=>import("./large_note.99a0dad8.js"),["./large_note.99a0dad8.js","./entry.42952971.js"],import.meta.url).then(t=>t.default),[w.LARGE_NOTE_RICH]:()=>k(()=>import("./large_note_rich.63917d97.js"),["./large_note_rich.63917d97.js","./entry.42952971.js"],import.meta.url).then(t=>t.default),[w.FULLSCREEN]:()=>k(()=>import("./fullscreen.fffb9dda.js"),["./fullscreen.fffb9dda.js","./entry.42952971.js"],import.meta.url).then(t=>t.default),[w.CALCULATOR]:()=>k(()=>import("./calculator.4a82b7ef.js"),["./calculator.4a82b7ef.js","./entry.42952971.js"],import.meta.url).then(t=>t.default),[w.CLOCK]:()=>k(()=>import("./clock.cfd092ac.js"),["./clock.cfd092ac.js","./entry.42952971.js"],import.meta.url).then(t=>t.default),[w.KEYBOARD_QUESTION]:()=>k(()=>import("./keyboard_question.46ff0f7a.js"),["./keyboard_question.46ff0f7a.js","./entry.42952971.js"],import.meta.url).then(t=>t.default),[w.LARGE_NOTEPAD]:()=>k(()=>import("./large_notepad.ce3f2596.js"),["./large_notepad.ce3f2596.js","./entry.42952971.js"],import.meta.url).then(t=>t.default),[w.LARGE_NOTEPAD_HELP]:()=>k(()=>import("./large_notepad_help.1177d066.js"),["./large_notepad_help.1177d066.js","./entry.42952971.js"],import.meta.url).then(t=>t.default),[w.RABBIT]:()=>k(()=>import("./rabbit.26c25050.js"),["./rabbit.26c25050.js","./entry.42952971.js"],import.meta.url).then(t=>t.default),[w.MORE]:()=>k(()=>import("./more.d2dbcbf6.js"),["./more.d2dbcbf6.js","./entry.42952971.js"],import.meta.url).then(t=>t.default),[w.SAY]:()=>k(()=>import("./say.5e6e3ad8.js"),["./say.5e6e3ad8.js","./entry.42952971.js"],import.meta.url).then(t=>t.default),[w.GITHUB]:()=>k(()=>import("./github.31923f56.js"),["./github.31923f56.js","./entry.42952971.js"],import.meta.url).then(t=>t.default),[w.LAMMPEE]:()=>k(()=>import("./lammpee.165ed54d.js"),["./lammpee.165ed54d.js","./entry.42952971.js"],import.meta.url).then(t=>t.default),[w.CUBY]:()=>k(()=>import("./cuby.9091126c.js"),["./cuby.9091126c.js","./entry.42952971.js"],import.meta.url).then(t=>t.default),[w.NUXT]:()=>k(()=>import("./nuxt.3abd60dd.js"),["./nuxt.3abd60dd.js","./entry.42952971.js"],import.meta.url).then(t=>t.default),[w.CLOWN]:()=>k(()=>import("./clown.0df85290.js"),["./clown.0df85290.js","./entry.42952971.js"],import.meta.url).then(t=>t.default),[w.DISALLOW_1]:()=>k(()=>import("./disallow_1.886955e9.js"),["./disallow_1.886955e9.js","./entry.42952971.js"],import.meta.url).then(t=>t.default),[w.COPY_1]:()=>k(()=>import("./copy_1.c1ab6492.js"),["./copy_1.c1ab6492.js","./entry.42952971.js"],import.meta.url).then(t=>t.default),[w.COPY_2]:()=>k(()=>import("./copy_2.d51c1c7d.js"),["./copy_2.d51c1c7d.js","./entry.42952971.js"],import.meta.url).then(t=>t.default),[w.DISPLAY_KEYBOARD]:()=>k(()=>import("./display_keyboard.fd8a6bbb.js"),["./display_keyboard.fd8a6bbb.js","./entry.42952971.js"],import.meta.url).then(t=>t.default),[w.PALETTE]:()=>k(()=>import("./palette.68a82fdb.js"),["./palette.68a82fdb.js","./entry.42952971.js"],import.meta.url).then(t=>t.default),[w.SIGN_1]:()=>k(()=>import("./sign_1.a13829e1.js"),["./sign_1.a13829e1.js","./entry.42952971.js"],import.meta.url).then(t=>t.default),[w.DOCUMENT_EDITOR]:()=>k(()=>import("./document_editor.84dc04a4.js"),["./document_editor.84dc04a4.js","./entry.42952971.js"],import.meta.url).then(t=>t.default),[w.DOCUMENT_READER]:()=>k(()=>import("./document_reader.d53fcc0d.js"),["./document_reader.d53fcc0d.js","./entry.42952971.js"],import.meta.url).then(t=>t.default)},Pp=({module:t,core:e})=>[{order:11,title:"Symbol",items:[{type:We.CHECKBOX,title:"Show Invisible Symbols",model:e.config.observable,name:J.SHOW_INVISIBLE_SYMBOLS,action(n){return e.config.set(J.SHOW_INVISIBLE_SYMBOLS,n)}},{title:"Rearrange Symbols",hotKey:"R",keyCode:82,action(){const n=t.getDefaultWrapper(),r=t.getPrimaryWrapper();return r.id!==n.id?(r.rearrangeIcons(),_e(r.fsItem)):(n.rearrangeIcons({root:!0}),_e(n.fsItem))}},{title:"Order Type",items:[{model:e.config.observable,type:We.RADIO,name:J.ORDER_TYPE,value:Se.NAME,title:"Name",action(){return e.config.set(J.ORDER_TYPE,Se.NAME)}},{model:e.config.observable,type:We.RADIO,name:J.ORDER_TYPE,value:Se.TYPE,title:"Type",action(){return e.config.set(J.ORDER_TYPE,Se.TYPE)}},{model:e.config.observable,type:We.RADIO,name:J.ORDER_TYPE,value:Se.CREATED_DATE,title:"Created Date",action(){return e.config.set(J.ORDER_TYPE,Se.CREATED_DATE)}},{model:e.config.observable,type:We.RADIO,name:J.ORDER_TYPE,value:Se.EDITED_DATE,title:"Edited Date",action(){return e.config.set(J.ORDER_TYPE,Se.EDITED_DATE)}}]},{title:"Order Direction",items:[{model:e.config.observable,type:We.RADIO,name:J.ORDER_DIRECTION,value:Ct.ASCENDING,title:"Ascending",action(){return e.config.set(J.ORDER_DIRECTION,Ct.ASCENDING)}},{model:e.config.observable,type:We.RADIO,name:J.ORDER_DIRECTION,value:Ct.DESCENDING,title:"Descending",action(){return e.config.set(J.ORDER_DIRECTION,Ct.DESCENDING)}}]}]}],Mp=({module:t,core:e})=>[{name:["rearrangeIcons"],description:"Rearrange Icons",args:[new x({name:"id",description:"Wraper id"}),new x({name:"root",description:"Use root wrapper",flag:!0})],async action({id:n,root:r}){const s=t.getDefaultWrapper(),i=t.getPrimaryWrapper();if(await new Promise(a=>window.requestAnimationFrame(a)),r)return s.rearrangeIcons({root:!0}),_e(s.fsItem);{let a=i;return n&&(a=t.get(n)),a.rearrangeIcons(),_e(a.fsItem)}}}];var xt,Vt,Ze,kn,Ut,Hr;class tl extends Ws{constructor(n){const{core:r}=Object.assign({core:null},n);super({config:cp,commands:Mp,contextMenu:Pp,core:r});g(this,xt,new Me);g(this,Vt,new Map);g(this,Ze,new Map);g(this,kn,{});p(this,"hasSelectedItems",!1);g(this,Ut,void 0);g(this,Hr,void 0);p(this,"activeWrapper");p(this,"defaultWrapper");p(this,"primaryWrapper");p(this,"secondaryWrapper")}addWrapper(n){return n=z(n),c(this,Ze).set(n.id,n),c(this,kn)[n.id]=n,n.events.subscribe(this.onEventWrapper.bind(this)),n.id}onEventWrapper({name:n,value:r}){const{wrapper:s}=r;(n==="selectItem"||n==="unselectItem")&&(this.hasSelectedItems=s.selectedItems.value.length>0,c(this,xt).next(new G("hasSelectedItems",this.hasSelectedItems)))}removeWrapper(n){typeof n!="string"&&(n=n.id),c(this,Ze).delete(n),delete c(this,kn)[String(n)]}getActiveWrapper(n){const r=this.core.modules.windows.contentWrapper.getActiveWindow();return r&&r.symbolWrapper?r.symbolWrapper:n?null:this.activeWrapper}getSelectedItems(){return Array.from(c(this,Ze).values()).reduce((n,r)=>(n.push(...r.selectedItems.value.map(s=>r.get(s))),n),[])}clearSelectedItems(){return Array.from(c(this,Ze).values()).forEach(n=>{n.clearSelectedItems()})}async addFileSystemWrapper(n,r){const s=new sr(this.core,null,r);return await s.setup(n),this.addWrapper(s)}async setup(){await this.loadCoreSymbols(),this.setDefaultWrapper(await this.addFileSystemWrapper(this.core.modules.files.fs.root,!0))}loadCoreSymbols(){return Promise.all(Object.values(w).map(async n=>c(this,Vt).set(n,await Lp[String(n)]())))}get(n){return c(this,Ze).get(n)}setDefaultWrapper(n){A(this,Hr,n),this.primaryWrapper=this.secondaryWrapper=this.activeWrapper=this.defaultWrapper=this.symbolWrappers.get(n)}getDefaultWrapper(){return this.defaultWrapper}getPrimaryWrapper(){return this.primaryWrapper||this.defaultWrapper}getSecondaryWrapper(){return this.secondaryWrapper||this.defaultWrapper}setPrimaryWrapper(n){n instanceof Gt&&(n=n.id),this.primaryWrapper=this.symbolWrappers.get(n),c(this,xt).next(new G("setPrimaryWrapper",this.getPrimaryWrapper()))}setSecondaryWrapper(n){n instanceof Gt&&(n=n.id),this.secondaryWrapper=this.symbolWrappers.get(n),c(this,xt).next(new G("setSecondaryWrapper",this.secondaryWrapper))}setActiveWrapper(n){n instanceof Gt&&(n=n.id);let r=this.symbolWrappers.get(c(this,Ut));return n!==c(this,Ut)&&(A(this,Ut,n),this.activeWrapper=this.symbolWrappers.get(c(this,Ut)),r=this.activeWrapper||this.symbolWrappers.get(c(this,Hr)),c(this,xt).next(new G("setActiveWrapper",r))),r}addSymbol(n,r){c(this,Vt).set(n,r)}removeSymbol(n){c(this,Vt).delete(n)}get wrappersObservable(){return c(this,kn)}get events(){return c(this,xt)}get symbols(){return c(this,Vt)}get symbolWrappers(){return c(this,Ze)}}xt=new WeakMap,Vt=new WeakMap,Ze=new WeakMap,kn=new WeakMap,Ut=new WeakMap,Hr=new WeakMap,p(tl,"NAME","Symbols");const ts=new Jn;ts.addModule(Bo);ts.addModule(Ko);ts.addModule(el);ts.addModule(tl);const on=ts,ng=Object.freeze(Object.defineProperty({__proto__:null,default:on},Symbol.toStringTag,{value:"Module"}));export{Me as $,x as A,Bp as B,$ as C,xo as D,Xc as E,Zt as F,Yt as G,qp as H,nd as I,Oc as J,ti as K,Ka as L,Ws as M,Ee as N,b as O,Kn as P,w as Q,Pl as R,Yr as S,eu as T,X as U,Ve as V,ma as W,Xr as X,so as Y,Pn as Z,tn as _,nu as a,G as a0,us as a1,Qp as a2,Jp as a3,Zs as a4,jp as a5,Qn as a6,Oo as a7,Yp as a8,Su as a9,Iu as aa,Sm as ab,$o as ac,$n as ad,kt as ae,ji as af,es as ag,Ah as ah,Ed as ai,Xo as aj,_u as ak,Tt as al,Xt as am,Un as an,Gp as ao,Hp as ap,tg as aq,ng as ar,Xs as b,wo as c,Vp as d,We as e,mc as f,O as g,ao as h,Ii as i,lr as j,iu as k,ct as l,ut as m,Op as n,dt as o,zp as p,nh as q,jt as r,Up as s,ls as t,lt as u,Ao as v,on as w,Z as x,od as y,Yc as z};
