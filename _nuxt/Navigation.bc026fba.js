var k=Object.defineProperty;var D=(i,e,t)=>e in i?k(i,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):i[e]=t;var p=(i,e,t)=>(D(i,typeof e!="symbol"?e+"":e,t),t);import{b as O,V as v,P as C,D as P,c as R,C as m,r as I,d as B,e as q,f as j,h as L,a as Y,s as K}from"./index.c407afae.js";import{E as g,_ as E,f as N,k as d,l as y,q as H,W as A,o as z,m as _,t as S,L as h,P as V,a5 as F,N as w,O as b,z as Z,I as x,C as U}from"./entry.211f2c5a.js";import{Q as W,j as X,k as G,u as J,q as o,ad as $}from"./index.eb95d3b6.js";class Ie{constructor(e,t){p(this,"track");p(this,"playing",!1);p(this,"noteIndex",-1);p(this,"currentSequence");p(this,"instrument");p(this,"autoplay");const{autoplay:s}=t||{};this.track=e,this.autoplay=s!==void 0?s:!0}refresh(){const e=O(this.track.notes);return this.createSequence(e,()=>{this.clearSequence(),this.playing=!1}),e}play(e){var s;if(!this.instrument)throw new Error("TrackPlayer requires an instrument");const t=this.refresh(e);if(t.length-1===this.noteIndex&&(this.noteIndex=-1),this.autoplay){const a=this.instrument.context.transport;a.stop(),a.seconds=e>-1&&((s=t[e+1])==null?void 0:s.time)||0,a.start(),this.currentSequence.start(0),this.playing=!0}return this.currentSequence}pause(){this.instrument.context.transport.pause(),this.playing=!1}stop(){this.clearSequence(),this.playing=!1,this.noteIndex=-1}restart(){this.stop(),this.play()}reset(){this.clearSequence(),this.stop(),this.track.notes=[]}destroy(){var e;(e=this.instrument)==null||e.dispose(),this.clearSequence()}createInstrument(e){var r;(r=this.instrument)==null||r.dispose();const t=R[String(e)],s=new v(-100).toDestination(),a=new t().connect(s).toDestination();this.instrument=g(a)}createSequence(e,t){var s;if(!this.currentSequence){(s=this.currentSequence)==null||s.dispose();let a;this.currentSequence=g(new C((r,{name:c,time:f,velocity:u})=>{if(c)try{this.instrument.triggerAttackRelease(c,`${this.track.noteCount}n`,r,u),a={name:c,time:r}}catch{console.log(a)}P.schedule(()=>{this.noteIndex++},r),this.noteIndex===e.length-1&&t&&t()},e))}}clearSequence(){var e;(e=this.currentSequence)==null||e.dispose(),this.currentSequence=null}}const Q={components:{AtomMarkdown:W},props:{...X,model:{type:Object,required:!0}},emits:[...G],setup(i,e){return{windowContext:J(i,e)}},data(){return{content:["# Synthesizer","Simple synthesizer with notes view.","",`Version: **0.1**  
Created by **Thorn-Welf Walli**`,"","Thanks to [Tone.js](https://tonejs.github.io/)"].join(`
`)}}},M={class:"wb-disks-debug-synthesizer-info"};function ee(i,e,t,s,a,r){const c=N("atom-markdown");return d(),y("div",M,[H(c,{content:a.content},null,8,["content"])])}const te=E(Q,[["render",ee],["__scopeId","data-v-6b58070e"]]),ge=({core:i,mainWindow:e,parentWindow:t,preserveContextMenu:s,model:a})=>{const{windows:r}=i.modules;function c(){return(t||e).close()}const f=a[m.SYNTHESIZER_PROJECT],u=a[m.SYNTHESIZER_TRACK];return[{title:"Synthesizer",items:[{hotKey:"I",keyCode:73,title:"Info",async action(){s(!0),await r.addWindow({title:"Info",component:te,componentData:{model:a},options:{prompt:!1,scaleX:!1,scaleY:!1,scrollX:!1,scrollY:!1}},{group:"extras13Synthesizer"}).awaitClose(),s(!1),e.focus()}},{type:o.SEPARATOR},{title:"Debug",hotKey:"D",async action(){s(!0);const{window:n}=a.actions.openDebug();await n.awaitClose(),s(!1),e.focus()}},{type:o.SEPARATOR},{title:"Close",action:c}]},...u?[]:[{title:"Project",items:[{title:"New…",action:async()=>{s(!0),await a.actions.newProject(),s(!1),e.focus()}},{title:"Edit Name…",action:async()=>{s(!0);const n=await I(i,"Project renaming:",f.name);n&&(f.name=n),s(!1),e.focus()}}]},{title:"Track",items:[{title:"New…",action:async()=>{s(!0),await a.actions.newTrack(),s(!1),e.focus()}},{type:o.SEPARATOR},{title:"Clear",async action(){s(!0),await a.actions.clearTracks(),s(!1),e.focus()}}]}],{title:"Options",items:[{type:o.DEFAULT,title:`BPM (${a[m.SYNTHESIZER_BPM]})`,items:[30,60,120,240,480].map(n=>({type:o.RADIO,title:String(n),model:a,name:m.SYNTHESIZER_BPM,value:n}))}]},...a[m.SYNTHESIZER_TRACK]&&[{title:"Track Options",items:[{type:o.CHECKBOX,title:"Show Note Labels",name:m.SYNTHESIZER_SHOW_NOTE_LABELS,model:a},{type:o.CHECKBOX,title:"Show Keyboard",name:m.SYNTHESIZER_SHOW_KEYBOARD,model:a},{type:o.DEFAULT,title:"Keyboard Size",items:Object.entries(B()).map(([n,l])=>({type:o.RADIO,title:l,model:a,name:m.SYNTHESIZER_KEYBOARD_SIZE,value:n}))},{type:o.DEFAULT,title:"Keyboard Alignment",items:Object.entries(q()).map(([n,l])=>({type:o.RADIO,title:l,model:a,name:m.SYNTHESIZER_KEYBOARD_ALIGNMENT,value:n}))},{type:o.SEPARATOR},{title:"Edit Name…",action:async()=>{s(!0);const n=await I(i,"Track renaming:",u.name);n&&(u.name=n,e.options.title=u.name),s(!1),e.focus()}},{type:o.DEFAULT,title:"Note Count",items:Object.entries(j()).map(([n,l])=>({type:o.RADIO,title:`${n} (${l})`,model:u,name:"noteCount",value:l}))},{type:o.DEFAULT,title:"Base Note",items:Object.entries(L()).map(([n,l])=>({type:o.RADIO,title:n,model:u,name:"baseNote",value:l}))},{type:o.SEPARATOR},{type:o.DEFAULT,title:"Beat Count",items:Array(9).fill({}).map((n,l)=>({type:o.RADIO,title:String(l+1),model:u,name:"beatCount",value:l+1}))}]}]||[],...$({core:i})].filter(Boolean)},se=Symbol("pending"),ae=Symbol("fulfilled"),ne=Symbol("rejected");class ie{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t,this.state=se}).then(e=>(this.state=ae,e)).catch(e=>{throw this.state=ne,new Error(e)})}}const T=new ie,oe=A({destination:null,transport:Y,ready:!1,awaitReady:T.promise,async start(){await K(),this.ready=!0,T.resolve()},setBpm(i,e){const t=this.tone.transport;t.stop(),t.bpm.value=120,t.seconds=0,e(),t.bpm.value=i,t.start()}});function we(){return z(()=>{window.Tone=R}),{tone:oe}}const re={props:{selected:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},text:{type:String,default:null},title:{type:String,default:""},name:{type:String,default:""},value:{type:[String,Number],default:void 0},model:{type:Object,default(){return{}}}},computed:{styleClasses(){return{selected:this.selected}}}},le=["disabled"],ce=["disabled","value","type"],ue=["disabled"];function de(i,e,t,s,a,r){return t.text?(d(),y("div",{key:0,class:h(r.styleClasses)},[_("span",null,S(t.text),1)],2)):t.name?(d(),y("label",{key:1,class:h(r.styleClasses),disabled:t.disabled?!0:void 0},[V(_("input",{"onUpdate:modelValue":e[0]||(e[0]=c=>t.model[t.name]=c),disabled:t.disabled?!0:void 0,value:t.value,type:t.value===void 0?"checkbox":"radio"},null,8,ce),[[F,t.model[t.name]]]),_("span",null,S(t.title),1)],10,le)):(d(),y("button",{key:2,class:h(r.styleClasses),disabled:t.disabled},[_("span",null,S(t.title),1)],10,ue))}const me=E(re,[["render",de],["__scopeId","data-v-58ffde04"]]);const ye=A({}),pe={components:{NavigationItem:me},props:{direction:{type:String,default:"horizontal"},model:{type:Object,default(){return ye}},multline:{type:Boolean,default:!1},items:{type:Array,default(){return[{id:1,title:"Play"},{id:2,title:"Pause"},{id:2,title:"Stop"},{id:2,title:"Reset"},{id:1,title:"Item 1 R",value:"item-1",name:"test"},{id:2,title:"Item 2 R",value:"item-2",name:"test"},{id:2,title:"Item 3 R",value:"item-3",name:"test"},{id:2,title:"Item 4 R",value:"item-4",name:"test"},{id:1,title:"Item 1 C",name:"item1Value"},{id:2,title:"Item 2 C",name:"item2Value"},{id:2,title:"Item 3 C",name:"item3Value"},{id:2,title:"Item 4 C",name:"item4Value"}]}}},computed:{preparedItems(){return this.items.find(i=>Array.isArray(i))?this.items:[this.items]},styleClasses(){return{multline:this.multline,[`direction-${this.direction}`]:this.direction}}}};function fe(i,e,t,s,a,r){const c=N("navigation-item");return d(),y("div",{class:h(r.styleClasses)},[(d(!0),y(w,null,b(r.preparedItems,(f,u)=>(d(),y("ul",{key:u},[(d(!0),y(w,null,b(f,(n,l)=>(d(),y("li",{key:l,class:h({spacer:n.spacer,fill:n.fill})},[n.spacer?U("",!0):(d(),Z(c,x({key:0,model:t.model},n),null,16,["model"]))],2))),128))]))),128))],2)}const be=E(pe,[["render",fe],["__scopeId","data-v-2822fedf"]]);export{be as N,Ie as T,ge as c,we as u};
