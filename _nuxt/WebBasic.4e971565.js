import{A as g}from"./InputText.224b5c3d.js";import{Q as T,j as f,k as m,u as _,q as d,U as W,y as S}from"./index.eb95d3b6.js";import{_ as h,f as v,k as w,l as C,q as x,S as k}from"./entry.211f2c5a.js";import{v as l,w as p,x as N}from"./index.c407afae.js";import"./async.a8557e7e.js";import"./index.56665add.js";import"./viewport.be0c4ff7.js";import"./math.2c224f08.js";const B={components:{AtomMarkdown:T},props:{...f},emits:[...m],setup(e,t){return _(e,t)},data(){return{content:["# WebBasic",`Version: **1.0**  
Created by **Thorn-Welf Walli**`].join(`
`)}}},P={class:"wb-disks-extras13-web-basic-info"};function $(e,t,a,s,u,c){const i=v("atom-markdown");return w(),C("div",P,[x(i,{content:u.content},null,8,["content"])])}const R=h(B,[["render",$],["__scopeId","data-v-b1e4a6cd"]]),A=({model:e,core:t})=>{const{windows:a}=t.modules;return[{order:0,title:"Editor",items:[{title:"New",hotKey:"N",keyCode:78,action:s},{title:"Open…",hotKey:"O",keyCode:79,action:b},{title:"Save",hotKey:"S",keyCode:83,action:u},{title:"Save As…",action:c},{type:d.SEPARATOR},{hotKey:"I",keyCode:73,title:"Info",action:E},{title:"Close",action:I}]},{order:1,title:"Document Settings",items:[{title:"Has Window Output",type:d.CHECKBOX,name:l.HAS_WINDOW_OUTPUT,model:e.value}]},{order:1,title:"Run",hotKey:"R",keyCode:82,action:y},{order:2,title:"Preview",type:d.CHECKBOX,name:p.WEB_BASIC_SHOW_PREVIEW,model:t.config.observable,action(n){return t.config.set(p.WEB_BASIC_SHOW_PREVIEW,n)}}];function s(){e.actions.reset()}function u(){return i()}function c(){return i(!0)}async function i(n=!1){let o=Object.assign({},e.value,{content:e.value.content.split(/\n/g)});o=await W(JSON.stringify(o));let r;return!n&&e.fsItem?(r=await t.executeCommand(`editfile "${e.fsItem.getPath()}" --data="${o}"`),r?t.executeCommand('openDialog "File saved."'):t.executeCommand('openDialog "File could not be saved."')):(e.fsItem=await t.executeCommand(`saveFileDialog --data="${o}" --extension="bs"`),e.fsItem)}async function b(){const n=await t.executeCommand("openFileDialog");if(n)if(l.CONTENT in n.value){const o=Object.assign({},n.value,{[l.CONTENT]:[].concat(n.value[l.CONTENT]).join(`
`)});e.fsItem=n.fsItem,e.openValue=o}else throw new Error("Can't read file content")}async function y(){const n=[];await t.modules.parser.parseBasic(e.value[l.CONTENT].split(/\n/),async(o,r)=>{const O=await t.executeCommand(o,r);return r.message&&n.push(r.message),O}),e.output=n.map(o=>S(o))}function I(){return e.actions.close()}function E(){a.addWindow({title:"Info",component:R,componentData:{model:e},options:{scaleX:!1,scaleY:!1,scrollX:!1,scrollY:!1}},{group:"extras13WebBasic"})}};const V={components:{AtomInputText:g},props:{...f,parentLayout:{type:Object,default(){return{value:N(),fsItem:null,openValue:null}}},model:{type:Object,default:null}},emits:[...m,"refresh"],setup(e,t){const a=k(e,"model"),s=_(e,t);return s.setContextMenu(A,{model:a.value}),s.preserveContextMenu(),{...s}},computed:{openValue(){return this.model.openValue},inputTextOptions(){return{focused:this.parentFocused}},showPreview(){return this.core.config.observable[p.WEB_BASIC_SHOW_PREVIEW]}},watch:{"model.value"(){this.refresh()},openValue(e){e&&(this.model.value=e,this.$nextTick(()=>{this.$refs.input.resetSelection(),this.$emit("refresh",{scroll:!0})}))},showPreview(e){this.model.actions.togglePreview(e)}},mounted(){this.showPreview&&this.$nextTick(()=>{this.model.actions.togglePreview()})},methods:{onRefreshInputText(){this.refresh()},refresh(){this.$nextTick(()=>{this.$emit("refresh",{scroll:!0})})}}},M={class:"wb-disks-extras13-web-basic"};function D(e,t,a,s,u,c){const i=v("atom-input-text");return w(),C("div",M,[x(i,{ref:"input",name:"content",options:c.inputTextOptions,model:a.model.value,onRefresh:c.onRefreshInputText},null,8,["options","model","onRefresh"])])}const G=h(V,[["render",D],["__scopeId","data-v-80cd9fb1"]]);export{G as default};
