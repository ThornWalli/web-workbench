import{W as E}from"./D9PjJnFw.js";import{a as B,N as g}from"./Bjf3RcYt.js";import{N as R}from"./ehWpBOkw.js";import{r as z}from"./D7YMvfqk.js";import{d as N,r as f,k as v,o as _,a1 as x,y as m,z as d,X as S,Y as A,I,_ as k,A as c,C as w,G as y}from"./BkRx7U8b.js";import"./OlYXjGCK.js";import"./D4lI5vpz.js";import"./B1Xgq4rl.js";import"./ClLpnmyR.js";import"./BTMT_sH9.js";import"./CaAbksje.js";import"./BoZA8JgY.js";import"./CNkvSXuu.js";const V=["data-key"],D=["width","height"],G=N({__name:"NoteCanvas",props:{density:{type:Number,default(){return window.devicePixelRatio||1}},notes:{type:Array,default:()=>[[["C#","2m"],["C#2","2m"],["C#2","2m."],["C#","1m"],["C#2","1m"],["C#2","1m."],["C#","2n."],["C#2","2n"],["C#2","2n."],["C#2","4n."]],[["","2m"],["","1m"],["","2n"],["","4n"],["","8n"],["","16n"],["","32n"]],[["C4","2m"],["C4","1m"],["C4","2n"],["C4","4n"],["C4","8n"],["C4","16n"],["C4","32n"]],[["C4","2m."],["C4","1m."],["C4","2n."],["C4","4n."],["C4","8n."],["C4","16n."],["C4","32n."]]]}},emits:["refresh"],setup(C,{emit:u}){const a=f(),i=u,r=f(),e=f(),l=C,h=v(()=>l.notes.flat().map(([t,o])=>new R({note:t,time:o}))),$=v(()=>r.value?h.value:[]);_(()=>{const o=new DOMParser().parseFromString(B,"image/svg+xml").querySelector("svg");if(!o)throw new Error("SVG node not found");window.svgNode=e.value=o,r.value=new g({svgNode:e.value}),x(async()=>{const n=Array.from(a.value?.querySelectorAll("canvas")||[]);await Promise.all(n.map((s,p)=>b(s,h.value[Number(p)]))),i("refresh")})});const b=async(t,o)=>{const n=t.getContext("2d");if(!n)throw new Error("Canvas context not found");n.clearRect(0,0,t.width,t.height);const s=await r.value?.render(o,{colors:{primary:"#ffffff",secondary:"#000000",tertiary:"#ff0000"}});t.width=s.canvas.width*l.density,t.height=s.canvas.height*l.density,t.style=`width: ${s.canvas.width}px; height: ${s.canvas.height}px;`;const p=z(s.canvas,t.width);n.drawImage(p,0,0)};return(t,o)=>(d(),m("ul",{ref_key:"rootEl",ref:a},[(d(!0),m(S,null,A($.value,n=>(d(),m("li",{key:n.name,"data-key":n.name},[r.value?(d(),m("canvas",{key:0,width:r.value.dimension.x,height:r.value.dimension.y},null,8,D)):I("",!0)],8,V))),128))],512))}}),P=k(G,[["__scopeId","data-v-62b4303f"]]),q={class:"wb-disks-extras13-synthesizer-debug-notes"},F=N({__name:"Notes",emits:["refresh"],setup(C,{emit:u}){const a=u,i=new g;return _(()=>{console.log("DEBUG",{noteRenderer:i}),x(()=>{a("refresh")})}),(r,e)=>(d(),m("div",q,[c("fieldset",null,[e[2]||(e[2]=c("legend",null,"Note Cache",-1)),w(E,{label:`Clear Cache (${y(i).cache.size} Bitmaps)`,onClick:e[0]||(e[0]=l=>y(i).cache.clear())},null,8,["label"])]),c("fieldset",null,[e[3]||(e[3]=c("legend",null,"Notes",-1)),w(P,{onRefresh:e[1]||(e[1]=l=>a("refresh"))})])]))}}),Z=k(F,[["__scopeId","data-v-d2cc321d"]]);export{Z as default};
