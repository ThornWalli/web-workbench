var Qo=Object.defineProperty;var Jo=(n,e,t)=>e in n?Qo(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t;var f=(n,e,t)=>(Jo(n,typeof e!="symbol"?e+"":e,t),t),Ns=(n,e,t)=>{if(!e.has(n))throw TypeError("Cannot "+t)};var c=(n,e,t)=>(Ns(n,e,"read from private field"),t?t.call(n):e.get(n)),g=(n,e,t)=>{if(e.has(n))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(n):e.set(n,t)},I=(n,e,t,r)=>(Ns(n,e,"write to private field"),r?r.call(n,t):e.set(n,t),t);var Oe=(n,e,t,r)=>({set _(s){I(n,e,s,t)},get _(){return c(n,e,r)}}),Zr=(n,e,t)=>(Ns(n,e,"access private method"),t);import{W as Le,E as z,r as yt,U as el,X as Qt,Y as tl,c as Na,Z as qi,o as nl,$ as rl,a0 as sl,A as Ki,_ as j,k as x,l as D,D as kn,v as La,z as U,s as Y,t as Ne,C as B,L as it,G as Xs,P as Xt,a1 as Pa,m as E,M as On,x as vi,y as Ei,f as R,q as N,I as V,N as wt,O as xt,a2 as il,H as Xn,a3 as Ma,a4 as al,a5 as Si,V as ol,F as O,u as ll}from"./entry.252f118a.js";import{n as $a,_ as Ii,a as os,b as Rn,c as jt,d as Dn,e as cl,f as Wa,g as Ls,h as ul,i as dl,p as hl}from"./index.56665add.js";function ml(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}function Fa(n,e){var t=n.charAt(0),r=n.substr(1).toLowerCase();return e>0&&t>="0"&&t<="9"?"_"+t+r:""+t.toUpperCase()+r}function fl(n,e){return e===void 0&&(e={}),$a(n,Ii({delimiter:"",transform:Fa},e))}function pl(n,e){return e===0?n.toLowerCase():Fa(n,e)}function Jt(n,e){return e===void 0&&(e={}),fl(n,Ii({transform:pl},e))}function gl(n){return n.charAt(0).toUpperCase()+n.substr(1)}function _l(n){return gl(n.toLowerCase())}function za(n,e){return e===void 0&&(e={}),$a(n,Ii({delimiter:" ",transform:_l},e))}function X(n){return typeof n=="function"}function Ai(n){var e=function(r){Error.call(r),r.stack=new Error().stack},t=n(e);return t.prototype=Object.create(Error.prototype),t.prototype.constructor=t,t}var Ps=Ai(function(n){return function(t){n(this),this.message=t?t.length+` errors occurred during unsubscription:
`+t.map(function(r,s){return s+1+") "+r.toString()}).join(`
  `):"",this.name="UnsubscriptionError",this.errors=t}});function qs(n,e){if(n){var t=n.indexOf(e);0<=t&&n.splice(t,1)}}var Vr=function(){function n(e){this.initialTeardown=e,this.closed=!1,this._parentage=null,this._finalizers=null}return n.prototype.unsubscribe=function(){var e,t,r,s,i;if(!this.closed){this.closed=!0;var a=this._parentage;if(a)if(this._parentage=null,Array.isArray(a))try{for(var o=os(a),l=o.next();!l.done;l=o.next()){var u=l.value;u.remove(this)}}catch(_){e={error:_}}finally{try{l&&!l.done&&(t=o.return)&&t.call(o)}finally{if(e)throw e.error}}else a.remove(this);var d=this.initialTeardown;if(X(d))try{d()}catch(_){i=_ instanceof Ps?_.errors:[_]}var h=this._finalizers;if(h){this._finalizers=null;try{for(var m=os(h),p=m.next();!p.done;p=m.next()){var v=p.value;try{Zi(v)}catch(_){i=i??[],_ instanceof Ps?i=Rn(Rn([],jt(i)),jt(_.errors)):i.push(_)}}}catch(_){r={error:_}}finally{try{p&&!p.done&&(s=m.return)&&s.call(m)}finally{if(r)throw r.error}}}if(i)throw new Ps(i)}},n.prototype.add=function(e){var t;if(e&&e!==this)if(this.closed)Zi(e);else{if(e instanceof n){if(e.closed||e._hasParent(this))return;e._addParent(this)}(this._finalizers=(t=this._finalizers)!==null&&t!==void 0?t:[]).push(e)}},n.prototype._hasParent=function(e){var t=this._parentage;return t===e||Array.isArray(t)&&t.includes(e)},n.prototype._addParent=function(e){var t=this._parentage;this._parentage=Array.isArray(t)?(t.push(e),t):t?[t,e]:e},n.prototype._removeParent=function(e){var t=this._parentage;t===e?this._parentage=null:Array.isArray(t)&&qs(t,e)},n.prototype.remove=function(e){var t=this._finalizers;t&&qs(t,e),e instanceof n&&e._removeParent(this)},n.EMPTY=function(){var e=new n;return e.closed=!0,e}(),n}(),Ba=Vr.EMPTY;function Va(n){return n instanceof Vr||n&&"closed"in n&&X(n.remove)&&X(n.add)&&X(n.unsubscribe)}function Zi(n){X(n)?n():n.unsubscribe()}var Ua={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1},Ks={setTimeout:function(n,e){for(var t=[],r=2;r<arguments.length;r++)t[r-2]=arguments[r];var s=Ks.delegate;return s!=null&&s.setTimeout?s.setTimeout.apply(s,Rn([n,e],jt(t))):setTimeout.apply(void 0,Rn([n,e],jt(t)))},clearTimeout:function(n){var e=Ks.delegate;return((e==null?void 0:e.clearTimeout)||clearTimeout)(n)},delegate:void 0};function ja(n){Ks.setTimeout(function(){throw n})}function Qi(){}function rs(n){n()}var ki=function(n){Dn(e,n);function e(t){var r=n.call(this)||this;return r.isStopped=!1,t?(r.destination=t,Va(t)&&t.add(r)):r.destination=xl,r}return e.create=function(t,r,s){return new er(t,r,s)},e.prototype.next=function(t){this.isStopped||this._next(t)},e.prototype.error=function(t){this.isStopped||(this.isStopped=!0,this._error(t))},e.prototype.complete=function(){this.isStopped||(this.isStopped=!0,this._complete())},e.prototype.unsubscribe=function(){this.closed||(this.isStopped=!0,n.prototype.unsubscribe.call(this),this.destination=null)},e.prototype._next=function(t){this.destination.next(t)},e.prototype._error=function(t){try{this.destination.error(t)}finally{this.unsubscribe()}},e.prototype._complete=function(){try{this.destination.complete()}finally{this.unsubscribe()}},e}(Vr),bl=Function.prototype.bind;function Ms(n,e){return bl.call(n,e)}var yl=function(){function n(e){this.partialObserver=e}return n.prototype.next=function(e){var t=this.partialObserver;if(t.next)try{t.next(e)}catch(r){Qr(r)}},n.prototype.error=function(e){var t=this.partialObserver;if(t.error)try{t.error(e)}catch(r){Qr(r)}else Qr(e)},n.prototype.complete=function(){var e=this.partialObserver;if(e.complete)try{e.complete()}catch(t){Qr(t)}},n}(),er=function(n){Dn(e,n);function e(t,r,s){var i=n.call(this)||this,a;if(X(t)||!t)a={next:t??void 0,error:r??void 0,complete:s??void 0};else{var o;i&&Ua.useDeprecatedNextContext?(o=Object.create(t),o.unsubscribe=function(){return i.unsubscribe()},a={next:t.next&&Ms(t.next,o),error:t.error&&Ms(t.error,o),complete:t.complete&&Ms(t.complete,o)}):a=t}return i.destination=new yl(a),i}return e}(ki);function Qr(n){ja(n)}function wl(n){throw n}var xl={closed:!0,next:Qi,error:wl,complete:Qi},Oi=function(){return typeof Symbol=="function"&&Symbol.observable||"@@observable"}();function Ga(n){return n}function vl(n){return n.length===0?Ga:n.length===1?n[0]:function(t){return n.reduce(function(r,s){return s(r)},t)}}var je=function(){function n(e){e&&(this._subscribe=e)}return n.prototype.lift=function(e){var t=new n;return t.source=this,t.operator=e,t},n.prototype.subscribe=function(e,t,r){var s=this,i=Sl(e)?e:new er(e,t,r);return rs(function(){var a=s,o=a.operator,l=a.source;i.add(o?o.call(i,l):l?s._subscribe(i):s._trySubscribe(i))}),i},n.prototype._trySubscribe=function(e){try{return this._subscribe(e)}catch(t){e.error(t)}},n.prototype.forEach=function(e,t){var r=this;return t=Ji(t),new t(function(s,i){var a=new er({next:function(o){try{e(o)}catch(l){i(l),a.unsubscribe()}},error:i,complete:s});r.subscribe(a)})},n.prototype._subscribe=function(e){var t;return(t=this.source)===null||t===void 0?void 0:t.subscribe(e)},n.prototype[Oi]=function(){return this},n.prototype.pipe=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return vl(e)(this)},n.prototype.toPromise=function(e){var t=this;return e=Ji(e),new e(function(r,s){var i;t.subscribe(function(a){return i=a},function(a){return s(a)},function(){return r(i)})})},n.create=function(e){return new n(e)},n}();function Ji(n){var e;return(e=n??Ua.Promise)!==null&&e!==void 0?e:Promise}function El(n){return n&&X(n.next)&&X(n.error)&&X(n.complete)}function Sl(n){return n&&n instanceof ki||El(n)&&Va(n)}function Il(n){return X(n==null?void 0:n.lift)}function qt(n){return function(e){if(Il(e))return e.lift(function(t){try{return n(t,this)}catch(r){this.error(r)}});throw new TypeError("Unable to lift unknown Observable type")}}function Gt(n,e,t,r,s){return new Al(n,e,t,r,s)}var Al=function(n){Dn(e,n);function e(t,r,s,i,a,o){var l=n.call(this,t)||this;return l.onFinalize=a,l.shouldUnsubscribe=o,l._next=r?function(u){try{r(u)}catch(d){t.error(d)}}:n.prototype._next,l._error=i?function(u){try{i(u)}catch(d){t.error(d)}finally{this.unsubscribe()}}:n.prototype._error,l._complete=s?function(){try{s()}catch(u){t.error(u)}finally{this.unsubscribe()}}:n.prototype._complete,l}return e.prototype.unsubscribe=function(){var t;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){var r=this.closed;n.prototype.unsubscribe.call(this),!r&&((t=this.onFinalize)===null||t===void 0||t.call(this))}},e}(ki),kl=Ai(function(n){return function(){n(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"}}),$e=function(n){Dn(e,n);function e(){var t=n.call(this)||this;return t.closed=!1,t.currentObservers=null,t.observers=[],t.isStopped=!1,t.hasError=!1,t.thrownError=null,t}return e.prototype.lift=function(t){var r=new ea(this,this);return r.operator=t,r},e.prototype._throwIfClosed=function(){if(this.closed)throw new kl},e.prototype.next=function(t){var r=this;rs(function(){var s,i;if(r._throwIfClosed(),!r.isStopped){r.currentObservers||(r.currentObservers=Array.from(r.observers));try{for(var a=os(r.currentObservers),o=a.next();!o.done;o=a.next()){var l=o.value;l.next(t)}}catch(u){s={error:u}}finally{try{o&&!o.done&&(i=a.return)&&i.call(a)}finally{if(s)throw s.error}}}})},e.prototype.error=function(t){var r=this;rs(function(){if(r._throwIfClosed(),!r.isStopped){r.hasError=r.isStopped=!0,r.thrownError=t;for(var s=r.observers;s.length;)s.shift().error(t)}})},e.prototype.complete=function(){var t=this;rs(function(){if(t._throwIfClosed(),!t.isStopped){t.isStopped=!0;for(var r=t.observers;r.length;)r.shift().complete()}})},e.prototype.unsubscribe=function(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null},Object.defineProperty(e.prototype,"observed",{get:function(){var t;return((t=this.observers)===null||t===void 0?void 0:t.length)>0},enumerable:!1,configurable:!0}),e.prototype._trySubscribe=function(t){return this._throwIfClosed(),n.prototype._trySubscribe.call(this,t)},e.prototype._subscribe=function(t){return this._throwIfClosed(),this._checkFinalizedStatuses(t),this._innerSubscribe(t)},e.prototype._innerSubscribe=function(t){var r=this,s=this,i=s.hasError,a=s.isStopped,o=s.observers;return i||a?Ba:(this.currentObservers=null,o.push(t),new Vr(function(){r.currentObservers=null,qs(o,t)}))},e.prototype._checkFinalizedStatuses=function(t){var r=this,s=r.hasError,i=r.thrownError,a=r.isStopped;s?t.error(i):a&&t.complete()},e.prototype.asObservable=function(){var t=new je;return t.source=this,t},e.create=function(t,r){return new ea(t,r)},e}(je),ea=function(n){Dn(e,n);function e(t,r){var s=n.call(this)||this;return s.destination=t,s.source=r,s}return e.prototype.next=function(t){var r,s;(s=(r=this.destination)===null||r===void 0?void 0:r.next)===null||s===void 0||s.call(r,t)},e.prototype.error=function(t){var r,s;(s=(r=this.destination)===null||r===void 0?void 0:r.error)===null||s===void 0||s.call(r,t)},e.prototype.complete=function(){var t,r;(r=(t=this.destination)===null||t===void 0?void 0:t.complete)===null||r===void 0||r.call(t)},e.prototype._subscribe=function(t){var r,s;return(s=(r=this.source)===null||r===void 0?void 0:r.subscribe(t))!==null&&s!==void 0?s:Ba},e}($e),Ha={now:function(){return(Ha.delegate||Date).now()},delegate:void 0},Ol=function(n){Dn(e,n);function e(t,r,s){t===void 0&&(t=1/0),r===void 0&&(r=1/0),s===void 0&&(s=Ha);var i=n.call(this)||this;return i._bufferSize=t,i._windowTime=r,i._timestampProvider=s,i._buffer=[],i._infiniteTimeWindow=!0,i._infiniteTimeWindow=r===1/0,i._bufferSize=Math.max(1,t),i._windowTime=Math.max(1,r),i}return e.prototype.next=function(t){var r=this,s=r.isStopped,i=r._buffer,a=r._infiniteTimeWindow,o=r._timestampProvider,l=r._windowTime;s||(i.push(t),!a&&i.push(o.now()+l)),this._trimBuffer(),n.prototype.next.call(this,t)},e.prototype._subscribe=function(t){this._throwIfClosed(),this._trimBuffer();for(var r=this._innerSubscribe(t),s=this,i=s._infiniteTimeWindow,a=s._buffer,o=a.slice(),l=0;l<o.length&&!t.closed;l+=i?1:2)t.next(o[l]);return this._checkFinalizedStatuses(t),r},e.prototype._trimBuffer=function(){var t=this,r=t._bufferSize,s=t._timestampProvider,i=t._buffer,a=t._infiniteTimeWindow,o=(a?1:2)*r;if(r<1/0&&o<i.length&&i.splice(0,i.length-o),!a){for(var l=s.now(),u=0,d=1;d<i.length&&i[d]<=l;d+=2)u=d;u&&i.splice(0,u+1)}},e}($e),Rl=new je(function(n){return n.complete()}),Ya=function(n){return n&&typeof n.length=="number"&&typeof n!="function"};function Tl(n){return X(n==null?void 0:n.then)}function Dl(n){return X(n[Oi])}function Cl(n){return Symbol.asyncIterator&&X(n==null?void 0:n[Symbol.asyncIterator])}function Nl(n){return new TypeError("You provided "+(n!==null&&typeof n=="object"?"an invalid object":"'"+n+"'")+" where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.")}function Ll(){return typeof Symbol!="function"||!Symbol.iterator?"@@iterator":Symbol.iterator}var Pl=Ll();function Ml(n){return X(n==null?void 0:n[Pl])}function $l(n){return cl(this,arguments,function(){var t,r,s,i;return Wa(this,function(a){switch(a.label){case 0:t=n.getReader(),a.label=1;case 1:a.trys.push([1,,9,10]),a.label=2;case 2:return[4,Ls(t.read())];case 3:return r=a.sent(),s=r.value,i=r.done,i?[4,Ls(void 0)]:[3,5];case 4:return[2,a.sent()];case 5:return[4,Ls(s)];case 6:return[4,a.sent()];case 7:return a.sent(),[3,2];case 8:return[3,10];case 9:return t.releaseLock(),[7];case 10:return[2]}})})}function Wl(n){return X(n==null?void 0:n.getReader)}function Ur(n){if(n instanceof je)return n;if(n!=null){if(Dl(n))return Fl(n);if(Ya(n))return zl(n);if(Tl(n))return Bl(n);if(Cl(n))return Xa(n);if(Ml(n))return Vl(n);if(Wl(n))return Ul(n)}throw Nl(n)}function Fl(n){return new je(function(e){var t=n[Oi]();if(X(t.subscribe))return t.subscribe(e);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}function zl(n){return new je(function(e){for(var t=0;t<n.length&&!e.closed;t++)e.next(n[t]);e.complete()})}function Bl(n){return new je(function(e){n.then(function(t){e.closed||(e.next(t),e.complete())},function(t){return e.error(t)}).then(null,ja)})}function Vl(n){return new je(function(e){var t,r;try{for(var s=os(n),i=s.next();!i.done;i=s.next()){var a=i.value;if(e.next(a),e.closed)return}}catch(o){t={error:o}}finally{try{i&&!i.done&&(r=s.return)&&r.call(s)}finally{if(t)throw t.error}}e.complete()})}function Xa(n){return new je(function(e){jl(n,e).catch(function(t){return e.error(t)})})}function Ul(n){return Xa($l(n))}function jl(n,e){var t,r,s,i;return ul(this,void 0,void 0,function(){var a,o;return Wa(this,function(l){switch(l.label){case 0:l.trys.push([0,5,6,11]),t=dl(n),l.label=1;case 1:return[4,t.next()];case 2:if(r=l.sent(),!!r.done)return[3,4];if(a=r.value,e.next(a),e.closed)return[2];l.label=3;case 3:return[3,1];case 4:return[3,11];case 5:return o=l.sent(),s={error:o},[3,11];case 6:return l.trys.push([6,,9,10]),r&&!r.done&&(i=t.return)?[4,i.call(t)]:[3,8];case 7:l.sent(),l.label=8;case 8:return[3,10];case 9:if(s)throw s.error;return[7];case 10:return[7];case 11:return e.complete(),[2]}})})}function Gl(n,e,t,r,s){r===void 0&&(r=0),s===void 0&&(s=!1);var i=e.schedule(function(){t(),s?n.add(this.schedule(null,r)):this.unsubscribe()},r);if(n.add(i),!s)return i}var qa=Ai(function(n){return function(){n(this),this.name="EmptyError",this.message="no elements in sequence"}});function qn(n,e){return qt(function(t,r){var s=0;t.subscribe(Gt(r,function(i){r.next(n.call(e,i,s++))}))})}var Hl=Array.isArray;function Yl(n,e){return Hl(e)?n.apply(void 0,Rn([],jt(e))):n(e)}function Xl(n){return qn(function(e){return Yl(n,e)})}function ql(n,e,t,r,s,i,a,o){var l=[],u=0,d=0,h=!1,m=function(){h&&!l.length&&!u&&e.complete()},p=function(_){return u<r?v(_):l.push(_)},v=function(_){i&&e.next(_),u++;var k=!1;Ur(t(_,d++)).subscribe(Gt(e,function(W){s==null||s(W),i?p(W):e.next(W)},function(){k=!0},void 0,function(){if(k)try{u--;for(var W=function(){var C=l.shift();a?Gl(e,a,function(){return v(C)}):v(C)};l.length&&u<r;)W();m()}catch(C){e.error(C)}}))};return n.subscribe(Gt(e,p,function(){h=!0,m()})),function(){o==null||o()}}function Ka(n,e,t){return t===void 0&&(t=1/0),X(e)?Ka(function(r,s){return qn(function(i,a){return e(r,i,s,a)})(Ur(n(r,s)))},t):(typeof e=="number"&&(t=e),qt(function(r,s){return ql(r,s,n,t)}))}var Kl=["addListener","removeListener"],Zl=["addEventListener","removeEventListener"],Ql=["on","off"];function Zs(n,e,t,r){if(X(t)&&(r=t,t=void 0),r)return Zs(n,e,t).pipe(Xl(r));var s=jt(tc(n)?Zl.map(function(o){return function(l){return n[o](e,l,t)}}):Jl(n)?Kl.map(ta(n,e)):ec(n)?Ql.map(ta(n,e)):[],2),i=s[0],a=s[1];if(!i&&Ya(n))return Ka(function(o){return Zs(o,e,t)})(Ur(n));if(!i)throw new TypeError("Invalid event target");return new je(function(o){var l=function(){for(var u=[],d=0;d<arguments.length;d++)u[d]=arguments[d];return o.next(1<u.length?u:u[0])};return i(l),function(){return a(l)}})}function ta(n,e){return function(t){return function(r){return n[t](e,r)}}}function Jl(n){return X(n.addListener)&&X(n.removeListener)}function ec(n){return X(n.on)&&X(n.off)}function tc(n){return X(n.addEventListener)&&X(n.removeEventListener)}function Qs(n,e){return qt(function(t,r){var s=0;t.subscribe(Gt(r,function(i){return n.call(e,i,s++)&&r.next(i)}))})}function nc(n){return qt(function(e,t){var r=!1;e.subscribe(Gt(t,function(s){r=!0,t.next(s)},function(){r||t.next(n),t.complete()}))})}function rc(n){return n<=0?function(){return Rl}:qt(function(e,t){var r=0;e.subscribe(Gt(t,function(s){++r<=n&&(t.next(s),n<=r&&t.complete())}))})}function sc(n){return n===void 0&&(n=ic),qt(function(e,t){var r=!1;e.subscribe(Gt(t,function(s){r=!0,t.next(s)},function(){return r?t.complete():t.error(n())}))})}function ic(){return new qa}function ac(n,e){var t=arguments.length>=2;return function(r){return r.pipe(n?Qs(function(s,i){return n(s,i,r)}):Ga,rc(1),t?nc(e):sc(function(){return new qa}))}}function kt(n){n===void 0&&(n={});var e=n.connector,t=e===void 0?function(){return new $e}:e,r=n.resetOnError,s=r===void 0?!0:r,i=n.resetOnComplete,a=i===void 0?!0:i,o=n.resetOnRefCountZero,l=o===void 0?!0:o;return function(u){var d,h,m,p=0,v=!1,_=!1,k=function(){h==null||h.unsubscribe(),h=void 0},W=function(){k(),d=m=void 0,v=_=!1},C=function(){var $=d;W(),$==null||$.unsubscribe()};return qt(function($,_e){p++,!_&&!v&&k();var le=m=m??t();_e.add(function(){p--,p===0&&!_&&!v&&(h=$s(C,l))}),le.subscribe(_e),!d&&p>0&&(d=new er({next:function(Q){return le.next(Q)},error:function(Q){_=!0,k(),h=$s(W,s,Q),le.error(Q)},complete:function(){v=!0,k(),h=$s(W,a),le.complete()}}),Ur($).subscribe(d))})(u)}}function $s(n,e){for(var t=[],r=2;r<arguments.length;r++)t[r-2]=arguments[r];if(e===!0){n();return}if(e!==!1){var s=new er({next:function(){s.unsubscribe(),n()}});return Ur(e.apply(void 0,Rn([],jt(t)))).subscribe(s)}}function Os(n){return Array.isArray(n)||ArrayBuffer.isView(n)}function Za(n,e){let{x:t,y:r,z:s}=e,{x:i,y:a,z:o,w:l}=n,u=l*t+a*s-o*r,d=l*r+o*t-i*s,h=l*s+i*r-a*t,m=-i*t-a*r-o*s,p=u*l+m*-i+d*-o-h*-a,v=d*l+m*-a+h*-i-u*-o,_=h*l+m*-o+u*-a-d*-i;return new e.constructor(p,v,_)}var Js=Math.PI,Ws=Math.PI*2;function jr(n){let e=n%Ws;return e<-Js?e+=Ws:e>Js&&(e-=Ws),e}function oc(n){return n>-1?n<1?Math.acos(n):0:Js}function lc(n,[e,t,r]){let[s,i,a]=n;return new n.constructor(new s.constructor(s.x*e.x+i.x*e.y+a.x*e.z,s.y*e.x+i.y*e.y+a.y*e.z,s.z*e.x+i.z*e.y+a.z*e.z),new s.constructor(s.x*t.x+i.x*t.y+a.x*t.z,s.y*t.x+i.y*t.y+a.y*t.z,s.z*t.x+i.z*t.y+a.z*t.z),new s.constructor(s.x*r.x+i.x*r.y+a.x*r.z,s.y*r.x+i.y*r.y+a.y*r.z,s.z*r.x+i.z*r.y+a.z*r.z))}function cc(n,{x:e,y:t,z:r}){let[s,i,a]=n;return new s.constructor(s.x*e+i.x*t+a.x*r,s.y*e+i.y*t+a.y*r,s.z*e+i.z*t+a.z*r)}function uc(n,[e,t,r]){return new n.constructor(n.dot(e),n.dot(t),n.dot(r))}function Et(n){return typeof n=="number"||(n==null?void 0:n.constructor)===Number}var dc=n=>{try{Cn(n),Hr(n,4)}catch(e){console.error("error while hijackDOMPoint"),console.error(e)}},Gr=0,Ri=1,Ti=2,Di=3,ls=9999999999999,cs=void 0,Qa=Symbol("vector length"),Rs=Symbol("get source"),na=Symbol("checked"),Ce=cs,ht,Tn,hc=[0,1,2,6,24,120,720,5760,51840,518400,5702400,68428800,889574400,12454041600,186810624e3],ei=[],jn=-1,Fs=!1,ra=[];function zs(n,e,t){Ce=n,jn=-1,Tn=1;let r=e(t);if(!Et(r))throw new Error(`
      your assigned progress did not not return a primitive!
      calc() does not support logical operators (|| && ==) directly

      instead of calc(() => v1 || v2);
      use        calc(() => +v1 || +v2);

      instead of calc(() => v1);
      use        calc(v1);
      `);return r}function us(n){let e=n[Rs];return e?e(n).length:n[Qa]||3}function mc(n,e){return us(n)>us(e)?n:e}function fc(n,e){if(Tn+=1,e===ls)return Tn;if(e>=us(n))return 0;let t=n[Rs];if(t)return 1*t(n)[e];if(e===Gr)return 1*n.x;if(e===Ri)return 1*n.y;if(e===Ti)return 1*n.z;if(e===Di)return 1*n.w}function sa(n,e,t){let r=n[Rs];if(r){r(n)[e]=t;return}if(e===Gr){n.x=t;return}if(e===Ri){n.y=t;return}e===Ti&&(n.z=t),e===Di&&(n.w=t)}function Ae(n,e){if(typeof n!="function")throw new Error("no function assigned");if(Ce!==cs)throw new Error("something wrong, do you use calc() inside calc?");try{let t=typeof e>"u",r=typeof e=="function",s=!r&&!t?e:void 0,i=zs(Gr,n,s);if(t&&typeof ht>"u")return i;let a=ht?us(ht):0;if(a===ls){if(!n[na]){let d=zs(ls,n),h=hc[Tn];if(Math.abs(d-h)>Number.EPSILON)throw new Error(`
            algebraic multiplication works only in calls with *

            calc(() => v * m);
            calc(() => m * v);
            calc(() => m * m);
            calc(() => m * m * v);

            `);n[na]=!0}let u=ei[0];for(let d=1;d<Tn-1;d+=1){let h=ei[d];if(!u.multiply)throw new Error(`cannot find method multiply() on ${u}`);u=u.multiply(h)}return u}let o=r?e.length:a;if(o||(o=a),o<a)throw new Error("Your assigned result Vector cant use higher space Operands than it has");let l=new Array(o);l[0]=i,s&&sa(s,Ce,l[0]);for(let u=1;u<o;u+=1){let d=zs(u,n,s);l[u]=d,s&&sa(s,Ce,d)}return t?new ht.constructor(...l):r?e(...l):s}finally{Ce=cs,ht=void 0}}function Cn(n,e){let t=n.prototype;t[Rs]=e;let r=t[Symbol.toPrimitive]||function(s){return s==="string"?this.toString():this.valueOf()};t[Symbol.toPrimitive]=function(s){return Ce===Gr&&(ht=ht?mc(ht,this):this,ei[Tn-1]=this),Ce===cs?r.call(this,s):fc(this,Ce)}}function Ci(n){return function(...e){if(Ce===Gr){if(Fs)return n.apply(this,e);try{Fs=!0,jn+=1;let t=n.apply(this,e);return ra[jn]=t,t}finally{Fs=!1}}return Ce===Ri||Ce===Ti||Ce===Di?(jn+=1,ra[jn]):n.apply(this,e)}}function xe(n,e){let t=n.prototype,r=t[e];t[e]=Ci(r)}function Ts(n,e){let t=n.prototype,r=Object.getOwnPropertyDescriptor(t,e);Object.defineProperty(t,e,{get:Ci(function(){return r.get.call(this)})})}function Hr(n,e){let t=n.prototype;Object.defineProperty(t,Qa,{value:e})}function Ja(n){Hr(n,ls)}function Ds(n){return Ci(n)}typeof DOMPoint<"u"&&dc(DOMPoint);function pc(n){let e="";return n&&(e=`${n}-`),e}function Yr(n,e,t={}){let r=pc(n);return Object.entries(e).forEach(([s,i])=>{t[`--${r}${s}`]=i}),t}var ti=0,ni=1,Me=Symbol("axes");function gc(n,e,t,r){let s=Math.atan2(n,e),i=Math.atan2(t,r);return jr(s-i)}function ia(n){return n*n}var We=class{constructor(n,e){typeof n=="function"?Ae(n,(t,r)=>{this[Me]=[t,r]}):Os(n)?this[Me]=[...n]:n&&Et(n.x)?this[Me]=[n.x||0,n.y||0]:this[Me]=[n||0,e||0]}valueOf(){throw new Error("valueOf() not implemented, looks like you try to calculate outside of calc")}normalize(){let{length:n}=this;return new this.constructor(this.x/n,this.y/n)}norm(){return this.normalize()}dot(n){return this.x*n.x+this.y*n.y}getRad(){return jr(Math.atan2(this.y,this.x))}angleTo(n){return gc(this.y,this.x,n.y,n.x)}rotate(n){let e=Math.sin(n),t=Math.cos(n),r=this.x*t-this.y*e,s=this.x*e+this.y*t;return new this.constructor(r,s)}distance(n){return Math.sqrt(ia(this.x-n.x)+ia(this.y-n.y))}dist(n){return this.distance(n)}toArray(){return[this.x,this.y]}calc(n){throw new Error("calc() not implemented")}clone(){throw new Error("clone() not implemented")}equals(n){return this.x===n.x&&this.y===n.y}toJSON(){return{x:this.x,y:this.y}}toString(){return JSON.stringify(this.toJSON())}toCSSVars(n,e){return Yr(n,this.toJSON(),e)}get lengthSq(){return this.dot(this)}get length(){return Math.sqrt(this.lengthSq)}get lensq(){return this.lengthSq}get len(){return this.length}get x(){return this[Me][ti]}set x(n){throw new Error("set x() not implemented")}get y(){return this[Me][ni]}set y(n){throw new Error("set y() not implemented")}get z(){throw new Error("get z() not implemented")}set z(n){throw new Error("set z() not implemented")}[Symbol.iterator](){return this[Me].values()}};Cn(We);Hr(We,2);xe(We,"dot");xe(We,"angleTo");xe(We,"distance");xe(We,"toArray");xe(We,"getRad");Ts(We,"length");Ts(We,"lengthSq");var eo=class to extends We{set x(e){this[Me][ti]=e}set y(e){this[Me][ni]=e}get x(){return this[Me][ti]}get y(){return this[Me][ni]}calc(e){return Ae(e,this)}clone(){return new to(this.x,this.y)}},en=class extends We{toPoint(){return new eo(this.x,this.y)}},_c=Ds((n,e)=>new eo(n,e)),no=(n,e)=>_c(n,e),bc=Ds((n,e)=>new en(n,e)),A=(n,e)=>bc(n,e);A(0,0);A(0,-1);A(-1,0);var tn=0,nn=1,rn=2,q=Symbol("axes");function Bs(n){return n*n}var ve=class{constructor(n,e,t){typeof n=="function"?Ae(n,(r,s,i)=>{this[q]=[r,s,i]}):Os(n)?this[q]=[...n]:n&&Et(n.x)?this[q]=[n.x||0,n.y||0,n.z||0]:this[q]=[n||0,e||0,t||0]}valueOf(){throw new Error("valueOf() not implemented, looks like you try to calculate outside of calc")}normalize(){let{length:n}=this;return new this.constructor(this.x/n,this.y/n,this.z/n)}norm(){return this.normalize()}dot(n){return this.x*n.x+this.y*n.y+this.z*n.z}cross(n){return new this.constructor(this.y*n.z-this.z*n.y,this.z*n.x-this.x*n.z,this.x*n.y-this.y*n.x)}crossNormalize(n){let e=this.cross(n),{length:t}=e;return e[q][tn]/=t,e[q][nn]/=t,e[q][rn]/=t,e}cn(n){return this.crossNormalize(n)}toAngles(){return{theta:Math.atan2(this.z,this.x),phi:Math.asin(this.y/this.length)}}angleTo(n){return jr(oc(this.dot(n)/(this.length*n.length)))}multiply(n){return n.x===void 0?this.multiplyMat3(n):n.w===void 0?this.multiplyVec3(n):Za(n,this)}multiplyMat3(n){return uc(this,n)}multiplyVec3({x:n,y:e,z:t}){return new this.constructor(this.x*n,this.y*e,this.z*t)}distance(n){return Math.sqrt(Bs(this.x-n.x)+Bs(this.y-n.y)+Bs(this.z-n.z))}dist(n){return this.distance(n)}toArray(){return[this.x,this.y,this.z]}swizzle(n){let e=n.split("").map(t=>this[t]);return e.length===2?new en(e[0],e[1]):new this.constructor(e[0],e[1],e[2])}calc(n){throw new Error("calc() not implemented")}clone(){throw new Error("clone() not implemented")}equals(n){return this.x===n.x&&this.y===n.y&&this.z===n.z}toJSON(){return{x:this.x,y:this.y,z:this.z}}toString(){return JSON.stringify(this.toJSON())}toCSSVars(n,e){return Yr(n,this.toJSON(),e)}get lengthSq(){return this.dot(this)}set lengthSq(n){throw new Error("set lengthSq() not implemented")}get length(){return Math.sqrt(this.lengthSq)}set length(n){throw new Error("set length() not implemented")}get lensq(){return this.lengthSq}set lensq(n){throw new Error("set lensq() not implemented")}get len(){return this.length}set len(n){throw new Error("set len() not implemented")}get x(){return this[q][tn]}set x(n){throw new Error("set x() not implemented")}get y(){return this[q][nn]}set y(n){throw new Error("set y() not implemented")}get z(){return this[q][rn]}set z(n){throw new Error("set z() not implemented")}get xy(){return new en(this[q][tn],this[q][nn])}set xy(n){throw new Error("set xz() not implemented")}get xz(){return new en(this[q][tn],this[q][rn])}set xz(n){throw new Error("set xz() not implemented")}get yz(){return new en(this[q][nn],this[q][rn])}set yz(n){throw new Error("set yz() not implemented")}[Symbol.iterator](){return this[q].values()}};Cn(ve);Hr(ve,3);xe(ve,"dot");xe(ve,"cross");xe(ve,"crossNormalize");xe(ve,"toAngles");xe(ve,"angleTo");xe(ve,"rotate");xe(ve,"distance");xe(ve,"toArray");Ts(ve,"length");Ts(ve,"lengthSq");var yc=class ro extends ve{set x(e){this[q][tn]=e}set y(e){this[q][nn]=e}set z(e){this[q][rn]=e}get x(){return this[q][tn]}get y(){return this[q][nn]}get z(){return this[q][rn]}calc(e){return Ae(e,this)}clone(){return new ro(this.x,this.y,this.z)}},wc=class extends ve{toVector(){return new yc(this.x,this.y,this.z)}clone(){return this}},xc=Ds((n,e,t)=>new wc(n,e,t)),St=(n,e,t)=>xc(n,e,t);St(0,0,0);var so=St(0,0,-1);St(0,0,1);var Ni=St(-1,0,0);St(1,0,0);var io=St(0,1,0);St(0,-1,0);St(1,1,1);var Je=Symbol("angle rad"),ao=Math.PI/180,ds=class oo{constructor(e){e instanceof oo?this[Je]=e[Je]:this[Je]=jr(e*ao)}valueOf(){return this[Je]}toJSON(){return{angle:this[Je]}}toString(){return JSON.stringify(this.toJSON())}toCSSVars(e,t){return Yr(e,this.toJSON(),t)}},lo=class extends ds{set(n){n instanceof ds?this[Je]=n[Je]:this[Je]=jr((n||0)*ao)}},vc=class extends ds{toDegree(){return new lo(this[Je])}};new vc(0);function Ec(n){return new lo(n)}function Sc(n){return Et(n)||n instanceof ds}var et=0,tt=1,nt=2,rt=3,oe=Symbol("axes"),Ic=Symbol("forward cache"),Ac=Symbol("left cache"),kc=Symbol("up cache"),Oc=Symbol("inverse cache");function Rc([n,e,t,r]){return Math.sqrt(n*n+e*e+t*t+r*r)}function co(n){let e=Rc(n);n[et]/=e,n[tt]/=e,n[nt]/=e,n[rt]/=e}function Tc(n,e){let t=n.normalize(),r=e.crossNormalize(t),s=t.crossNormalize(r),i=r.x,a=r.y,o=r.z,l=s.x,u=s.y,d=s.z,h=t.x,m=t.y,p=t.z,v=i+u+p,_=new Array(4);if(v>0){let C=Math.sqrt(v+1);return _[rt]=C*.5,C=.5/C,_[et]=(d-m)*C,_[tt]=(h-o)*C,_[nt]=(a-l)*C,_}if(i>=u&&i>=p){let C=Math.sqrt(1+i-u-p),$=.5/C;return _[et]=.5*C,_[tt]=(a+l)*$,_[nt]=(o+h)*$,_[rt]=(d-m)*$,_}if(u>p){let C=Math.sqrt(1+u-i-p),$=.5/C;return _[et]=(l+a)*$,_[tt]=.5*C,_[nt]=(m+d)*$,_[rt]=(h-o)*$,_}let k=Math.sqrt(1+p-i-u),W=.5/k;return _[et]=(h+o)*W,_[tt]=(m+d)*W,_[nt]=.5*k,_[rt]=(a-l)*W,_}function Dc(n,e){let t=new Array(4),r=e*.5,s=Math.sin(r),i=Math.cos(r);return t[et]=s*n.x,t[tt]=s*n.y,t[nt]=s*n.z,t[rt]=i,t}function ri(n,e,t,r){if(Et(n))return[n,e,t,r];if(Os(n))return[...n];if(Sc(e))return Dc(n,e);if(n&&e)return Tc(n,e)}function uo(n,e,t,r){return n&&Et(n.w)?ri(n.x,n.y,n.z,n.w):ri(n,e,t,r)||[0,0,0,1]}var tr=class{constructor(n,e,t,r){this[oe]=uo(n,e,t,r),co(this[oe])}set(n,e,t,r){throw new Error("set x() not implemented")}multiply(n,e,t,r){if(Et(n.w))return this.multiplyQuaternion(n);let s=ri(n,e,t,r);return s?this.multiplyQuaternion(new this.constructor(s)):this.multiplyVector(n)}multiplyVector(n){return Za(this,n)}multiplyQuaternion(n){let e=this.x,t=this.y,r=this.z,s=this.w,i=n.x,a=n.y,o=n.z,l=n.w,u=s*i+e*l+t*o-r*a,d=s*a+t*l+r*i-e*o,h=s*o+r*l+e*a-t*i,m=s*l-e*i-t*a-r*o;return new this.constructor(u,d,h,m)}mul(n,e,t,r){return this.multiply(n,e,t,r)}get inverse(){let{x:n,y:e,z:t,w:r}=this;return this.constructor(n*-1,e*-1,t*-1,r)}get inv(){return this.inverse}equals(n){return this.x===n.x&&this.y===n.y&&this.z===n.z&&this.w===n.w}get left(){return this.multiplyVector(Ni)}get dir(){return this.multiplyVector(so)}get up(){return this.multiplyVector(io)}get 0(){return this.left}get 1(){return this.dir}get 2(){return this.up}get x(){return this[oe][et]}set x(n){throw new Error("set x() not implemented")}get y(){return this[oe][tt]}set y(n){throw new Error("set y() not implemented")}get z(){return this[oe][nt]}set z(n){throw new Error("set z() not implemented")}get w(){return this[oe][rt]}set w(n){throw new Error("set w() not implemented")}toJSON(){let{x:n,y:e,z:t,w:r}=this;return{x:n,y:e,z:t,w:r,a1:1-e*e*2-t*t*2,a2:n*e*2-t*r*2,a3:n*t*2+e*r*2,b1:n*e*2+t*r*2,b2:1-n*n*2-t*t*2,b3:e*t*2-n*r*2,c1:n*t*2-e*r*2,c2:e*t*2+n*r*2,c3:1-n*n*2-e*e*2}}toString(){return JSON.stringify(this.toJSON())}toCSSVars(n,e){return Yr(n,this.toJSON(),e)}};Cn(tr);Ja(tr);var Cc=class extends tr{set(n,e,t,r){n instanceof tr?this[oe]=[...n[oe]]:(this[oe]=uo(n,e,t,r),co(this[oe]))}set x(n){this[oe][et]=n}set y(n){this[oe][tt]=n}set z(n){this[oe][nt]=n}set w(n){this[oe][rt]=n}get x(){return this[oe][et]}get y(){return this[oe][tt]}get z(){return this[oe][nt]}get w(){return this[oe][rt]}};function Jr(n,e,t){let r=n[e];return r||(r=t(),n[e]=r),r}var ho=class extends tr{get left(){return Jr(this,Ac,()=>this.multiplyVector(Ni))}get dir(){return Jr(this,Ic,()=>this.multiplyVector(so))}get up(){return Jr(this,kc,()=>this.multiplyVector(io))}get inverse(){return Jr(this,Oc,()=>{let{x:n,y:e,z:t,w:r}=this;return this.constructor(n*-1,e*-1,t*-1,r)})}};new Cc;var Nc=Ds((n,e,t,r)=>new ho(n,e,t,r)),Lc=(n,e,t,r)=>Nc(n,e,t,r);new ho(Ni,Ec(90));Lc(0,0,0,1);var Pc=0,Mc=1,$c=2,Wc=3,Ge=Symbol("axes"),Li=class{constructor(n,e,t,r){typeof n=="function"?Ae(n,(s,i,a,o)=>{this[Ge]=[s,i,a,o]}):Os(n)?this[Ge]=[...n]:n&&Et(n.x)?this[Ge]=[n.x||0,n.y||0,n.z||0,n.w||0]:this[Ge]=[n||0,e||0,t||0,r||0]}dot(n){return this.x*n.x+this.y*n.y+this.z*n.z+this.w*n.w}valueOf(){throw new Error("valueOf() not implemented, looks like you try to calculate outside of calc")}toArray(){return[this.x,this.y,this.z,this.w]}calc(n){throw new Error("calc() not implemented")}clone(){throw new Error("clone() not implemented")}equals(n){return this.x===n.x&&this.y===n.y&&this.z===n.z&&this.w===n.w}toJSON(){return{x:this.x,y:this.y,z:this.z,w:this.w}}toString(){return JSON.stringify(this.toJSON())}toCSSVars(n,e){return Yr(n,this.toJSON(),e)}get x(){return this[Ge][Pc]}set x(n){throw new Error("set x() not implemented")}get y(){return this[Ge][Mc]}set y(n){throw new Error("set y() not implemented")}get z(){return this[Ge][$c]}set z(n){throw new Error("set z() not implemented")}get w(){return this[Ge][Wc]}set w(n){throw new Error("set w() not implemented")}[Symbol.iterator](){return this[Ge].values()}};Cn(Li);Hr(Li,4);xe(Li,"toArray");var $n=Symbol("data"),mo=class fo{constructor(...e){this[$n]=e}get 0(){return this[$n][0]}set 0(e){throw new Error("set [0] not implemented")}get 1(){return this[$n][1]}set 1(e){throw new Error("set [1] not implemented")}get 2(){return this[$n][2]}set 2(e){throw new Error("set [2] not implemented")}multiplyMat(e){return lc(this,e)}multiplyVec(e){return cc(this,e)}multiply(e){if(e instanceof fo)return this.multiplyMat(e);let{x:t,y:r,z:s}=e;if(t===void 0||r===void 0||s===void 0)throw new Error(`multiply only works with mat3 and vec3, not supported ${e}`);return this.multiplyVec(e)}[Symbol.iterator](){return this[$n].values()}};Cn(mo);Ja(mo);class Fc{constructor(e){f(this,"items",[]);f(this,"itemsMapping",new Map);f(this,"key");this.key=e}add(e){e.forEach(t=>{[].concat(t[this.key]).forEach(r=>{this.itemsMapping.set(r,t)})}),this.items.push(...e)}remove(e){e.forEach(t=>{this.items.splice(this.items.indexOf(t),1)})}has(e){return this.itemsMapping.has(e)}get(e){return this.itemsMapping.get(e)}}class zc extends Fc{constructor(){super("name")}}const Ot=new zc;var ar,or,an,lr;class Bc{constructor({name:e,description:t,args:r,action:s}){g(this,ar,void 0);g(this,or,void 0);g(this,an,[]);g(this,lr,void 0);I(this,ar,[].concat(e)),I(this,or,t),I(this,an,r||c(this,an)),I(this,lr,s)}action(...e){return c(this,lr).call(this,...e)}get description(){return c(this,or)}get name(){return c(this,ar)}get args(){return c(this,an)}}ar=new WeakMap,or=new WeakMap,an=new WeakMap,lr=new WeakMap;function po(n){return n.map(e=>new Bc(e))}function Vc(n,e){return n.args.reduce((t,r)=>{const s=[].concat(r.name);s.length<1&&(s.push=`argument-${r.index}`);const i=Jt(r.name[0]);if("index"in r&&r.index!==void 0&&Number(r.index)in e.args){const a=r.index;let o=e.args[Number(a)];o=o===void 0?!0:o,t[Number(a)]=o,t.unresolved[Number(a)]=e.unresolved.args[Number(a)],t[String(i)]=o,t.unresolved[String(i)]=e.unresolved.args[Number(a)]}return s.forEach(a=>{if(a in e.kwargs){const o=e.kwargs[String(a)];t[String(i)]=o===void 0?!0:o,t.unresolved[String(i)]=e.kwargs[String(a)]===void 0?!0:o}}),t},{unresolved:{}})}var cr,ur,dr,hr;class b{constructor({name:e,index:t,flag:r,description:s}){g(this,cr,void 0);g(this,ur,void 0);g(this,dr,void 0);g(this,hr,void 0);I(this,cr,[].concat(e)),I(this,ur,t),I(this,dr,r),I(this,hr,s)}get name(){return c(this,cr)}get index(){return c(this,ur)}get flag(){return c(this,dr)}get description(){return c(this,hr)}}cr=new WeakMap,ur=new WeakMap,dr=new WeakMap,hr=new WeakMap;let es;const Uc=new Uint8Array(16);function jc(){if(!es&&(es=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!es))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return es(Uc)}const ce=[];for(let n=0;n<256;++n)ce.push((n+256).toString(16).slice(1));function Gc(n,e=0){return(ce[n[e+0]]+ce[n[e+1]]+ce[n[e+2]]+ce[n[e+3]]+"-"+ce[n[e+4]]+ce[n[e+5]]+"-"+ce[n[e+6]]+ce[n[e+7]]+"-"+ce[n[e+8]]+ce[n[e+9]]+"-"+ce[n[e+10]]+ce[n[e+11]]+ce[n[e+12]]+ce[n[e+13]]+ce[n[e+14]]+ce[n[e+15]]).toLowerCase()}const Hc=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),aa={randomUUID:Hc};function Nn(n,e,t){if(aa.randomUUID&&!e&&!n)return aa.randomUUID();n=n||{};const r=n.random||(n.rng||jc)();if(r[6]=r[6]&15|64,r[8]=r[8]&63|128,e){t=t||0;for(let s=0;s<16;++s)e[t+s]=r[s];return e}return Gc(r)}const te={DEFAULT:0,SEPARATOR:1,SPACER:2,TEXT:3,CHECKBOX:4,RADIO:5};class oa{constructor({type:e=te.DEFAULT,model:t,options:r,action:s,command:i,url:a,order:o=-1,title:l=null,text:u=null,items:d=[],name:h=null,value:m=null,hotKey:p,keyCode:v,onInit:_}){f(this,"options",{disabled:!1,checked:!1});this.id=Nn(),this.type=e,this.model=t,this.options=Object.assign(r||{},this.options,Object.assign({},r)),e===te.RADIO&&(this.options.checked=this.options.checked=this.options.checked?m:!1),this.action=s,this.command=i,this.url=a,this.name=h,this.value=m,this.order=o,this.title=l,this.text=u,this.items=go(d),this.hotKey=p,this.keyCode=v,_&&_(this)}}function go(n){return n.map(e=>e instanceof oa?e:new oa(e))}class Ht{constructor(e,t){f(this,"id",Nn());f(this,"items",[]);e&&(this.items=go(e(t)))}add(e){e instanceof Ht&&this.items.push(...e.items)}}class Cs{constructor({config:e={},commands:t,contextMenu:r=null,core:s}){f(this,"commands",[]);f(this,"contextMenu",[]);f(this,"config",{});f(this,"core");this.core=s,this.config=e,this.commands=t,this.contextMenu=r}beforeSetup(){const e=this.core;e.config.setDefaults(this.config),typeof this.commands=="function"&&(this.commands=po(this.commands({core:e,module:this})),Ot.add(this.commands)),typeof this.contextMenu=="function"&&(this.contextMenu=new Ht(this.contextMenu,{core:e,module:this}),this.core.modules.windows.contextMenu.addDefaultItems(this.contextMenu))}setup(e){this.log(this.name)}destroy(){this.core.removeCommands(this.commands)}log(e){this.core.logger.add(e,{namespace:this.constructor.NAME})}get name(){return this.constructor.NAME}}const _o="default",Gn={default:{title:"Theme Default",colors:["#FFFFFF","#000","#FFAA55","#0055AA"],filter:"invert(100%)"},theme1:{title:"Theme 1",colors:["#000000","#FFFFFF","#4466aa","#919191"],filter:"invert(100%)"},theme2:{title:"Theme 2",colors:["#FFFFFF","#000000","#dd99aa","#8080a0"],filter:"invert(100%)"},theme3:{title:"Theme 3",colors:["#FFFFFF","#000000","#a8a0a0","#406080"],filter:"invert(100%)"},theme4:{title:"Theme 4",colors:["#FFFFFF","#50473f","#a08070","#b0a090"],filter:"invert(100%)"},themeAmber:{title:"Theme Amber",colors:["#FFB000","#805800","#805800","#000000"],filter:"brightness(50%)"},themeGreen:{title:"Theme Green",colors:["#00f900","#008f11","#00Bb00","#000000"],filter:"brightness(50%)"},themeRed:{title:"Theme Red",colors:["#ee0000","#660000","#990000","#330000"],filter:"brightness(50%)"}};function bo(n){return n=n||["#FFF","#000","#FFAA55","#0055AA"],{boot:{sequence_error:"#000",sequence_ready:n[3],sequence_no_disk:"#fff",sequence_0:"#000",sequence_1:"#ccc",sequence_2:"#fff",sequence_3:n[3]},symbol:{primary:n[0],secondary:n[1],tertiary:n[2],quaternary:n[3]},screen:{background:n[3]},header:{background:n[0],coverBackground:n[0],coverTitle:n[3],title:n[3]},windowHeader:{background:n[0],stripes:n[3],title:n[3],buttonBackground:n[3],buttonPrimary:n[0],buttonSecondary:n[1]},contextMenu:{border:n[3]},contextMenuItem:{background:n[0],label:n[3],indicatorContext:n[3],hotkey:n[3]},contextMenuSeparator:{background:n[3]},window:{text:n[0],background:n[3],border:n[0],borderScaling:n[2],helper__scaleBackground:n[0],helper__scaleIcon:n[3],helper__scaleIconActive:n[1]},storageBar:{background:n[1],border:n[0],sizeHelper:n[2],icon:n[0]},scrollContent:{scrollbarCorner:n[0],scrollbarSpacer:n[0],scrollbarBackground:n[3],scrollbarHelperBackground:n[0],scrollbarHelper:n[3],scrollbarHelperActive:n[1],scrollbarRange:n[0]},symbolWrapperItem:{text:n[0]},button:{label:n[0],primary:{label:n[3],background:n[0],border:n[0],outline:n[3]},secondary:{label:n[0],background:n[3],border:n[0]},dialog:{label:n[3],background:n[0],border:n[2],outline:n[3]}},checkboxGroupItem:{disabled:{icon:n[0],background:n[0]},background:n[3],checkbox:{icon:n[0]},radio:{icon:n[0]}},rangeSlider:{background:n[3],border:n[0],thumbBackground:n[0]},textbox:{text:n[0],background:n[3],border:n[3],outline:n[0],dialog:{text:n[3],background:n[0],border:n[0],outline:n[3]},disabledReadonlyText:n[3],disabledReadonlyBackground:n[0]},textarea:{text:n[0],background:n[3],border:n[3],outline:n[0],resizeBackground:n[3],resizeIcon:n[0]},dropdown:{disabled:{text:n[3],background:n[0]},text:n[0],background:n[3],border:n[3],outline:n[0],scrollbarPrimary:n[0],scrollbarSecondary:n[3],expander:{icon:n[3],border:n[3],background:n[0]}},itemSelect:{border:n[0]},itemSelectItem:{border:n[0],background:n[3],disabledLabelText:n[0],disabledLabelbackground:n[1]},inputText:{selected:n[3],pointer:n[2]},markdown:{typo:{selection:n[1],headlinePrimary:n[0],headlineSecondary:n[2],strong:n[2],strongEm:n[0],link:n[2],linkHover:n[0],del:n[1],line:n[0],blockquoteBackground:n[2],blockquoteText:n[1],codeBackground:n[0],codeText:n[1],codeSelection:n[2]}},dialogContent:{backgroundPrimary:n[0],backgroundSecondary:n[0],text:n[3]},form:{fieldsetBorder:n[2]},console:{text:n[0],typo:{fieldsetBorder:n[2],line:n[0],strong:n[2],strongEm:n[0]}},core:{text:n[0]},workbench13:{calculator:{background:n[1],button:{text:n[0],border:n[0]},result:{border:n[0]}}}}}function yo(n){return{default:n||"invert(100%)"}}class Yc{constructor(e,t){f(this,"name","wb13");const{colors:r,filters:s}=Object.assign({colors:{},filters:{}},t);this.name=e||this.name,this.colors=Object.assign(bo(),r),this.filters=Object.assign(yo(),s)}toCSSVars(){return Object.assign({},si(Object.assign({color:this.colors,filter:this.filters})),si())}}const Xc="-";function si(n,e="",t={}){return typeof n=="object"?(Object.keys(n).map(r=>si(n[String(r)],(e?e+Xc:"")+r,t)),t):(t[`--${hl(e)}`]=n,t)}class qc extends Yc{constructor(e,t){const{colors:r,filter:s}=Object.assign({colors:null,filter:null},t);super(e,{colors:bo(r),filters:yo(s)})}}const Dp=2e3,Cp={NO_DISK:"no-disk",ERROR:"error",READY:"ready",SEQUENCE_1:0,SEQUENCE_2:1,SEQUENCE_3:2},P={SCREEN_1084_FRAME:"core_screen1084Frame",SCREEN_REAL_LOOK:"core_screenRealLook",SCREEN_SCAN_LINES:"core_screenScanlines",SCREEN_ACTIVE_ANIMATION:"core_screenActiveAnimation",BOOT_WITH_SEQUENCE:"core_bootWithSequence",BOOT_WITH_WEBDOS:"core_bootWithWebDos",THEME:"core_theme",FILE_EXTENSION_ASSIGNMENT:"core_fileExtensionAssignment",SCREEN_CONFIG:"core_screenConfig"},la={[P.SCREEN_1084_FRAME]:!0,[P.SCREEN_REAL_LOOK]:!0,[P.SCREEN_SCAN_LINES]:!0,[P.SCREEN_ACTIVE_ANIMATION]:!0,[P.BOOT_WITH_SEQUENCE]:!0,[P.BOOT_WITH_WEBDOS]:!0,[P.THEME]:Gn[String(_o)],[P.FILE_EXTENSION_ASSIGNMENT]:[["md","DF0:DocumentReader.app"],["bas","DF1:WebBasic.app"],["basic","DF1:WebBasic.app"]],[P.SCREEN_CONFIG]:{contrast:.5,brightness:.5,color:.5,sharpness:0,horizontalCentering:.5,soundVolume:.5}},Kc="web_workbench_CONFIG",Np=new Promise(n=>{/complete|interactive|loaded/.test(document.readyState)?n():document.addEventListener("DOMContentLoaded",n,!1)});var mr;class Zc{constructor(){g(this,mr,void 0);window.requestAnimationFrame(()=>{document.documentElement.style.overflowY="scroll",I(this,mr,window.innerWidth-document.body.offsetWidth),document.documentElement.style.overflowY=null})}get size(){return c(this,mr)}}mr=new WeakMap;const Lp=new Zc;function Qc(n,e){return n===e?!0:n.parentElement?n.parentElement!==e?Qc(n.parentElement,e):!0:!1}window.requestAnimationFrame(()=>{document.documentElement.style.overflowY="scroll",window.innerWidth-document.body.offsetWidth,document.documentElement.style.overflowY=null});function ss(n){if(n.touches&&n.touches.length>0){const e=n.touches[0];n.clientX=e.clientX,n.clientY=e.clientY}return"x"in n||(n.x=n.clientX,n.y=n.clientY),n}class G{constructor(e,t){this.name=e,this.value=t}}const Jc=A(0,0);class nr{constructor({title:e,sidebarComponent:t,sidebarComponentData:r,component:s,componentData:i,options:a,symbolWrapper:o,wrapper:l,layout:u}){f(this,"events",new $e);f(this,"id",Nn());f(this,"component");f(this,"componentData");f(this,"sidebarComponent");f(this,"sidebarComponentData");f(this,"options",Le({title:"Unnamed",scaleX:!0,scaleY:!0,scrollX:!0,scrollY:!0,clampX:!0,clampY:!1,freeze:!1,focused:!1,center:!0,close:!0,overlay:!0,embed:!1,borderless:!1,hideRootHeader:!1,sidebar:!0}));f(this,"symbolWrapper",null);f(this,"group",null);f(this,"wrapper",null);f(this,"layout",Le({focused:!1,position:A(0,0),size:Jc,scrollOffset:A(0,0)}));this.options.title=e,t&&(this.sidebarComponent=z(t)),r&&(this.sidebarComponentData=z(r)),this.component=z(s),this.componentData={...i,window:this},o&&(this.symbolWrapper=z(o)),l&&(this.wrapper=z(l)),this.options=Object.assign(this.options,a),this.layout=Object.assign(this.layout,u)}ready(){this.options.ready=!0,this.events.next(new G("ready"))}focus(){this.options.focused=!0,this.events.next(new G("focus"))}unfocus(){this.options.focused=!1,this.events.next(new G("unfocus"))}close(e){this.wrapper&&(this.events.next(new G("close",e)),this.wrapper.remove(this.id),this.wrapper=null)}setWrapper(e){this.wrapper=z(e)}setGroup(e){this.group=e}awaitClose(){return new Promise(e=>{const t=this.events.pipe(Qs(({name:r})=>r==="close")).subscribe((...r)=>{t.unsubscribe(),e(...r)})})}awaitReady(){return new Promise(e=>{if(this.options.ready)e();else{const t=this.events.pipe(Qs(({name:r})=>r==="ready")).subscribe((...r)=>{t.unsubscribe(),e(...r)})}})}}var on;class eu{constructor(){g(this,on,new Map)}get items(){return c(this,on)}add(e,t){Array.isArray(e)?e.forEach(r=>{this.add(...r)}):c(this,on).set(e,[].concat(t))}get(...e){const t=e.shift();return c(this,on).get(t).map(r=>e.reduce((s,i)=>s.replace(/%\d+/,i),r))}}on=new WeakMap;const L=new eu;L.add("bad_args","Bad args");L.add("cant_find","Can't find %1");const tu="/",Vs="ROOT",nu="CLOUD";function Te(n){return typeof n=="object"&&"id"in n?n.id:n.replace(/.*[\\/:]{1,1}([^:\\/]+)$/,"$1")}function ru(n){return/^[a-zA-Z0-9_-]+:/.test(n)}function Pi(...n){return n.reduce((e,t)=>(e.push(...t.replace(/[\\/]+/,"/").replace(/^\//,"").replace(/\/$/,"").split("/")),e),[]).join("/").replace(/\/$/,"")}function su(n){return n.replace(/(.*)[:/]([^\\/:]+)/,"$1")}function iu(n){return n.replace(/(.*)\/([^\\/]+)/,"$2")}function Wn(n){return n.replace(/(.*[\\/:]{1,1})[^:\\/]+$/,"$1")}function is(n){return n.length&&/^[\w .\\/:-]+$/.test(n)}function au(n){return is(n)&&!!(n.includes("/")||n.match(/^([^:]+):.*/))}function ou(n){return n*1e3}function Mi(n){return n.replace(/^(.*)\.[^.]+$/,"$1")}function rr(n){const e=n.match(/^.*\.([^.]*)$/);return e?e[1]:""}function wo(n){return n.replace(/[^.a-zA-Z0-9_-]/g,"_")}function hs(n,e){return e?`${Mi(n)}.${e}`:n}function xo(n,e,t){let r=n;return e.hasItem(hs(r,t))?(r=`copy_${n}`,e.hasItem(hs(r,t))?xo(r,e,t):r):r}function He(n){if(n.getStorageItem()){if(n.getStorageItem().locked)throw L.get("FileSystem_permissionsNeeded");return n}return n}async function we(n,e){return(e||n.getStorageItem())&&(await n.save(),await(e||n.getStorageItem()).save()),n}async function lu(n,e){const t=await e.remove(n);return Array.isArray(t)?t:[t]}const w={DEFAULT:"default",DIRECTORY:"directory",DIRECTORY_PREFS:"directory_prefs",CLOUD_DISK:"cloud_disk",HARD_DISK:"hard_disk",RAM_DISK:"ram_disk",TMP_DISK:"tmp_disk",DISK_1:"disk_1",DISK_2:"disk_2",DISK_WORKBENCH13:"disk_workbench13",DISK_MARKDOWN:"disk_markdown",DISK_BASIC:"disk_basic",WORK:"work",CONSOLE:"console",SETTINGS:"settings",TRASHCAN:"trashcan",COMPUTER_1:"computer_1",TELEPHONE:"telephone",CURSOR:"cursor",PREFERENCE:"preference",WEB_BASIC:"web_basic",WEB_PAINTING:"web_painting",COLORS:"colors",PRINT_1:"print_1",PRINT_2:"print_2",NOTEPAD:"notepad",BASIC:"basic",IMAGE:"image",NOTE:"note",NOTE_BLANK:"note_blank",LARGE_NOTE:"large_note",LARGE_NOTE_RICH:"large_note_rich",FULLSCREEN:"fullscreen",CALCULATOR:"calculator",CLOCK:"clock",KEYBOARD_QUESTION:"keyboard_question",LARGE_NOTEPAD:"large_notepad",LARGE_NOTEPAD_HELP:"large_notepad_help",RABBIT:"rabbit",MORE:"more",SAY:"say",GITHUB:"github",LAMMPEE:"lammpee",CUBY:"cuby",NUXT:"nuxt",CLOWN:"clown",DISALLOW_1:"disallow_1",COPY_1:"copy_1",COPY_2:"copy_2",DISPLAY_KEYBOARD:"display_keyboard",PALETTE:"palette",SIGN_1:"sign_1",DOCUMENT_EDITOR:"document_editor",DOCUMENT_READER:"document_reader",SYNTHESIZER:"synthesizer"};function vo(n){return/^"([^"]*)"$/.test(n)}function cu(n){return vo(n)?n:(n=K(n),`"${n}"`)}function ca(n){return n.replace(/[ ]*(.+)[ ]+/)}function K(n){return typeof n!="string"?n:n.replace(/^[ ]*"(.*)"[ ]*$/,"$1").replace(/\\"/g,'"')}function Hn(n){return!isNaN(n)}let $i;$i=Promise.resolve({atob:n=>window.decodeURIComponent(window.atob(n)),btoa:n=>window.btoa(window.encodeURIComponent(n))});async function ii(n){const{atob:e}=await $i;return e(n)}async function uu(n){const{btoa:e}=await $i;return e(n)}const y={SYMBOL:"symbol",VISIBLE:"visible",POSITION:"position",WINDOW_SYMBOL_REARRANGE:"window_symbol_rearrange",WINDOW_SIZE:"window_size",WINDOW_POSITION:"window_position",WINDOW_SCALE:"window_scale",WINDOW_SCROLL_X:"window_scroll_x",WINDOW_SCROLL_Y:"window_scroll_y",WINDOW_FULL_SIZE:"window_full_size",WINDOW_SIDEBAR:"window_sidebar",WEB_URL:"web_url",IGNORE_SYMBOL_REARRANGE:"ignore_symbol_rearrange"},du={basic:w.BASIC,bas:w.BASIC,markdown:w.DISK_MARKDOWN,md:w.DISK_MARKDOWN,image:w.IMAGE,img:w.IMAGE};function hu(n,e=w.NOTE_BLANK){const t=rr(n).toLowerCase();return du[String(t)]||e}var fr,ln,Dt,cn,un,Fe,Ct,dn,ze,pr;const Qn=class Qn{constructor({locked:e=!1,id:t=null,name:r=null,meta:s=[],data:i=null,action:a=null,createdDate:o=Date.now(),editedDate:l=null}){g(this,fr,void 0);g(this,ln,!1);g(this,Dt,null);g(this,cn,void 0);g(this,un,void 0);g(this,Fe,void 0);g(this,Ct,void 0);g(this,dn,void 0);g(this,ze,void 0);g(this,pr,void 0);if(I(this,fr,new $e),I(this,cn,o),I(this,un,l||o),I(this,ln,e),I(this,Fe,t),I(this,Ct,r),I(this,dn,new Map([[y.SYMBOL,hu(t||"",this.constructor.SYMBOL)],[y.VISIBLE,!0]].concat(s||[]))),typeof i=="string")try{i=JSON.parse(i)}catch(u){throw console.log(i),new Error(u)}I(this,pr,a),this.data=i||{}}async remove(e){const{silent:t}=Object.assign({silent:!1},e);let r;const s=this.isLocked();if(!s)r={type:this.constructor.NAME,id:this.id,name:this.name,path:await this.getPath(),size:this.size,storage:this.getStorageItem()};else if(!t)return L.get("FileSystemItem_itemLocked",await this.getPath());return(t||!s)&&(this.events.next(new G("remove",this)),this.events.unsubscribe(),this.parent.removeItem(this)),r}isLocked(e){return e?!1:this.parent&&this.parent.locked&&this.parent.id!==Vs?!0:c(this,ln)}getStorageItem(){return"storage"in this?this:this.parent?this.parent.getStorageItem():null}async copy(){const e=this.constructor;let t=await this.export({encodeData:!1});return t=new e(t),Promise.resolve(t)}rename(e,t){const{name:r=!1,ignore:s=!1}=Object.assign({name:!1,ignore:!1},t);if(!this.isLocked(s)){if(r)return this.name=e,this;{const i=this.id;I(this,Fe,wo(e)),this.parent&&i!==this.id&&this.parent.changeItemId(this,i,this.id)}this.events.next(new G("rename",{name:r,id:e}))}return this}save(){this.events.next(new G("save",this))}get type(){return this.constructor.NAME}async export(e){const{encodeData:t}=Object.assign({encodeData:!0},e),r=new Map(c(this,dn));return Array.from(r.keys()).forEach(s=>{r.get(s)instanceof en&&r.set(s,r.get(s).toJSON())}),{type:this.type,id:c(this,Fe),name:c(this,Ct),createdDate:c(this,cn),editedDate:c(this,un),data:t?await uu(c(this,ze)):c(this,ze),meta:Array.from(r)}}get createdDate(){return c(this,cn)}get editedDate(){return c(this,un)}get data(){if(typeof c(this,ze)=="string")try{return JSON.parse(c(this,ze))}catch{return{data:c(this,ze)}}return c(this,ze)}set data(e){typeof e=="object"&&(e=JSON.stringify(e)),I(this,ze,e)}get action(){return c(this,pr)}get events(){return c(this,fr)}get parent(){return c(this,Dt)}setId(e){I(this,Fe,e)}setParent(e){I(this,Dt,e)}get locked(){return c(this,Dt)?c(this,Dt).locked:c(this,ln)}get id(){return c(this,Fe)}get name(){return c(this,Ct)||c(this,Fe)}set name(e){I(this,Ct,e)}get extension(){return rr(c(this,Fe))}get meta(){return c(this,dn)}get size(){return new Blob([Object.values(this.data)]).size}get maxSize(){return new Blob([Object.values(this.data)]).size}getBase(){return Qn.getBaseRecursive({item:this},!1)}getPath(){return Qn.getBaseRecursive({item:this})}static getBaseRecursive({item:e,path:t=[]},r=!0){if(r&&t.push(e.id),e.parent)return Qn.getBaseRecursive({item:e.parent,path:t});if(t=t.reverse(),t[0]===Vs&&t.shift(),t.length>0){let s=t[0];return/\./.test(s)||(s+=":"),`${s}${t.slice(1,t.length).join(tu)}`}else return Vs}};fr=new WeakMap,ln=new WeakMap,Dt=new WeakMap,cn=new WeakMap,un=new WeakMap,Fe=new WeakMap,Ct=new WeakMap,dn=new WeakMap,ze=new WeakMap,pr=new WeakMap;let ge=Qn;L.add([["FileSystemItem_itemLocked",["Item Locked","Item is locked, can't be edit %1"]]]);const ut={CENTER:0,ORDER_HORIZONTAL:1,ORDER_VERTICAL:2,ORDER_DIAGONAL_LEFT:3,ORDER_DIAGONAL_RIGHT:4,SPLIT_HORIZONTAL:5,SPLIT_VERTICAL:6,FULL:7};class ua{constructor(e,t=[]){f(this,"events",new $e);f(this,"id",Nn());f(this,"core");f(this,"layout",{size:A(0,0),position:A(0,0)});f(this,"groups",new Map);f(this,"modelMap",new Map);f(this,"models",yt([]));this.core=e,t.forEach(r=>this.add(r))}getActiveWindow(){return this.models.value.find(e=>e.options.focused)}setActiveWindow(e){this.models.value.forEach(t=>{t.options.focused=e===t.id,e===t.id&&this.events.next(new G("setActiveWindow",t))})}hasEmbbedWindow(){return!!this.models.value.find(e=>e.options.embed)}isHeaderVsible(){return!this.models.value.find(e=>e.options.embed&&e.options.hideRootHeader)}add(e,t){const{full:r,active:s,group:i}={full:!1,active:!0,group:null,...t};if(e instanceof nr||(e=new nr(e)),e.setWrapper(this),r&&(e.layout.size=this.layout.size),i){let a;this.groups.has(i)?(a=this.groups.get(i),a.windows.push(e)):(a={primary:e,windows:[],name:i},this.groups.set(i,a)),e.setGroup(a)}return e.layout.zIndex=this.models.value.length,this.models.value.push(e),this.events.next(new G("add",e)),this.modelMap.set(e.id,e),s&&this.setActiveWindow(e.id),e}remove(e){typeof e=="string"&&(e=this.get(e)),e.group&&(e.group.primary===e?(e.group.windows.forEach(t=>t.close()),this.groups.delete(e.group.name)):e.group.primary.focus()),this.models.value.splice(this.models.value.indexOf(e),1),this.modelMap.delete(e.id)}get(e){return this.modelMap.get(e)}clear(){this.models=yt([].splice(0,this.models.value.length)),this.modelMap.clear()}setWindowUpDown(e,t){const r=this.models.value,s=Array.from(r).filter(l=>!l.options.embed).sort((l,u)=>l.layout.zIndex-u.layout.zIndex).map(el),i=this.get(e),a=s.indexOf(i),o=s[t?a-1:a+1];if(o){const l=i.layout.zIndex;i.layout.zIndex=o.layout.zIndex,o.layout.zIndex=l}}centerWindow(e){typeof e=="string"&&(e=this.get(e)),ai(e,this.layout)}setWindowPositions(e,t=[]){switch(t.length<1&&t.push(...this.models.value),t=t.filter(r=>!r.options.embed),e){case ut.FULL:t.forEach(r=>{mu(r,this.layout)});break;case ut.CENTER:t.forEach(r=>{ai(r,this.layout)});break;case ut.ORDER_DIAGONAL_LEFT:case ut.ORDER_DIAGONAL_RIGHT:fu(t,this.layout,ut.ORDER_DIAGONAL_RIGHT===e);break;case ut.SPLIT_HORIZONTAL:case ut.SPLIT_VERTICAL:pu(t,this.layout,ut.SPLIT_VERTICAL===e);break}}saveSize(e,t){if(this.get(e).symbolWrapper&&this.get(e).symbolWrapper.fsItem){const r=this.get(e).symbolWrapper.fsItem;r.meta.set(y.WINDOW_SIZE,t),this.core.modules.files.fs.saveItem(r)}}savePosition(e,t){if(this.get(e).symbolWrapper&&this.get(e).symbolWrapper.fsItem){const r=this.get(e).symbolWrapper.fsItem;r.meta.set(y.WINDOW_POSITION,t),this.core.modules.files.fs.saveItem(r)}}}function mu(n,e){n.layout.size=e.size}function ai(n,e){n.layout.position=A(()=>(e.size-n.layout.size)/2)}function fu(n,e,t){const r=1/n.length;n.forEach((s,i)=>{ai(s,e),i=-Math.floor(n.length/2)+i;const a=A(s.layout.position.x+(t?-1:1)*(r*s.layout.size.x)*i,s.layout.position.y+r*s.layout.size.y*i),o=A(()=>e.size-s.layout.size);s.layout.position=A(()=>Math.max(Math.min(a,o),0))})}function pu(n,e,t){let r;const s=n.length;t?(r=A(e.size.x,e.size.y/s),n.forEach((i,a)=>{i.layout.position=A(0,a*r.y),i.layout.size=r})):(r=A(e.size.x/s,e.size.y),n.forEach((i,a)=>{i.layout.position=A(a*r.x,0),i.layout.size=r}))}var mt;class gu{constructor(){g(this,mt,new Map);f(this,"capsLockActive",!1);f(this,"shiftLeftActive",!1);f(this,"shiftRightActive",!1);f(this,"cmdLeftActive",!1);f(this,"cmdRightActive",!1);f(this,"altLeftActive",!1);f(this,"altRightActive",!1);f(this,"pointerDown",null);f(this,"pointerUp",null);f(this,"pointerMove",null);f(this,"keyDown",null);f(this,"keyUp",null);this.resize=this.get("resize",window).pipe(kt()),this.pointerDown=this.getPointerDown(),this.pointerUp=this.getPointerUp(),this.pointerMove=this.getPointerMove(),this.keypress=this.get("keypress").pipe(kt()),this.keydown=this.keyDown=this.get("keydown").pipe(kt()),this.keyup=this.keyUp=this.get("keyup").pipe(kt()),this.keyDown.subscribe(({keyCode:e,location:t})=>{switch(e){case 91:this.cmdLeftActive=!0;break;case 93:this.cmdRightActive=!0;break;case 16:t===2?this.shiftRightActive=!0:this.shiftLeftActive=!0;break;case 18:t===2?this.altRightActive=!0:this.altLeftActive=!0;break;case 20:this.capsLockActive=!this.capsLockActive;break}}),this.keyUp.subscribe(({keyCode:e,location:t})=>{switch(e){case 91:this.cmdLeftActive=!1;break;case 93:this.cmdRightActive=!1;break;case 16:t===2?this.shiftRightActive=!1:this.shiftLeftActive=!1;break;case 18:t===2?this.altRightActive=!1:this.altLeftActive=!1;break}})}getPointerDown(e){return this.get("pointerdown",e).pipe(qn(t=>ss(t))).pipe(kt())}getPointerUp(e){return this.get("pointerup",e).pipe(qn(t=>ss(t))).pipe(kt())}getPointerMove(e){return this.get("pointermove",e).pipe(qn(t=>ss(t))).pipe(kt())}get(e,t){t=t||document,c(this,mt).has(t)||c(this,mt).set(t,new Map);const r=c(this,mt).get(t);if(!r.has(e)){const s={passive:!0,capture:!1};r.set(e,Zs(t,e,s))}return r.get(e)}reset(){Array.from(c(this,mt).values).forEach(e=>e.unsubscribe()),c(this,mt).reset()}get cmdActive(){return this.cmdLeftActive||this.cmdRightActive}get altActive(){return this.altLeftActive||this.altRightActive}get shiftActive(){return this.shiftLeftActive||this.shiftRightActive}}mt=new WeakMap;let da;const Us=da||(da=new gu);var _u=({onlyFirst:n=!1}={})=>{const e=["[\\u001B\\u009B][[\\]()#;?]*(?:(?:(?:(?:;[-a-zA-Z\\d\\/#&.:=?%@~_]+)*|[a-zA-Z\\d]+(?:;[-a-zA-Z\\d\\/#&.:=?%@~_]*)*)?\\u0007)","(?:(?:\\d{1,4}(?:;\\d{0,4})*)?[\\dA-PR-TZcf-ntqry=><~]))"].join("|");return new RegExp(e,n?void 0:"g")};const bu=_u;var yu=n=>typeof n=="string"?n.replace(bu(),""):n,Wi={exports:{}},Eo={exports:{}};(function(n){var e=function(){function t(l,u,d,h){typeof u=="object"&&(d=u.depth,h=u.prototype,u.filter,u=u.circular);var m=[],p=[],v=typeof Qt.Buffer<"u";typeof u>"u"&&(u=!0),typeof d>"u"&&(d=1/0);function _(k,W){if(k===null)return null;if(W==0)return k;var C,$;if(typeof k!="object")return k;if(t.__isArray(k))C=[];else if(t.__isRegExp(k))C=new RegExp(k.source,o(k)),k.lastIndex&&(C.lastIndex=k.lastIndex);else if(t.__isDate(k))C=new Date(k.getTime());else{if(v&&Qt.Buffer.isBuffer(k))return Qt.Buffer.allocUnsafe?C=Qt.Buffer.allocUnsafe(k.length):C=new Qt.Buffer(k.length),k.copy(C),C;typeof h>"u"?($=Object.getPrototypeOf(k),C=Object.create($)):(C=Object.create(h),$=h)}if(u){var _e=m.indexOf(k);if(_e!=-1)return p[_e];m.push(k),p.push(C)}for(var le in k){var Q;$&&(Q=Object.getOwnPropertyDescriptor($,le)),!(Q&&Q.set==null)&&(C[le]=_(k[le],W-1))}return C}return _(l,d)}t.clonePrototype=function(u){if(u===null)return null;var d=function(){};return d.prototype=u,new d};function r(l){return Object.prototype.toString.call(l)}t.__objToStr=r;function s(l){return typeof l=="object"&&r(l)==="[object Date]"}t.__isDate=s;function i(l){return typeof l=="object"&&r(l)==="[object Array]"}t.__isArray=i;function a(l){return typeof l=="object"&&r(l)==="[object RegExp]"}t.__isRegExp=a;function o(l){var u="";return l.global&&(u+="g"),l.ignoreCase&&(u+="i"),l.multiline&&(u+="m"),u}return t.__getRegExpFlags=o,t}();n.exports&&(n.exports=e)})(Eo);var wu=Eo.exports,xu=wu,vu=function(n,e){return n=n||{},Object.keys(e).forEach(function(t){typeof n[t]>"u"&&(n[t]=xu(e[t]))}),n},Eu=[[768,879],[1155,1158],[1160,1161],[1425,1469],[1471,1471],[1473,1474],[1476,1477],[1479,1479],[1536,1539],[1552,1557],[1611,1630],[1648,1648],[1750,1764],[1767,1768],[1770,1773],[1807,1807],[1809,1809],[1840,1866],[1958,1968],[2027,2035],[2305,2306],[2364,2364],[2369,2376],[2381,2381],[2385,2388],[2402,2403],[2433,2433],[2492,2492],[2497,2500],[2509,2509],[2530,2531],[2561,2562],[2620,2620],[2625,2626],[2631,2632],[2635,2637],[2672,2673],[2689,2690],[2748,2748],[2753,2757],[2759,2760],[2765,2765],[2786,2787],[2817,2817],[2876,2876],[2879,2879],[2881,2883],[2893,2893],[2902,2902],[2946,2946],[3008,3008],[3021,3021],[3134,3136],[3142,3144],[3146,3149],[3157,3158],[3260,3260],[3263,3263],[3270,3270],[3276,3277],[3298,3299],[3393,3395],[3405,3405],[3530,3530],[3538,3540],[3542,3542],[3633,3633],[3636,3642],[3655,3662],[3761,3761],[3764,3769],[3771,3772],[3784,3789],[3864,3865],[3893,3893],[3895,3895],[3897,3897],[3953,3966],[3968,3972],[3974,3975],[3984,3991],[3993,4028],[4038,4038],[4141,4144],[4146,4146],[4150,4151],[4153,4153],[4184,4185],[4448,4607],[4959,4959],[5906,5908],[5938,5940],[5970,5971],[6002,6003],[6068,6069],[6071,6077],[6086,6086],[6089,6099],[6109,6109],[6155,6157],[6313,6313],[6432,6434],[6439,6440],[6450,6450],[6457,6459],[6679,6680],[6912,6915],[6964,6964],[6966,6970],[6972,6972],[6978,6978],[7019,7027],[7616,7626],[7678,7679],[8203,8207],[8234,8238],[8288,8291],[8298,8303],[8400,8431],[12330,12335],[12441,12442],[43014,43014],[43019,43019],[43045,43046],[64286,64286],[65024,65039],[65056,65059],[65279,65279],[65529,65531],[68097,68099],[68101,68102],[68108,68111],[68152,68154],[68159,68159],[119143,119145],[119155,119170],[119173,119179],[119210,119213],[119362,119364],[917505,917505],[917536,917631],[917760,917999]],Su=vu,Fn=Eu,So={nul:0,control:0};Wi.exports=function(e){return Io(e,So)};Wi.exports.config=function(n){return n=Su(n||{},So),function(t){return Io(t,n)}};function Io(n,e){if(typeof n!="string")return ha(n,e);for(var t=0,r=0;r<n.length;r++){var s=ha(n.charCodeAt(r),e);if(s<0)return-1;t+=s}return t}function ha(n,e){return n===0?e.nul:n<32||n>=127&&n<160?e.control:Iu(n)?0:1+(n>=4352&&(n<=4447||n==9001||n==9002||n>=11904&&n<=42191&&n!=12351||n>=44032&&n<=55203||n>=63744&&n<=64255||n>=65040&&n<=65049||n>=65072&&n<=65135||n>=65280&&n<=65376||n>=65504&&n<=65510||n>=131072&&n<=196605||n>=196608&&n<=262141))}function Iu(n){var e=0,t=Fn.length-1,r;if(n<Fn[0][0]||n>Fn[t][1])return!1;for(;t>=e;)if(r=Math.floor((e+t)/2),n>Fn[r][1])e=r+1;else if(n<Fn[r][0])t=r-1;else return!0;return!1}var Au=Wi.exports,ku=yu,Ou=Au,Ao=function(n){return Ou(ku(n))},Kt={},st=Ao;function ms(n,e){return Array.apply(null,{length:e+1}).join(n).slice(0,e)}function Ru(n,e,t){n=n??"",n=String(n);var r=e-st(n);return r<=0?n:n+ms(t||" ",r)}function Tu(n,e,t){n=n??"",n=String(n);var r=e-st(n);if(r<=0)return n;var s=Math.floor(r/2),i=r-s;return ms(t||" ",s)+n+ms(t||" ",i)}function Du(n,e,t){n=n??"",n=String(n);var r=e-st(n);return r<=0?n:ms(t||" ",r)+n}function Cu(n,e){function t(r,s){return r.trim().split(" ").reduce(function(i,a){var o=i[i.length-1];return o&&st(o.join(" "))+st(a)<s?i[i.length-1].push(a):i.push([a]),i},[]).map(function(i){return i.join(" ")})}return n.split(`
`).map(function(r){return t(r,e)}).reduce(function(r,s){return r.concat(s)},[])}function Nu(n,e,t){n=n.trim();for(var r=[],s=n.split(" "),i="",a=st(t);i||s.length;){if(i){var o=i;i=""}else var o=s.shift();if(st(o)>e){for(var l=0,u=0,d=e-a;l<o.length;){var h=st(o.charAt(l));if(h+u>d)break;u+=h,++l}i=o.slice(l),o=o.slice(0,l),o+=t}r.push(o)}return r.join(" ")}function Lu(n,e){if(n=n??"",n=String(n),e==1/0)return n;for(var t=0,r=0;t<n.length;){var s=st(n.charAt(t));if(s+r>e)break;r+=s,++t}return n.slice(0,t)}Kt.padRight=Ru;Kt.padCenter=Tu;Kt.padLeft=Du;Kt.splitIntoLines=Cu;Kt.splitLongWords=Nu;Kt.truncateString=Lu;var js=Ao,Ln=Kt,Pu=Ln.padRight,Mu=Ln.padCenter,$u=Ln.padLeft,ma=Ln.splitIntoLines,Wu=Ln.splitLongWords,Fu=Ln.truncateString,ko=function(e){return e.toUpperCase()},zu=function(e,t,r){return e},Bu=Object.freeze({maxWidth:1/0,minWidth:0,columnSplitter:" ",truncate:!1,truncateMarker:"",preserveNewLines:!1,paddingChr:" ",showHeaders:!0,headingTransform:ko,dataTransform:zu}),Vu=function(n){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},t=e.config||{};delete e.config;var r=e.maxLineWidth||1/0;r==="auto"&&(r=Qt.process.stdout.columns||1/0),delete e.maxLineWidth,e=fa({},Bu,e),e.config=e.config||Object.create(null),e.spacing=e.spacing||`
`,e.preserveNewLines=!!e.preserveNewLines,e.showHeaders=!!e.showHeaders,e.columns=e.columns||e.include;var s=e.columns||[];n=Hu(n,s),s.length||n.forEach(function(l){for(var u in l)s.indexOf(u)===-1&&s.push(u)});var i=s.reduce(function(l,u){var d=Object.create(e);return l[u]=fa(d,t[u]),l},Object.create(null));s.forEach(function(l){var u=i[l];u.name=l,u.maxWidth=Math.ceil(u.maxWidth),u.minWidth=Math.ceil(u.minWidth),u.truncate=!!u.truncate,u.align=u.align||"left"}),n=n.map(function(l){var u=Object.create(null);return s.forEach(function(d){u[d]=l[d]!=null?l[d]:"",u[d]=""+u[d],i[d].preserveNewLines?u[d]=u[d].replace(/[^\S\n]/gmi," "):u[d]=u[d].replace(/\s/gmi," ")}),u}),s.forEach(function(l){var u=i[l];n=n.map(function(d,h){var m=Object.create(u);d[l]=u.dataTransform(d[l],m,h);var p=Object.keys(m);if(p.indexOf("name")!==-1){if(u.headingTransform!==ko)return;u.headingTransform=function(v){return v}}return p.forEach(function(v){return u[v]=m[v]}),d})});var a={};e.showHeaders&&(s.forEach(function(l){var u=i[l];if(!u.showHeaders){a[l]="";return}a[l]=u.headingTransform(u.name)}),n.unshift(a)),s.forEach(function(l){var u=i[l];u.width=n.map(function(d){return d[l]}).reduce(function(d,h){return d>=u.maxWidth?d:Math.max(d,Math.min(u.maxWidth,Math.max(u.minWidth,js(h))))},0)}),s.forEach(function(l){var u=i[l];n=n.map(function(d){return d[l]=Wu(d[l],u.width,u.truncateMarker),d})}),s.forEach(function(l){var u=i[l];n=n.map(function(d,h){var m=d[l];if(d[l]=ma(m,u.width),u.truncate&&d[l].length>1){d[l]=ma(m,u.width-js(u.truncateMarker));var p=d[l][0];Gu(p,u.truncateMarker)||(d[l][0]+=u.truncateMarker),d[l]=d[l].slice(0,1)}return d})}),s.forEach(function(l){var u=i[l];u.width=n.map(function(d){return d[l].reduce(function(h,m){return h>=u.maxWidth?h:Math.max(h,Math.min(u.maxWidth,Math.max(u.minWidth,js(m))))},0)}).reduce(function(d,h){return d>=u.maxWidth?d:Math.max(d,Math.min(u.maxWidth,Math.max(u.minWidth,h)))},0)});var o=Uu(n,i,s,e.paddingChr);return o.reduce(function(l,u){return l.concat(u.reduce(function(d,h){return d.concat(h.join(e.columnSplitter))},[]))},[]).map(function(l){return Fu(l,r)}).join(e.spacing)};function Uu(n,e,t,r){return n.map(function(s){var i=[],a=0;t.forEach(function(u){a=Math.max(a,s[u].length)});for(var o=function(d){i[d]=i[d]||[],t.forEach(function(h){var m=e[h],p=s[h][d]||"";m.align==="right"?i[d].push($u(p,m.width,r)):m.align==="center"||m.align==="centre"?i[d].push(Mu(p,m.width,r)):i[d].push(Pu(p,m.width,r))})},l=0;l<a;l++)o(l);return i})}function fa(){return Object.assign?Object.assign.apply(Object,arguments):ju.apply(void 0,arguments)}function ju(n,e){if(n==null)throw new TypeError("Cannot convert first argument to object");for(var t=Object(n),r=!1,s,i=1;i<arguments.length;i++){var a=arguments[i];if(a!=null){for(var o=Object.keys(Object(a)),l=0,u=o.length;l<u;l++){var d=o[l];try{var h=Object.getOwnPropertyDescriptor(a,d);h!==void 0&&h.enumerable&&(t[d]=a[d])}catch(m){r||(r=!0,s=m)}}if(r)throw s}}return t}function Gu(n,e,t){t=t||n.length,t=t-e.length;var r=n.lastIndexOf(e);return r!==-1&&r===t}function Hu(n,e){if(Array.isArray(n))return n;var t=[];for(var r in n){var s={};s[e[0]||"key"]=r,s[e[1]||"value"]=n[r],t.push(s)}return t}const oi=ml(Vu);var gr,_r,br,hn;class Vt{constructor(e){g(this,gr,0);g(this,_r,!0);g(this,br,[]);g(this,hn,[]);const{showHeader:t,headerPadding:r,columns:s}=Object.assign({showHeader:!0,headerPadding:0,columns:[]},e);I(this,_r,t),I(this,gr,r),this.addColumn(s)}addColumn(e){Array.isArray(e)?c(this,hn).push(...[].concat(e)):c(this,hn).push(Object.assign({value:null,align:"left",minWidth:0,maxWidth:0,spacerChar:" "},e))}addRow(e){c(this,br).push(...[].concat(e))}static createSpacer(e,t,r){if(e.length<t){t=t-e.length;for(let s=0;s<t;s++)e+=r}return e}get columns(){return c(this,hn)}get rows(){return c(this,br)}get showHeader(){return c(this,_r)}get headerPadding(){return c(this,gr)}toColumnify(){const e=this.columns.map(s=>s.value),t=this.rows.reduce((s,i,a)=>(a<1&&this.showHeader&&this.headerPadding&&s.push(...Array(this.headerPadding).fill("")),s.push(this.columns.reduce((o,l,u)=>(o[l.value]=i[Number(u)],o),{})),s),[]),r=this.columns.reduce((s,i)=>(s[i.value]={},i.align&&(s[i.value].align=i.align),i.minWidth&&(s[i.value].minWidth=i.minWidth),i.maxWidth&&(s[i.value].maxWidth=i.maxWidth),s[i.value].headingTransform=a=>a,s),{});return oi(t,{showHeaders:this.showHeader,preserveNewLines:!0,config:r,columns:e}).replace(/\xC2/g," ")}}gr=new WeakMap,_r=new WeakMap,br=new WeakMap,hn=new WeakMap;class Yu{constructor(e){f(this,"core");f(this,"debug",!1);f(this,"consoleInterface");const{core:t,debug:r,consoleInterface:s}=Object.assign({core:null,debug:!1,consoleInterface:null},e);this.core=t,this.debug=r,this.consoleInterface=s}add(e,t){}}const Jn=class Jn extends Yu{constructor(t){const{silent:r,color:s}=t=Object.assign({silent:!1,color:!1},t);super(t);f(this,"silent");f(this,"entries",[]);f(this,"color",!1);this.silent=r,this.color=s}add(t,r){const{namespace:s,type:i}=Object.assign({namespace:null,type:Jn.TYPE.INFO},r);this.entries.push(t),!this.silent&&i!==Jn.TYPE.DEBUG&&(s?this.color?console.log("%c[ %s ]%c[ %s ]","background: #000; color: #008000",i,"background: #000; color: #90ee90",s,t):console.log(`[ ${i.toUpperCase()} ][ ${s} ]`,t):t instanceof Vt?this.consoleInterface.table(t):this.consoleInterface.log(t))}};f(Jn,"TYPE",{DEBUG:"debug",INFO:"info",OUTPUT:"output"});let sr=Jn;var mn,Nt,yr,Ye,Ta;let Fi=(Ta=class{constructor(e){g(this,mn,!1);g(this,Nt,void 0);g(this,yr,void 0);g(this,Ye,{});e=Object.assign({locked:c(this,mn),storage:void 0,name:void 0},e),I(this,mn,e.locked),I(this,Nt,e.storage),I(this,yr,e.name)}get locked(){return c(this,mn)}get name(){return c(this,yr)}get storage(){return c(this,Nt)}get data(){return c(this,Ye)}set data(e){I(this,Ye,e)}mount(){return new Promise(e=>{e(this)})}unmount(){return new Promise(e=>{e(this)})}load(){if(!c(this,Nt))throw new Error("no storage");return Promise.resolve(c(this,Ye))}save(e){if(!c(this,Nt))throw new Error("no storage");return I(this,Ye,e||c(this,Ye)),Promise.resolve(c(this,Ye))}},mn=new WeakMap,Nt=new WeakMap,yr=new WeakMap,Ye=new WeakMap,Ta);var Lt;class Oo{constructor(){g(this,Lt,new Map)}getItem(e){return c(this,Lt).get(e)}setItem(e,t){c(this,Lt).set(e,t)}removeItem(e){c(this,Lt).delete(e)}clear(){c(this,Lt).clear()}}Lt=new WeakMap;class Xu extends Fi{constructor(e){e=Object.assign({storage:new Oo},e),super(e)}}class Ro extends Fi{mount(){return new Promise(e=>{try{let t;try{if(t=this.storage.getItem(this.name),t){if(t=JSON.parse(t),!t||!(t instanceof Object))throw new Error("json invalid")}else throw new Error("json invalid")}catch{t={}}this.storage.setItem(this.name,JSON.stringify(t)),e(this)}catch(t){throw new Error(t)}})}load(){return new Promise(e=>{if(this.storage)try{this.data=JSON.parse(this.storage.getItem(this.name)),e(this.data)}catch(t){throw new Error(t)}})}save(e){return new Promise(t=>{if(this.storage)try{this.data=e||this.data,this.storage.setItem(this.name,JSON.stringify(this.data)),t(this.data)}catch(r){throw new Error(r)}})}}class qu extends Ro{constructor(e){e=Object.assign({storage:window.localStorage},e),super(e)}}class Ku extends Ro{constructor(e){e=Object.assign({storage:window.sessionStorage||new Oo},e),super(e)}}class To extends Fi{}const de={NONE:0,AUTO:1,TEMP:3,LOCAL:4,SESSION:5,CLOUD:6};function Do(n){switch(n){case de.TEMP:return Xu;case de.LOCAL:return qu;case de.SESSION:return Ku;case de.CLOUD:return To;default:return Storage}}var Pe,Pt,fn,wr;class Zu{constructor(e,t){g(this,Pe,new Map);g(this,Pt,Le({}));g(this,fn,void 0);g(this,wr,void 0);I(this,fn,new(Do(t||de.NONE))({name:e})),I(this,wr,c(this,fn).load().then(r=>(I(this,Pe,new Map(r)),Object.assign(c(this,Pt),Object.fromEntries(c(this,Pe))),this)).catch(r=>{throw r}))}setDefaults(e){Object.keys(e).forEach(t=>{this.has(t)||this.set(t,e[String(t)])})}get(e){return c(this,Pe).get(e)}has(e){return c(this,Pe).has(e)}set(e,t){return typeof e=="object"&&!(e instanceof Map)?Object.keys(e).forEach(r=>{t=e[String(r)],c(this,Pe).set(r,t),c(this,Pt)[String(r)]=t}):(c(this,Pe).set(e,t),c(this,Pt)[String(e)]=t),c(this,fn).save(Array.from(c(this,Pe)))}get observable(){return c(this,Pt)}get entries(){return c(this,Pe)}get ready(){return c(this,wr)}}Pe=new WeakMap,Pt=new WeakMap,fn=new WeakMap,wr=new WeakMap;class Qu{constructor(e){f(this,"core");this.core=e}ready(){}prompt(e){}log(...e){console.log(...e)}clear(...e){}destroy(){}}class Ju extends Qu{prompt(e){const t=["openDialog","--prompt"];return e&&t.push(`--message="${K(e)}"`),this.core.executeCommand(t.join(" "))}}var xr,vr;class ed{constructor(e){g(this,xr,void 0);g(this,vr,[]);I(this,xr,e)}command(e,t){c(this,vr).push({value:e,targetValue:t})}run(){return Promise.all(c(this,vr).map(({value:e,targetValue:t})=>c(this,xr).executeCommand(e).then(r=>{const s=r===t;return s||console.warn(`[ ${e} ]; ${r} === ${t}`),{value:e,targetValue:t,result:r,success:s}})))}async start(){const e=await this.run();return[[e.length,"Tests processed"],[e.filter(t=>t.success).length,"Tests success"],[e.filter(t=>!t.success).length,"Tests failed"]]}}xr=new WeakMap,vr=new WeakMap;function ot(n,e={}){const t=tl(n),{id:r,parentFocused:s,core:i,window:a,parentWindow:o}=t,l=yt(),u=yt(),d=Na(()=>a.value.options.embedded),h=(_,k={})=>{u.value=new Ht(_,{core:i.value,mainWindow:Ki(a),parentWindow:Ki(o),preserveContextMenu:p,...k})},m=yt(!1),p=(_=!0)=>{m.value=_},v=_=>{u.value&&(_?l.value=i.value.modules.windows.setActiveContextMenu(u.value):!m.value&&i.value.modules.windows.getActiveContextMenu()===l.value&&!d.value&&i.value.modules.windows.setActiveContextMenu(null))};return qi(s,_=>v(_)),qi(u,_=>{l.value=i.value.modules.windows.setActiveContextMenu(_)}),nl(()=>{rl(()=>{e.emit("ready"),v(!0)})}),sl(()=>{u.value&&i.value.modules.windows.isContextMenu(l.value)&&i.value.modules.windows.setActiveContextMenu(null)}),{id:r,parentFocused:s,core:i,window:a,setContextMenu:h,preserveContextMenu:p,contextMenu:u,currentContextMenu:l}}const lt={id:{type:String,default:""},parentFocused:{type:Boolean,default:!1},core:{type:Object,required:!0},window:{type:Object,required:!0},parentWindow:{type:Object,required:!1}},ct=["ready"];function td(n,e,t){return"#"+((1<<24)+(n<<16)+(e<<8)+t).toString(16).slice(1)}function pa(n){return n=n.replace(/ /g,""),n.length===7?["0x"+n[1]+n[2]|0,"0x"+n[3]+n[4]|0,"0x"+n[5]+n[6]|0]:["0x"+n[1]+n[1]|0,"0x"+n[2]+n[2]|0,"0x"+n[3]+n[3]|0]}function Mp(n){if(n=n.replace(/^#/,""),n.length===3)return"#"+n.split("").map(e=>{const t=String(parseInt(e,16));return t.length===1?`0${t}`:t}).join("");if(n.length===6)return"#"+n}const nd={__name:"Form",emits:["submit"],setup(n,{emit:e}){const t=r=>{r.preventDefault(),e("submit",r)};return(r,s)=>(x(),D("form",{class:"wb-env-molecule-form",onSubmit:t},[kn(r.$slots,"default",{},()=>[La("Form Content")],!0)],32))}},Pn=j(nd,[["__scopeId","data-v-f27f0d40"]]);const rd={props:{labelTop:{type:Boolean,default:!1},tag:{type:String,default:"div"},label:{type:String,default:"FormField Label"}},computed:{styleClasses(){return{"label-top":this.labelTop}}}},sd={key:0,class:"label"};function id(n,e,t,r,s,i){return x(),U(Xs(t.tag),{class:it(["wb-env-atom-form-field",i.styleClasses])},{default:Y(()=>[t.label?(x(),D("span",sd,[kn(n.$slots,"label",{},()=>[La(Ne(t.label),1)],!0)])):B("",!0),kn(n.$slots,"default",{},void 0,!0)]),_:3},8,["class"])}const Mn=j(rd,[["render",id],["__scopeId","data-v-b7502b89"]]);const ad={props:{model:{type:[Array,Object],default(){return{value:0}}},min:{type:Number,default(){return 0}},max:{type:Number,default(){return 1}},step:{type:Number,default(){return .1}},name:{type:String,default:"value"},handleSize:{type:Number,default(){return .2}},styleType:{type:String,default:"window"},directionVertical:{type:Boolean,default:!1}},data(){return{positions:{start:A(),move:A(),current:A()}}},computed:{style(){const n={"--value":this.model[this.name]/this.max,"--direction":this.directionVertical?1:0};return n["--size"]=this.handleSize*100+"%",n},styleClasses(){return{"direction-x":!this.directionVertical,"direction-y":this.directionVertical,[`type-${this.styleType}`]:this.styleType}}}},od=n=>(vi("data-v-d4cc5e75"),n=n(),Ei(),n),ld=["orient","min","max","step"],cd=od(()=>E("i",null,null,-1));function ud(n,e,t,r,s,i){return x(),D("div",{class:it(["wb-env-atom-range-slider",i.styleClasses]),style:On(i.style)},[Xt(E("input",{"onUpdate:modelValue":e[0]||(e[0]=a=>t.model[t.name]=a),orient:t.directionVertical?"vertical":"horizontal",type:"range",min:t.min,max:t.max,step:t.step},null,8,ld),[[Pa,t.model[t.name]]]),cd],6)}const dd=j(ad,[["render",ud],["__scopeId","data-v-d4cc5e75"]]),hd={components:{WbEnvAtomFormField:Mn,WbEnvAtomRangeSlider:dd},props:{model:{type:[Array,Object],default(){return{}}},id:{type:String,default:null},name:{type:String,default:null},readonly:{type:Boolean,default:!1},min:{type:Number,default:null},max:{type:Number,default:null},step:{type:Number,default:null},handleSize:{type:Number,default:null},disabled:{type:Boolean,default:!1},directionVertical:{type:Boolean,default:!1}},computed:{currentModel:{get(){return this.name?this.model[this.name]:this.model.value},set(n){this.name?this.model[this.name]=n:this.model.value=n}},rangeSlider(){return{name:this.name,min:this.min,max:this.max,step:this.step,handleSize:this.handleSize,readonly:this.readonly,disabled:this.disabled,directionVertical:this.directionVertical}}}};function md(n,e,t,r,s,i){const a=R("wb-env-atom-range-slider"),o=R("wb-env-atom-form-field");return x(),U(o,V({tag:"div",class:"wb-env-atom-form-range-slider"},n.$attrs),{default:Y(()=>[kn(n.$slots,"before"),N(a,V(i.rangeSlider,{model:t.model,"style-type":"form-field"}),null,16,["model"]),kn(n.$slots,"after")]),_:3},16)}const fd=j(hd,[["render",md]]),pd={xmlns:"http://www.w3.org/2000/svg",width:"10",height:"6"},gd=E("g",{class:"primary"},[E("path",{d:"M0 0h2v2H0zM2 2h2v2H2zM8 0h2v2H8zM4 4h2v2H4zM6 2h2v2H6z"})],-1),_d=[gd];function bd(n,e){return x(),D("svg",pd,_d)}const yd={render:bd};const wd={components:{SvgControlTinyArrayDown:yd,WbEnvAtomFormField:Mn},props:{model:{type:Object,default(){return{value:"option-1"}}},label:{type:String,default:"Select Label"},id:{type:String,default:null},name:{type:String,default:null},size:{type:Number,default:null},multiple:{type:Boolean,default:!1},readonly:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},options:{type:Array,default(){return[{title:"Option 1.",value:"option-1"},{title:"Option 2.",value:"option-2"},{title:"Option 3.",value:"option-3"},{title:"Option 4.",value:"option-4"},{title:"Option 5.",value:"option-5"}]}}},computed:{currentModel:{get(){return this.name?this.model[this.name]:this.model.value},set(n){this.name?this.model[this.name]=n:this.model.value=n}},input(){return{id:this.id,size:this.size>1?this.size:null,multiple:this.multiple,readonly:this.readonly,disabled:this.disabled}}}},xd={class:"wrapper"},vd=["value"],Ed={key:0,class:"select-expander"};function Sd(n,e,t,r,s,i){const a=R("svg-control-tiny-array-down"),o=R("wb-env-atom-form-field");return x(),U(o,{tag:"label",class:"wb-env-atom-form-field-dropdown",label:t.label},{default:Y(()=>[E("div",xd,[Xt(E("select",V({"onUpdate:modelValue":e[0]||(e[0]=l=>i.currentModel=l)},i.input),[(x(!0),D(wt,null,xt(t.options,(l,u)=>(x(),D("option",{key:u,value:l.value},Ne(l.title),9,vd))),128))],16),[[il,i.currentModel]]),!t.disabled&&!t.readonly?(x(),D("span",Ed,[N(a)])):B("",!0)])]),_:1},8,["label"])}const zi=j(wd,[["render",Sd],["__scopeId","data-v-34f9d189"]]);const Id={props:{disabled:{type:Boolean,default:!1},accept:{type:String,default:"application/json"},type:{type:String,default(){return"button"}},styleType:{type:String,default(){return"primary"}},id:{type:String,required:!1,default:null},name:{type:String,required:!1,default:null},label:{type:String,required:!1,default:"Primary Button"}},emits:["upload","click"],computed:{upload(){return this.type==="upload"},styleClasses(){return{disabled:this.disabled,upload:this.upload,["type-"+this.styleType]:this.styleType}}},methods:{onInput(n){this.$emit("upload",n.target.files)},onClick(){this.$emit("click")}}},Ad={class:"label"},kd=["id","name","accept","disabled"],Od=["type","disabled"],Rd={class:"label"};function Td(n,e,t,r,s,i){return i.upload?(x(),D("label",{key:0,class:it(["wb-env-atom-button",i.styleClasses])},[E("span",Ad,Ne(t.label),1),E("input",{id:t.id,name:t.name,type:"file",accept:t.accept,disabled:t.disabled,onInput:e[0]||(e[0]=(...a)=>i.onInput&&i.onInput(...a))},null,40,kd)],2)):(x(),D("button",{key:1,type:t.type,class:it(["wb-env-atom-button",i.styleClasses]),disabled:t.disabled,onClick:e[1]||(e[1]=(...a)=>i.onClick&&i.onClick(...a))},[E("span",Rd,Ne(t.label),1)],10,Od))}const It=j(Id,[["render",Td],["__scopeId","data-v-d0dc09a9"]]);const Dd={props:{full:{type:Boolean,required:!1,default:!1},align:{type:String,required:!1,validate:n=>["center","left","right","outer"].includes(n),default:"left"},direction:{type:String,required:!1,validate:n=>["horizontal","vertical"].includes(n),default:"horizontal"}},computed:{styleClasses(){return{[`direction-${this.direction}`]:!0,[`align-${this.align}`]:!0,full:this.full}}}};function Cd(n,e,t,r,s,i){return x(),D("div",{class:it(["wb-env-molecule-button-wrapper",i.styleClasses])},[E("div",null,[kn(n.$slots,"default",{},void 0,!0)])],2)}const At=j(Dd,[["render",Cd],["__scopeId","data-v-13c4bed6"]]);const Nd={components:{WbForm:Pn,WbFormField:Mn,WbFormFieldRangeSlider:fd,WbFormFieldDropdown:zi,WbButton:It,WbButtonWrapper:At},props:{...lt},emits:[...ct,"close"],setup(n,e){return ot(n,e)},data(){const n=this.core.config.get(P.THEME)||Gn[String(_o)];return{screenModule:this.core.modules.screen,selectedColor:n.colors[1],colors:pa(n.colors[1]),saveLabel:"Save",resetLabel:"Reset",model:n,preset:"",fields:{presets:{name:"preset",model:this,label:"Presets",options:[{title:"Select Theme",value:""},...Object.keys(Gn).map(e=>({title:Gn[String(e)].title,value:e}))]},colorPrimary:{name:"0",type:"color",label:"Primary"},colorSecondary:{name:"1",type:"color",label:"Secondary"},colorTertiary:{name:"2",type:"color",label:"Tertiary"},colorQuaternary:{name:"3",type:"color",label:"Quaternary"},filter:{name:"filter",label:"Filter",options:[{title:"Invert",value:"invert(100%)"},{title:"Brightness",value:"brightness(50%)"}]}}}},watch:{preset(n){const e=Gn[String(n)];this.model={name:e.name,colors:e.colors,filter:e.filter},this.selectedColor=this.model.colors[0]},selectedColor(n){this.colors=pa(n)},colors:{deep:!0,handler(n){this.selectedColor=this.model.colors[this.model.colors.indexOf(this.selectedColor)]=td(...Object.values(n).map(e=>Number(e)))}}},methods:{onSubmit(n){const e=this.model;this.core.config.set(P.THEME,e),this.core.modules.screen.setTheme(new qc("custom",e)),this.$emit("close")}}},Ld={class:"wb-module-core-color-settings"},Pd={class:"col-1"},Md=["value"],$d={class:"col-1 colors"},Wd={class:"color-controls"},Fd={class:"color-preview"};function zd(n,e,t,r,s,i){const a=R("wb-form-field-dropdown"),o=R("wb-form-field"),l=R("wb-form-field-range-slider"),u=R("wb-button"),d=R("wb-button-wrapper"),h=R("wb-form");return x(),D("div",Ld,[N(h,{class:"form",onSubmit:i.onSubmit},{default:Y(()=>[E("div",null,[E("div",Pd,[N(a,Xn(Ma(s.fields.presets)),null,16),N(o,{label:"Colors",class:"color-select"},{default:Y(()=>[(x(!0),D(wt,null,xt(s.model.colors,(m,p)=>(x(),D("label",{key:p,style:On({"--color":m})},[Xt(E("input",{"onUpdate:modelValue":e[0]||(e[0]=v=>s.selectedColor=v),type:"radio",name:"color",value:m},null,8,Md),[[al,s.selectedColor]])],4))),128))]),_:1}),N(a,V(s.fields.filter,{model:s.model}),null,16,["model"])]),E("div",$d,[E("div",Wd,[E("div",Fd,[E("i",{style:On(`background-color: rgb(${s.colors.join(", ")});`)},null,4)]),E("div",null,[E("div",null,[N(l,{"style-type":"color-select",label:"Red",class:"color-slider",model:s.colors,name:"0",max:255,min:0,step:1,"handle-size":.2},{after:Y(()=>[E("span",null,Ne(s.colors[0].toString(16).toUpperCase()),1)]),_:1},8,["model"])]),E("div",null,[N(l,{"style-type":"color-select",label:"Green",class:"color-slider",model:s.colors,name:"1",max:255,min:0,step:1,"handle-size":.2},{after:Y(()=>[E("span",null,Ne(s.colors[1].toString(16).toUpperCase()),1)]),_:1},8,["model"])]),E("div",null,[N(l,{"style-type":"color-select",label:"Blue",class:"color-slider",model:s.colors,name:"2",max:255,min:0,step:1,"handle-size":.2},{after:Y(()=>[E("span",null,Ne(s.colors[2].toString(16).toUpperCase()),1)]),_:1},8,["model"])])])])])]),N(d,{align:"outer",full:""},{default:Y(()=>[s.saveLabel?(x(),U(u,{key:0,"style-type":"primary",label:s.saveLabel,type:"submit"},null,8,["label"])):B("",!0)]),_:1})]),_:1},8,["onSubmit"])])}const Bd=j(Nd,[["render",zd],["__scopeId","data-v-1e50478b"]]),Vd={xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16"},Ud=E("path",{d:"M0 0v16h16V0H0zm14 14H2V2h12v12z",class:"svg-primary"},null,-1),jd=E("path",{d:"M4 6v4h2v2h2v-2h2V8h2V4h-2v2H8v2H6V6z",class:"svg-secondary"},null,-1),Gd=[Ud,jd];function Hd(n,e){return x(),D("svg",Vd,Gd)}const Yd={render:Hd},Xd={xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16"},qd=E("path",{d:"M0 0v16h16V0H0zm14 14H2V2h12v12z",class:"svg-primary"},null,-1),Kd=E("path",{d:"M4 4h8v8H4z",class:"svg-secondary"},null,-1),Zd=[qd,Kd];function Qd(n,e){return x(),D("svg",Xd,Zd)}const Jd={render:Qd};const eh={components:{SvgControlInputCheckbox:Yd,SvgControlInputRadio:Jd},props:{label:{type:String,default:"Item Label"},model:{type:Object,default(){return{value:null}}},name:{type:String,default:null},value:{type:[String,Number],default:null},radio:{type:Boolean,default:!1},readonly:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1}},computed:{currentModel:{get(){return this.name?this.model[this.name]:this.model.value},set(n){this.name?this.model[this.name]=n:this.model.value=n}},styleClasses(){return{radio:this.radio,checkbox:!this.radio}},input(){return{name:this.name,readonly:this.readonly,disabled:this.disabled,type:this.radio?"radio":"checkbox"}}}},th=["value"],nh={key:2,class:"label"};function rh(n,e,t,r,s,i){const a=R("svg-control-input-checkbox"),o=R("svg-control-input-radio");return x(),D("label",{class:it(["wb-env-atom-form-field-checkbox-group-item",i.styleClasses])},[Xt(E("input",V({"onUpdate:modelValue":e[0]||(e[0]=l=>i.currentModel=l)},i.input,{value:t.value}),null,16,th),[[Si,i.currentModel]]),t.radio?B("",!0):(x(),U(a,{key:0})),t.radio?(x(),U(o,{key:1})):B("",!0),t.label?(x(),D("span",nh,Ne(t.label),1)):B("",!0)],2)}const sh=j(eh,[["render",rh],["__scopeId","data-v-2466babe"]]);const ih={components:{WbEnvAtomFormField:Mn,WbEnvAtomFormFieldCheckboxGroupItem:sh},props:{label:{type:String,default:"Checkbox Group Title"},name:{type:String,default:"value"},radio:{type:Boolean,default:!1},readonly:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},read:{type:Boolean,default:!1},model:{type:Object,default(){return{item1:!1,item2:!1}}},items:{type:Array,default(){return[{label:"Item 1",name:"item1"},{label:"Item 2",name:"item2"}]}}}};function ah(n,e,t,r,s,i){const a=R("wb-env-atom-form-field-checkbox-group-item"),o=R("wb-env-atom-form-field");return x(),U(o,{class:"wb-env-atom-form-field-checkbox-group",label:t.label,"label-top":""},{default:Y(()=>[E("ul",null,[(x(!0),D(wt,null,xt(t.items,(l,u)=>(x(),D("li",{key:u},[N(a,V({radio:t.radio,name:l.name||t.name,model:t.model,readonly:l.readonly||t.readonly,disabled:l.disabled||t.disabled},l),null,16,["radio","name","model","readonly","disabled"])]))),128))])]),_:1},8,["label"])}const Co=j(ih,[["render",ah],["__scopeId","data-v-33c1f318"]]),oh={xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16"},lh=E("path",{d:"M2 14v2h14V2h-2v12",class:"svg-primary"},null,-1),ch=E("path",{d:"M6 10v2h6V6h-2v4",class:"svg-primary"},null,-1),uh=[lh,ch];function dh(n,e){return x(),D("svg",oh,uh)}const hh={render:dh};const mh={components:{SvgControlTextareaResize:hh,WbEnvAtomFormField:Mn},props:{labelTop:{type:Boolean,default:!1},model:{type:Object,default(){return{}}},label:{type:String,default:"Textarea Label"},id:{type:String,default:null},name:{type:String,default:null},placeholder:{type:String,default:"Textarea Placeholder"},rows:{type:Number,default:null},wrap:{type:Boolean,default:!0},resize:{type:String,validate:n=>["both","horizontal","vertical",null].includes(n),default:"both"},readonly:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},autocomplete:{type:Boolean,default:!1}},computed:{currentModel:{get(){return this.name?this.model[this.name]:this.model.value},set(n){this.name?this.model[this.name]=n:this.model.value=n}},styleClasses(){return{resize:this.resize,[`resize-${this.resize}`]:this.resize}},input(){return{id:this.id,name:this.name,placeholder:this.placeholder,rows:this.rows,wrap:this.wrap?"on":"off",resize:this.resize,readonly:this.readonly,disabled:this.disabled,autocomplete:this.autocomplete?"on":"off"}}}},fh={class:"wrapper"},ph={class:"helper resize"};function gh(n,e,t,r,s,i){const a=R("svg-control-textarea-resize"),o=R("wb-env-atom-form-field");return x(),U(o,{tag:"label",class:it(["wb-env-atom-form-field-textarea",i.styleClasses]),label:t.label,"label-top":t.labelTop},{default:Y(()=>[E("span",fh,[E("span",null,[Xt(E("textarea",V({"onUpdate:modelValue":e[0]||(e[0]=l=>i.currentModel=l)},i.input),null,16),[[Pa,i.currentModel]]),E("span",ph,[N(a)])])])]),_:1},8,["label","class","label-top"])}const _h=j(mh,[["render",gh],["__scopeId","data-v-80092c4b"]]);const bh={components:{WbForm:Pn,WbButton:It,WbButtonWrapper:At,WbFormFieldCheckboxGroup:Co,WbFormFieldTextarea:_h},props:{...lt},emits:[...ct,"close"],setup(n,e){return ot(n,e)},data(){return{saveLabel:"Save",model:{[P.SCREEN_1084_FRAME]:this.core.config.get(P.SCREEN_1084_FRAME)||!1,[P.SCREEN_REAL_LOOK]:this.core.config.get(P.SCREEN_REAL_LOOK)||!1,[P.SCREEN_SCAN_LINES]:this.core.config.get(P.SCREEN_SCAN_LINES)||!1,[P.SCREEN_ACTIVE_ANIMATION]:this.core.config.get(P.SCREEN_ACTIVE_ANIMATION)||!1,[P.BOOT_WITH_SEQUENCE]:this.core.config.get(P.BOOT_WITH_SEQUENCE)||!1,[P.BOOT_WITH_WEBDOS]:this.core.config.get(P.BOOT_WITH_WEBDOS)||!1,[P.FILE_EXTENSION_ASSIGNMENT]:(this.core.config.get(P.FILE_EXTENSION_ASSIGNMENT)||[]).map(e=>e.join(" ")).join(`
`)}}},computed:{fileTypeAssignment(){return{model:this.model,name:P.FILE_EXTENSION_ASSIGNMENT,label:"File Extension assignment to Application",placeholder:"e.g. md openPreview"}},generalSettings(){return{model:this.model,label:null,items:[]}},screenSettings(){return{model:this.model,label:"Screen - Settings",items:[{label:"Use 1084 Frame with 640x480",name:P.SCREEN_1084_FRAME},{label:"Screen with Real-Look",name:P.SCREEN_REAL_LOOK},{label:"Screen with Scan-Lines",name:P.SCREEN_SCAN_LINES},{label:"Screen with On/Off Animation",name:P.SCREEN_ACTIVE_ANIMATION}]}},bootSettings(){return{model:this.model,label:"BOOT - Settings",items:[{label:"Boot with Sequence?",name:P.BOOT_WITH_SEQUENCE},{label:"Boot with WebDos?",name:P.BOOT_WITH_WEBDOS}]}}},methods:{onSubmit(){this.model[String(P.FILE_EXTENSION_ASSIGNMENT)]=this.model[String(P.FILE_EXTENSION_ASSIGNMENT)].split(`
`).map(n=>n.match(/^([^ ]+) +(.*)$/).slice(1,3)),this.core.config.set(this.model),this.$emit("close")}}},yh={class:"wb-module-core-settings"},wh={class:"cols"},xh={class:"col-2"},vh={class:"col-2"};function Eh(n,e,t,r,s,i){const a=R("wb-form-field-checkbox-group"),o=R("wb-form-field-textarea"),l=R("wb-button"),u=R("wb-button-wrapper"),d=R("wb-form");return x(),D("div",yh,[N(d,{onSubmit:i.onSubmit},{default:Y(()=>[E("div",wh,[E("div",xh,[i.generalSettings.items.length>0?(x(),U(a,Xn(V({key:0},i.generalSettings)),null,16)):B("",!0),i.screenSettings.items.length>0?(x(),U(a,Xn(V({key:1},i.screenSettings)),null,16)):B("",!0),i.bootSettings.items.length>0?(x(),U(a,Xn(V({key:2},i.bootSettings)),null,16)):B("",!0)]),E("div",vh,[N(o,V(i.fileTypeAssignment,{"label-top":"",rows:10,resize:null}),null,16)])]),N(u,{align:"outer",full:""},{default:Y(()=>[s.saveLabel?(x(),U(l,{key:0,"style-type":"primary",label:s.saveLabel,type:"submit"},null,8,["label"])):B("",!0)]),_:1})]),_:1},8,["onSubmit"])])}const Sh=j(bh,[["render",Eh],["__scopeId","data-v-1b3f7b31"]]),Ih=({core:n})=>[{name:["execute"],description:"Execute file.",args:[new b({index:0,name:"path",description:"Path to the file"})],async action({path:e}){const t=new Map(n.config.get(P.FILE_EXTENSION_ASSIGNMENT));if(!e)throw L.get("bad_args");let r;if(t.has(rr(e))?r=await n.modules.files.fs.get(t.get(rr(e))):(r=await n.modules.files.fs.get(e),e=null),typeof r.action=="function")return r.action(n,e);if("type"in r.data){const s=[`openPreview "${r.getPath()}"`];return r.data.openMaximized&&s.push("-maximized"),n.executeCommand(s.join(" "))}}},{name:["openColorSettings"],action(){n.modules.windows.addWindow({title:"Color Settings",component:Bd,componentData:{},options:{prompt:!1,scaleX:!1,scaleY:!1,scrollX:!1,scrollY:!1}})}},{name:["openSettings"],action(){n.modules.windows.addWindow({title:"Settings",component:Sh,componentData:{},options:{prompt:!1,scaleX:!1,scaleY:!1,scrollX:!1,scrollY:!1}})}},{name:["echo","print"],args:[new b({name:["newline","n"],flag:!0})],async action({newline:e},t){const r=s=>K(s).replace(/\\"/g,'"').replace(/\\n/g,`
`);if(e)t.message(t.commandArgs.map(s=>r(s)));else{let s=await t.core.executeCommand(t.commandValue);typeof s=="object"&&(s=JSON.stringify(s)),t.message(`${K(r(s))}`)}}},{name:"commands",action(e,t){const r=new Vt({headerPadding:1});return r.addColumn([{value:"Command(s)",align:"left",maxWidth:20},{value:"Description/Arguments",align:"left",maxWidth:60}]),r.addRow(Ot.items.reduce((s,i)=>{const a=i.args||[],o=[];i.description&&(o.push(i.description),o.push("")),a.length&&(o.push("Arguments:"),o.push(""));const{flagNames:l,kwargNames:u}=a.reduce((h,m)=>{const p=m.name.join(", ");return m.flag?h.flagNames.push({name:`-${p}`,description:m.description}):h.kwargNames.push({name:`--${p}`,description:m.description}),h},{flagNames:[],kwargNames:[]}),d={paddingChr:"",showHeaders:!1,config:{name:{minWidth:15},description:{minWidth:10,maxWidth:30}}};return o.push(oi(l,Object.assign({},d))),l.length>0&&u.length>0&&o.push(""),o.push(oi(u,Object.assign({},d))),s.push([i.name.join(", "),o.join(`
`)]),s},[])),t.message(["Commands:",r]),Promise.resolve()}},{name:["CLS","CLEAR"],action(){n.consoleInterface.clear()}},{name:["prompt","input","PROMPT","INPUT"],args:[new b({index:0,name:"text",description:"Text from prompt."}),new b({index:1,name:"variable",description:"Variable"})],action:({text:e,variable:t,unresolved:r},s)=>(r.text&&!r.variable?(t=r.text,e=null):t=r.variable,n.consoleInterface.prompt(e).then(i=>(Hn(i)&&(i=Number(i)),t&&n.modules.parser.memory.set(t,i),i)))},{name:["confirm","CONFIRM"],args:[new b({index:0,name:"text",description:"Text from confirm."})],action({text:e}){return n.consoleInterface.confirm(e)}},{name:["selfCheck"],async action(e,t){const r=new Vt;r.addColumn([{value:"Count",align:"left",minWidth:8},{value:"Description",align:"left",minWidth:15}]),r.addRow(await Ah(n)),t.message(["Command Tests:",r])}}];function Ah(n){const e=new ed(n);return e.command('"foo" +"bar"','"foobar"'),e.command("(-3+-6)+1",-3+-6+1),e.command("(-3-+6)+1",-3-6+1),e.command("(-3*-6)+1",-3*-6+1),e.command("(-3/-6)+1",-3/-6+1),e.command("(-3+6)+1",-3+6+1),e.command("(-3-6)+1",-3-6+1),e.command("(-3*6) + 1",-3*6+1),e.command("(-3/6)+1",-3/6+1),e.command("INT(PI)",3),e.command("(POW(2,2)+1)",5),e.command('ASC("D")',68),e.command("CHR$(68)",'"D"'),e.command('LEN("ABC")',3),e.command('"a" + "b"','"ab"'),e.command("STRING$(3,0)",'"000"'),e.command("SQRT(2,2)",Math.sqrt(2,2)),e.command("128 >> (256 + 5)",128>>256+5),e.command("-2+4+SQRT(2,2)",-2+4+Math.sqrt(2,2)),e.command("-2- 2 * 2",-2-2*2),e.command("(1+1)",1+1),e.command("2*2",2*2),e.command("1+2+3+(POW(2,2)+1)+5*8-(50/2)",1+2+3+(2**2+1)+5*8-50/2),e.start()}const{version:kh}=ol().public;var xs,Er,Sr,Ir,Mt,Ar,kr,Or;const Rt=class Rt{constructor(){g(this,xs,new $e);g(this,Er,new $e);g(this,Sr,!1);g(this,Ir,new Ol(0));g(this,Mt,{});g(this,Ar,new Ju(this));g(this,kr,new sr({core:this,debug:!1,consoleInterface:c(this,Ar)}));f(this,"executionCounter",yt(0));g(this,Or,new Zu(Kc,de.SESSION,la));this.log(`${Rt.NAME}; ${Rt.VERSION}`)}get version(){return Rt.VERSION}addExecution(){return this.executionCounter.value++,()=>{this.executionCounter.value--}}get events(){return c(this,xs)}async setup(){if(c(this,Sr))return console.warn("Setup is complete!"),this;I(this,Sr,!0),Ot.add(po(Ih({core:this}))),await c(this,Or).ready,this.config.setDefaults(la);const e=Object.values(c(this,Mt));return await Promise.all(e.map(t=>Promise.resolve(t.beforeSetup()))),await Promise.all(e.map(t=>Promise.resolve(t.setup()))),await Oh(this.modules.files.fs),c(this,Ir).next(this),this}destroy(){Ot.clear()}addModule(e,t){const r=new e(Object.assign({core:this},t));c(this,Mt)[Jt(r.constructor.NAME)]=r}async removeModule(e){await e.destroy(),delete c(this,Mt)[e.constructor.NAME]}executeCommands(e){if(e.length>0){const t=e.shift();return this.executeCommand(t).then(()=>this.executeCommands(e))}}async executeCommand(e,t){typeof e=="string"&&(e=e.replace(/(.*[^\\])\n(\S*)/gm,"$1\\n$2")),t=Object.assign({show:!1,commandBucket:Ot,core:this,logger:this.logger},t);const r=[];t.message&&r.push(...r.concat(t.message));const s=t.show;t.message=a=>{s&&r.push(...[].concat(a))};let i;try{if(e){const a=await this.modules.parser.parseCommand(e);t.commandBucket.has(a.command)?i=await ga(e,a,t.commandBucket,t):Ot.has(a.command)?i=await ga(e,a,Ot,t):this.modules.parser.isMathValue(e)?i=await this.modules.parser.parseMath(e):/^\w+$/.test(e)&&console.warn(`can\\'t use variable or method "${e}"`)}}catch(a){let o=a;Array.isArray(a)&&(o=new Error(a[a.length-1])),c(this,Er).next(o)}return i!==void 0&&i!=="undefined"&&typeof i=="string"&&t.show&&r.length<1&&r.push(i),r.forEach(a=>t.logger.add(a,{type:sr.TYPE.OUTPUT})),i}log(e){c(this,kr).add(e,{namespace:"Core"})}get consoleInterface(){return c(this,Ar)}get errorObserver(){return c(this,Er)}get ready(){return c(this,Ir)}get config(){return c(this,Or)}get logger(){return c(this,kr)}get modules(){return c(this,Mt)}};xs=new WeakMap,Er=new WeakMap,Sr=new WeakMap,Ir=new WeakMap,Mt=new WeakMap,Ar=new WeakMap,kr=new WeakMap,Or=new WeakMap,f(Rt,"VERSION",kh||"0.0.0"),f(Rt,"NAME","web-workbench");let li=Rt;async function ga(n,e,t,r){const s=t.get(e.command),i=r.show,a=await s.action(Vc(s,e),Object.assign({command:e.command,commandValue:e.commandValue,commandArgs:e.args},r));return i&&r.showCommand&&r.logger.add("> "+n,{type:sr.TYPE.OUTPUT}),a}async function Oh(n){const{FONT_FAMILES:e,DEFAULT_FONT_SIZE:t}=await O(()=>import("./index.ea805cdb.js"),["./index.ea805cdb.js","./entry.252f118a.js","./index.56665add.js"],import.meta.url),[r,s,i]=(await Promise.all([O(()=>import("./CHANGELOG.d2c3136d.js"),[],import.meta.url),O(()=>import("./imprint.4596c064.js"),[],import.meta.url),O(()=>import("./disclaimer.ed39e2a0.js"),[],import.meta.url)])).map(l=>l.default||l);await n.createRootFile("Cuby_Generator.link","Cuby Generator",null,{meta:[[y.POSITION,{x:236,y:394}],[y.IGNORE_SYMBOL_REARRANGE,!0],[y.WEB_URL,"https://cuby.lammpee.de"],[y.SYMBOL,w.CUBY]]}),await n.createRootFile("Github.link","Github",null,{meta:[[y.POSITION,{x:159,y:386}],[y.IGNORE_SYMBOL_REARRANGE,!0],[y.WEB_URL,"https://github.com/ThornWalli/web-workbench"],[y.SYMBOL,w.GITHUB]]});const a=[{id:"Imprint.md",name:"Imprint",content:s,position:{x:0,y:390},fontFamily:e.Monospace["Courier New"],fontSize:14},{id:"Disclaimer.md",name:"Disclaimer",content:i,position:{x:80,y:390},fontFamily:e.Monospace["Courier New"],fontSize:14},{id:"Changelog.md",name:"Changelog",content:r,position:{x:0,y:305},fontFamily:e.Monospace["Courier New"],fontSize:14}];return(await n.createRootDir("Press","Press",{meta:[[y.WINDOW_SIDEBAR,!1],[y.WINDOW_SCALE,!1],[y.WINDOW_SCROLL_X,!1],[y.WINDOW_SCROLL_Y,!1],[y.POSITION,{x:80,y:320}],[y.WINDOW_SIZE,{x:100,y:120}],[y.IGNORE_SYMBOL_REARRANGE,!0]]})).addItems([{id:"Amiga-News.link",name:"Amiga-News.de",meta:[[y.WEB_URL,"https://www.amiga-news.de/de/news/AN-2022-07-00094-DE.html"],[y.SYMBOL,w.LARGE_NOTE_RICH],[y.POSITION,{x:10,y:10}]]}]),Promise.all(a.map(({id:l,name:u,content:d,position:h,fontFamily:m,fontSize:p})=>n.createRootFile(l,u,{openMaximized:!0,type:"markdown",content:d,fontFamily:m||e.SansSerif.Arial,fontSize:p||t},{meta:[[y.POSITION,h],[y.IGNORE_SYMBOL_REARRANGE,!0],[y.SYMBOL,w.LARGE_NOTE_RICH]]}))).catch(l=>{throw new Error(l)})}function $p(n){const e={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#039;","\n":`&nbsp;
`," ":"&nbsp;"};return n.replace(/[&<>"'\n ]/g,function(t){return e[String(t)]})}function ci(n,e,t,r=" "){if(n.length<e)for(let s=n.length;s<=e-1;s++)t?n=r+n:n=n+r;return n}function Yn(n){return n>2e3?(n=parseInt(n/1e3),n>1e3?(n=parseInt(n/1e3),n>1e3?(n=parseInt(n/1e3),`${n}g`):`${n}m`):`${n}k`):`${n}b`}function ui(n,e){const t=new Date(e),r=[[/y/g,`${t.getFullYear()}`.slice(2)],[/Y/g,t.getFullYear()],[/dd/g,_a(t.getDate())],[/d/g,t.getDate()],[/DD/g,_a(t.getDate())],[/D/g,zn(t.getDate())],[/mm/g,ba(t.getMonth(),!0)],[/m/g,t.getMonth()+1],[/MM/g,ba(t.getMonth()+1,!1)],[/M/g,zn(t.getMonth()+1)],[/h/g,t.getHours()],[/H/g,zn(t.getHours())],[/i/g,t.getMinutes()],[/I/g,zn(t.getMinutes())],[/s/g,t.getSeconds()],[/S/g,zn(t.getSeconds())]];return r.forEach((s,i)=>{n=n.replace(s[0],`%${i}%`)}),r.forEach((s,i)=>{n=n.replace(`%${i}%`,s[1])}),n}const Rh=[["Sunday","Sun"],["Monday","Mon"],["Tuesday","Tue"],["Wednesday","Wed"],["Thursday","Thu"],["Friday","Fri"],["Saturday","Sat"]];function _a(n,e){return Rh[String(n)]}const Th=[["Januar","Jan"],["February","Feb"],["March","Mar"],["April","Apr"],["May"],["June"],["July"],["August","Aug"],["September","Sept"],["October","Oct"],["November","Nov"],["December","Dec"]];function ba(n,e){return n=Th[n-1],n.length>1?e?n[1]:n[0]:n}function zn(n){return n=String(n),n.length<2?`0${n}`:n}function No(n,e){return e<=0?"":e>String(n).length?n:String(n).substring(0,e)}function Dh(n,e){if(e<=0)return"";if(e>String(n).length)return n;{const t=String(n).length;return String(n).substring(t,t-e)}}function ya(n,e=" "){return Array(parseInt(n)).fill(e).join("")}const me=class me{static parse(e,t=[],r=0){let s=e;const i=Lh();let a=!1,o=0;for(;e.length>=o;){const l=e[Number(o-1)],u=e[Number(o+1)],d=e[Number(o)];if(d==="("&&i.clamp!==!1&&i.clamp++,/(^[$]{6}\d+\$)/.test(e.slice(o,e.length))&&!dt(i)){const[h]=e.slice(o,e.length).match(/(^[$]{6}\d+\$)/);o+=h.length-1}else if(/(^[$]{3}\d+)/.test(e.slice(o,e.length))&&!dt(i)){const[h]=e.slice(o,e.length).match(/(^[$]{3}\d+)/);i.startRecord=o,o+=h.length,i.stopRecord=o}else d==="-"&&(u==="-"||me.REGEX_CHAR_WORD_NON_DIGIT.test(u))&&!dt(i)?(i.parameter=!0,i.startRecord=o):d==="("&&!dt(i)?(i.clamp=0,i.startRecord=o):me.REGEX_NUMERIC.test(d)&&!dt(i)?(i.numeric=!0,i.startRecord=o):me.REGEX_CHAR_WORD_NON_DIGIT.test(d)&&!dt(i)?(i.char=!0,i.startRecord=o):d==='"'&&!dt(i)?(i.doubleQuote=!0,i.startRecord=o):d==="'"&&!dt(i)?(i.singleQuote=!0,i.startRecord=o):i.startRecord!==!1&&(i.parameter?(d==="="||!me.REGEX_CHAR_WORD_NON_DIGIT.test(u))&&(d==="="?(i.parameter=!1,i.char=!1,i.startOverride=i.startRecord):u!=="="&&!me.REGEX_CHAR_WORD_NON_DIGIT.test(u)&&u!=="-"&&(i.stopRecord=o+1)):i.clamp!==!1?d===")"&&(i.clamp===0?i.stopRecord=o+1:i.clamp--):i.numeric?me.REGEX_NUMERIC.test(l)&&!me.REGEX_NUMERIC.test(d)&&(i.stopRecord=o):i.char?me.REGEX_CHAR_WORD_NON_DIGIT.test(l)&&!(me.REGEX_CHAR_WORD_NON_DIGIT.test(d)&&!/[$%]/.test(d))&&(/[ ]*\(/.test(e.slice(o,e.length))?(i.char=!1,i.clamp=0):i.stopRecord=o+1):i.doubleQuote?l!=="\\"&&d==='"'&&(i.stopRecord=o+1):i.singleQuote&&l!=="\\"&&d==="'"&&(i.stopRecord=o+1));if(!i.stopRecord&&o+1>e.length&&(i.stopRecord=o+1,a=!0),i.stopRecord&&i.startRecord===!1&&o+1!==e.length)a=!0;else if(i.stopRecord){let h=i.startRecord;i.startOverride!==void 0&&(h=i.startOverride),s=s.slice(0,h)+Nh(t,s.slice(h,i.stopRecord))+s.slice(i.stopRecord,s.length),me.DEBUG&&console.log("result",s),a||(this.parse(s,t,r),a=!0)}if(a)break;o++}return t.length>0?t.filter(l=>l.length>0):[e]}};f(me,"REGEX_CHAR_WORD_NON_DIGIT",/^[^\d\W$%]|[.].$/),f(me,"REGEX_NUMERIC",/^[\d+\-*\\/.<>]$/),f(me,"DEBUG",!1);let ir=me;function Ch(n){return`$$$$$$${n}$`}function Nh(n,e){return n.push(e),Ch(n.length-1)}function dt(n){return n.singleQuote||n.doubleQuote||n.clamp!==!1||n.char||n.numeric||n.parameter}function Lh(){return{dollarCount:0,startRecord:!1,stopRecord:!1,char:!1,numeric:!1,singleQuote:!1,doubleQuote:!1,clamp:!1,parameter:!1}}var Rr;const ne=class ne{constructor(e){g(this,Rr,void 0);I(this,Rr,e)}async parse(e){const t=e;let r=e;const s=e.match(ne.REGEX_COMMAND_REPLACE);s&&(r=s[1],e=s[2]);const i=e;let a=[],o={},l;if(r!==e){const u=this.parseParameter(e);l=u.unresolved,a=await Promise.all(u.args),o=u.kwargs,await Promise.all(Object.keys(o).map(d=>o[String(d)].then(h=>o[String(d)]=h)))}return{origin:t,unresolved:l,args:a,kwargs:o,command:r,commandValue:i}}parseParameter(e){return ir.parse(e).reduce((r,s)=>{if(ne.REGEX_PARAM_KWARG.test(s)){const[,i,a]=s.match(ne.REGEX_PARAM_KWARG);r.kwargs[Jt(String(i))]=this.parseValue(a),r.unresolved.kwargs[Jt(String(i))]=ca(a)}else ne.REGEX_PARAM_ARG.test(s)?(r.kwargs[Jt(String(s.replace(ne.REGEX_PARAM_ARG,"$1")))]=Promise.resolve(!0),r.unresolved.kwargs[Jt(String(s.replace(ne.REGEX_PARAM_ARG,"$1")))]=Promise.resolve(!0)):(r.args.push(this.parseValue(s)),r.unresolved.args.push(ca(s)));return r},{unresolved:{kwargs:{},args:[]},kwargs:{},args:[]})}parseValue(e){return/.*(true|false).*/.test(e)?Promise.resolve(e.replace(/.*(true|false).*/,"$1")==="true"):/^".*"$/.test(e)?Promise.resolve(K(e)):/^\d+$/.test(e)?Promise.resolve(Number(e)):typeof e=="string"&&/ *([a-zA-Z_-]+) */.test(e)?c(this,Rr).parse(e.replace(/ *([a-zA-Z_-]+) */,"$1")):Promise.resolve(e)}static extractStrings(e,t=" "){let r=!1,s;const i=[];let a=!1;for(let l=e.length-1;l>=0;l--){const u=e[Number(l)],d=e[l-1];!a&&u==='"'&&d!=="\\"?r?(r=!1,i.push(e.slice(l,s+1))):(a=!1,r=!0,s=l):(!r&&a||a)&&u==="'"&&d!=="\\"&&(r?(a=!1,r=!1,i.push(e.slice(l,s+1))):(a=!0,r=!0,s=l))}if(r)throw new Error("can't extract values; "+e);return{result:i.reduce((l,u,d)=>l.replace(u,ne.resolveKey(d)),e),values:i}}static extractValues(e,t=" "){let r=!1,s;const i=[];let a=!1;for(let l=e.length-1;l>=0;l--){const u=e[Number(l)],d=e[l-1];!a&&u==='"'&&d!=="\\"?r?(r=!1,i.push(e.slice(l,s+1))):(a=!1,r=!0,s=l):(!r&&a||a)&&u==="'"&&d!=="\\"&&(r?(a=!1,r=!1,i.push(e.slice(l,s+1))):(a=!0,r=!0,s=l))}if(r)throw new Error("can't extract values; "+e);return i.forEach((l,u)=>{e=e.replace(l,ne.resolveKey(u))}),{params:e.split(t).filter(l=>l),values:i}}static resolveKey(e){return`$$$$$$${e}`}static resolveValues({params:e,values:t}){return e.map(r=>ne.resolveValue(r,t))}static valueUnresolved(e){return ne.REGEX_VALUE_RESOLVE.test(e)}static resolveValue(e,t){if(ne.valueUnresolved(e)){if(e=e.match(/[$]{3}(\d+)/g).reduce((r,s)=>r.replace(s,t[Number(s.replace(ne.REGEX_VALUE_RESOLVE,"$1"))]),e),/[\w]+[$%]?[ ]*\(/.test(e))return e;if(typeof e=="string"){if(e==="undefined")return;if(Mh(e))return e;if(Ph(e))return Number(e);if(!e.startsWith('"'))return cu(e)}}return e}};Rr=new WeakMap,f(ne,"REGEX_VALUE_RESOLVE",/[$]{3}(\d+)/),f(ne,"REGEX_COMMAND_REPLACE",/^([a-zA-Z]+[a-zA-Z0-9_]+) (.*)$/),f(ne,"REGEX_PARAM_KWARG",/^[-]{0,2}([\\-\w]+)=(.*)$/),f(ne,"REGEX_PARAM_ARG",/^[-]{1,2}([\\-\w]+)$/);let ee=ne;function Ph(n){return!isNaN(n)}function Mh(n){return!isNaN(parseInt(n))}var Tr,pn,gn,_n;class Lo{constructor(e,t,r,s){g(this,Tr,void 0);g(this,pn,void 0);g(this,gn,!1);g(this,_n,!1);I(this,Tr,e),I(this,pn,t),I(this,gn,r||c(this,gn)),I(this,_n,s||c(this,_n))}get name(){return c(this,Tr)}get value(){return c(this,pn)}set value(e){this.readonly||I(this,pn,e)}get global(){return c(this,gn)}get readonly(){return c(this,_n)}}Tr=new WeakMap,pn=new WeakMap,gn=new WeakMap,_n=new WeakMap;class $h extends Lo{constructor(e,t,r){super(e,t,r,!0)}execute(e){return this.value.apply(this,e)}}class wa extends Lo{}var ue,ft,be;class Bi{constructor(){g(this,ue,new Map);g(this,ft,new Map);g(this,be,[])}reset(){this.resetPrefixStack(),c(this,ue).clear(),c(this,ft).clear()}resetPrefixStack(){I(this,be,[])}get prefixStack(){return c(this,be)}get currentPrefixStack(){return c(this,be)[c(this,be).length-1]}has(e){return e=e.replace(/(.*[^ ])[ ]+$/,"$1"),e=e.replace(/[$%]$/,""),(!c(this,ue).get(e)||c(this,ue).get(e)&&!c(this,ue).get(e).global)&&(e=this.prepareName(e)),c(this,ue).has(e)}add(e,t,r=!1,s=!1){e=e.replace(/(.*[^ ])[ ]+$/,"$1"),/\$$/.test(e)?t===void 0&&(t=""):/\\%$/.test(e)&&t===void 0&&(t=0),e=e.replace(/[$%]$/,""),e=this.prepareName(e),this.has(e)||c(this,ue).set(e,new wa(e,t,r,s))}get(e){e=e.replace(/(.*[^ ])[ ]+$/,"$1");const t=e;e=e.replace(/[$%]$/,""),(!c(this,ue).get(e)||c(this,ue).get(e)&&!c(this,ue).get(e).global)&&(e=this.prepareName(e));let r=c(this,ue).get(e);return r?(r=r.value,/\$$/.test(t)?r=String(r):/\\%$/.test(t)||/^\d+$/.test(r)?r=parseInt(r):/^[\d.]+$/.test(r)&&(r=parseFloat(r)),r):null}set(e,t,r=!1,s=!1){if(e=e.replace(/(.*[^ ])[ ]+$/,"$1"),typeof t!="object"&&(/[$]$/.test(e)?t===void 0?t="":t=String(t):/[%]$/.test(e)&&(t===void 0?t=0:t=parseInt(t))),e=e.replace(/[$%]$/,""),e=this.prepareName(e),this.has(e)){const i=c(this,ue).get(e);i instanceof wa&&i&&(i.value=t)}else this.add(e,t,r,s)}addSub(e,t){e=this.prepareName(e,!1),this.has(e)||c(this,ft).set(e,new $h(e,t))}executeSub(e,t,r=!1){return e=this.prepareName(e,!1),c(this,be).push({name:`${parseInt(Math.random()*1e4)}`,global:r}),c(this,ft).get(e).execute(t).then(s=>(c(this,ue).forEach(i=>{RegExp(`[$]{3}${c(this,be)[c(this,be).length-1].name}$`).test(i.name)&&c(this,ue).delete(i.name)}),c(this,be).pop(),s))}hasSub(e){return e=this.prepareName(e,!1),c(this,ft).has(e)}prepareName(e,t=!0){return typeof e=="string"&&(e=e.replace(/ /g,"")),t&&c(this,be).length&&!/[$]{3}/.test(e)&&(e=`${e}$$$${c(this,be)[c(this,be).length-1].name}`),e}get dims(){return c(this,ue)}get subs(){return c(this,ft)}}ue=new WeakMap,ft=new WeakMap,be=new WeakMap;var $t,Dr,se,Ee,Xe,Cr,Nr,Se,Lr,Wt,qe,ye,pt,ie,ae,Da;let Wh=(Da=class{constructor(e,t,r,s=null,i=null){g(this,$t,void 0);g(this,Dr,void 0);g(this,se,void 0);g(this,Ee,void 0);g(this,Xe,void 0);g(this,Cr,9999999999);g(this,Nr,0);g(this,Se,null);g(this,Lr,[]);g(this,Wt,0);g(this,qe,[]);g(this,ye,-1);g(this,pt,[]);g(this,ie,[]);g(this,ae,-1);I(this,Xe,e),I(this,Ee,t),I(this,se,r||new Bi),I(this,$t,s),I(this,Dr,i)}get memory(){return c(this,se)}get lines(){return c(this,Xe)}parse(e){e=e||[].concat(c(this,Xe));const t=e.shift().trim();return new Promise(r=>{if(c(this,Se)&&t!=="END SUB"){c(this,Se).lines.push(t),r();return}if(c(this,Cr)>0&&c(this,Nr)>c(this,Cr))throw new Error("BASIC INTERPRETER OVERFLOW");if(Oe(this,Nr)._++,c(this,ae)>=0){if(c(this,ie).forEach(s=>{c(this,ie)[c(this,ae)].count===0&&s.count===0&&s.lines.push(t)}),t==="WEND"||/NEXT /.test(t))return c(this,ie)[c(this,ae)].condition().then(async s=>{if(c(this,ie)[c(this,ae)].tmpLines=c(this,ie)[c(this,ae)].tmpLines||e,s){const i=c(this,ie)[c(this,ae)].lines;return c(this,ie)[c(this,ae)].count++,"step"in c(this,ie)[c(this,ae)]&&await c(this,ie)[c(this,ae)].step(),i.length>0?this.parse([].concat(i)):(c(this,ie)[c(this,ae)]=!1,Oe(this,ae)._--,c(this,ie).pop(),null)}else return c(this,ie)[c(this,ae)]=!1,Oe(this,ae)._--,c(this,ie).pop(),null}).then(r);r()}else r()}).then(()=>{if(!c(this,Se)&&c(this,ye)>=-1&&(c(this,pt)[c(this,ye)]!==void 0&&c(this,qe)[c(this,ye)]===void 0&&c(this,qe).push(!c(this,pt)[c(this,ye)]),t==="ELSE"&&c(this,Wt)<1&&(c(this,qe)[c(this,ye)]=!c(this,qe)[c(this,ye)])),c(this,qe)[c(this,ye)])/^IF (\((.*)\)|(.*)) THEN$/.test(t)&&Oe(this,Wt)._++;else return this.parseLine(t,e);return null}).then(()=>(c(this,ye)>-1&&(t==="ENDIF"||t==="END IF")&&(c(this,Wt)<1?(Oe(this,ye)._--,c(this,pt).pop(),c(this,qe).pop()):Oe(this,Wt)._--),e.length?this.parse(e):c(this,Lr)))}parseLine(e,t){return new Promise((r,s)=>{if(e=(e||"").replace(/^[ \t]+/g,""),/^ *[#/]+/.test(e)){r();return}if(/^SUB (.*) STATIC$/.test(e)){const i=e.match(/^SUB (.*) STATIC$/);return this.commandSubStatic(i[1]).then(r)}else{if(e==="END SUB")return this.commandEndSub().then(r);if(c(this,Se)){r();return}}if(/^IF (\((.*)\)|(.*)) THEN$/.test(e)){const i=e.match(/^IF (\((.*)\)|(.*)) THEN$/),a=i[3]||i[2];return this.commandIfThen(a).then(r)}else if(e==="ELSE"||e==="ENDIF"||e==="END IF"){r();return}if(/^WHILE (.*)$/.test(e)){const i=e.match(/^WHILE (.*)$/);return this.commandWhile(i[1]).then(r)}else if(e==="WEND"){r();return}if(/^FOR (.*)$/.test(e)){const i=e.match(/^FOR (.*)$/);return this.commandFor(i[1]).then(r)}else if(e.startsWith("NEXT ")){r();return}if(/^([\w\d]+):$/.test(e)){r();return}if(/^GOTO +([\w\d]+)$/.test(e)){const i=e.match(/^GOTO +([\w\d]+)$/);this.commandGoto(t,i[1])}if(/^DIM( SHARED)? +(.*)$/.test(e)){const i=e.match(/^DIM( SHARED)? +(.*)$/);return this.commandDimShared(i[2],!!i[1]).then(r)}if(/^LET +([\w,$%]+)(\((.*)\))? *= *(.*)$/.test(e)){const i=e.match(/^LET +([\w,$%]+)(\((.*)\))? *= *(.*)$/);return this.commandLet(i[1],i[4],i[3]).then(()=>r())}if(/^READ +([\w, $%]+)$/.test(e)){const i=e.match(/^READ +([\w, $%]+)$/);return this.commandRead(i[1]).then(r)}if(/^END[ ]*$/.test(e))return this.commandEnd().then(r);if(/^(PAUSE|SLEEP) +(.+)/.test(e)){const a=e.match(/^(PAUSE|SLEEP) +(.+)/)[2];return this.commandPause(a).then(r)}if(/^CALL *(.*)/.test(e)){const i=e.match(/^CALL *(.*)/);return this.commandCall(i[1],t).then(r)}if(/^EXECUTE *(FILE|EVAL) *(.*)/.test(e)){const i=e.match(/^EXECUTE *(FILE|EVAL) *(.*)/);return this.commandExecute(i[1],i[2]).then(r).catch(s)}if(/^PRINT +USING +(.*);(.*)$/.test(e)){const i=e.match(/^PRINT +USING +(.*);(.*)$/);return this.commandPrintUsing(i[1],i[2]).then(r)}if(/^PRINT +(.*)$/.test(e)){const i=e.match(/^PRINT +(.*)$/);return this.commandPrint(i[1]).then(r)}if(/^DATA +(.*)$/.test(e)){const i=e.match(/^DATA +(.*)$/);return this.commandDataVar(i[1]).then(r)}c(this,Ee)?c(this,Ee).call(this,e,{show:!0}).then(i=>{i&&c(this,Lr).push(i)}).then(r).catch(s):r()})}async setReadStack(e,t){let r=await this.parseValue(t,!0);return ts(r)&&(r=parseFloat(r)),c(this,se).set(e,r,!0)}async addDataStack(e){let t=await this.parseValue(e,!0);return ts(t)&&(t=parseFloat(t)),c(this,$t).push(t)}async setStack({name:e,value:t,index:r,global:s}){let i=await this.parseValue(t,!0);return ts(i)&&(i=parseFloat(i)),r!==void 0?(r=await this.parseValue(r,!0),c(this,se).get(e)[r-1]=i):c(this,se).set(e,i,s)}async setGotoMarkStack(e,t){c(this,Dr).set(e,await this.parseValue(t,!0))}parseValue(e,t=!0,r=!1){if(e===void 0)return Promise.resolve(e);if(vo(e))return Promise.resolve(e);if(Array.isArray(e))return Promise.resolve(e);if(typeof e=="boolean"||/^ *(true|false|TRUE|FALSE) *$/.test(e))return typeof e!="boolean"&&(e=e.toLowerCase()==="true"),Promise.resolve(e);if(/^ *@"((.|\n)*)" *$/.test(e))return Promise.resolve(e.replace(/^ *@"((.|\n)*)" *$/,'"$1"'));if(/^ *"((\\"|[^"])*)" *$/.test(e))return Promise.resolve(e.replace(/^ *"((\\"|[^"])*)" *$/,'"$1"'));if(/^ *[\d]+ *$/.test(e))return Promise.resolve(parseFloat(e));if(/^ *([\\-]?[\d.]+(e[-+]?\d+)?) *$/.test(e))return Promise.resolve(parseFloat(e));if(e&&/^[^"]?(.*)[^"]? *$/.test(e.replace(/ /g,""))){if(e=e.replace(/^ */g,""),c(this,se).has(e.replace(/ /g,"")))return e=e.replace(/ /g,""),this.parseValue(c(this,se).get(e),!0);if(r)throw new Error("test");return c(this,Ee).call(this,e,{message:t?void 0:e}).then(s=>s)}return Promise.resolve(null)}async executeCondition(e,t,r){return e=await this.parseValue(e,!0),r=await this.parseValue(r,!0),/^[=]?==$/.test(t)?e===r:t==="<>"?e!==r:/^([<>][=]|[<>])?$/.test(t)?Fh(e,t,r):/^!=[=]?$/.test(t)?e!==r:null}commandIfThen(e){const t=e.match(/([^<>]*) *(<>|<=|>=|<|>|[=!]{2,3}) *([^<>].*)/);return t?this.executeCondition(t[1],t[2],t[3]).then(r=>(c(this,pt).push(r),Oe(this,ye)._++,r)):this.parseValue(e[1],!0).then(r=>(c(this,pt).push("value"in r?r.value:r),Oe(this,ye)._++,r))}commandWhile(e){const t=e.match(/([^<>]*) *(<>|<=|>=|<|>|[=!]{2,3}) *([^<>].*)/);return t?this.executeCondition(t[1],t[2],t[3]).then(r=>{if(r)return c(this,ie).push({count:0,lines:[],condition:()=>this.executeCondition(t[1],t[2],t[3])}),Oe(this,ae)._++,r}):Promise.resolve()}async commandFor(e){const t=e.match(/(.*) *= *(.*) +TO +(.*) +STEP[ ](.*)/)||e.match(/(.*) *= *(.*) +TO +(.*)/);if(t){const r=await this.parseValue(t[2],!0),s=await this.parseValue(t[3],!0);c(this,se).set(t[1],r),Oe(this,ae)._++;const i=async(a=!0)=>{let o=1;return t[4]&&(o=await this.parseValue(t[4],!0)),a&&c(this,se).set(t[1],c(this,se).get(t[1])+o),o};return c(this,ie).push({step:i,count:0,lines:[],condition:async()=>{const a=await i(!1);return a===0?!1:this.executeCondition(`(${t[1]}  )`,a<0?">":"<",s)}})}}commandSubStatic(e){const t=e.match(/^([\w,$%]+)(\((.*)\))?$/),r=t[1],s=ee.resolveValues(ee.extractValues(t[3]||"",","));return I(this,Se,{name:r,lines:[],args:s}),Promise.resolve()}commandEndSub(){if(c(this,Se)){const e=c(this,Se).lines,t=c(this,Se).args;c(this,se).addSub(c(this,Se).name,async(...r)=>{(await Promise.all(t.map((i,a)=>this.parseValue(r[Number(a)]).then(o=>({arg:i,value:o}))))).forEach(({arg:i,value:a})=>{c(this,se).add(i,a)}),await this.parse([].concat(e))}),I(this,Se,null)}else throw new Error("has no active SUB");return Promise.resolve()}commandGoto(e,t){return e.splice(0,e.length),this.parse(c(this,Xe).slice(c(this,Xe).indexOf(`${t}:`),c(this,Xe).length))}commandDimShared(e,t){return ee.resolveValues(ee.extractValues(e,",")).reduce((s,i)=>(i=i.match(/^([\w, $%]+)?(\((.*)\))?$/),c(this,se).has(i[1])||(i[3]&&(s=s.then(()=>this.parseValue(i[3],!0))),s=s.then(a=>this.setStack({name:i[1],value:a?Array(a):void 0,global:t}))),s),Promise.resolve())}commandLet(e,t,r){if(c(this,se).has(e))return this.setStack({name:e,value:t,index:r});throw new Error(`Variable ${e} not defined`)}async commandPrintUsing(e,t){const r=await this.parseValue(e,!0);try{t=await Promise.all(ee.resolveValues(ee.extractValues(t.trim(),",")).map(i=>this.parseValue(i,!0,!0)))}catch{t=[await this.parseValue(t,!0)]}const s=t.reduce((i,a)=>{const o=r.match(/((#+)(\.(#+))?)/);return a=String(a),/[\d.]+/.test(a)&&(a=a.split(/\./),o[4]&&a.length>1?a[1]=No(ci(String(a[1]),o[4].length,!1,"0"),o[4].length):a.splice(1,1),a[0]=ci(String(a[0]),o[2].length,!0," "),a=a.join(".")),i.replace(/(#+(\.#+)?)/,K(a))},r);return c(this,Ee).call(this,null,{message:`"${K(s)}"`})}commandDataVar(e){if(c(this,$t).length===0)return Promise.all(e.split(",").map(t=>this.addDataStack(t)));throw new Error("DATA has already been declared")}async commandPrint(e){if(/^((".*"|[^"]*);([^;]*))$/.test(e)){const t=e.match(/(.*);(.*)$/),r=await this.parseValue(t[1],!0);let s=await Promise.all(ee.resolveValues(ee.extractValues(t[2]," ")).reduce((i,a)=>(i.push(this.parseValue(a,!0)),i),[]));return s=s.map(i=>`${K(r)}${K(i)}`).join(" "),c(this,Ee).call(this,null,{message:`"${s}"`})}else{let t=await this.parseValue(e);return t=await Promise.all(ee.resolveValues(ee.extractValues(String(t)," ")).map(r=>this.parseValue(r,!0))),t=t.map(r=>K(r)),t=t.join(""),c(this,Ee).call(this,null,{message:ts(t)?t:`"${t}"`})}}commandEnd(){return Promise.resolve()}async commandPause(e){const t=await this.parseValue(e);return new Promise(r=>window.setTimeout(()=>{r()},t))}commandRead(e){const t=e.split(",");return Promise.all(t.map(r=>{const s=c(this,$t).shift();return this.setReadStack(r,s),Promise.resolve()}))}commandCall(e,t){const s=e.match(/([^(]+)\(.*\)/)[1];if(c(this,se).hasSub(s))return this.parseLine(e,t);throw new Error(`SUB ${s} NOT FOUND`)}async commandExecute(e,t){if(!c(this,Ee))throw new Error("No callback available for readfile");console.log("READFILE",e,t);let r;switch(e){case"FILE":try{r=await c(this,Ee).call(this,`READFILE ${t}`,{show:!1})}catch(s){throw new Error(s)}if(console.log("READFILE",r),r!==void 0)try{return c(this,Ee).call(this,r.value,{show:!0})}catch(s){throw new Error(s)}else throw new Error("File Content is empty");case"EVAL":try{return this.parseValue(t,{show:!0})}catch(s){throw new Error(s)}}}},$t=new WeakMap,Dr=new WeakMap,se=new WeakMap,Ee=new WeakMap,Xe=new WeakMap,Cr=new WeakMap,Nr=new WeakMap,Se=new WeakMap,Lr=new WeakMap,Wt=new WeakMap,qe=new WeakMap,ye=new WeakMap,pt=new WeakMap,ie=new WeakMap,ae=new WeakMap,Da);function Fh(n,e,t){switch(e.match(/^([<>][=]|[<>])$/)[1]){case"<":return parseFloat(n)<parseFloat(t);case">":return parseFloat(n)>parseFloat(t);case"<=":return parseFloat(n)<=parseFloat(t);case">=":return parseFloat(n)>=parseFloat(t);default:return null}}function ts(n){return!isNaN(parseFloat(n))&&isFinite(n)}var bn,vs,Es,yn;class zh{constructor(e,t){g(this,bn,new Map);g(this,vs,new Map);g(this,Es,[]);g(this,yn,void 0);I(this,yn,t),I(this,bn,e)}get callback(){return c(this,yn)}get memory(){return c(this,bn)}async parse(e,t,r){if(e.length===0)return;e.length>1&&await this.readData(e);const s=[];return new Wh(e,async(a,o)=>{o=Object.assign({},o,r);const l=await(t||c(this,yn))(a,o);return o.show&&typeof l=="string"&&l!=="undefined"&&s.push(l),l},c(this,bn),c(this,Es),c(this,vs)).parse().then(()=>s)}readData(e){let t=e.find(r=>/^[ ]*DATA[ +]/.test(r));return t?(t=e.splice(e.indexOf(t),1),this.parse(t)):Promise.resolve()}}bn=new WeakMap,vs=new WeakMap,Es=new WeakMap,yn=new WeakMap;function Re(...n){if(n.includes(void 0))throw new Error("invalid arguments")}let di,hi,mi,fi,pi,gi,_i,Po;try{di=/([^\w$%]?)\(([^\\(\\)]+)\)/,hi=/^\((.*)\)$/,mi=new RegExp("[^\\d$\\-\\w]?(?<a>([+-]?[\\w.]+e\\+\\d+)|([+-]?[\\w$%.]+)|(^[+-]?[\\w$%.]+)|([\\w$%.]+)|([$]{3}\\d+))[ ]*(?<operator>[\\^*%\\/]|MOD|XOR|AND|OR|<<|>>|>>>)[ ]*(?<b>([-]?[\\w.]+e\\+\\d+)|([-]?[\\w$%.]+)|(^[+-]?[\\w$%.]+)|([\\w$%.]+)|([$]{3}\\d+))"),fi=/([+-]?[\w.]+e\+\d+|[+-]?[\w$%.]+|[$]{3}\d+)[ ]*([+-])[ ]*([+-]?[\w.]+e\+\d+|[+-]?[\w$%.]+|[$]{3}\d+)/,pi=/([\w]+[a-zA-Z0-9_.]+[$%]?)[ ]*\(([^\\(\\)]*)\)/,gi=/^([\w]+[a-zA-Z0-9_.]+[$%]?)[ ]*\(([^\\(\\)]*)\)/,_i=/^([\w]+[a-zA-Z0-9_.]?[$%]?)/,Po=/^([+-]?[\d.]+e\+\d+|[+-]?[\d.])+($|$)/}catch{}var J;class Bh{constructor(e){g(this,J,void 0);this.createMemory(e)}createMemory(e){I(this,J,e||new Bi),c(this,J).addSub("RND",()=>Promise.resolve(Math.random())),c(this,J).addSub("PI",()=>Promise.resolve(Math.PI)),c(this,J).addSub("POW",(t,r)=>(Re(t,r),Promise.resolve(t**(r||2)))),c(this,J).addSub("SQRT",(t,r)=>(Re(t,r),Promise.resolve(Math.sqrt(t,r||2)))),c(this,J).addSub("INT",t=>(Re(t),this.parse(K(t)).then(r=>parseInt(r)))),c(this,J).addSub("SPC",t=>(Re(t),Promise.resolve(`"${ya(t)}"`))),c(this,J).addSub("LEN",t=>(Re(t),Promise.resolve(K(String(t)).length))),c(this,J).addSub("ASC",t=>(Re(t),Promise.resolve(K(t).charCodeAt(0)))),c(this,J).addSub("CHR$",t=>(Re(t),Promise.resolve(String.fromCharCode(t)))),c(this,J).addSub("LEFT$",(t,r)=>(Re(t,r),Promise.resolve(`"${No(K(t),parseInt(r))}"`))),c(this,J).addSub("RIGHT$",(t,r)=>(Re(t,r),Promise.resolve(`"${Dh(K(t),parseInt(r))}"`))),c(this,J).addSub("STRING$",(t,r)=>(Re(t,r),Promise.resolve(`"${ya(K(t),K(r))}"`))),c(this,J).addSub("TIME%",()=>Promise.resolve(Date.now())),c(this,J).addSub("HEX_ENC$",t=>(Re(t),t=Number(K(t)).toString(16),Promise.resolve(t))),c(this,J).addSub("HEX_DEC$",t=>(Re(t),t=parseInt(K(t),16),Promise.resolve(t)))}parse(e){return new Uh(this).parse(e)}validInput(e){return/[/*\-+^()]?/.test(e)}get memory(){return c(this,J)}}J=new WeakMap;const Vh=5e3;var fe,Ke,Pr;class Uh{constructor(e){g(this,fe,void 0);g(this,Ke,[]);g(this,Pr,0);I(this,fe,e)}get parser(){return c(this,fe)}get parsedValues(){return c(this,Ke)}async parse(e){if(c(this,Pr)>Vh)throw new Error(`Can't parse ${e}`);Oe(this,Pr)._++;const{result:t,values:r}=ee.extractStrings(String(e));let s=ir.parse(t);I(this,Ke,c(this,Ke).concat(r)),s=s.map(o=>/^MOD|XOR|AND|OR$/.test(o)?` ${o} `:o);let i=s.join("");Hn(i)&&(i=Number(i));const a=i;return i=await this.action(i),i!==a&&!/^".*"$/.test(i)?this.parse(i):this.$v(i)}async action(e){if(hi.test(e)){const[t,r]=e.match(hi);e=e.replace(t,r)}if(pi.test(e)){const[t,r,s,i]=e.match(pi),a=r||i;let o=ir.parse(s||"");const l=s.includes(",")&&o.join("")!==s;if(l&&(o=s.split(",")),o=await Promise.all(o.map(u=>this.parse(u))),o=l?o:[await this.parse(o.join(""))],c(this,fe).memory.has(a))return e.replace(t,c(this,fe).memory.get(a)[Number(o[0])-1]);if(c(this,fe).memory.hasSub(a))return e.replace(t,this.cacheValue(await c(this,fe).memory.executeSub(a,o)))}if(di.test(e)){const[t,r,s]=e.match(di);return e.replace(t,r+await this.parse(s))}return mi.test(e)?this.operation(e,mi):fi.test(e)?this.operation(e,fi):this.$v(e)}async operation(e,t){const r=e.match(t);let s,i,a;const o=r[0];"groups"in r&&r.groups?(s=r.groups.a,i=r.groups.b,a=r.groups.operator):(s=r[1],a=r[2],i=r[3]);let l=e,u=await this.parse(s);Hn(u)||(u=K(u));let d=await this.parse(i);switch(Hn(d)||(d=K(d)),a){case"+":l=u+d;break;case"-":l=u-d;break;case"*":l=u*d;break;case"/":l=u/d;break;case">":l=u>d;break;case"<":l=u<d;break;case"^":l=u^d;break;case"%":l=u%d;break;case"MOD":l=u%d;break;case"AND":l=u&d;break;case"OR":l=u|d;break;case"XOR":l=u^d;break;case"<<":l=u<<d;break;case">>":l=u>>d;break;case">>>":l=u>>>d;break}return Hn(l)||(l=`"${l}"`),e.replace(o,o.replace(RegExp(`[${s}]{${String(s).length}}[ ]*[${a}]{${String(a).length}}[ ]*[${i}]{${String(i).length}}`),"")+this.cacheValue(l))}$v(e){if(ee.valueUnresolved(e))return e=ee.resolveValue(e,c(this,Ke)),Promise.resolve(e);if(typeof e=="string"&&(e=e.replace(/^[ ]*([^ ].*[^ ])[ ]*$/,"$1")),Po.test(e))return Promise.resolve(Number(e));if(gi.test(String(e))){const[,t,r]=e.match(gi);if(c(this,fe).memory.hasSub(t))return c(this,fe).memory.executeSub(t,ee.resolveValues(ee.extractValues(r,",")));throw new Error(`can't find sub "${t}" in memory`)}else if(_i.test(String(e))){const t=e.replace(_i,"$1");if(c(this,fe).memory.hasSub(t))return c(this,fe).memory.executeSub(t);if(c(this,fe).memory.has(t))return Promise.resolve(c(this,fe).memory.get(t))}return Promise.resolve(e)}cacheValue(e){return c(this,Ke).push(e),ee.resolveKey(c(this,Ke).length-1)}}fe=new WeakMap,Ke=new WeakMap,Pr=new WeakMap;const jh=["CLS","READ max","DIM fib%(max)","LET fib(1) = 1","LET fib(2) = 2","FOR i=3 TO max","LET fib(i) = fib(i - 2) + fib(i -1)","NEXT i","FOR i=1 TO max","PRINT fib(i)","NEXT i","DATA 10","END"],Gh=["CLS","DIM w%,h%,a%","LET w%=12","LET h%=4","LET a%=w%*h%",'PRINT "With the width " + w%','PRINT " and the height " + h%','PRINT " you have the area " + a%'],Hh=["CLS","DIM r,a","LET r=5","READ pi","LET a=r*r*pi",'PRINT USING "With the radius ##.##"; r','PRINT USING "we have the area ##.##"; a',"DATA 3.14","END"],Yh=["GuessTheNumber","CLS","READ max%","DIM number%, guess%, guesses%",'PRINT "The number is between 1-1000."',"LET number% = INT(RND * max%) + 1","LET guess% = 1","LET guesses% = 0","WHILE guess%<>number%",'PRINT "Guess the number"',"INPUT guess%","IF (guess%<>number%) THEN","IF (guess%>number%) THEN",'PRINT "Your guess was too high"',"ELSE",'PRINT "Your guess was too low"',"ENDIF","ENDIF","LET guesses% = guesses% + 1","WEND",'PRINT USING "You found the number in # tries"; guesses%',"DATA 1000","END"],Xh=["DIM result",'PRINT "Calculate the factorial of"',"INPUT n","LET result = 1","FOR i = n TO 1 STEP -1","LET result = result * i","NEXT i",'PRINT USING "#! = #"; n, result',"END"],qh=["CLS","DIM stars$",'PRINT "Enter the height of the pyramid"',"INPUT height",'LET stars$ = ""',"FOR i = 1 TO height",'LET stars$ = ""',"FOR j = 1 TO (i+i-1)",'LET stars$ = stars$ + "*"',"NEXT j","PRINT SPC(height - i) + stars","NEXT i","END"],Kh=['PRINT "Step 1"','PRINT "Step 2"','PRINT "Step 3"',"GOTO ignore",'PRINT "Step 4"',"ignore:",'PRINT "Step 5"'],Zh=["DIM A, B","LET A = 2000",'LET B = "Hello World"','PRINT USING "A: #"; A','PRINT USING "B: #"; B'],Qh=["DIM A, B","LET A = 1","LET B = 2","IF A == B THEN",'PRINT "true"',"ELSE",'PRINT "false"',"END","IF (A < B) THEN",'PRINT "true"',"END"],Jh=["DIM i%","FOR i% = 1 TO 5",'PRINT USING "For Number #"; i%',"NEXT i%"],em=["DIM i%","LET i%=0","WHILE i% < 5",'PRINT USING "While Number #"; i%',"LET i% = i% + 1","WEND"],tm=["DIM duration","LET duration = 2500",'PRINT USING "Start with Pause #ms"; duration',"PAUSE duration",'PRINT "End Pause"','PRINT USING "Start with Sleep #ms"; duration',"PAUSE duration",'PRINT "End Sleep"'],nm={Fibonacci:jh,Area:Gh,Circle:Hh,"Your Name":["CLS",'PRINT "What is your name?"',"INPUT n$",'PRINT "What is your shoe size?"',"INPUT size",'PRINT "Hello "; n$','PRINT USING "your shoe size is ##.##"; size',"END"],GuessTheNumber:Yh,Factorial:Xh,Pyramid:qh,"Bubble Sort":["CLS","READ max","DIM SHARED numbers(max)","SUB CreateList(max) STATIC","FOR i=1 TO max","LET numbers(i) = INT(RND * 100)","NEXT i","END SUB","SUB PrintList(max) STATIC","FOR i=1 TO max","PRINT numbers(i)","NEXT i","END SUB","SUB SwapValues(i%, j%) STATIC","LET numbers(i%) = numbers(i%) XOR numbers(j%)","LET numbers(j%) = numbers(i%) XOR numbers(j%)","LET numbers(i%) = numbers(i%) XOR numbers(j%)","END SUB","SUB Sort(max) STATIC","FOR i%=1 TO (max - 1)","FOR j%=i% TO max","IF numbers(i%)>numbers(j%) THEN","CALL SwapValues(i%, j%)","END IF","NEXT j%","NEXT i%","END SUB","CreateList(max)","Sort(max)","PrintList(max)","DATA 10","END"],Goto:Kh,Vars:Zh,If:Qh,For:Jh,"For Step":["CLS","FOR i% = 0 TO 6 STEP 2",'PRINT "For Step Number #"; i%',"NEXT i%"],While:em,Pause:tm},rm=({module:n,core:e})=>{const{fileSystem:t}=e.modules.files;return[{name:["basic"],args:[new b({index:0,name:"path",description:"Path to basic script"})],async action({path:r},s){if(!r)throw L.get("bad_args");const i=await t.get(r);if("type"in i.data&&i.data.type==="basic"&&Array.isArray(i.data.content))return n.parseBasic(i.data.content,null,{logger:s.logger});throw new TypeError(`Can't read file ${r}`)}},{name:["basicExamples"],args:[new b({index:0,name:"name",description:"Name from example"})],action({name:r}){return n.parseBasic(nm[String(r)])}}]};var wn,xn,vn,Ss;class Mo extends Cs{constructor({core:t}){super({commands:(...r)=>[...rm(...r)],core:t});g(this,wn,void 0);g(this,xn,new Bi);g(this,vn,new Bh(c(this,xn)));g(this,Ss,new ee(c(this,vn)));I(this,wn,new zh(c(this,xn),t.executeCommand.bind(t)))}get memory(){return c(this,xn)}parse(...t){return c(this,wn).parse(...t)}parseBasic(...t){return c(this,wn).parse(...t)}parseCommand(...t){return c(this,Ss).parse(...t)}parseMath(...t){return c(this,vn).parse(...t)}isMathValue(...t){return c(this,vn).validInput(...t)}}wn=new WeakMap,xn=new WeakMap,vn=new WeakMap,Ss=new WeakMap,f(Mo,"NAME","Parser");var pe,Ft;const Is=class Is extends ge{constructor(t){t=Object.assign({},t);super(t);g(this,pe,new Map);g(this,Ft,ou(1));this.addItems(t.items||c(this,pe)),I(this,Ft,t.maxSize||c(this,Ft))}async export(...t){const r=await ge.prototype.export.apply(this,...t);return delete r.data,r.items=await Promise.all(Array.from(c(this,pe).values()).map(s=>s.export())),r}async addItems(t,r=!1){return t instanceof Map&&(t=Array.from(t.values())),t=await Promise.all(t.map(async s=>(typeof s.data=="string"&&(s.data=await ii(s.data)),s))),t=this.parseItems(t),Promise.all(t.map(s=>this.addItem(s,r)))}static normalizeItemData(t){return"info"in t&&(t.meta=[t.info],delete t.info),"items"in t&&(t.items instanceof Map||(t.items=new Map(t.items.map(r=>[r.id,r])))),"extension"in t&&(t.id+="."+t.extension,delete t.extension),"createTime"in t&&(t.createdDate=t.createTime,delete t.createTime),"editTime"in t&&(t.editedDate=t.editTime,delete t.editTime),"icon"in t&&delete t.icon,t}parseItems(t){return t.map(r=>{r=Is.normalizeItemData(r);let s;return r.type?s=Gs(r.type):r.items?s=Gs("Directory"):s=Gs(),new s(r)})}async addItem(t,r=!1){const s=t.parent;if(!r&&this.hasItem(t.id))throw new Error(`File ${t.id} exists`);if(s&&await s.removeItem(t),r){const i=rr(t.id),a=Mi(t.id);t.setId(hs(xo(a,this,i),i))}return c(this,pe).set(t.id,t),t.setParent(this),t.events.next(new G("move",{item:t,lastParent:s})),this.events.next(new G("addItem",t)),t}removeItem(t){return t.setParent(null),c(this,pe).delete(t.id),this.events.next(new G("removeItem",t)),Promise.resolve()}async remove(t){const{recursive:r}=Object.assign({recursive:!1},t);if(r){let s=await this.getItems();return s=await Promise.all(Array.from(s.values()).map(i=>i.remove(t))),s=s.reduce((i,a)=>i.concat(a),[]),s.push(await ge.prototype.remove.apply(this,[t])),s}else{if((await this.getItems()).size>0)throw new Error(L.get("FileSystemItem_itemContainerNotEmpty",await this.getPath()));return[await ge.prototype.remove.apply(this,arguments)]}}changeItemId(t,r,s){c(this,pe).delete(r),c(this,pe).set(s,t),this.parent&&console.log("changeItemId by parent",r,s,c(this.parent,pe))}getItems(){return Promise.resolve(c(this,pe))}getItem(t){return c(this,pe).get(t)}hasItem(t){return c(this,pe).has(t)}get items(){return c(this,pe)}get size(){return Array.from(c(this,pe).values()).reduce(function(t,r){return r instanceof Is||(t+=r.size),t},0)}get maxSize(){return t(this);function t(r){return r.parent&&c(r,Ft)?t(r.parent):c(r,Ft)}}};pe=new WeakMap,Ft=new WeakMap;let H=Is;L.add([["FileSystemItem_itemContainerNotEmpty",["ItemWrapp Not Empty","ItemContainer not empty %1"]]]);class Vi extends H{constructor(e){e=Object.assign({},e,{locked:!0,id:"ROOT"}),super(e)}}f(Vi,"NAME","Root");var Ys,Ze;let at=(Ys=class extends H{constructor(t){t=Object.assign({storage:null},t,{locked:!0});super(t);g(this,Ze,void 0);I(this,Ze,t.storage)}get storage(){return c(this,Ze)}get locked(){return c(this,Ze).locked}mount(...t){return c(this,Ze).mount(...t)}unmount(...t){return c(this,Ze).unmount(...t)}async save(){return c(this,Ze).save(await this.export())}},Ze=new WeakMap,f(Ys,"NAME","Storage"),Ys);class fs extends at{constructor(...e){super(...e),this.meta.set(y.VISIBLE,!1)}}f(fs,"NAME","TmpDisk"),f(fs,"SYMBOL",w.TMP_DISK);class ps extends at{}f(ps,"NAME","RamDisk"),f(ps,"SYMBOL",w.RAM_DISK);class Ui extends H{}f(Ui,"NAME","FloppyDisk");class gs extends at{}f(gs,"NAME","HardDisk"),f(gs,"SYMBOL",w.HARD_DISK);class _s extends at{isLogged(){return this.storage.storage.isLogged()}}f(_s,"NAME","CloudDisk"),f(_s,"SYMBOL",w.CLOUD_DISK);class vt extends H{constructor(...e){super(...e),[y.WINDOW_SCALE,y.WINDOW_SCROLL_X,y.WINDOW_SCROLL_Y].forEach(t=>{this.meta.has(t,!0)||this.meta.set(t,!0)})}}f(vt,"NAME","Directory"),f(vt,"SYMBOL",w.DIRECTORY);class De extends H{}f(De,"NAME","Trashcan"),f(De,"SYMBOL",w.TRASHCAN);class Xr extends ge{}f(Xr,"NAME","File");var En;class ji extends ge{constructor(t){t=Object.assign({refPath:null},t);super(t);g(this,En,void 0);I(this,En,t.refPath)}get refPath(){return c(this,En)}set refPath(t){I(this,En,t)}}En=new WeakMap,f(ji,"NAME","Link");var Mr,Be,Ie,$r,Sn;const re=class re{constructor(e){g(this,Mr,void 0);g(this,Be,void 0);g(this,Ie,void 0);g(this,$r,new Map);g(this,Sn,new $e);I(this,Mr,e),this.setup()}get root(){return c(this,Be)}setup(){I(this,Be,new Vi),I(this,Ie,c(this,Be));const e=[this.addStorage(re.RAM_DISK_TITLE,de.SESSION,{id:re.RAM_DISK_NAME}),this.addStorage(re.HARD_DISK_NAME,de.LOCAL,{trashcan:!0}),this.addStorage(re.TMP_DISK_TITLE,de.TEMP,{id:re.TMP_DISK_NAME,trashcan:!1})];return Promise.all(e).catch(t=>{throw t})}createTmpFile(e,t,r,s){return this.createRootFile(`TMP:${e}`,t,r,s)}createRootDir(e,t,r){const s=`${e}`;return this.makedir(s,t,Object.assign({},r,{override:!0}))}createRootFile(e,t,r,s){typeof t=="object"&&(r=t,t=null);const i=`${e}`;return this.makefile(i,t,r,Object.assign({},s,{override:!0}))}async get(e,t){if(e instanceof ge)return e;if(is(e))try{return await this.parsePath(e)}catch(r){if(t)return new ge({name:Te(e)});throw r}else throw L.get("FileSystem_pathInvalid",Te(e),Wn(e))}async parsePath(e){let t=e,r=c(this,Ie);const s=e.match(/^([^:\\/]+):(.*)$/);if(s?(r=c(this,Be).getItem(s[1]),t=s[2]):t[0]==="/"?(t=t.slice(1),r=c(this,Ie).getStorageItem()):t==="ROOT"&&(r=c(this,Be),t=""),t&&t.length>0&&(r=yi(t.split("/"),r)),r)return r;throw L.get("FileSystem_pathInvalid",e,await c(this,Ie).getBase())}async addFloppyDisk(e){typeof e=="function"&&(e=e());const t=await e;return this.addStorage(t)}async removeFloppyDisk(e){await e.remove(!0)}async addStorage(e,t=de.NONE,r){r=Object.assign({id:null},r);let s;typeof t=="function"&&(s=t,t=de.CLOUD);const i={id:this.getFreeSlot(re.PREFIX.FLOPPY_DISK),itemClass:Ui};let a={};if(typeof e=="object"){const o=e;i.name=o.name,i.items=o.items,i.meta=Array.from(new Map([[y.SYMBOL,w.DISK_1]].concat(o.meta||[])))}else{switch(t){case de.SESSION:i.id=re.PREFIX.RAM,i.itemClass=ps;break;case de.TEMP:i.id=re.PREFIX.TMP,i.itemClass=fs;break;case de.LOCAL:i.id=this.getFreeSlot(re.PREFIX.HARD_DISK),i.itemClass=gs;break;case de.CLOUD:i.id=this.getFreeSlot(re.PREFIX.CLOUD_DISK),i.itemClass=_s;break}i.id=r.id||i.id,s=await this.registerStorage(i.id,s||t).mount(r);const o=await s.load();a=H.normalizeItemData(o),i.storage=s,de.NONE!==t&&(i.name=a.name||e)}return(i.meta=i.meta||[]).push(...a.meta||[]),this.addDisk(Object.assign(a,i),r)}removeStorage(e){return e.unmount().then(()=>(c(this,Sn).next(new G("removeStorage",{itemStorage:e})),e))}registerStorage(e,t){let r;typeof t=="function"?r=t:r=Do(t);const s=`${c(this,Mr)}_${e}`,i=new r({id:e,name:s});return c(this,$r).set(s,i),i}connect(e,t){return this.addStorage(nu,e,t).then(r=>r).catch(r=>{throw r})}async disconnect(e){return e=await this.removeStorage(e),e.remove({silent:!0,recursive:!0}),e}addDisk({id:e,name:t,meta:r,items:s,itemClass:i,storage:a},o){o=Object.assign({trashcan:!1},o),o.trashcan&&(!s||s&&!s.has(De.NAME))&&(s=s||new Map,s.set(De.NAME,{type:De.NAME,id:De.NAME,name:De.NAME}));const l=i;if(!l)throw new Error("ItemClass is empty!");const u=new l({id:e,name:t,meta:r,items:s,storage:a});return c(this,Be).addItem(u),c(this,Sn).next(new G("addDisk",{id:e,item:u})),u}get currentItem(){return c(this,Ie)}get events(){return c(this,Sn)}get storages(){return c(this,$r)}getFreeSlot(e){let t=0;for(;c(this,Be).hasItem(`${e}${t}`);)t++;return`${e}${t}`}async exist(e){try{return!!await this.get(e)}catch{return!1}}async changeDirectory(e){const t=await this.get(e);return I(this,Ie,t),this.events.next(new G("changeDirectory",t)),t}async makedir(e,t,r){const{ignore:s,meta:i}=Object.assign({ignore:!1,override:!1,meta:[]},r);let a;e&&au(e)&&e!==t?a=await this.get(Wn(e)):a=c(this,Ie);const o=new vt({id:Te(e),name:t||"",createdDate:Date.now(),meta:i});if(await He(a),s||!a.getItem(o.id))a.addItem(o,s),this.events.next(new G("writeItem",o));else throw L.get("FileSystem_fileExist",o.id);return await we(a),o}async makefile(e,t,r,s){const{override:i,meta:a}=Object.assign({override:!1,meta:[]},s),o=new Xr({id:Te(e),name:t,data:r,meta:a,createdDate:Date.now()});if(!is(e))throw L.get("FileSystem_invalidPath",e);let l=su(e);const u=iu(e);l===u&&(l=".");let d;if(ru(l)?d=await this.get(l):c(this,Ie).id!=="ROOT"?d=await this.get(Pi(await c(this,Ie).getPath(),l)):d=await this.get(l),d.hasItem(u))if(i)await d.getItem(u).remove(),d.addItem(o);else throw L.get("FileSystem_fileExist",o.id);else d.addItem(o),this.events.next(new G("writeItem",o));return await we(d),o}async editfile(e,t){const r=await this.get(e).then(He);return await He(r),r.data=t,we(r)}async editfileMeta(e,t,r){const s=await this.get(e);return Array.isArray(t)?t.map(i=>({name:i[0],value:i[1]})):s.meta.set(t,r),we(s)}async saveItem(e){const t=await this.get(e);return we(t)}async makelink(e,t=null){const r=await this.get(e);await He(r);const s=c(this,Ie),i=new ji({id:Mi(r.id)+".ref",name:`${t||r.name}`,refPath:await r.getPath(),createdDate:Date.now()});return await s.addItem(i),await we(r),i}async editlink(e,t){const r=await this.get(e);await He(r);const s=await this.get(t);return r.refPath=await s.getPath(),we(r)}async rename(e,t,{name:r=!1,removeName:s=!1}){let i;if(e instanceof ge)i=e;else if(is(e)||typeof e=="string")i=await this.get(e);else throw L.get("FileSystem_pathInvalid",Wn(e),e);return await He(i),s&&(r=!0,t=null),await i.rename(t,{ignore:!0,name:r}),we(i)}async copy(e,t,r){const{ignore:s}=Object.assign({ignore:!1},r);let i,a,o;if(e instanceof ge?(a=e,i=e.id):(a=await this.get(e),i=Te(e)),t instanceof ge)t instanceof H||(t=t.parent),o=t;else{i=Te(t);const u=await this.get(t,!0);if(u instanceof H?i=Te(e):u.parent?o=u.parent:o=await this.get(Wn(t)),!(o instanceof H))throw new TypeError("no ItemContainer")}await He(a);const l=await a.copy();if(s||!o.getItem(i))l.rename(i),o.addItem(l,s),this.events.next(new G("copyItem",l));else throw L.get("FileSystem_fileExist",i);return we(l)}async move(e,t,{override:r=!1}){let s,i,a;if(e instanceof ge)i=e,s=e.id;else{if(i=await this.get(e),i instanceof at)throw L.get("FileSystem_cantMoveStorage",i.displayName);s=Te(e)}if(t instanceof ge)t instanceof H||(t=t.parent),a=t;else{if(s=Te(t),a=await this.get(t),a instanceof H)s=Te(e);else return this.get(Wn(t));if(!(a instanceof H))throw new TypeError("no ItemContainer")}let o;if(await He(i),r||!await a.getItem(s))o=i.getStorageItem(),await i.rename(s),await a.addItem(i,r),this.events.next(new G("moveItem",i));else throw L.get("FileSystem_fileExist",i.id,s);return await we(i),o?o.save().then(()=>i):i}async remove(e,t,r){const{ignore:s}=Object.assign({ignore:!1},r),i=await this.get(e);await He(i);try{const a=await lu(t,i);return a[a.length-1].storage&&await a[a.length-1].storage.save(),a}catch(a){if(!s)throw new Error(a)}}};Mr=new WeakMap,Be=new WeakMap,Ie=new WeakMap,$r=new WeakMap,Sn=new WeakMap,f(re,"PREFIX",{FLOPPY_DISK:"DF",TMP:"TMP",RAM:"RAM",HARD_DISK:"HD",CLOUD_DISK:"CD"}),f(re,"TMP_DISK_NAME","TMP"),f(re,"TMP_DISK_TITLE","TMP DISK"),f(re,"RAM_DISK_NAME","RAM"),f(re,"RAM_DISK_TITLE","RAM DISK"),f(re,"HARD_DISK_NAME","HARD DISK");let bi=re;function yi(n,e){const t=n.shift();if(t===void 0)return e;if(t===".."){if(e.parent)return e.parent}else if(t==="."||t==="")return yi(n,e);if(e){const r=e.getItem(t);return n.length>0&&r instanceof H?yi(n,r):r}}const sm=[vt,De,at,fs,ps,gs,Ui,_s,ji,Xr].reduce((n,e)=>(n[e.NAME]=e,n),{});function Gs(n){return sm[String(n)]||Xr}L.add([["FileSystem_invalidPath",["Invalid File",'Invalid path "%1"']],["FileSystem_invalidFile",["Invalid File",'Invalid file "%1"']],["FileSystem_fileExist",["File Ready",'File already exists "%1"']],["FileSystem_pathInvalid",["Path Invalid",'Path invalid "%1"; base: "%2"']],["FileSystem_itemInvalid",["Item Invalid",'Item id invalid "%1" from "%2"']],["FileSystem_cantMoveStorage",["Can't Move",`Can't move Storage "%1"`]],["FileSystem_permissionsNeeded",["Permissions needed","Permissions needed"]]]);const im={props:{label:{type:String,default:"Item Label"},model:{type:Object,default(){return{value:null}}},name:{type:String,default:null},value:{type:[String,Number],default:null},multiple:{type:Boolean,default:!1},readonly:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1}},computed:{currentModel:{get(){return this.name?this.model[this.name]:this.model.value},set(n){this.name?this.model[this.name]=n:this.model.value=n}},input(){return{name:this.name,readonly:this.readonly,disabled:this.disabled,type:this.multiple?"checkbox":"radio"}}}},am={class:"wb-env-atom-form-field-item-select-item"},om=["value"],lm=["innerHTML"];function cm(n,e,t,r,s,i){return x(),D("label",am,[Xt(E("input",V({"onUpdate:modelValue":e[0]||(e[0]=a=>i.currentModel=a)},i.input,{value:t.value}),null,16,om),[[Si,i.currentModel]]),E("span",{class:"label",innerHTML:t.label||""},null,8,lm)])}const um=j(im,[["render",cm],["__scopeId","data-v-f600844e"]]);const dm={components:{WbEnvAtomFormFieldFieldItemSelectItem:um},props:{title:{type:String,default:"Item Select Title"},multiple:{type:Boolean,default:!1},name:{type:String,default:"value"},readonly:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},model:{type:Object,default(){return{value:{}}}},items:{type:Array,required:!1,default(){return[{label:"Item 1",value:"item-1"},{label:"Item 2",value:"item-2"}]}}}},hm={class:"wb-env-atom-form-field-item-select"},mm={key:0,class:"title"};function fm(n,e,t,r,s,i){const a=R("wb-env-atom-form-field-field-item-select-item");return x(),D("div",hm,[t.title?(x(),D("div",mm,Ne(t.title),1)):B("",!0),E("ul",null,[(x(!0),D(wt,null,xt(t.items,(o,l)=>(x(),D("li",{key:l},[N(a,V(o,{name:o.name||t.name,model:t.model,multiple:t.multiple,readonly:o.readonly||t.readonly,disabled:o.disabled||t.disabled}),null,16,["name","model","multiple","readonly","disabled"])]))),128))])])}const pm=j(dm,[["render",fm],["__scopeId","data-v-393e2da0"]]);const gm={components:{WbButton:It,WbButtonWrapper:At,WbItemSelect:pm},props:{fileSystem:{type:Object,default(){return null}},fsItem:{type:Object,default(){return null}},name:{type:String,default(){return"fsItem"}},model:{type:Object,default(){return{fsItem:null}}},backLabel:{type:String,default(){return"../"}},upLabel:{type:String,default(){return"Up"}},downLabel:{type:String,default(){return"Down"}},maxVisibleItems:{type:Number,default(){return 5}}},emits:["select","refresh"],data(){return{currentFsItem:this.fsItem||z(this.fileSystem.root),fsItems:[],currentIndex:0}},computed:{disableds(){return{back:!this.currentFsItem.parent,up:this.currentIndex-1<0,down:this.currentIndex+1>this.fsItems.length-this.maxVisibleItems}},currentPath(){return this.model[this.name]},items(){const n=this.fsItems.slice(this.currentIndex,this.currentIndex+this.maxVisibleItems).map(e=>({label:e.id,value:e.getPath()})).concat(Array(Math.max(this.maxVisibleItems-this.fsItems.length,0)).fill({label:"&nbsp;",disabled:!0}));return this.fsItems.length<1&&(n[Math.floor(n.length/2)]={label:"Empty",disabled:!0}),n}},watch:{async currentPath(){this.currentFsItem=z(await this.fileSystem.get(this.model[this.name])),this.currentFsItem instanceof H&&(this.fsItems=Array.from((await this.currentFsItem.getItems()).values()).map(z),this.currentIndex=0),this.$emit("select",this.currentFsItem)}},async mounted(){this.fsItems=Array.from((await this.currentFsItem.getItems()).values()).map(z),this.$nextTick(()=>{this.$emit("refresh",{reset:!0,resize:!1,scroll:!1})})},methods:{onClicBack(){this.currentFsItem instanceof H?this.model[this.name]=this.currentFsItem.parent.getPath():this.model[this.name]=this.currentFsItem.parent.parent.getPath()},onClickUp(){this.currentIndex=Math.max(this.currentIndex-1,0)},onClickDown(){this.currentIndex=Math.min(this.currentIndex+1,this.fsItems.length-this.maxVisibleItems)}}},_m={class:"wb-module-files-atoms-file-select"};function bm(n,e,t,r,s,i){const a=R("wb-item-select"),o=R("wb-button"),l=R("wb-button-wrapper");return x(),D("div",_m,[E("div",null,[N(a,{title:null,items:i.items,name:t.name,model:t.model},null,8,["items","name","model"])]),E("div",null,[N(l,{align:"outer",full:"",direction:"vertical"},{default:Y(()=>[N(o,{"style-type":"secondary",label:t.backLabel,disabled:i.disableds.back,onClick:i.onClicBack},null,8,["label","disabled","onClick"]),N(o,{"style-type":"secondary",label:t.upLabel,disabled:i.disableds.up,onClick:i.onClickUp},null,8,["label","disabled","onClick"]),t.downLabel?(x(),U(o,{key:0,"style-type":"secondary",label:t.downLabel,disabled:i.disableds.down,onClick:i.onClickDown},null,8,["label","disabled","onClick"])):B("",!0)]),_:1})])])}const $o=j(gm,[["render",bm],["__scopeId","data-v-456ecefa"]]);const ym={components:{WbEnvAtomFormField:Mn},props:{model:{type:[Array,Object],default(){return{}}},type:{type:String,default:"text"},id:{type:String,default:null},name:{type:String,default:null},placeholder:{type:String,default:"Placeholder"},pattern:{type:String,default:null},readonly:{type:Boolean,default:!1},min:{type:Number,default:null},max:{type:Number,default:null},step:{type:Number,default:null},disabled:{type:Boolean,default:!1},autocomplete:{type:Boolean,default:!1},size:{type:[String,Number],default:void 0}},computed:{currentModel:{get(){return this.name?this.model[this.name]:this.model.value},set(n){this.name?this.model[this.name]=n:this.model.value=n}},styleClasses(){return{["type-"+this.type]:!0}},input(){return{name:this.name,type:this.type,placeholder:this.placeholder,pattern:this.pattern,min:this.min,max:this.max,step:this.step,readonly:this.readonly,disabled:this.disabled,autocomplete:this.autocomplete?"on":"off"}}}};function wm(n,e,t,r,s,i){const a=R("wb-env-atom-form-field");return x(),U(a,V({tag:"div",class:"wb-env-atom-form-textbox"},n.$attrs,{class:i.styleClasses}),{default:Y(()=>[Xt(E("input",V({ref:"input","onUpdate:modelValue":e[0]||(e[0]=o=>i.currentModel=o),class:"input"},i.input),null,16),[[Si,i.currentModel]])]),_:1},16,["class"])}const qr=j(ym,[["render",wm],["__scopeId","data-v-64796933"]]);const xm={components:{WbForm:Pn,WbButton:It,WbButtonWrapper:At,WbFormFieldTextbox:qr,WbFileSelect:$o},props:{...lt,fsItem:{type:Object,default(){return null}},id:{type:String,default(){return null}},model:{type:Object,default(){return Le({path:null,filename:null,file:null})}}},emits:[...ct,"close"],setup(n,e){return ot(n,e)},data(){return{filesModule:z(this.core.modules.files),cancelLabel:"Cancel",saveLabel:"Save",fields:{path:{name:"path",label:null,placeholder:"Path"},filesSelect:{title:null,name:"item"},filename:{name:"filename",label:null,placeholder:"Filename"}},currentFsItem:this.fsItem||z(this.core.modules.files.fs.root)}},computed:{fileSelectFsItem(){return this.fsItem||z(this.core.modules.files.fs.root)},isLocked(){return this.currentFsItem?this.currentFsItem.locked:!1},saveDisabled(){return!this.model.filename}},mounted(){this.id&&(this.model.filename=this.id)},methods:{onSelect(n){this.currentFsItem=n,n instanceof H?this.model.path=n.getPath():(this.model.path=n.getBase(),this.model.filename=n.id)},onClickCancel(){this.$emit("close")},onSubmit(n){const e=Pi(this.model.path,this.model.filename);this.$emit("close",e)}}},vm={class:"wb-module-files-save"};function Em(n,e,t,r,s,i){const a=R("wb-form-field-textbox"),o=R("wb-file-select"),l=R("wb-button"),u=R("wb-button-wrapper"),d=R("wb-form");return x(),D("div",vm,[N(d,{onSubmit:i.onSubmit},{default:Y(()=>[N(a,V(s.fields.path,{model:t.model,readonly:""}),null,16,["model"]),N(o,{"file-system":s.filesModule.fileSystem,"fs-item":i.fileSelectFsItem,model:t.model,name:"file",onSelect:i.onSelect},null,8,["file-system","fs-item","model","onSelect"]),N(a,V(s.fields.filename,{model:t.model}),null,16,["model"]),N(u,{align:"outer",full:""},{default:Y(()=>[s.cancelLabel?(x(),U(l,{key:0,"style-type":"secondary",label:s.cancelLabel,onClick:i.onClickCancel},null,8,["label","onClick"])):B("",!0),s.saveLabel?(x(),U(l,{key:1,"style-type":"primary",label:s.saveLabel,type:"submit",disabled:i.isLocked||i.saveDisabled},null,8,["label","disabled"])):B("",!0)]),_:1})]),_:1},8,["onSubmit"])])}const Sm=j(xm,[["render",Em],["__scopeId","data-v-20baae2d"]]);const Im={components:{WbForm:Pn,WbButton:It,WbButtonWrapper:At,WbFormFieldTextbox:qr,WbFileSelect:$o},props:{...lt,fsItem:{type:Object,default(){return null}},model:{type:Object,default(){return Le({path:null})}}},emits:[...ct,"close"],setup(n,e){return ot(n,e)},data(){return{filesModule:z(this.core.modules.files),cancelLabel:"Cancel",openLabel:"Open",fields:{path:{name:"path",label:null,placeholder:"Path"},fileSelect:{name:"path"},filename:{name:"filename",label:null,placeholder:"Filename"}},currentFsItem:this.fsItem||z(this.core.modules.files.fs.root)}},computed:{isItemContainer(){return this.currentFsItem instanceof H},fileSelectFsItem(){return this.fsItem||z(this.core.modules.files.fs.root)}},methods:{onSelect(n){this.currentFsItem=z(n),n instanceof H&&(this.model.path=n.getPath())},onClickCancel(){this.$emit("close")},onSubmit(n){this.$emit("close",this.model.path)}}},Am={class:"wb-module-files-open"};function km(n,e,t,r,s,i){const a=R("wb-form-field-textbox"),o=R("wb-file-select"),l=R("wb-button"),u=R("wb-button-wrapper"),d=R("wb-form");return x(),D("div",Am,[N(d,{onSubmit:i.onSubmit},{default:Y(()=>[N(a,V(s.fields.path,{model:t.model,readonly:""}),null,16,["model"]),N(o,V(s.fields.fileSelect,{"file-system":s.filesModule.fileSystem,"fs-item":i.fileSelectFsItem,model:t.model,onSelect:i.onSelect}),null,16,["file-system","fs-item","model","onSelect"]),N(u,{align:"outer",full:""},{default:Y(()=>[s.cancelLabel?(x(),U(l,{key:0,"style-type":"secondary",label:s.cancelLabel,onClick:i.onClickCancel},null,8,["label","onClick"])):B("",!0),s.openLabel?(x(),U(l,{key:1,"style-type":"primary",label:s.openLabel,type:"submit",disabled:i.isItemContainer},null,8,["label","disabled"])):B("",!0)]),_:1})]),_:1},8,["onSubmit"])])}const Om=j(Im,[["render",km],["__scopeId","data-v-492fa964"]]);function Gi(){return{async:!1,baseUrl:null,breaks:!1,extensions:null,gfm:!0,headerIds:!1,headerPrefix:"",highlight:null,hooks:null,langPrefix:"language-",mangle:!1,pedantic:!1,renderer:null,sanitize:!1,sanitizer:null,silent:!1,smartypants:!1,tokenizer:null,walkTokens:null,xhtml:!1}}let Zt=Gi();function Wo(n){Zt=n}const Fo=/[&<>"']/,Rm=new RegExp(Fo.source,"g"),zo=/[<>"']|&(?!(#\d{1,7}|#[Xx][a-fA-F0-9]{1,6}|\w+);)/,Tm=new RegExp(zo.source,"g"),Dm={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},xa=n=>Dm[n];function he(n,e){if(e){if(Fo.test(n))return n.replace(Rm,xa)}else if(zo.test(n))return n.replace(Tm,xa);return n}const Cm=/&(#(?:\d+)|(?:#x[0-9A-Fa-f]+)|(?:\w+));?/ig;function Bo(n){return n.replace(Cm,(e,t)=>(t=t.toLowerCase(),t==="colon"?":":t.charAt(0)==="#"?t.charAt(1)==="x"?String.fromCharCode(parseInt(t.substring(2),16)):String.fromCharCode(+t.substring(1)):""))}const Nm=/(^|[^\[])\^/g;function F(n,e){n=typeof n=="string"?n:n.source,e=e||"";const t={replace:(r,s)=>(s=typeof s=="object"&&"source"in s?s.source:s,s=s.replace(Nm,"$1"),n=n.replace(r,s),t),getRegex:()=>new RegExp(n,e)};return t}const Lm=/[^\w:]/g,Pm=/^$|^[a-z][a-z0-9+.-]*:|^[?#]/i;function va(n,e,t){if(n){let r;try{r=decodeURIComponent(Bo(t)).replace(Lm,"").toLowerCase()}catch{return null}if(r.indexOf("javascript:")===0||r.indexOf("vbscript:")===0||r.indexOf("data:")===0)return null}e&&!Pm.test(t)&&(t=Fm(e,t));try{t=encodeURI(t).replace(/%25/g,"%")}catch{return null}return t}const ns={},Mm=/^[^:]+:\/*[^/]*$/,$m=/^([^:]+:)[\s\S]*$/,Wm=/^([^:]+:\/*[^/]*)[\s\S]*$/;function Fm(n,e){ns[" "+n]||(Mm.test(n)?ns[" "+n]=n+"/":ns[" "+n]=as(n,"/",!0)),n=ns[" "+n];const t=n.indexOf(":")===-1;return e.substring(0,2)==="//"?t?e:n.replace($m,"$1")+e:e.charAt(0)==="/"?t?e:n.replace(Wm,"$1")+e:n+e}const bs={exec:()=>null};function Ea(n,e){const t=n.replace(/\|/g,(i,a,o)=>{let l=!1,u=a;for(;--u>=0&&o[u]==="\\";)l=!l;return l?"|":" |"}),r=t.split(/ \|/);let s=0;if(r[0].trim()||r.shift(),r.length>0&&!r[r.length-1].trim()&&r.pop(),e)if(r.length>e)r.splice(e);else for(;r.length<e;)r.push("");for(;s<r.length;s++)r[s]=r[s].trim().replace(/\\\|/g,"|");return r}function as(n,e,t){const r=n.length;if(r===0)return"";let s=0;for(;s<r;){const i=n.charAt(r-s-1);if(i===e&&!t)s++;else if(i!==e&&t)s++;else break}return n.slice(0,r-s)}function zm(n,e){if(n.indexOf(e[1])===-1)return-1;let t=0;for(let r=0;r<n.length;r++)if(n[r]==="\\")r++;else if(n[r]===e[0])t++;else if(n[r]===e[1]&&(t--,t<0))return r;return-1}function Bm(n,e){!n||n.silent||(e&&console.warn("marked(): callback is deprecated since version 5.0.0, should not be used and will be removed in the future. Read more here: https://marked.js.org/using_pro#async"),(n.sanitize||n.sanitizer)&&console.warn("marked(): sanitize and sanitizer parameters are deprecated since version 0.7.0, should not be used and will be removed in the future. Read more here: https://marked.js.org/#/USING_ADVANCED.md#options"),(n.highlight||n.langPrefix!=="language-")&&console.warn("marked(): highlight and langPrefix parameters are deprecated since version 5.0.0, should not be used and will be removed in the future. Instead use https://www.npmjs.com/package/marked-highlight."),n.mangle&&console.warn("marked(): mangle parameter is enabled by default, but is deprecated since version 5.0.0, and will be removed in the future. To clear this warning, install https://www.npmjs.com/package/marked-mangle, or disable by setting `{mangle: false}`."),n.baseUrl&&console.warn("marked(): baseUrl parameter is deprecated since version 5.0.0, should not be used and will be removed in the future. Instead use https://www.npmjs.com/package/marked-base-url."),n.smartypants&&console.warn("marked(): smartypants parameter is deprecated since version 5.0.0, should not be used and will be removed in the future. Instead use https://www.npmjs.com/package/marked-smartypants."),n.xhtml&&console.warn("marked(): xhtml parameter is deprecated since version 5.0.0, should not be used and will be removed in the future. Instead use https://www.npmjs.com/package/marked-xhtml."),(n.headerIds||n.headerPrefix)&&console.warn("marked(): headerIds and headerPrefix parameters enabled by default, but are deprecated since version 5.0.0, and will be removed in the future. To clear this warning, install  https://www.npmjs.com/package/marked-gfm-heading-id, or disable by setting `{headerIds: false}`."))}function Sa(n,e,t,r){const s=e.href,i=e.title?he(e.title):null,a=n[1].replace(/\\([\[\]])/g,"$1");if(n[0].charAt(0)!=="!"){r.state.inLink=!0;const o={type:"link",raw:t,href:s,title:i,text:a,tokens:r.inlineTokens(a)};return r.state.inLink=!1,o}return{type:"image",raw:t,href:s,title:i,text:he(a)}}function Vm(n,e){const t=n.match(/^(\s+)(?:```)/);if(t===null)return e;const r=t[1];return e.split(`
`).map(s=>{const i=s.match(/^\s+/);if(i===null)return s;const[a]=i;return a.length>=r.length?s.slice(r.length):s}).join(`
`)}class ys{constructor(e){f(this,"options");f(this,"rules");f(this,"lexer");this.options=e||Zt}space(e){const t=this.rules.block.newline.exec(e);if(t&&t[0].length>0)return{type:"space",raw:t[0]}}code(e){const t=this.rules.block.code.exec(e);if(t){const r=t[0].replace(/^ {1,4}/gm,"");return{type:"code",raw:t[0],codeBlockStyle:"indented",text:this.options.pedantic?r:as(r,`
`)}}}fences(e){const t=this.rules.block.fences.exec(e);if(t){const r=t[0],s=Vm(r,t[3]||"");return{type:"code",raw:r,lang:t[2]?t[2].trim().replace(this.rules.inline._escapes,"$1"):t[2],text:s}}}heading(e){const t=this.rules.block.heading.exec(e);if(t){let r=t[2].trim();if(/#$/.test(r)){const s=as(r,"#");(this.options.pedantic||!s||/ $/.test(s))&&(r=s.trim())}return{type:"heading",raw:t[0],depth:t[1].length,text:r,tokens:this.lexer.inline(r)}}}hr(e){const t=this.rules.block.hr.exec(e);if(t)return{type:"hr",raw:t[0]}}blockquote(e){const t=this.rules.block.blockquote.exec(e);if(t){const r=t[0].replace(/^ *>[ \t]?/gm,""),s=this.lexer.state.top;this.lexer.state.top=!0;const i=this.lexer.blockTokens(r);return this.lexer.state.top=s,{type:"blockquote",raw:t[0],tokens:i,text:r}}}list(e){let t=this.rules.block.list.exec(e);if(t){let r=t[1].trim();const s=r.length>1,i={type:"list",raw:"",ordered:s,start:s?+r.slice(0,-1):"",loose:!1,items:[]};r=s?`\\d{1,9}\\${r.slice(-1)}`:`\\${r}`,this.options.pedantic&&(r=s?r:"[*+-]");const a=new RegExp(`^( {0,3}${r})((?:[	 ][^\\n]*)?(?:\\n|$))`);let o="",l="",u=!1;for(;e;){let d=!1;if(!(t=a.exec(e))||this.rules.block.hr.test(e))break;o=t[0],e=e.substring(o.length);let h=t[2].split(`
`,1)[0].replace(/^\t+/,W=>" ".repeat(3*W.length)),m=e.split(`
`,1)[0],p=0;this.options.pedantic?(p=2,l=h.trimLeft()):(p=t[2].search(/[^ ]/),p=p>4?1:p,l=h.slice(p),p+=t[1].length);let v=!1;if(!h&&/^ *$/.test(m)&&(o+=m+`
`,e=e.substring(m.length+1),d=!0),!d){const W=new RegExp(`^ {0,${Math.min(3,p-1)}}(?:[*+-]|\\d{1,9}[.)])((?:[ 	][^\\n]*)?(?:\\n|$))`),C=new RegExp(`^ {0,${Math.min(3,p-1)}}((?:- *){3,}|(?:_ *){3,}|(?:\\* *){3,})(?:\\n+|$)`),$=new RegExp(`^ {0,${Math.min(3,p-1)}}(?:\`\`\`|~~~)`),_e=new RegExp(`^ {0,${Math.min(3,p-1)}}#`);for(;e;){const le=e.split(`
`,1)[0];if(m=le,this.options.pedantic&&(m=m.replace(/^ {1,4}(?=( {4})*[^ ])/g,"  ")),$.test(m)||_e.test(m)||W.test(m)||C.test(e))break;if(m.search(/[^ ]/)>=p||!m.trim())l+=`
`+m.slice(p);else{if(v||h.search(/[^ ]/)>=4||$.test(h)||_e.test(h)||C.test(h))break;l+=`
`+m}!v&&!m.trim()&&(v=!0),o+=le+`
`,e=e.substring(le.length+1),h=m.slice(p)}}i.loose||(u?i.loose=!0:/\n *\n *$/.test(o)&&(u=!0));let _=null,k;this.options.gfm&&(_=/^\[[ xX]\] /.exec(l),_&&(k=_[0]!=="[ ] ",l=l.replace(/^\[[ xX]\] +/,""))),i.items.push({type:"list_item",raw:o,task:!!_,checked:k,loose:!1,text:l,tokens:[]}),i.raw+=o}i.items[i.items.length-1].raw=o.trimRight(),i.items[i.items.length-1].text=l.trimRight(),i.raw=i.raw.trimRight();for(let d=0;d<i.items.length;d++)if(this.lexer.state.top=!1,i.items[d].tokens=this.lexer.blockTokens(i.items[d].text,[]),!i.loose){const h=i.items[d].tokens.filter(p=>p.type==="space"),m=h.length>0&&h.some(p=>/\n.*\n/.test(p.raw));i.loose=m}if(i.loose)for(let d=0;d<i.items.length;d++)i.items[d].loose=!0;return i}}html(e){const t=this.rules.block.html.exec(e);if(t){const r={type:"html",block:!0,raw:t[0],pre:!this.options.sanitizer&&(t[1]==="pre"||t[1]==="script"||t[1]==="style"),text:t[0]};if(this.options.sanitize){const s=this.options.sanitizer?this.options.sanitizer(t[0]):he(t[0]),i=r;i.type="paragraph",i.text=s,i.tokens=this.lexer.inline(s)}return r}}def(e){const t=this.rules.block.def.exec(e);if(t){const r=t[1].toLowerCase().replace(/\s+/g," "),s=t[2]?t[2].replace(/^<(.*)>$/,"$1").replace(this.rules.inline._escapes,"$1"):"",i=t[3]?t[3].substring(1,t[3].length-1).replace(this.rules.inline._escapes,"$1"):t[3];return{type:"def",tag:r,raw:t[0],href:s,title:i}}}table(e){const t=this.rules.block.table.exec(e);if(t){const r={type:"table",raw:t[0],header:Ea(t[1]).map(s=>({text:s,tokens:[]})),align:t[2].replace(/^ *|\| *$/g,"").split(/ *\| */),rows:t[3]&&t[3].trim()?t[3].replace(/\n[ \t]*$/,"").split(`
`):[]};if(r.header.length===r.align.length){let s=r.align.length,i,a,o,l;for(i=0;i<s;i++){const u=r.align[i];u&&(/^ *-+: *$/.test(u)?r.align[i]="right":/^ *:-+: *$/.test(u)?r.align[i]="center":/^ *:-+ *$/.test(u)?r.align[i]="left":r.align[i]=null)}for(s=r.rows.length,i=0;i<s;i++)r.rows[i]=Ea(r.rows[i],r.header.length).map(u=>({text:u,tokens:[]}));for(s=r.header.length,a=0;a<s;a++)r.header[a].tokens=this.lexer.inline(r.header[a].text);for(s=r.rows.length,a=0;a<s;a++)for(l=r.rows[a],o=0;o<l.length;o++)l[o].tokens=this.lexer.inline(l[o].text);return r}}}lheading(e){const t=this.rules.block.lheading.exec(e);if(t)return{type:"heading",raw:t[0],depth:t[2].charAt(0)==="="?1:2,text:t[1],tokens:this.lexer.inline(t[1])}}paragraph(e){const t=this.rules.block.paragraph.exec(e);if(t){const r=t[1].charAt(t[1].length-1)===`
`?t[1].slice(0,-1):t[1];return{type:"paragraph",raw:t[0],text:r,tokens:this.lexer.inline(r)}}}text(e){const t=this.rules.block.text.exec(e);if(t)return{type:"text",raw:t[0],text:t[0],tokens:this.lexer.inline(t[0])}}escape(e){const t=this.rules.inline.escape.exec(e);if(t)return{type:"escape",raw:t[0],text:he(t[1])}}tag(e){const t=this.rules.inline.tag.exec(e);if(t)return!this.lexer.state.inLink&&/^<a /i.test(t[0])?this.lexer.state.inLink=!0:this.lexer.state.inLink&&/^<\/a>/i.test(t[0])&&(this.lexer.state.inLink=!1),!this.lexer.state.inRawBlock&&/^<(pre|code|kbd|script)(\s|>)/i.test(t[0])?this.lexer.state.inRawBlock=!0:this.lexer.state.inRawBlock&&/^<\/(pre|code|kbd|script)(\s|>)/i.test(t[0])&&(this.lexer.state.inRawBlock=!1),{type:this.options.sanitize?"text":"html",raw:t[0],inLink:this.lexer.state.inLink,inRawBlock:this.lexer.state.inRawBlock,block:!1,text:this.options.sanitize?this.options.sanitizer?this.options.sanitizer(t[0]):he(t[0]):t[0]}}link(e){const t=this.rules.inline.link.exec(e);if(t){const r=t[2].trim();if(!this.options.pedantic&&/^</.test(r)){if(!/>$/.test(r))return;const a=as(r.slice(0,-1),"\\");if((r.length-a.length)%2===0)return}else{const a=zm(t[2],"()");if(a>-1){const l=(t[0].indexOf("!")===0?5:4)+t[1].length+a;t[2]=t[2].substring(0,a),t[0]=t[0].substring(0,l).trim(),t[3]=""}}let s=t[2],i="";if(this.options.pedantic){const a=/^([^'"]*[^\s])\s+(['"])(.*)\2/.exec(s);a&&(s=a[1],i=a[3])}else i=t[3]?t[3].slice(1,-1):"";return s=s.trim(),/^</.test(s)&&(this.options.pedantic&&!/>$/.test(r)?s=s.slice(1):s=s.slice(1,-1)),Sa(t,{href:s&&s.replace(this.rules.inline._escapes,"$1"),title:i&&i.replace(this.rules.inline._escapes,"$1")},t[0],this.lexer)}}reflink(e,t){let r;if((r=this.rules.inline.reflink.exec(e))||(r=this.rules.inline.nolink.exec(e))){let s=(r[2]||r[1]).replace(/\s+/g," ");if(s=t[s.toLowerCase()],!s){const i=r[0].charAt(0);return{type:"text",raw:i,text:i}}return Sa(r,s,r[0],this.lexer)}}emStrong(e,t,r=""){let s=this.rules.inline.emStrong.lDelim.exec(e);if(!s||s[3]&&r.match(/[\p{L}\p{N}]/u))return;if(!(s[1]||s[2]||"")||!r||this.rules.inline.punctuation.exec(r)){const a=[...s[0]].length-1;let o,l,u=a,d=0;const h=s[0][0]==="*"?this.rules.inline.emStrong.rDelimAst:this.rules.inline.emStrong.rDelimUnd;for(h.lastIndex=0,t=t.slice(-1*e.length+a);(s=h.exec(t))!=null;){if(o=s[1]||s[2]||s[3]||s[4]||s[5]||s[6],!o)continue;if(l=[...o].length,s[3]||s[4]){u+=l;continue}else if((s[5]||s[6])&&a%3&&!((a+l)%3)){d+=l;continue}if(u-=l,u>0)continue;l=Math.min(l,l+u+d);const m=[...e].slice(0,a+s.index+l+1).join("");if(Math.min(a,l)%2){const v=m.slice(1,-1);return{type:"em",raw:m,text:v,tokens:this.lexer.inlineTokens(v)}}const p=m.slice(2,-2);return{type:"strong",raw:m,text:p,tokens:this.lexer.inlineTokens(p)}}}}codespan(e){const t=this.rules.inline.code.exec(e);if(t){let r=t[2].replace(/\n/g," ");const s=/[^ ]/.test(r),i=/^ /.test(r)&&/ $/.test(r);return s&&i&&(r=r.substring(1,r.length-1)),r=he(r,!0),{type:"codespan",raw:t[0],text:r}}}br(e){const t=this.rules.inline.br.exec(e);if(t)return{type:"br",raw:t[0]}}del(e){const t=this.rules.inline.del.exec(e);if(t)return{type:"del",raw:t[0],text:t[2],tokens:this.lexer.inlineTokens(t[2])}}autolink(e,t){const r=this.rules.inline.autolink.exec(e);if(r){let s,i;return r[2]==="@"?(s=he(this.options.mangle?t(r[1]):r[1]),i="mailto:"+s):(s=he(r[1]),i=s),{type:"link",raw:r[0],text:s,href:i,tokens:[{type:"text",raw:s,text:s}]}}}url(e,t){let r;if(r=this.rules.inline.url.exec(e)){let s,i;if(r[2]==="@")s=he(this.options.mangle?t(r[0]):r[0]),i="mailto:"+s;else{let a;do a=r[0],r[0]=this.rules.inline._backpedal.exec(r[0])[0];while(a!==r[0]);s=he(r[0]),r[1]==="www."?i="http://"+r[0]:i=r[0]}return{type:"link",raw:r[0],text:s,href:i,tokens:[{type:"text",raw:s,text:s}]}}}inlineText(e,t){const r=this.rules.inline.text.exec(e);if(r){let s;return this.lexer.state.inRawBlock?s=this.options.sanitize?this.options.sanitizer?this.options.sanitizer(r[0]):he(r[0]):r[0]:s=he(this.options.smartypants?t(r[0]):r[0]),{type:"text",raw:r[0],text:s}}}}const T={newline:/^(?: *(?:\n|$))+/,code:/^( {4}[^\n]+(?:\n(?: *(?:\n|$))*)?)+/,fences:/^ {0,3}(`{3,}(?=[^`\n]*(?:\n|$))|~{3,})([^\n]*)(?:\n|$)(?:|([\s\S]*?)(?:\n|$))(?: {0,3}\1[~`]* *(?=\n|$)|$)/,hr:/^ {0,3}((?:-[\t ]*){3,}|(?:_[ \t]*){3,}|(?:\*[ \t]*){3,})(?:\n+|$)/,heading:/^ {0,3}(#{1,6})(?=\s|$)(.*)(?:\n+|$)/,blockquote:/^( {0,3}> ?(paragraph|[^\n]*)(?:\n|$))+/,list:/^( {0,3}bull)([ \t][^\n]+?)?(?:\n|$)/,html:"^ {0,3}(?:<(script|pre|style|textarea)[\\s>][\\s\\S]*?(?:</\\1>[^\\n]*\\n+|$)|comment[^\\n]*(\\n+|$)|<\\?[\\s\\S]*?(?:\\?>\\n*|$)|<![A-Z][\\s\\S]*?(?:>\\n*|$)|<!\\[CDATA\\[[\\s\\S]*?(?:\\]\\]>\\n*|$)|</?(tag)(?: +|\\n|/?>)[\\s\\S]*?(?:(?:\\n *)+\\n|$)|<(?!script|pre|style|textarea)([a-z][\\w-]*)(?:attribute)*? */?>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n *)+\\n|$)|</(?!script|pre|style|textarea)[a-z][\\w-]*\\s*>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n *)+\\n|$))",def:/^ {0,3}\[(label)\]: *(?:\n *)?([^<\s][^\s]*|<.*?>)(?:(?: +(?:\n *)?| *\n *)(title))? *(?:\n+|$)/,table:bs,lheading:/^((?:(?!^bull ).|\n(?!\n|bull ))+?)\n {0,3}(=+|-+) *(?:\n+|$)/,_paragraph:/^([^\n]+(?:\n(?!hr|heading|lheading|blockquote|fences|list|html|table| +\n)[^\n]+)*)/,text:/^[^\n]+/};T._label=/(?!\s*\])(?:\\.|[^\[\]\\])+/;T._title=/(?:"(?:\\"?|[^"\\])*"|'[^'\n]*(?:\n[^'\n]+)*\n?'|\([^()]*\))/;T.def=F(T.def).replace("label",T._label).replace("title",T._title).getRegex();T.bullet=/(?:[*+-]|\d{1,9}[.)])/;T.listItemStart=F(/^( *)(bull) */).replace("bull",T.bullet).getRegex();T.list=F(T.list).replace(/bull/g,T.bullet).replace("hr","\\n+(?=\\1?(?:(?:- *){3,}|(?:_ *){3,}|(?:\\* *){3,})(?:\\n+|$))").replace("def","\\n+(?="+T.def.source+")").getRegex();T._tag="address|article|aside|base|basefont|blockquote|body|caption|center|col|colgroup|dd|details|dialog|dir|div|dl|dt|fieldset|figcaption|figure|footer|form|frame|frameset|h[1-6]|head|header|hr|html|iframe|legend|li|link|main|menu|menuitem|meta|nav|noframes|ol|optgroup|option|p|param|section|source|summary|table|tbody|td|tfoot|th|thead|title|tr|track|ul";T._comment=/<!--(?!-?>)[\s\S]*?(?:-->|$)/;T.html=F(T.html,"i").replace("comment",T._comment).replace("tag",T._tag).replace("attribute",/ +[a-zA-Z:_][\w.:-]*(?: *= *"[^"\n]*"| *= *'[^'\n]*'| *= *[^\s"'=<>`]+)?/).getRegex();T.lheading=F(T.lheading).replace(/bull/g,T.bullet).getRegex();T.paragraph=F(T._paragraph).replace("hr",T.hr).replace("heading"," {0,3}#{1,6} ").replace("|lheading","").replace("|table","").replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",T._tag).getRegex();T.blockquote=F(T.blockquote).replace("paragraph",T.paragraph).getRegex();T.normal={...T};T.gfm={...T.normal,table:"^ *([^\\n ].*\\|.*)\\n {0,3}(?:\\| *)?(:?-+:? *(?:\\| *:?-+:? *)*)(?:\\| *)?(?:\\n((?:(?! *\\n|hr|heading|blockquote|code|fences|list|html).*(?:\\n|$))*)\\n*|$)"};T.gfm.table=F(T.gfm.table).replace("hr",T.hr).replace("heading"," {0,3}#{1,6} ").replace("blockquote"," {0,3}>").replace("code"," {4}[^\\n]").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",T._tag).getRegex();T.gfm.paragraph=F(T._paragraph).replace("hr",T.hr).replace("heading"," {0,3}#{1,6} ").replace("|lheading","").replace("table",T.gfm.table).replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",T._tag).getRegex();T.pedantic={...T.normal,html:F(`^ *(?:comment *(?:\\n|\\s*$)|<(tag)[\\s\\S]+?</\\1> *(?:\\n{2,}|\\s*$)|<tag(?:"[^"]*"|'[^']*'|\\s[^'"/>\\s]*)*?/?> *(?:\\n{2,}|\\s*$))`).replace("comment",T._comment).replace(/tag/g,"(?!(?:a|em|strong|small|s|cite|q|dfn|abbr|data|time|code|var|samp|kbd|sub|sup|i|b|u|mark|ruby|rt|rp|bdi|bdo|span|br|wbr|ins|del|img)\\b)\\w+(?!:|[^\\w\\s@]*@)\\b").getRegex(),def:/^ *\[([^\]]+)\]: *<?([^\s>]+)>?(?: +(["(][^\n]+[")]))? *(?:\n+|$)/,heading:/^(#{1,6})(.*)(?:\n+|$)/,fences:bs,lheading:/^(.+?)\n {0,3}(=+|-+) *(?:\n+|$)/,paragraph:F(T.normal._paragraph).replace("hr",T.hr).replace("heading",` *#{1,6} *[^
]`).replace("lheading",T.lheading).replace("blockquote"," {0,3}>").replace("|fences","").replace("|list","").replace("|html","").getRegex()};const S={escape:/^\\([!"#$%&'()*+,\-./:;<=>?@\[\]\\^_`{|}~])/,autolink:/^<(scheme:[^\s\x00-\x1f<>]*|email)>/,url:bs,tag:"^comment|^</[a-zA-Z][\\w:-]*\\s*>|^<[a-zA-Z][\\w-]*(?:attribute)*?\\s*/?>|^<\\?[\\s\\S]*?\\?>|^<![a-zA-Z]+\\s[\\s\\S]*?>|^<!\\[CDATA\\[[\\s\\S]*?\\]\\]>",link:/^!?\[(label)\]\(\s*(href)(?:\s+(title))?\s*\)/,reflink:/^!?\[(label)\]\[(ref)\]/,nolink:/^!?\[(ref)\](?:\[\])?/,reflinkSearch:"reflink|nolink(?!\\()",emStrong:{lDelim:/^(?:\*+(?:((?!\*)[punct])|[^\s*]))|^_+(?:((?!_)[punct])|([^\s_]))/,rDelimAst:/^[^_*]*?__[^_*]*?\*[^_*]*?(?=__)|[^*]+(?=[^*])|(?!\*)[punct](\*+)(?=[\s]|$)|[^punct\s](\*+)(?!\*)(?=[punct\s]|$)|(?!\*)[punct\s](\*+)(?=[^punct\s])|[\s](\*+)(?!\*)(?=[punct])|(?!\*)[punct](\*+)(?!\*)(?=[punct])|[^punct\s](\*+)(?=[^punct\s])/,rDelimUnd:/^[^_*]*?\*\*[^_*]*?_[^_*]*?(?=\*\*)|[^_]+(?=[^_])|(?!_)[punct](_+)(?=[\s]|$)|[^punct\s](_+)(?!_)(?=[punct\s]|$)|(?!_)[punct\s](_+)(?=[^punct\s])|[\s](_+)(?!_)(?=[punct])|(?!_)[punct](_+)(?!_)(?=[punct])/},code:/^(`+)([^`]|[^`][\s\S]*?[^`])\1(?!`)/,br:/^( {2,}|\\)\n(?!\s*$)/,del:bs,text:/^(`+|[^`])(?:(?= {2,}\n)|[\s\S]*?(?:(?=[\\<!\[`*_]|\b_|$)|[^ ](?= {2,}\n)))/,punctuation:/^((?![*_])[\spunctuation])/};S._punctuation="\\p{P}$+<=>`^|~";S.punctuation=F(S.punctuation,"u").replace(/punctuation/g,S._punctuation).getRegex();S.blockSkip=/\[[^[\]]*?\]\([^\(\)]*?\)|`[^`]*?`|<[^<>]*?>/g;S.anyPunctuation=/\\[punct]/g;S._escapes=/\\([punct])/g;S._comment=F(T._comment).replace("(?:-->|$)","-->").getRegex();S.emStrong.lDelim=F(S.emStrong.lDelim,"u").replace(/punct/g,S._punctuation).getRegex();S.emStrong.rDelimAst=F(S.emStrong.rDelimAst,"gu").replace(/punct/g,S._punctuation).getRegex();S.emStrong.rDelimUnd=F(S.emStrong.rDelimUnd,"gu").replace(/punct/g,S._punctuation).getRegex();S.anyPunctuation=F(S.anyPunctuation,"gu").replace(/punct/g,S._punctuation).getRegex();S._escapes=F(S._escapes,"gu").replace(/punct/g,S._punctuation).getRegex();S._scheme=/[a-zA-Z][a-zA-Z0-9+.-]{1,31}/;S._email=/[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+(@)[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)+(?![-_])/;S.autolink=F(S.autolink).replace("scheme",S._scheme).replace("email",S._email).getRegex();S._attribute=/\s+[a-zA-Z:_][\w.:-]*(?:\s*=\s*"[^"]*"|\s*=\s*'[^']*'|\s*=\s*[^\s"'=<>`]+)?/;S.tag=F(S.tag).replace("comment",S._comment).replace("attribute",S._attribute).getRegex();S._label=/(?:\[(?:\\.|[^\[\]\\])*\]|\\.|`[^`]*`|[^\[\]\\`])*?/;S._href=/<(?:\\.|[^\n<>\\])+>|[^\s\x00-\x1f]*/;S._title=/"(?:\\"?|[^"\\])*"|'(?:\\'?|[^'\\])*'|\((?:\\\)?|[^)\\])*\)/;S.link=F(S.link).replace("label",S._label).replace("href",S._href).replace("title",S._title).getRegex();S.reflink=F(S.reflink).replace("label",S._label).replace("ref",T._label).getRegex();S.nolink=F(S.nolink).replace("ref",T._label).getRegex();S.reflinkSearch=F(S.reflinkSearch,"g").replace("reflink",S.reflink).replace("nolink",S.nolink).getRegex();S.normal={...S};S.pedantic={...S.normal,strong:{start:/^__|\*\*/,middle:/^__(?=\S)([\s\S]*?\S)__(?!_)|^\*\*(?=\S)([\s\S]*?\S)\*\*(?!\*)/,endAst:/\*\*(?!\*)/g,endUnd:/__(?!_)/g},em:{start:/^_|\*/,middle:/^()\*(?=\S)([\s\S]*?\S)\*(?!\*)|^_(?=\S)([\s\S]*?\S)_(?!_)/,endAst:/\*(?!\*)/g,endUnd:/_(?!_)/g},link:F(/^!?\[(label)\]\((.*?)\)/).replace("label",S._label).getRegex(),reflink:F(/^!?\[(label)\]\s*\[([^\]]*)\]/).replace("label",S._label).getRegex()};S.gfm={...S.normal,escape:F(S.escape).replace("])","~|])").getRegex(),_extended_email:/[A-Za-z0-9._+-]+(@)[a-zA-Z0-9-_]+(?:\.[a-zA-Z0-9-_]*[a-zA-Z0-9])+(?![-_])/,url:/^((?:ftp|https?):\/\/|www\.)(?:[a-zA-Z0-9\-]+\.?)+[^\s<]*|^email/,_backpedal:/(?:[^?!.,:;*_'"~()&]+|\([^)]*\)|&(?![a-zA-Z0-9]+;$)|[?!.,:;*_'"~)]+(?!$))+/,del:/^(~~?)(?=[^\s~])([\s\S]*?[^\s~])\1(?=[^~]|$)/,text:/^([`~]+|[^`~])(?:(?= {2,}\n)|(?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)|[\s\S]*?(?:(?=[\\<!\[`*~_]|\b_|https?:\/\/|ftp:\/\/|www\.|$)|[^ ](?= {2,}\n)|[^a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-](?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)))/};S.gfm.url=F(S.gfm.url,"i").replace("email",S.gfm._extended_email).getRegex();S.breaks={...S.gfm,br:F(S.br).replace("{2,}","*").getRegex(),text:F(S.gfm.text).replace("\\b_","\\b_| {2,}\\n").replace(/\{2,\}/g,"*").getRegex()};function Um(n){return n.replace(/---/g,"").replace(/--/g,"").replace(/(^|[-\u2014/(\[{"\s])'/g,"$1").replace(/'/g,"").replace(/(^|[-\u2014/(\[{\u2018\s])"/g,"$1").replace(/"/g,"").replace(/\.{3}/g,"")}function Ia(n){let e="";for(let t=0;t<n.length;t++){const r=Math.random()>.5?"x"+n.charCodeAt(t).toString(16):n.charCodeAt(t).toString();e+="&#"+r+";"}return e}class Ve{constructor(e){f(this,"tokens");f(this,"options");f(this,"state");f(this,"tokenizer");f(this,"inlineQueue");this.tokens=[],this.tokens.links=Object.create(null),this.options=e||Zt,this.options.tokenizer=this.options.tokenizer||new ys,this.tokenizer=this.options.tokenizer,this.tokenizer.options=this.options,this.tokenizer.lexer=this,this.inlineQueue=[],this.state={inLink:!1,inRawBlock:!1,top:!0};const t={block:T.normal,inline:S.normal};this.options.pedantic?(t.block=T.pedantic,t.inline=S.pedantic):this.options.gfm&&(t.block=T.gfm,this.options.breaks?t.inline=S.breaks:t.inline=S.gfm),this.tokenizer.rules=t}static get rules(){return{block:T,inline:S}}static lex(e,t){return new Ve(t).lex(e)}static lexInline(e,t){return new Ve(t).inlineTokens(e)}lex(e){e=e.replace(/\r\n|\r/g,`
`),this.blockTokens(e,this.tokens);let t;for(;t=this.inlineQueue.shift();)this.inlineTokens(t.src,t.tokens);return this.tokens}blockTokens(e,t=[]){this.options.pedantic?e=e.replace(/\t/g,"    ").replace(/^ +$/gm,""):e=e.replace(/^( *)(\t+)/gm,(o,l,u)=>l+"    ".repeat(u.length));let r,s,i,a;for(;e;)if(!(this.options.extensions&&this.options.extensions.block&&this.options.extensions.block.some(o=>(r=o.call({lexer:this},e,t))?(e=e.substring(r.raw.length),t.push(r),!0):!1))){if(r=this.tokenizer.space(e)){e=e.substring(r.raw.length),r.raw.length===1&&t.length>0?t[t.length-1].raw+=`
`:t.push(r);continue}if(r=this.tokenizer.code(e)){e=e.substring(r.raw.length),s=t[t.length-1],s&&(s.type==="paragraph"||s.type==="text")?(s.raw+=`
`+r.raw,s.text+=`
`+r.text,this.inlineQueue[this.inlineQueue.length-1].src=s.text):t.push(r);continue}if(r=this.tokenizer.fences(e)){e=e.substring(r.raw.length),t.push(r);continue}if(r=this.tokenizer.heading(e)){e=e.substring(r.raw.length),t.push(r);continue}if(r=this.tokenizer.hr(e)){e=e.substring(r.raw.length),t.push(r);continue}if(r=this.tokenizer.blockquote(e)){e=e.substring(r.raw.length),t.push(r);continue}if(r=this.tokenizer.list(e)){e=e.substring(r.raw.length),t.push(r);continue}if(r=this.tokenizer.html(e)){e=e.substring(r.raw.length),t.push(r);continue}if(r=this.tokenizer.def(e)){e=e.substring(r.raw.length),s=t[t.length-1],s&&(s.type==="paragraph"||s.type==="text")?(s.raw+=`
`+r.raw,s.text+=`
`+r.raw,this.inlineQueue[this.inlineQueue.length-1].src=s.text):this.tokens.links[r.tag]||(this.tokens.links[r.tag]={href:r.href,title:r.title});continue}if(r=this.tokenizer.table(e)){e=e.substring(r.raw.length),t.push(r);continue}if(r=this.tokenizer.lheading(e)){e=e.substring(r.raw.length),t.push(r);continue}if(i=e,this.options.extensions&&this.options.extensions.startBlock){let o=1/0;const l=e.slice(1);let u;this.options.extensions.startBlock.forEach(d=>{u=d.call({lexer:this},l),typeof u=="number"&&u>=0&&(o=Math.min(o,u))}),o<1/0&&o>=0&&(i=e.substring(0,o+1))}if(this.state.top&&(r=this.tokenizer.paragraph(i))){s=t[t.length-1],a&&s.type==="paragraph"?(s.raw+=`
`+r.raw,s.text+=`
`+r.text,this.inlineQueue.pop(),this.inlineQueue[this.inlineQueue.length-1].src=s.text):t.push(r),a=i.length!==e.length,e=e.substring(r.raw.length);continue}if(r=this.tokenizer.text(e)){e=e.substring(r.raw.length),s=t[t.length-1],s&&s.type==="text"?(s.raw+=`
`+r.raw,s.text+=`
`+r.text,this.inlineQueue.pop(),this.inlineQueue[this.inlineQueue.length-1].src=s.text):t.push(r);continue}if(e){const o="Infinite loop on byte: "+e.charCodeAt(0);if(this.options.silent){console.error(o);break}else throw new Error(o)}}return this.state.top=!0,t}inline(e,t=[]){return this.inlineQueue.push({src:e,tokens:t}),t}inlineTokens(e,t=[]){let r,s,i,a=e,o,l,u;if(this.tokens.links){const d=Object.keys(this.tokens.links);if(d.length>0)for(;(o=this.tokenizer.rules.inline.reflinkSearch.exec(a))!=null;)d.includes(o[0].slice(o[0].lastIndexOf("[")+1,-1))&&(a=a.slice(0,o.index)+"["+"a".repeat(o[0].length-2)+"]"+a.slice(this.tokenizer.rules.inline.reflinkSearch.lastIndex))}for(;(o=this.tokenizer.rules.inline.blockSkip.exec(a))!=null;)a=a.slice(0,o.index)+"["+"a".repeat(o[0].length-2)+"]"+a.slice(this.tokenizer.rules.inline.blockSkip.lastIndex);for(;(o=this.tokenizer.rules.inline.anyPunctuation.exec(a))!=null;)a=a.slice(0,o.index)+"++"+a.slice(this.tokenizer.rules.inline.anyPunctuation.lastIndex);for(;e;)if(l||(u=""),l=!1,!(this.options.extensions&&this.options.extensions.inline&&this.options.extensions.inline.some(d=>(r=d.call({lexer:this},e,t))?(e=e.substring(r.raw.length),t.push(r),!0):!1))){if(r=this.tokenizer.escape(e)){e=e.substring(r.raw.length),t.push(r);continue}if(r=this.tokenizer.tag(e)){e=e.substring(r.raw.length),s=t[t.length-1],s&&r.type==="text"&&s.type==="text"?(s.raw+=r.raw,s.text+=r.text):t.push(r);continue}if(r=this.tokenizer.link(e)){e=e.substring(r.raw.length),t.push(r);continue}if(r=this.tokenizer.reflink(e,this.tokens.links)){e=e.substring(r.raw.length),s=t[t.length-1],s&&r.type==="text"&&s.type==="text"?(s.raw+=r.raw,s.text+=r.text):t.push(r);continue}if(r=this.tokenizer.emStrong(e,a,u)){e=e.substring(r.raw.length),t.push(r);continue}if(r=this.tokenizer.codespan(e)){e=e.substring(r.raw.length),t.push(r);continue}if(r=this.tokenizer.br(e)){e=e.substring(r.raw.length),t.push(r);continue}if(r=this.tokenizer.del(e)){e=e.substring(r.raw.length),t.push(r);continue}if(r=this.tokenizer.autolink(e,Ia)){e=e.substring(r.raw.length),t.push(r);continue}if(!this.state.inLink&&(r=this.tokenizer.url(e,Ia))){e=e.substring(r.raw.length),t.push(r);continue}if(i=e,this.options.extensions&&this.options.extensions.startInline){let d=1/0;const h=e.slice(1);let m;this.options.extensions.startInline.forEach(p=>{m=p.call({lexer:this},h),typeof m=="number"&&m>=0&&(d=Math.min(d,m))}),d<1/0&&d>=0&&(i=e.substring(0,d+1))}if(r=this.tokenizer.inlineText(i,Um)){e=e.substring(r.raw.length),r.raw.slice(-1)!=="_"&&(u=r.raw.slice(-1)),l=!0,s=t[t.length-1],s&&s.type==="text"?(s.raw+=r.raw,s.text+=r.text):t.push(r);continue}if(e){const d="Infinite loop on byte: "+e.charCodeAt(0);if(this.options.silent){console.error(d);break}else throw new Error(d)}}return t}}class ws{constructor(e){f(this,"options");this.options=e||Zt}code(e,t,r){var i;const s=(i=(t||"").match(/^\S*/))==null?void 0:i[0];if(this.options.highlight){const a=this.options.highlight(e,s);a!=null&&a!==e&&(r=!0,e=a)}return e=e.replace(/\n$/,"")+`
`,s?'<pre><code class="'+this.options.langPrefix+he(s)+'">'+(r?e:he(e,!0))+`</code></pre>
`:"<pre><code>"+(r?e:he(e,!0))+`</code></pre>
`}blockquote(e){return`<blockquote>
${e}</blockquote>
`}html(e,t){return e}heading(e,t,r,s){if(this.options.headerIds){const i=this.options.headerPrefix+s.slug(r);return`<h${t} id="${i}">${e}</h${t}>
`}return`<h${t}>${e}</h${t}>
`}hr(){return this.options.xhtml?`<hr/>
`:`<hr>
`}list(e,t,r){const s=t?"ol":"ul",i=t&&r!==1?' start="'+r+'"':"";return"<"+s+i+`>
`+e+"</"+s+`>
`}listitem(e,t,r){return`<li>${e}</li>
`}checkbox(e){return"<input "+(e?'checked="" ':"")+'disabled="" type="checkbox"'+(this.options.xhtml?" /":"")+"> "}paragraph(e){return`<p>${e}</p>
`}table(e,t){return t&&(t=`<tbody>${t}</tbody>`),`<table>
<thead>
`+e+`</thead>
`+t+`</table>
`}tablerow(e){return`<tr>
${e}</tr>
`}tablecell(e,t){const r=t.header?"th":"td";return(t.align?`<${r} align="${t.align}">`:`<${r}>`)+e+`</${r}>
`}strong(e){return`<strong>${e}</strong>`}em(e){return`<em>${e}</em>`}codespan(e){return`<code>${e}</code>`}br(){return this.options.xhtml?"<br/>":"<br>"}del(e){return`<del>${e}</del>`}link(e,t,r){const s=va(this.options.sanitize,this.options.baseUrl,e);if(s===null)return r;e=s;let i='<a href="'+e+'"';return t&&(i+=' title="'+t+'"'),i+=">"+r+"</a>",i}image(e,t,r){const s=va(this.options.sanitize,this.options.baseUrl,e);if(s===null)return r;e=s;let i=`<img src="${e}" alt="${r}"`;return t&&(i+=` title="${t}"`),i+=this.options.xhtml?"/>":">",i}text(e){return e}}class Hi{strong(e){return e}em(e){return e}codespan(e){return e}del(e){return e}html(e){return e}text(e){return e}link(e,t,r){return""+r}image(e,t,r){return""+r}br(){return""}}class Yi{constructor(){f(this,"seen");this.seen={}}serialize(e){return e.toLowerCase().trim().replace(/<[!\/a-z].*?>/ig,"").replace(/[\u2000-\u206F\u2E00-\u2E7F\\'!"#$%&()*+,./:;<=>?@[\]^`{|}~]/g,"").replace(/\s/g,"-")}getNextSafeSlug(e,t){let r=e,s=0;if(this.seen.hasOwnProperty(r)){s=this.seen[e];do s++,r=e+"-"+s;while(this.seen.hasOwnProperty(r))}return t||(this.seen[e]=s,this.seen[r]=0),r}slug(e,t={}){const r=this.serialize(e);return this.getNextSafeSlug(r,t.dryrun)}}class Ue{constructor(e){f(this,"options");f(this,"renderer");f(this,"textRenderer");f(this,"slugger");this.options=e||Zt,this.options.renderer=this.options.renderer||new ws,this.renderer=this.options.renderer,this.renderer.options=this.options,this.textRenderer=new Hi,this.slugger=new Yi}static parse(e,t){return new Ue(t).parse(e)}static parseInline(e,t){return new Ue(t).parseInline(e)}parse(e,t=!0){let r="";for(let s=0;s<e.length;s++){const i=e[s];if(this.options.extensions&&this.options.extensions.renderers&&this.options.extensions.renderers[i.type]){const a=i,o=this.options.extensions.renderers[a.type].call({parser:this},a);if(o!==!1||!["space","hr","heading","code","table","blockquote","list","html","paragraph","text"].includes(a.type)){r+=o||"";continue}}switch(i.type){case"space":continue;case"hr":{r+=this.renderer.hr();continue}case"heading":{const a=i;r+=this.renderer.heading(this.parseInline(a.tokens),a.depth,Bo(this.parseInline(a.tokens,this.textRenderer)),this.slugger);continue}case"code":{const a=i;r+=this.renderer.code(a.text,a.lang,!!a.escaped);continue}case"table":{const a=i;let o="",l="";for(let d=0;d<a.header.length;d++)l+=this.renderer.tablecell(this.parseInline(a.header[d].tokens),{header:!0,align:a.align[d]});o+=this.renderer.tablerow(l);let u="";for(let d=0;d<a.rows.length;d++){const h=a.rows[d];l="";for(let m=0;m<h.length;m++)l+=this.renderer.tablecell(this.parseInline(h[m].tokens),{header:!1,align:a.align[m]});u+=this.renderer.tablerow(l)}r+=this.renderer.table(o,u);continue}case"blockquote":{const a=i,o=this.parse(a.tokens);r+=this.renderer.blockquote(o);continue}case"list":{const a=i,o=a.ordered,l=a.start,u=a.loose;let d="";for(let h=0;h<a.items.length;h++){const m=a.items[h],p=m.checked,v=m.task;let _="";if(m.task){const k=this.renderer.checkbox(!!p);u?m.tokens.length>0&&m.tokens[0].type==="paragraph"?(m.tokens[0].text=k+" "+m.tokens[0].text,m.tokens[0].tokens&&m.tokens[0].tokens.length>0&&m.tokens[0].tokens[0].type==="text"&&(m.tokens[0].tokens[0].text=k+" "+m.tokens[0].tokens[0].text)):m.tokens.unshift({type:"text",text:k}):_+=k}_+=this.parse(m.tokens,u),d+=this.renderer.listitem(_,v,!!p)}r+=this.renderer.list(d,o,l);continue}case"html":{const a=i;r+=this.renderer.html(a.text,a.block);continue}case"paragraph":{const a=i;r+=this.renderer.paragraph(this.parseInline(a.tokens));continue}case"text":{let a=i,o=a.tokens?this.parseInline(a.tokens):a.text;for(;s+1<e.length&&e[s+1].type==="text";)a=e[++s],o+=`
`+(a.tokens?this.parseInline(a.tokens):a.text);r+=t?this.renderer.paragraph(o):o;continue}default:{const a='Token with "'+i.type+'" type was not found.';if(this.options.silent)return console.error(a),"";throw new Error(a)}}}return r}parseInline(e,t){t=t||this.renderer;let r="";for(let s=0;s<e.length;s++){const i=e[s];if(this.options.extensions&&this.options.extensions.renderers&&this.options.extensions.renderers[i.type]){const a=this.options.extensions.renderers[i.type].call({parser:this},i);if(a!==!1||!["escape","html","link","image","strong","em","codespan","br","del","text"].includes(i.type)){r+=a||"";continue}}switch(i.type){case"escape":{const a=i;r+=t.text(a.text);break}case"html":{const a=i;r+=t.html(a.text);break}case"link":{const a=i;r+=t.link(a.href,a.title,this.parseInline(a.tokens,t));break}case"image":{const a=i;r+=t.image(a.href,a.title,a.text);break}case"strong":{const a=i;r+=t.strong(this.parseInline(a.tokens,t));break}case"em":{const a=i;r+=t.em(this.parseInline(a.tokens,t));break}case"codespan":{const a=i;r+=t.codespan(a.text);break}case"br":{r+=t.br();break}case"del":{const a=i;r+=t.del(this.parseInline(a.tokens,t));break}case"text":{const a=i;r+=t.text(a.text);break}default:{const a='Token with "'+i.type+'" type was not found.';if(this.options.silent)return console.error(a),"";throw new Error(a)}}}return r}}class Kn{constructor(e){f(this,"options");this.options=e||Zt}preprocess(e){return e}postprocess(e){return e}}f(Kn,"passThroughHooks",new Set(["preprocess","postprocess"]));var Wr,wi,As,Vo;class jm{constructor(...e){g(this,Wr);g(this,As);f(this,"defaults",Gi());f(this,"options",this.setOptions);f(this,"parse",Zr(this,Wr,wi).call(this,Ve.lex,Ue.parse));f(this,"parseInline",Zr(this,Wr,wi).call(this,Ve.lexInline,Ue.parseInline));f(this,"Parser",Ue);f(this,"parser",Ue.parse);f(this,"Renderer",ws);f(this,"TextRenderer",Hi);f(this,"Lexer",Ve);f(this,"lexer",Ve.lex);f(this,"Tokenizer",ys);f(this,"Slugger",Yi);f(this,"Hooks",Kn);this.use(...e)}walkTokens(e,t){var s,i;let r=[];for(const a of e)switch(r=r.concat(t.call(this,a)),a.type){case"table":{const o=a;for(const l of o.header)r=r.concat(this.walkTokens(l.tokens,t));for(const l of o.rows)for(const u of l)r=r.concat(this.walkTokens(u.tokens,t));break}case"list":{const o=a;r=r.concat(this.walkTokens(o.items,t));break}default:{const o=a;(i=(s=this.defaults.extensions)==null?void 0:s.childTokens)!=null&&i[o.type]?this.defaults.extensions.childTokens[o.type].forEach(l=>{r=r.concat(this.walkTokens(o[l],t))}):o.tokens&&(r=r.concat(this.walkTokens(o.tokens,t)))}}return r}use(...e){const t=this.defaults.extensions||{renderers:{},childTokens:{}};return e.forEach(r=>{const s={...r};if(s.async=this.defaults.async||s.async||!1,r.extensions&&(r.extensions.forEach(i=>{if(!i.name)throw new Error("extension name required");if("renderer"in i){const a=t.renderers[i.name];a?t.renderers[i.name]=function(...o){let l=i.renderer.apply(this,o);return l===!1&&(l=a.apply(this,o)),l}:t.renderers[i.name]=i.renderer}if("tokenizer"in i){if(!i.level||i.level!=="block"&&i.level!=="inline")throw new Error("extension level must be 'block' or 'inline'");const a=t[i.level];a?a.unshift(i.tokenizer):t[i.level]=[i.tokenizer],i.start&&(i.level==="block"?t.startBlock?t.startBlock.push(i.start):t.startBlock=[i.start]:i.level==="inline"&&(t.startInline?t.startInline.push(i.start):t.startInline=[i.start]))}"childTokens"in i&&i.childTokens&&(t.childTokens[i.name]=i.childTokens)}),s.extensions=t),r.renderer){const i=this.defaults.renderer||new ws(this.defaults);for(const a in r.renderer){const o=r.renderer[a],l=a,u=i[l];i[l]=(...d)=>{let h=o.apply(i,d);return h===!1&&(h=u.apply(i,d)),h||""}}s.renderer=i}if(r.tokenizer){const i=this.defaults.tokenizer||new ys(this.defaults);for(const a in r.tokenizer){const o=r.tokenizer[a],l=a,u=i[l];i[l]=(...d)=>{let h=o.apply(i,d);return h===!1&&(h=u.apply(i,d)),h}}s.tokenizer=i}if(r.hooks){const i=this.defaults.hooks||new Kn;for(const a in r.hooks){const o=r.hooks[a],l=a,u=i[l];Kn.passThroughHooks.has(a)?i[l]=d=>{if(this.defaults.async)return Promise.resolve(o.call(i,d)).then(m=>u.call(i,m));const h=o.call(i,d);return u.call(i,h)}:i[l]=(...d)=>{let h=o.apply(i,d);return h===!1&&(h=u.apply(i,d)),h}}s.hooks=i}if(r.walkTokens){const i=this.defaults.walkTokens,a=r.walkTokens;s.walkTokens=function(o){let l=[];return l.push(a.call(this,o)),i&&(l=l.concat(i.call(this,o))),l}}this.defaults={...this.defaults,...s}}),this}setOptions(e){return this.defaults={...this.defaults,...e},this}}Wr=new WeakSet,wi=function(e,t){return(r,s,i)=>{typeof s=="function"&&(i=s,s=null);const a={...s},o={...this.defaults,...a};this.defaults.async===!0&&a.async===!1&&(o.silent||console.warn("marked(): The async option was set to true by an extension. The async: false option sent to parse will be ignored."),o.async=!0);const l=Zr(this,As,Vo).call(this,!!o.silent,!!o.async,i);if(typeof r>"u"||r===null)return l(new Error("marked(): input parameter is undefined or null"));if(typeof r!="string")return l(new Error("marked(): input parameter is of type "+Object.prototype.toString.call(r)+", string expected"));if(Bm(o,i),o.hooks&&(o.hooks.options=o),i){const u=i,d=o.highlight;let h;try{o.hooks&&(r=o.hooks.preprocess(r)),h=e(r,o)}catch(v){return l(v)}const m=v=>{let _;if(!v)try{o.walkTokens&&this.walkTokens(h,o.walkTokens),_=t(h,o),o.hooks&&(_=o.hooks.postprocess(_))}catch(k){v=k}return o.highlight=d,v?l(v):u(null,_)};if(!d||d.length<3||(delete o.highlight,!h.length))return m();let p=0;this.walkTokens(h,v=>{v.type==="code"&&(p++,setTimeout(()=>{d(v.text,v.lang,(_,k)=>{if(_)return m(_);k!=null&&k!==v.text&&(v.text=k,v.escaped=!0),p--,p===0&&m()})},0))}),p===0&&m();return}if(o.async)return Promise.resolve(o.hooks?o.hooks.preprocess(r):r).then(u=>e(u,o)).then(u=>o.walkTokens?Promise.all(this.walkTokens(u,o.walkTokens)).then(()=>u):u).then(u=>t(u,o)).then(u=>o.hooks?o.hooks.postprocess(u):u).catch(l);try{o.hooks&&(r=o.hooks.preprocess(r));const u=e(r,o);o.walkTokens&&this.walkTokens(u,o.walkTokens);let d=t(u,o);return o.hooks&&(d=o.hooks.postprocess(d)),d}catch(u){return l(u)}}},As=new WeakSet,Vo=function(e,t,r){return s=>{if(s.message+=`
Please report this to https://github.com/markedjs/marked.`,e){const i="<p>An error occurred:</p><pre>"+he(s.message+"",!0)+"</pre>";if(t)return Promise.resolve(i);if(r){r(null,i);return}return i}if(t)return Promise.reject(s);if(r){r(s);return}throw s}};const Yt=new jm;function M(n,e,t){return Yt.parse(n,e,t)}M.options=M.setOptions=function(n){return Yt.setOptions(n),M.defaults=Yt.defaults,Wo(M.defaults),M};M.getDefaults=Gi;M.defaults=Zt;M.use=function(...n){return Yt.use(...n),M.defaults=Yt.defaults,Wo(M.defaults),M};M.walkTokens=function(n,e){return Yt.walkTokens(n,e)};M.parseInline=Yt.parseInline;M.Parser=Ue;M.parser=Ue.parse;M.Renderer=ws;M.TextRenderer=Hi;M.Lexer=Ve;M.lexer=Ve.lex;M.Tokenizer=ys;M.Slugger=Yi;M.Hooks=Kn;M.parse=M;M.options;M.setOptions;M.use;M.walkTokens;M.parseInline;Ue.parse;Ve.lex;const Gm=["innerHTML"],Hm={__name:"Markdown",props:{content:{type:String,required:!1,default:"# Headline  <p>Hello World</p>"},fontFamily:{type:String,required:!1,default:null}},setup(n){const e=n,t=new M.Renderer;t.link=function(s,i,a){return M.Renderer.prototype.link.apply(this,arguments).replace("<a","<a target='_blank'")},M.setOptions({renderer:t}),M.use({mangle:!1});const r=Na(()=>M(e.content));return(s,i)=>(x(),D("div",{class:"wb-env-atom-markdown",innerHTML:r.value},null,8,Gm))}},Uo=j(Hm,[["__scopeId","data-v-b1491cb3"]]);const Ym={components:{WbMarkdown:Uo},props:{...lt,type:{type:String,default:null},content:{type:[String,Array],default:null}},emits:[...ct],setup(n,e){return ot(n,e)},data(){return{lines:[]}},mounted(){this.type==="basic"&&window.requestAnimationFrame(()=>{this.lines=[],this.core.modules.parser.parseBasic(this.content,async(n,e)=>{const t=await this.core.executeCommand(n,e);return e.message&&this.lines.push(K(e.message)),t})})}},Xm={class:"wb-module-files-preview"},qm={key:0,class:"basic"},Km=["innerHTML"],Zm=["src"];function Qm(n,e,t,r,s,i){const a=R("wb-markdown");return x(),D("div",Xm,[t.type==="basic"?(x(),D("ul",qm,[(x(!0),D(wt,null,xt(s.lines,(o,l)=>(x(),D("li",{key:l},Ne(o),1))),128))])):B("",!0),t.type==="markdown"?(x(),U(a,{key:1,content:t.content},null,8,["content"])):B("",!0),t.type==="html"?(x(),D("div",{key:2,innerHTML:t.content},null,8,Km)):B("",!0),t.type==="image"?(x(),D("img",{key:3,src:t.content},null,8,Zm)):B("",!0)])}const Jm=j(Ym,[["render",Qm],["__scopeId","data-v-13e34558"]]),ef={HAS_WINDOW_OUTPUT:"has_window_output"};async function tf(n,e,t){const r=await n.executeCommand(`exist "${e}"`);let s=!1;r&&(s=await n.executeCommand('openDialog "File exist, overwrite?" --confirm'));const i=[`makefile "${e}"`];return t&&i.push(`--data="${t}"`),s?i.push("--override"):i.push("--ignore"),n.executeCommand(i.join(" "))}async function nf(n,e){const t=await n.modules.files.fs.get(e),r=await n.executeCommand(`readfile "${e}"`);return{fsItem:t,value:r}}const rf=({module:n,core:e})=>{const t=e.modules.windows,{fileSystem:r}=n;return[{name:"openPreview",args:[new b({index:0,name:"path",description:"Path to the file"}),new b({name:"maximized",description:"If set, window is maximized."})],async action({path:s,maximized:i}){const a=await r.get(s),{type:o,content:l,openMaximized:u}=a.data;o==="basic"&&!a.data[ef.HAS_WINDOW_OUTPUT]?await e.modules.parser.parseBasic(l,async(d,h)=>await e.executeCommand(d,h)):t.addWindow({title:a.name,component:Jm,componentData:{type:o,content:l},options:{scaleX:!0,scaleY:!0,scrollX:!0,scrollY:!0},layout:{size:A(420,360)}},{full:u||i||!1})}},{name:"saveFileDialog",args:[new b({index:0,name:"data",description:"File Content"}),new b({index:1,name:"id",description:"File Id"}),new b({index:2,name:"extension",description:"File Extension"})],async action({data:s,id:i,extension:a}){const o=t.addWindow({title:"Save File",component:Sm,componentData:{fsItem:z(r.root),id:i},options:{scaleX:!1,scaleY:!1,scrollX:!1,scrollY:!1}});let{value:l}=o.awaitClose();if(l){const u=hs(l,a);l=await tf(e,u,s)}}},{name:"openFileDialog",args:[],async action({data:s}){const i=t.addWindow({title:"Open File",component:Om,componentData:{fsItem:z(r.root)},options:{scaleX:!1,scaleY:!1,scrollX:!1,scrollY:!1}});let{value:a}=await i.awaitClose();return a&&(a=nf(e,a)),a}},{name:"fileinfo",description:"Get info from File or Directory",args:[new b({index:0,name:"path",description:"Path to the file"}),new b({index:1,name:"name",description:"Name from the Info"}),new b({index:2,name:["list","ls"],flag:!0,description:"List all Infos"})],async action({path:s,name:i,list:a},o){const l=await r.itemMeta(s,i,a);if(Array.isArray(l)){const u=new Vt;u.addColumn({value:"Name",align:"left",minWidth:20}),u.addColumn({value:"Value",align:"left",minWidth:20}),u.addRow(l.map(d=>{let h=d.value;return Array.isArray(h)&&(h=h.join(" ")),[d.name,h]})),o.message([u])}return l}},{name:["info","i"],args:[new b({index:0,name:"path",description:"Path to the file"})],async action({path:s},i){let a=r.root;s&&(a=await r.get(s)),a instanceof H||(a=a.parent);let o=await a.getItems();const l=new Vt;l.addColumn([{value:"Unit",align:"left",minWidth:8},{value:"Size",align:"right",minWidth:6},{value:"Used",align:"right",minWidth:6},{value:"Free",align:"right",minWidth:6},{value:"Full",minWidth:4},{value:"Errs",align:"center",minWidth:4},{value:"Status",align:"center",minWidth:10},{value:"Name",align:"right",minWidth:14}]),o=Array.from(o.values()).filter(d=>d instanceof at),l.addRow(o.map(d=>{let h=0;return(d.size>0||d.maxSize>0)&&(h=parseInt(d.size/d.maxSize*100)),[`${d.id}:`,Yn(d.maxSize),Yn(d.size),Yn(d.maxSize-d.size),`${h}%`,"0",d.locked?"Read":"Read/Write",`${d.name||""}`]}));const u=["","Mounted disks:",l,"","Volumes available:"];o.forEach(d=>{u.push(`${d.name}: [Mounted]`)}),u.push(""),i.message(u)}},{name:["list","ls"],args:[new b({index:0,name:"path",description:"Path to the file"}),new b({name:"dir-size",flag:!0,description:"Show Directory Size."})],async action({path:s,dirSize:i},a){let o=r.currentItem;s&&(o=await r.get(s));const l=Array.from((await o.getItems()).values()),u=new Vt;u.addColumn({value:"Name",align:"left",minWidth:13}),u.addColumn({value:"Size",align:"right",minWidth:8}),u.addColumn({value:"Access",align:"center",minWidth:12}),u.addColumn({value:"Date / Time",align:"center",minWidth:18}),u.addRow(l.reduce((m,p)=>{let v;p instanceof H&&!i?v="DIR":v=ci(Yn(p.size),8,!0,"0");const _=p.isLocked()?"Read":"Read/Write";return m.push([`${p.id}:`,v,_,p.createdDate?ui("D-mm-y H:I:S",p.createdDate):""]),m},[]));const d=l.reduce((m,p)=>(p instanceof vt&&m++,m),0),h=l.reduce((m,p)=>(m+=p.size,m),0);return a.message([u,`${l.length} files - ${d} directories - ${h} blocks used`]),Promise.resolve()}}]};const sf={components:{WbForm:Pn,WbButton:It,WbButtonWrapper:At,WbFormFieldTextbox:qr,WbFormFieldDropdown:zi,WbFormFieldCheckboxGroup:Co},props:{...lt,fsItem:{type:Object,default(){return null}},model:{type:Object,default(){return{actions:{save(){}},id:null,name:null,symbol:null,visible:!1}}}},emits:[...ct,"close"],setup(n,e){return ot(n,e)},data(){const n=this.fsItem.locked;return{cancelLabel:"Cancel",saveLabel:"Save",fields:{id:{disabled:n,label:"Id",name:"id"},name:{disabled:n,label:"Name",name:"name"},checkboxes:{disabled:n,label:"Others",name:null,items:[{label:"Symbol Visible",name:y.VISIBLE},{label:"Ignore Symbol Rearrange ",name:y.IGNORE_SYMBOL_REARRANGE}]},windowSettings:{disabled:n,label:"Window Settings",name:null,items:[{label:"Has Scale ?",name:y.WINDOW_SCALE},{label:"Has Scroll-X ?",name:y.WINDOW_SCROLL_X},{label:"Has Scroll-Y ?",name:y.WINDOW_SCROLL_Y},{label:"Is Full-Size ?",name:y.WINDOW_FULL_SIZE},{label:"Sort Symbols (Directory)",name:y.WINDOW_SYMBOL_REARRANGE},{label:"Has Sidebar?",name:y.WINDOW_SIDEBAR}]},symbol:{disabled:n,label:"Symbol",name:"symbol",options:Object.keys(w).map(e=>({title:za(e),value:w[String(e)]}))}}}},methods:{onClickCancel(){this.$emit("close")},async onSubmit(){this.locked||await this.model.actions.save(this.model,this.fsItem),this.$emit("close")}}},af={class:"wb-module-files-edit"},of={class:"cols"},lf={class:"col-2"},cf={class:"col-2"};function uf(n,e,t,r,s,i){const a=R("wb-form-field-textbox"),o=R("wb-form-field-dropdown"),l=R("wb-form-field-checkbox-group"),u=R("wb-button"),d=R("wb-button-wrapper"),h=R("wb-form");return x(),D("div",af,[N(h,{class:"form",onSubmit:i.onSubmit},{default:Y(()=>[E("div",null,[N(a,V(s.fields.id,{model:t.model}),null,16,["model"]),N(a,V(s.fields.name,{model:t.model}),null,16,["model"]),N(o,V(s.fields.symbol,{model:t.model}),null,16,["model"]),E("div",of,[E("div",lf,[N(l,V(s.fields.checkboxes,{model:t.model}),null,16,["model"])]),E("div",cf,[N(l,V(s.fields.windowSettings,{model:t.model}),null,16,["model"])])])]),N(d,{align:"outer",full:""},{default:Y(()=>[s.cancelLabel?(x(),U(u,{key:0,"style-type":"secondary",label:s.cancelLabel,onClick:i.onClickCancel},null,8,["label","onClick"])):B("",!0),s.saveLabel?(x(),U(u,{key:1,"style-type":"primary",label:s.saveLabel,type:"submit"},null,8,["label"])):B("",!0)]),_:1})]),_:1},8,["onSubmit"])])}const df=j(sf,[["render",uf],["__scopeId","data-v-df72514a"]]);const hf={components:{WbForm:Pn,WbButton:It,WbButtonWrapper:At,WbFormFieldTextbox:qr,WbFormFieldDropdown:zi},props:{...lt,fsItem:{type:Object,default(){return null}},model:{type:Object,default(){return{actions:{save:()=>{}},name:null,url:null,symbol:null}}}},emits:[...ct,"close"],setup(n,e){return ot(n,e)},data(){const n=(this.fsItem||{}).locked;return{cancelLabel:"Cancel",saveLabel:"Save",fields:{name:{disabled:n,placeholder:"Name",label:"Name",name:"name"},url:{disabled:n,placeholder:"http://",label:"Url",name:"url"},symbol:{disabled:n,label:"Symbol",name:"symbol",options:Object.keys(w).map(e=>({title:za(e),value:w[String(e)]}))}}}},computed:{disabledSave(){return!this.model.name||!this.model.url||!this.model.symbol}},methods:{onClickCancel(){this.$emit("close")},async onSubmit(){await this.model.actions.save(this.model,this.fsItem)&&this.$emit("close")}}},mf={class:"wb-module-files-web-link"};function ff(n,e,t,r,s,i){const a=R("wb-form-field-textbox"),o=R("wb-form-field-dropdown"),l=R("wb-button"),u=R("wb-button-wrapper"),d=R("wb-form");return x(),D("div",mf,[N(d,{onSubmit:i.onSubmit},{default:Y(()=>[N(a,V(s.fields.name,{model:t.model}),null,16,["model"]),N(a,V(s.fields.url,{model:t.model,type:"url"}),null,16,["model"]),N(o,V(s.fields.symbol,{model:t.model}),null,16,["model"]),N(u,{align:"outer",full:""},{default:Y(()=>[s.cancelLabel?(x(),U(l,{key:0,"style-type":"secondary",label:s.cancelLabel,onClick:i.onClickCancel},null,8,["label","onClick"])):B("",!0),s.saveLabel?(x(),U(l,{key:1,"style-type":"primary",label:s.saveLabel,type:"submit",disabled:i.disabledSave},null,8,["label","disabled"])):B("",!0)]),_:1})]),_:1},8,["onSubmit"])])}const Aa=j(hf,[["render",ff],["__scopeId","data-v-5a95c505"]]);const pf={components:{},props:{...lt,fsItem:{type:Object,default(){return null}}},emits:[...ct],setup(n,e){return ot(n,e)},computed:{meta(){return Array.from(this.fsItem.meta).map(([n,e])=>{if(typeof e=="object")try{e=JSON.stringify(e)}catch{}return{title:n,value:e}})},items(){return[{title:"Id",value:this.fsItem.id},{title:"Name",value:this.fsItem.name},{title:"Type",value:this.fsItem.constructor.NAME},{title:"Path",value:this.fsItem.getPath()},{title:"Size",value:Yn(this.fsItem.size)},{title:"Locked",value:this.fsItem.locked?"Yes":"No"},{title:"Created Date",value:`<nobr>${ui("H:I:S D.M.Y",this.fsItem.createdDate)}</nobr>`},{title:"Modified Date",value:`<nobr>${ui("H:I:S D.M.Y",this.fsItem.editedDate)}</nobr>`}]}}},gf=n=>(vi("data-v-18dfde50"),n=n(),Ei(),n),_f={class:"wb-module-files-info"},bf=["innerHTML"],yf=gf(()=>E("legend",null,"Meta:",-1)),wf=["innerHTML"];function xf(n,e,t,r,s,i){return x(),D("div",_f,[E("table",null,[(x(!0),D(wt,null,xt(i.items,({title:a,value:o},l)=>(x(),D("tr",{key:l},[E("td",null,Ne(a)+":",1),E("td",{innerHTML:o},null,8,bf)]))),128))]),E("fieldset",null,[yf,E("table",null,[(x(!0),D(wt,null,xt(i.meta,({title:a,value:o},l)=>(x(),D("tr",{key:l},[E("td",null,Ne(a)+":",1),E("td",{innerHTML:o},null,8,wf)]))),128))])])])}const vf=j(pf,[["render",xf],["__scopeId","data-v-18dfde50"]]),Ef=({core:n})=>{const{windows:e,symbols:t}=n.modules,r=Le({open:{disabled:!1},edit:{disabled:!1},duplicate:{disabled:!1},container:{disabled:!1},emptyTrashcan:{disabled:!1},discard:{disabled:!1},info:{disabled:!1},webLink:{disabled:!1},webLinkNew:{disabled:!1},webLinkEdit:{disabled:!1}});function s(){const h=t.getSelectedItems(),m=t.getPrimaryWrapper();r.info.disabled=h.length<1,r.open.disabled=h.length<1,r.edit.disabled=h.length<1||h.find(p=>p.locked||p instanceof De),r.duplicate.disabled=h.length<1||h.find(({fsItem:p})=>p.locked||p instanceof De||p instanceof at),r.container.disabled=!r.open.disabled||m&&m.fsItem&&(m.fsItem instanceof Vi||m.fsItem.locked)||!m,r.webLinkEdit.disabled=h.length<1||h.find(p=>!p.fsItem.meta.get(y.WEB_URL)),r.webLinkNew.disabled=r.container.disabled,r.webLink.disabled=r.webLinkNew.disabled&&r.webLinkEdit.disabled,r.emptyTrashcan.disabled=h.length<1||h.find(p=>!(p.fsItem instanceof De)),r.discard.disabled=h.length<1||h.find(({fsItem:p})=>p.locked||p instanceof De||p instanceof at)}return t.events.subscribe(()=>s()),s(),[{order:1,title:"File",items:[{title:"Open",options:r.open,action:i},{title:"Edit",options:r.edit,action:u},{type:te.SEPARATOR},{title:"Web Link",options:r.webLink,items:[{title:"New",options:r.webLinkNew,action:o},{title:"Edit",options:r.webLinkEdit,action:l}]},{type:te.SEPARATOR},{title:"Duplicate",options:r.duplicate,action(){const h=t.getSelectedItems();return Promise.all(h.filter(m=>m.fsItem).map(async({fsItem:m})=>{const p=await m.getPath();return n.executeCommand(`copy "${p}" "${p}" -ignore`)}))}},{title:"Make Dir",options:r.container,async action(){const h=t.getPrimaryWrapper().fsItem,m=Pi(await h.getPath(),"Directory");return console.log(`makedir "${m}" -ignore`),n.executeCommand(`makedir "${m}" -ignore`)}},{type:te.SEPARATOR},{title:"Discard",options:r.discard,action(){const h=t.getSelectedItems();return Promise.all(h.filter(m=>m.fsItem).map(async({fsItem:m})=>{const p=await m.getPath();return n.executeCommand(`remove "${p}" -r`)}))}},{title:"Empty Trashcan",options:r.emptyTrashcan,action(){const h=t.getSelectedItems();return Promise.all(h.filter(m=>m.fsItem).map(async({fsItem:m})=>Promise.all(Array.from((await m.getItems()).values()).map(async p=>{const v=await p.getPath();return n.executeCommand(`remove "${v}" -r -ignore`)}))))}},{type:te.SEPARATOR},{title:"Info",options:r.info,action(){t.getSelectedItems().filter(m=>m.fsItem).forEach(m=>{e.addWindow({title:`Info File ${m.fsItem.name}`,component:vf,componentData:{fsItem:z(m.fsItem)},layout:{size:A(460,280)},options:{scaleX:!0,scaleY:!0,prompt:!1,scrollX:!0,scrollY:!0}})})}}]}];function i(){t.getSelectedItems().filter(m=>m.fsItem).forEach(m=>{if(m.command){const p={showCommand:!1,show:!0};return n.executeCommand(m.command,p)}})}async function a({name:h,url:m,symbol:p},v){if(v||(v=await n.executeCommand(`saveFileDialog --id="${wo(h)}"`)),v){const _=n.addExecution();try{const k=v.getPath();await n.executeCommand(`rename "${k}" "${h}" -n`),await n.executeCommand(`editfilemeta "${k}" "${y.WEB_URL}" "${m}"`),await n.executeCommand(`editfilemeta "${k}" "${y.SYMBOL}" "${p}"`)}catch(k){throw _(),new Error(k)}return _(),!0}return!1}function o(){return e.addWindow({title:"Make Link",component:Aa,componentData:{model:{actions:{save:a},name:null,url:null,symbol:"default"}},options:{prompt:!1,scaleX:!1,scaleY:!1,scrollX:!1,scrollY:!1}}).awaitClose()}function l(){t.getSelectedItems().filter(m=>m.fsItem).forEach(m=>{const p=m.fsItem;e.addWindow({title:"Edit Link",component:Aa,componentData:{fsItem:p,model:{actions:{save:a},name:p.name,url:p.meta.get(y.WEB_URL),symbol:p.meta.get(y.SYMBOL)}},options:{prompt:!1,scaleX:!1,scaleY:!1,scrollX:!1,scrollY:!1}})})}function u(){t.getSelectedItems().filter(m=>m.fsItem).forEach(m=>{const p=m.fsItem,v=Le({actions:{save:d},id:p.id,name:p.name});[y.SYMBOL,y.VISIBLE,y.IGNORE_SYMBOL_REARRANGE,y.WINDOW_SCALE,y.WINDOW_SCROLL_X,y.WINDOW_SCROLL_Y,y.WINDOW_FULL_SIZE,y.WINDOW_SYMBOL_REARRANGE,y.WINDOW_SIDEBAR].forEach(_=>{v[String(_)]=p.meta.has(_)?p.meta.get(_):!1}),e.addWindow({title:`Edit File ${p.name}`,component:df,componentData:{fsItem:z(p),model:v},options:{prompt:!1,scaleX:!1,scaleY:!1,scrollX:!1,scrollY:!1}})})}async function d(h,m){const{id:p,name:v}=h,_=m.getPath();if(!p)throw new Error("Id is emoty!");let k;const W=n.addExecution();try{await Promise.all([y.SYMBOL,y.VISIBLE,y.IGNORE_SYMBOL_REARRANGE,y.WINDOW_SCALE,y.WINDOW_SCROLL_X,y.WINDOW_SCROLL_Y,y.WINDOW_FULL_SIZE,y.WINDOW_SYMBOL_REARRANGE,y.WINDOW_SIDEBAR].map(C=>{let $=h[String(C)];return typeof $=="string"&&($=`"${$}"`),n.executeCommand(`editfilemeta "${_}" "${C}" ${$}`)})),v&&p!==v?await n.executeCommand(`rename "${_}" "${v}" -n`):k=n.executeCommand(`rename "${_}" "${p}" -rn`),k=n.executeCommand(`rename "${_}" "${p}"`)}catch(C){throw W(),new Error(C)}return W(),k}},Sf=({module:n})=>{const{fileSystem:e}=n,t=n.core;return[{name:["mountDisk"],description:"Mount Disk",args:[new b({index:0,name:"id",description:"Disk ID"})],async action({id:r},s){const i=t.addExecution(),o=await(await await O(()=>import("./index.2cd72a3f.js"),["./index.2cd72a3f.js","./entry.252f118a.js"],import.meta.url).then(u=>u.default))(r),l=await e.addFloppyDisk(o({core:t}));s.message(`Mount Disk <strong>${l.name}</strong> <strong>(${l.id})</strong> successful!`),i()}},{name:["changeDirectory","cd"],description:"cd %path%",args:[new b({index:0,name:"path",description:"Directory path"})],async action({path:r}){if(!r)throw L.get("bad_args");try{await e.changeDirectory(r)}catch{throw L.get("cant_find",r)}}},{name:["exist"],description:"Check if file exists.",args:[new b({index:0,name:"path",description:"Filename"})],async action({path:r},s){if(!r)throw L.get("bad_args");const i=Te(r),a=await e.exist(r);return a?s.message(`File ${i} exists`):s.message(`File ${i} does not exist`),a}},{name:["makedir","mkdir"],args:[new b({index:0,name:"path",description:"Filename"}),new b({index:1,name:"name",description:"Name"}),new b({name:"ignore",flag:!0,description:"Ignore file exist."})],async action({path:r,name:s,ignore:i},a){if(!r)throw L.get("bad_args");const o=await e.makedir(r,s||Te(r),{ignore:i});return a.message(`Directory "${o.name}" created`),o}},{name:["remove","rm"],args:[new b({index:0,name:"path",description:"Filename"}),new b({name:["recursive","r"],flag:!0,description:"Remove Directory Items and Directories."}),new b({name:["ignore"],flag:!0,description:"Ignore the specified file is deleted."})],async action({path:r,recursive:s,ignore:i},a){if(!r)throw L.get("bad_args");const o=await e.remove(r,s,{ignore:i});return[].concat(o).map(l=>{const u=l.type===vt.NAME?"Directory":"File";return a.message(`Removed ${u}: ${l.name}`),l})}},{name:["readfile","getfile"],description:"Get file content",args:[new b({index:0,name:"path",description:"Filename"})],async action({path:r},s){if(!r)throw L.get("bad_args");return(await e.get(r)).data}},{name:["makefile","mkfile"],description:"Creates a file with the specified attributes.",args:[new b({index:0,name:"path",description:"Filename"}),new b({index:1,name:"name",description:"Name"}),new b({index:3,name:"data",description:"Data"}),new b({name:"override",flag:!0,description:"Deletes existing file and recreates."})],async action({path:r,name:s,data:i,override:a=!1,encode:o},l){if(!r)throw L.get("bad_args");typeof i=="string"&&(i=await ii(i));const u=await e.makefile(r,s,i,{override:a});return l.message(`File "${u.name}" created`),u}},{name:["editfile"],description:"Edits file with specified attributes.",args:[new b({index:0,name:"path",description:"Filename"}),new b({index:1,name:"data",description:"Data"})],async action({path:r,data:s},i){if(!r)throw L.get("bad_args");typeof s=="string"&&(s=await ii(s));const a=await e.editfile(r,s);return i.message(`File "${a.name}" edited`),a}},{name:["editfilemeta"],description:"Edits file with specified attributes.",args:[new b({index:0,name:"path",description:"Filename"}),new b({index:1,name:"name",description:"Name"}),new b({index:2,name:"value",description:"Value"})],async action({path:r,name:s,value:i},a){if(!r)throw L.get("bad_args");const o=await e.editfileMeta(r,s,i);return a.message(`File  "${o.name}" Meta edited`),o}},{name:["makelink","mklink"],description:"Creates a link to the specified path.",args:[new b({index:0,name:"ref",description:"Reference path with id (example.ext)."}),new b({index:1,name:"name",description:"Displayed Name"}),new b({index:2,name:"dest",description:"Destination directory."})],async action({ref:r,name:s,dest:i},a){if(!r)throw L.get("bad_args");i=i||".";const o=await e.get(r),l=await e.makelink(o,s);return await e.get(i)!==e.currentItem&&await e.move(l,i,{ignore:!0}),a.message(`Created link "${s}" with "${await o.getPath()}"`),l}},{name:["editlink"],description:"",args:[new b({index:0,name:"path",description:"Reference filepath with id (example.ext)."}),new b({index:1,name:"ref",description:"Destination directory."})],async action({path:r,ref:s},i){if(!(r&&s))throw L.get("bad_args");const a=await e.get(s),o=await e.editlink(r,a);return i.message(`Edited link "${name}" with "${await a.getPath()}"`),o}},{name:"rename",description:"Renamed a file",args:[new b({index:0,name:"path",description:"Filepath with id (example.ext)."}),new b({index:1,name:"value",description:"Value for id or displayed name."}),new b({name:["name","n"],flag:!0,description:"When set, changes the display name."}),new b({name:["removeName","rn"],flag:!0,description:"When set, removes the display name."})],async action({path:r,value:s,name:i,removeName:a},o){if(!a&&(!r||!s))throw L.get("bad_args");const l=await e.get(r),u=i?l.name:l.id;return await e.rename(r,s,{name:i,removeName:a}),o.message(`Renamed from "${u}" to "${s}"`),l}},{name:["cp","copy"],args:[new b({index:0,name:"from",description:"Source Filepath with id (example.ext)."}),new b({index:1,name:"dest",description:"Destination Filepath with id (example.ext)."}),new b({name:["ignore","i"],flag:!0,description:"When sets, creates a new file if exists."})],async action({from:r,dest:s,ignore:i},a){let o=s;if(!o&&i&&(o=r),!o||!r)throw L.get("bad_args");const l=await e.copy(r,o,{ignore:i});return a.message(`Copied from "${r}" to "${o}"`),l}},{name:["mv","move"],description:"move %from% %to%",args:[new b({index:0,name:"from",description:"From path"}),new b({index:1,name:"to",description:"To path"}),new b({index:2,name:"item-position",description:"Sets the position in the Icon view. (x,y)"})],async action({from:r,to:s,itemPosition:i},a){if(!s||!r)throw L.get("bad_args");const o=new Map;i&&o.set("itemPosition",[0,0].map((d,h)=>{const m=i.split(",");return parseInt(m[Number(h)]||0)}));const l=await e.move(r,s,{meta:o});let u;return l instanceof vt?u="Directory":u="File",a.message(`${u} moved ${l.name}`),l}},{name:["executeFile"],description:"Execute file.",args:[new b({index:0,name:"path",description:"Path to the file"})],async action({path:r},s){if(!r)throw L.get("bad_args");const i=await e.get(r);if(typeof i.action=="function")return i.action(t);throw L.get("cant_find_action",r)}}]};L.add("cant_find_action","Can't find action %1");var Fr,Ca;const If=new(Ca=class{constructor(){g(this,Fr,void 0)}get(){return c(this,Fr)||I(this,Fr,(()=>this.getImports())())}getImports(){return Promise.all([O(()=>import("./index.esm.5d5bc718.js"),["./index.esm.5d5bc718.js","./index.esm2017.9f7d75fd.js","./entry.252f118a.js"],import.meta.url),O(()=>import("./index.esm.7d5cc51d.js"),["./index.esm.7d5cc51d.js","./index.esm2017.9f7d75fd.js","./entry.252f118a.js","./index.56665add.js"],import.meta.url),O(()=>import("./index.esm.25f93694.js"),["./index.esm.25f93694.js","./entry.252f118a.js","./index.esm2017.9f7d75fd.js"],import.meta.url)]).then(([e,t,r])=>({app:e.default||e,auth:t.default||t,database:r.default||r}))}},Fr=new WeakMap,Ca),Hs=new Map;class Af{constructor(){f(this,"services");f(this,"app");f(this,"firebase")}get name(){return this.app.name}async connect(e,{apiKey:t,url:r}){if(this.services=await If.get(),this.firebase=this.services.app,this.app)Hs.has(e)&&(this.app=Hs.get(e));else{const s=this.services.app.initializeApp({apiKey:t,databaseURL:r},e);Hs.set(s.name,s),this.app=s}return this.app}async disconnect(){if(!this.app)throw L.get("FirebaseWrapper_noApp");Bn(this),await this.logout(),await this.services.app.deleteApp(this.app),this.app=null}get locked(){return!!this.app&&!this.isLogged()}get currentUser(){const{getAuth:e}=this.services.auth;return e(this.app).currentUser}isLogged(){return!!this.app&&!!this.currentUser}login(e,t){const{getAuth:r,signInWithEmailAndPassword:s}=this.services.auth,i=r(this.app);return Bn(this),s(i,e,t)}logout(){if(this.app){const{getAuth:e,signOut:t}=this.services.auth,r=e(this.app);return t(r)}else throw L.get("FirebaseWrapper_notConnected")}remove(e){Bn(this);const{remove:t,ref:r,getDatabase:s}=this.services.database,i=s(this.app),a=r(i,e);return t(a)}get(e){Bn(this);const{ref:t,onValue:r,getDatabase:s}=this.services.database,i=s(this.app),a=t(i,e);return new Promise(o=>{r(a,l=>o(l.val()))})}async set(e,t){Bn(this);const{ref:r,set:s,getDatabase:i}=this.services.database,a=i(this.app),o=r(a,e);return await s(o,t),t}}function Bn(n){if(!n.app)throw L.get("FirebaseWrapper_notConnected")}L.add([["FirebaseWrapper_notConnected",["Not connected","Not connected"]],["FirebaseWrapper_noApp",["No app available","No app available"]],["FirebaseWrapper_hasApp",["App already available",'App "%1" already available']]]);class kf extends To{constructor(e){e=Object.assign({storage:new Af},e),super(e)}mount(e){return e.onDisconnect=()=>{this.unmount()},this.storage.connect(e.id,e).then(()=>this)}unmount(){return this.storage.disconnect().then(()=>this)}async load(){try{let e=await this.storage.get(this.name);return!e&&(e={},!this.storage.locked)?this.storage.set(this.name,e).then(t=>t):(this.data=e,e)}catch(e){throw new Error(e)}}save(e){return e=jo(e),this.data=e||this.data,this.storage.set(this.name,e).then((t,r)=>this.data)}get locked(){return this.storage.locked}}function jo(n){return Object.keys(n).reduce((e,t)=>{const r=e[String(t)];return r&&typeof r=="object"&&jo(r),(r==null||r==="")&&delete e[String(t)],e},n)}const Vn=new Map,Of=({module:n,core:e})=>{const{fileSystem:t}=n;return[{name:"cloudList",args:[new b({name:"json",flag:!0,description:"Get JSON Export"})],action({json:r},s){const i=Array.from(Vn.values());if(r)return Promise.resolve(i);{const a=new Vt;return a.addColumn({value:"Storage (Id)",align:"left",minWidth:15}),a.addColumn({value:"Name",align:"left",minWidth:15}),a.addColumn({value:"Logged In",align:"center",minWidth:9}),a.addRow(i.reduce((o,l)=>(o.push([l.id,l.name,l.storage.storage.isLogged()?"yes":"no"]),o),[])),s.message([a]),Promise.resolve()}}},{name:"cloudMount",args:[new b({index:0,name:"id",flag:!0,description:"Id from Storage."}),new b({index:1,name:"apiKey",description:"Firebase Api-Key."}),new b({index:2,name:"url",description:"Firebase Database-Url."})],async action({id:r,apiKey:s,url:i},a){if(!s||!i)throw L.get("bad_args");const o=e.addExecution(),l=await t.connect(kf,{id:r,apiKey:s,url:i});return Vn.set(l.id,l),a.message(`Mount <strong>${l.name}</strong> <strong>(${l.id})</strong> successful!`),o(),l}},{name:"cloudUnmount",args:[new b({index:0,name:"id",flag:!0,description:"Id from Storage."})],async action({id:r},s){if(!r)throw L.get("bad_args");const i=e.addExecution();try{const a=Vn.get(r);await t.disconnect(a),Vn.delete(a.id),s.message(`Unmount "${a.name}" successful!`),i()}catch(a){throw i(),new Error(a)}}},{name:"cloudAuth",args:[new b({name:"login",flag:!0,description:"Storage Login"}),new b({name:"logout",flag:!0,description:"Logout from Storage."}),new b({name:"email",description:"Email for Login."}),new b({name:"password",description:"Password for Login."}),new b({name:"storage",description:"Specifies which drive is logged on."})],async action({email:r,password:s,storage:i,login:a,logout:o},l){const u=i;if(!u)throw L.get("bad_args");const d=e.addExecution(),h=Vn.get(u);let m;if(h)try{if(a){if(!r||!s)throw L.get("bad_args");m=await h.storage.storage.login(r,s),l.message(`Login with ${h.id} (${h.id}) successful!`)}else o&&(m=await h.storage.storage.logout(),l.message(`Logout from ${h.id} (${h.id}) successful!`))}catch(p){switch(d(),p.code){case"auth/user-not-found":case"auth/wrong-password":return p}throw new Error(p)}else throw new Error(`${u} is not mounted.`);return d(),m}}]},ka=new bi("web_workbench_FS");class Go extends Cs{constructor({core:e}){super({commands:(...t)=>[...rf(...t),...Sf(...t),...Of(...t)],contextMenu:Ef,core:e})}get fileSystem(){return ka}get fs(){return ka}}f(Go,"NAME","Files");class Rf{constructor(e){f(this,"defaultItems",new Ht);f(this,"activeItems");f(this,"core",null);this.core=e,this.activeItems=this.defaultItems}addDefaultItems(e){this.defaultItems.add(e)}getActiveItems(){return this.activeItems}setActiveItems(e){return this.activeItems=e||this.defaultItems}}const Tf={components:{AtomMarkdown:Uo},props:{...lt},emits:[...ct],setup(n,e){const t=ll().versions;return{...ot(n,e),versions:t}},data(){return{content:`# Web-Workbench 1.3
<nobr>Created by Thorn-Welf Walli</nobr><br>Email: lammpee@gmail.com<br>Homepage: [lammpee.de](https://lammpee.de)<br><br>Version: <strong>${this.core.version}</strong><br>Nuxt: <strong>${this.versions.nuxt}</strong><br>Vue: <strong>${this.versions.vue}</strong>`}}},Df={class:"wb-module-core-info"};function Cf(n,e,t,r,s,i){const a=R("atom-markdown");return x(),D("div",Df,[N(a,{content:s.content},null,8,["content"])])}const Nf=j(Tf,[["render",Cf],["__scopeId","data-v-cf4ce318"]]),Lf=({core:n})=>{const{windows:e}=n.modules;return[{order:0,title:"Web-Workbench",items:[{title:"Settings",action(){return n.executeCommand("openSettings")}},{type:te.SEPARATOR},{hotKey:"I",keyCode:73,title:"Info",action(){e.addWindow({title:"Info",component:Nf,componentData:{},options:{prompt:!1,scaleX:!1,scaleY:!1,scrollX:!1,scrollY:!1}})}},{type:te.SEPARATOR},{title:"Imprint",action(){return n.executeCommand('execute "Imprint.md"')}},{title:"Disclaimer",action(){return n.executeCommand('execute "Disclaimer.md"')}}]}]},Un={CENTER:0,ORDER_HORIZONTAL:1,ORDER_VERTICAL:2,ORDER_DIAGONAL_LEFT:3,ORDER_DIAGONAL_RIGHT:4,SPLIT_HORIZONTAL:5,SPLIT_VERTICAL:6},xi={SHOW_STORAGE_SPACE:"windowsShowStorageSpace"},Pf={[xi.SHOW_STORAGE_SPACE]:!0},Mf=({core:n})=>[{order:10,title:"Window",items:[{type:te.CHECKBOX,title:"Show Disk Space",model:n.config.observable,name:xi.SHOW_STORAGE_SPACE,action(e){return n.config.set(xi.SHOW_STORAGE_SPACE,e)}},{type:te.SEPARATOR},{title:"Order",items:[{title:"Center",action(){n.modules.windows.contentWrapper.setWindowPositions(Un.CENTER)}},{type:te.SEPARATOR},{title:"Diagonal (Left to right)",action(){n.modules.windows.contentWrapper.setWindowPositions(Un.ORDER_DIAGONAL_RIGHT)}},{title:"Diagonal (Right to left)",action(){n.modules.windows.contentWrapper.setWindowPositions(Un.ORDER_DIAGONAL_LEFT)}},{type:te.SEPARATOR},{title:"Split (Horizontal)",action(){n.modules.windows.contentWrapper.setWindowPositions(Un.SPLIT_HORIZONTAL)}},{title:"Split (Vertical)",action(){n.modules.windows.contentWrapper.setWindowPositions(Un.SPLIT_VERTICAL)}}]}]}],$f={xmlns:"http://www.w3.org/2000/svg",width:"6",height:"10",viewBox:"0.5 50.5 6 10"},Wf=E("path",{fill:"#020203",d:"M.5 50.5h6v2h-4v2h2v2h-2v4h-2z"},null,-1),Ff=[Wf];function zf(n,e){return x(),D("svg",$f,Ff)}const Bf={render:zf},Vf={xmlns:"http://www.w3.org/2000/svg",width:"6",height:"10"},Uf=E("path",{d:"M0 10h6V8H2V6h2V4H2V2h4V0H0z"},null,-1),jf=[Uf];function Gf(n,e){return x(),D("svg",Vf,jf)}const Hf={render:Gf};const Yf={components:{SvgStorageBarFull:Bf,SvgStorageBarEmpty:Hf},props:{visible:{type:Boolean,default:!0},value:{type:Number,default:.8}},computed:{style(){return{"--bar-height":Math.min(this.value,1)}}}},Xf=n=>(vi("data-v-d81cda0d"),n=n(),Ei(),n),qf={class:"icon full"},Kf=Xf(()=>E("span",{class:"size"},[E("span",{class:"helper"})],-1)),Zf={class:"icon empty"};function Qf(n,e,t,r,s,i){const a=R("svg-storage-bar-full"),o=R("svg-storage-bar-empty");return t.visible?(x(),D("div",{key:0,class:"wb-env-atom-storage-bar",style:On(i.style)},[E("div",null,[E("div",qf,[N(a)]),Kf,E("div",Zf,[N(o)])])],4)):B("",!0)}const Jf=j(Yf,[["render",Qf],["__scopeId","data-v-d81cda0d"]]),ke={NAME:0,TYPE:1,CREATED_DATE:2,EDITED_DATE:3},Tt={ASCENDING:0,DESCENDING:1},Z={SHOW_INVISIBLE_SYMBOLS:"symbolWrapper_showInvisibleItems",ORDER_TYPE:"symbolWrapper_iconsOrderType",ORDER_DIRECTION:"symbolWrapper_iconsOrderDirection"},ep={[Z.SHOW_INVISIBLE_SYMBOLS]:!1,[Z.ORDER_TYPE]:ke.NAME,[Z.ORDER_DIRECTION]:Tt.ASCENDING};class Oa{constructor({fsItem:e=null,command:t,model:r,layout:s}){f(this,"type",null);f(this,"id",Nn());f(this,"layout",Le({position:A(0,0),size:A(0,0)}));f(this,"ignoreRearrange",!1);f(this,"model",Le({title:"Item Title",symbol:w.DEFAULT,used:!1,visible:!0}));if(this.command=t,this.model=Object.assign(this.model,r),this.layout=Object.assign(this.layout,s),this.fsItem=e,this.fsItem){const i=this.fsItem;this.type=tp(i),this.setProperties(i),this.fsItem.events.subscribe(({name:a,value:o})=>{a!=="addItem"&&a!=="removeItem"&&this.setProperties(e)})}}setProperties(e){if(this.model.title=e.name,this.layout.position=A(e.meta.get(y.POSITION)||A(0,0)),this.model.visible=!!e.meta.get(y.VISIBLE),this.model.symbol=e.meta.get(y.SYMBOL),this.model.url=e.meta.get(y.WEB_URL),this.model.ignoreRearrange=e.meta.get(y.IGNORE_SYMBOL_REARRANGE),e instanceof H){const t=[`openDirectory "${e.getPath()}"`];e.meta.get(y.WINDOW_SYMBOL_REARRANGE)&&t.push("-sort-symbols");const r=A(e.meta.get(y.WINDOW_POSITION)||A(0,0));r.length>0&&t.push(`--window-position="${A(r).toArray().join(",")}"`);const s=A(e.meta.get(y.WINDOW_SIZE)||A(0,0));s.length>0&&t.push(`--window-size="${A(s).toArray().join(",")}"`),e.meta.has(y.WINDOW_SCALE)&&t.push(`--window-scale=${e.meta.get(y.WINDOW_SCALE)}`),e.meta.has(y.WINDOW_SCROLL_X)&&t.push(`--window-scroll-x=${e.meta.get(y.WINDOW_SCROLL_X)}`),e.meta.has(y.WINDOW_SCROLL_Y)&&t.push(`--window-scroll-y=${e.meta.get(y.WINDOW_SCROLL_Y)}`),e.meta.has(y.WINDOW_SIDEBAR)&&t.push(`--window-sidebar=${e.meta.get(y.WINDOW_SIDEBAR)}`),e.meta.has(y.WINDOW_FULL_SIZE)&&t.push(`--window-full-size=${e.meta.get(y.WINDOW_FULL_SIZE)}`),this.command=t.join(" ")}else this.model.url||(this.command=`execute "${e.getPath()}"`)}}function Ra(n){return n.map(e=>e instanceof Oa?e:new Oa(e))}function tp(n){return n instanceof H?"container":n.meta.get(y.WEB_URL)?"link":"default"}var gt,ks,_t,zr;class Ut{constructor(e,t=[],r=!1){g(this,gt,new $e);g(this,ks,Nn());g(this,_t,void 0);f(this,"items",yt([]));f(this,"selectedItems",yt([]));g(this,zr,!1);f(this,"layout",Le({size:A(0,0),position:A(0,0)}));f(this,"size",A(0,0));f(this,"parentSize",A(0,0));I(this,zr,r||!1),I(this,_t,e),this.items.value=Ra(t||[])}get(e){return this.items.value.find(t=>t.id===e)}has(e){return!!this.items.value.find(t=>t.id===e)}add(...e){const t=Ra(e);this.items.value.push(...t.map(z)),c(this,gt).next(new G("add",{wrapper:this,items:t}))}remove(e){typeof e!="object"&&(e=this.get(e)),this.unselectItem(e.id),this.items.value.splice(this.items.value.indexOf(e),1),c(this,gt).next(new G("remove",{wrapper:this,item:e}))}setup(){return Promise.resolve()}moveItem(e,t){const r=this.get(e);return t.add(r),this.remove(r),Promise.resolve()}moveItemToItem(){return Promise.resolve()}savePosition(e,t){return Promise.resolve()}isSelectedItem(e){return this.selectedItems.value.includes(e)}selectItem(e){this.isSelectedItem(e)||(this.selectedItems.value.push(e),c(this,gt).next(new G("selectItem",{wrapper:this,id:e})))}unselectItem(e){this.isSelectedItem(e)&&(this.selectedItems.value=this.selectedItems.value.filter(t=>t!==e),c(this,gt).next(new G("unselectItem",{wrapper:this,id:e})))}clearSelectedItems(){[].concat(this.selectedItems.value).forEach(e=>this.unselectItem(e))}get root(){return c(this,zr)}get events(){return c(this,gt)}get id(){return c(this,ks)}get core(){return c(this,_t)}rearrangeIcons(e){e=Object.assign({orderType:c(this,_t).config.get(Z.ORDER_TYPE),orderDirection:c(this,_t).config.get(Z.ORDER_DIRECTION),onlyVisible:!c(this,_t).config.get(Z.SHOW_INVISIBLE_SYMBOLS),root:!1,margin:10},e);let t=this.items.value;switch(e.root&&(e.orderType=ke.NAME,e.orderDirection=Tt.DESCENDING),e.onlyVisible&&(t=t.filter(o=>o.model.visible)),t=t.filter(o=>!o.model.ignoreRearrange),e.orderType){case ke.TYPE:t=t.sort((o,l)=>o.type.localeCompare(l.type));break;case ke.CREATED_DATE:t=t.sort((o,l)=>o.createDate===l.createDate?0:o.createDate>l.createDate?1:-1);break;case ke.EDITED_DATE:t=t.sort((o,l)=>o.editedDate===l.editedDate?0:o.editedDate>l.editedDate?1:-1);break;default:t=t.sort((o,l)=>o.model.title.localeCompare(o.model.title))}switch(e.orderDirection){case Tt.ASCENDING:t.reverse();break}const r=e.margin;let s,i=r;const a=no(0,0);return e.root?s=this.size.x:s=r,t.forEach(o=>{e.root?(o.layout.position=A(s-o.layout.size.x,i),o.layout.size.x>a.x&&(a.x=o.layout.size.x),i+o.layout.size.y<this.parentSize.y?i+=o.layout.size.y+r:(s-=a.x+r,i=r)):(o.layout.size.y>a.y&&(a.y=o.layout.size.y),o.layout.position=A(s,i),s+o.layout.size.x<this.parentSize.x||(s=r,i+=a.y+r,o.layout.position=A(s,i)),s+=o.layout.size.x+r)}),Promise.all(t.map(({id:o,layout:l})=>this.savePosition(o,l.position)))}}gt=new WeakMap,ks=new WeakMap,_t=new WeakMap,zr=new WeakMap;class Zn extends Ut{constructor(){super(...arguments);f(this,"fsItem");f(this,"usedMemory",0)}async setup(t){this.fsItem=t;const r=Array.from((await t.getItems()).values());await Promise.all(r.map(async s=>this.add(await Zn.fsItemToSymbol(s)))),t.events.subscribe(this.onEventItem.bind(this))}async moveItemToItem(t,r){if(t.locked)throw new Error("Items are locked!");if(r.locked)throw new Error("Destination is locked!");t.meta.set(y.POSITION,A(0,0)),await this.core.modules.files.fs.saveItem(t),await this.core.modules.files.fs.move(t,r,{override:!0})}async moveItem(t,r){const s=this.get(t);if(s.fsItem instanceof Xr||s.fsItem instanceof vt)try{return await this.moveItemToItem(s.fsItem,r.fsItem),!0}catch(i){return console.warn(i),!1}return Promise.resolve(!1)}savePosition(t,r){const s=this.get(t);s.fsItem.meta.set(y.POSITION,r),this.core.modules.files.fs.saveItem(s.fsItem)}hasFsItem(t){return this.items.value.find(r=>r.fsItem.id===t.id)}async onEventItem({name:t,value:r}){let s;switch(t){case"addItem":s=await Zn.fsItemToSymbol(r),this.hasFsItem(r)||this.add(s);break;case"removeItem":this.remove(this.items.value.find(i=>i.fsItem===r));break}this.usedMemory=this.fsItem.size/this.fsItem.maxSize}static getItemsFromItem(t){return Promise.all(Array.from(t.items.values()).map(Zn.fsItemToSymbol))}static async fsItemToSymbol(t){const r=await t.getPath(),s={fsItem:t,model:{title:t.name}};return typeof t.action=="function"&&(s.command=`executeFile "${r}"`),t.meta.has(y.WEB_URL)&&(s.url=t.meta.get(y.WEB_URL)),s}}const np={xmlns:"http://www.w3.org/2000/svg",width:"31",height:"30",class:"wb_symbol_disk_1"},rp=E("path",{d:"M0 0h25v2h2v2h2v2h2v24H0z",class:"svg-secondary"},null,-1),sp=E("path",{fill:"#FFF",d:"M2 2v26h27V6h-2V4h-2V2",class:"svg-primary"},null,-1),ip=E("path",{fill:"#FA5",d:"M7 2h13v10H7z",class:"svg-tertiary"},null,-1),ap=E("path",{d:"M11 2h5v8h-5z",class:"svg-secondary"},null,-1),op=[rp,sp,ip,ap];function Ho(n,e){return x(),D("svg",np,op)}const Yo={render:Ho},lp=Object.freeze(Object.defineProperty({__proto__:null,default:Yo,render:Ho},Symbol.toStringTag,{value:"Module"}));const cp={props:{parentLayout:{type:Object,default(){return null}},clampGlobal:{type:Boolean,default:!1},container:{type:Boolean,default(){return!1}},command:{type:String,default:null},id:{type:String,default:null},model:{type:Object,default(){return{title:"Item Title",url:null,symbol:Yo,used:!1,visible:!0}}},layout:{type:Object,default(){return{position:A(0,0),size:A(50,50)}}},scrollOffset:{type:Object,default(){return A(0,0)}},wrapper:{type:Object,default(){return z(new Ut)}}},emits:["click"],setup(n){return{wrapperItems:n.wrapper.items,wrapperSelectedItems:n.wrapper.selectedItems}},data(){return{globalPosition:null,moving:!1,positions:{start:null,move:null},subscription:new Vr,parentEl:null,screenModul:sn.modules.screen}},computed:{linkTag(){return this.model.url?"a":"span"},linkBind(){return this.model.url?{href:this.model.url,target:this.model.url?"_blank":null,title:this.model.title}:{}},contentLayout(){return this.screenModul.contentLayout},selected(){return this.wrapperSelectedItems.includes(this.id)},styleClasses(){return{moving:this.moving,selected:this.selected,"symbol-used":this.model.used}},symbolsModule(){return sn.modules.symbols}},watch:{model:{deep:!0,handler(){this.onRefresh()}}},mounted(){this.parentEl=this.$el.parentElement,this.onRefresh()},unmounted(){this.subscription.unsubscribe(),this.wrapper.unselectItem(this.id)},methods:{onRefresh(){this.layout.size=A(200,200),window.requestAnimationFrame(()=>{this.layout.size=A(this.$el.children[0].offsetWidth,this.$el.children[0].offsetHeight)})},getRootBounds(){const{width:n,height:e,left:t,top:r}=this.parentEl.getBoundingClientRect();return{position:A(t,r),size:A(n,e)}},onPointerDown(n){ss(n);const e=this.id;if(!(this.model.url&&this.selected)&&(n.preventDefault(),!this.model.used)){if(this.command&&this.selected){const t={showCommand:!1,show:!0};return this.wrapper.unselectItem(e),this.model.used=!0,sn.executeCommand(this.command,t).then(()=>this.model.used=!1)}Us.shiftActive?this.wrapper.isSelectedItem(e)?this.wrapper.unselectItem(e):this.wrapper.selectItem(e):(this.symbolsModule.getSelectedItems().length>0&&this.symbolsModule.clearSelectedItems(),this.wrapper.selectItem(e)),this.startMove(A(n)),this.$emit("click",this)}},onPointerUp(){const n=this.symbolsModule.getSelectedItems().filter(t=>t.id!==this.id),e=this.wrapper.get(this.id);n.length>0&&e.fsItem instanceof H&&n.forEach(t=>this.wrapper.moveItemToItem(t.fsItem,e.fsItem))},startMove(n){const e=this.getRootBounds();this.positions.lastPosition=A(this.layout.position),this.positions.scrollOffset=A(this.scrollOffset),this.positions.start=n,this.positions.offset=A(()=>this.positions.start-this.layout.position),this.setPosition(n,e,!0),this.moving=!0;let t=n;const r=Us.pointerMove.subscribe(s=>{t=A(s),this.setPosition(A(s),e,!0)});this.subscription.add(Us.pointerUp.pipe(ac()).subscribe(()=>{if(r.unsubscribe(),this.symbolsModule.getSecondaryWrapper().id!==this.wrapper.id)return this.wrapper.moveItem(this.id,this.symbolsModule.getSecondaryWrapper()).then(s=>(s||(this.layout.position=A(this.positions.lastPosition)),this.globalPosition=null,this.moving=!1,s));if(this.moving=!1,this.setPosition(t,e),!this.layout.position.equals(Ae(()=>this.positions.start-this.positions.offset)))return this.wrapper.savePosition(this.id,this.layout.position)}))},setPosition(n,e,t=!1){const r={min:A(0,0),max:Ae(()=>e.size-this.layout.size)};this.positions.move=Ae(()=>n-this.positions.start);let s=Ae(()=>Math.round(this.positions.start+this.positions.move-this.positions.offset));t?(r.min=e.position,r.max=Ae(()=>r.max+this.contentLayout.position),s=Ae(()=>Math.round(s+r.min)),this.clampGlobal?this.globalPosition=A(()=>Math.max(Math.min(s,this.contentLayout.position+this.wrapper.size-this.layout.size),r.min)):this.globalPosition=s):(this.wrapper.root?this.layout.position=Ae(()=>Math.max(Math.min(s,this.wrapper.size-this.layout.size),0)):this.layout.position=Ae(()=>Math.max(s,0)),this.globalPosition=null)}}},up=["data-id"],dp=["innerHTML"];function hp(n,e,t,r,s,i){return x(),D("figure",{"data-id":t.id,class:it(["wb-env-atom-symbol-wrapper-item",i.styleClasses]),style:On([t.layout.size.toCSSVars("item-size"),(s.globalPosition||t.layout.position).toCSSVars("item-position")]),"touch-action":"none",onPointerdown:e[0]||(e[0]=(...a)=>i.onPointerDown&&i.onPointerDown(...a)),onPointerup:e[1]||(e[1]=(...a)=>i.onPointerUp&&i.onPointerUp(...a))},[(x(),U(Xs(i.linkTag),Xn(Ma(i.linkBind)),{default:Y(()=>[E("i",null,[(x(),U(Xs(i.symbolsModule.symbols.get(t.model.symbol))))]),E("figcaption",{innerHTML:t.model.title},null,8,dp)]),_:1},16))],46,up)}const mp=j(cp,[["render",hp],["__scopeId","data-v-1d03926a"]]);const fp={components:{WbEnvAtomSymbolWrapperItem:mp},props:{parentLayout:{type:Object,default(){return{size:A(window.innerWidth,window.innerHeight)}}},parentScrollable:{type:Boolean,default:!0},parentFocused:{type:Boolean,default:!1},clampSymbols:{type:Boolean,default:!1},wrapper:{type:Ut,default(){return z(new Ut(sn,[{layout:{position:A(100,0)},model:{title:"Item 1",symbol:w.DIRECTORY}},{layout:{position:A(0,0)},model:{title:"Item 2",symbol:w.DEFAULT}},{layout:{position:A(0,0)},model:{title:"Item 3",symbol:w.DEFAULT}}]))}}},emits:["ready","refresh"],setup(n){return{wrapperItems:n.wrapper.items,wrapperSelectedItems:n.wrapper.selectedItems}},data(){const n=sn;return{core:z(n),webWorkbenchConfig:z(n.config.observable),symbolsModule:z(n.modules.symbols),selectedItems:[],layout:{size:A(0,0),position:A(0,0)}}},computed:{styleClasses(){return{"parent-scrollable":this.parentScrollable,active:(this.core.modules.symbols.primaryWrapper||{}).id===this.wrapper.id}},scrollOffset(){return this.parentLayout&&"scrollOffset"in this.parentLayout?this.parentLayout.scrollOffset:A(0,0)},style(){const n=[this.scrollOffset.toCSSVars("symbol-wrapper-scroll-offset")];return this.parentScrollable?n.push(this.size.toCSSVars("symbol-wrapper-size")):n.push(this.layout.size.toCSSVars("symbol-wrapper-size")),n},size(){return this.visibleItems.map(n=>({item:n,index:this.wrapperSelectedItems.indexOf(n.id)+1})).sort((n,e)=>n.index>e.index?1:n.index<e.index?-1:0).reduce((n,{item:e})=>{const t=e.layout.position.x+e.layout.size.x,r=e.layout.position.y+e.layout.size.y;return n.x=n.x<t?t:n.x,n.y=n.y<r?r:n.y,n},no(0,0))},showInvisibleItems(){return this.webWorkbenchConfig[Z.SHOW_INVISIBLE_SYMBOLS]},visibleItems(){return this.wrapperItems.filter(this.isItemVisible)},parentLayoutSize(){return(this.parentLayout||{}).size}},watch:{parentFocused(n){this.setFocused(n)},wrapper(){this.onResize()},parentLayoutSize(n){this.onResize()},size(){this.$nextTick(()=>{this.$emit("refresh",{scroll:!0})})}},mounted(){this.$nextTick(()=>{this.onResize(),this.setFocused(this.parentFocused),this.$emit("ready")})},unmounted(){this.core.modules.symbols.getPrimaryWrapper()&&this.core.modules.symbols.getPrimaryWrapper().id===this.wrapper.id&&this.core.modules.symbols.setPrimaryWrapper(null),this.core.modules.symbols.getSecondaryWrapper()&&this.core.modules.symbols.getSecondaryWrapper().id===this.wrapper.id&&this.core.modules.symbols.setSecondaryWrapper(null)},methods:{setFocused(n){n?this.symbolsModule.setPrimaryWrapper(this.wrapper):this.symbolsModule.getPrimaryWrapper()&&this.symbolsModule.getPrimaryWrapper().id===this.wrapper.id&&this.symbolsModule.setPrimaryWrapper(null)},onResize(){const{left:n,top:e}=this.$el.getBoundingClientRect();this.wrapper.layout=this.layout={position:A(n,e),size:this.parentLayout.size},this.wrapper.size=A(this.$el.offsetWidth,this.$el.offsetHeight),this.wrapper.parentSize=this.parentLayout.size},isItemVisible(n){return this.showInvisibleItems||!this.showInvisibleItems&&n.model.visible},onPointerMove(){this.core.modules.symbols.setSecondaryWrapper(this.wrapper)},onPointerDown(n){(n.target===this.$refs.helper||n.target===this.$refs.items)&&this.wrapper.clearSelectedItems()}}},pp={ref:"helper",class:"helper"},gp={ref:"items",class:"items"};function _p(n,e,t,r,s,i){const a=R("wb-env-atom-symbol-wrapper-item");return x(),D("div",{class:it(["wb-env-symbol-wrapper",i.styleClasses]),style:On(i.style),onPointerdown:e[0]||(e[0]=(...o)=>i.onPointerDown&&i.onPointerDown(...o)),onPointermove:e[1]||(e[1]=(...o)=>i.onPointerMove&&i.onPointerMove(...o))},[E("div",pp,null,512),E("div",gp,[(x(!0),D(wt,null,xt(i.visibleItems,(o,l)=>(x(),U(a,V({key:l,"clamp-global":t.clampSymbols},o,{wrapper:t.wrapper,"parent-layout":s.layout,"scroll-offset":i.scrollOffset}),null,16,["clamp-global","wrapper","parent-layout","scroll-offset"]))),128))],512)],38)}const bp=j(fp,[["render",_p],["__scopeId","data-v-c2d0bdc4"]]);const yp={components:{WbButton:It,WbFormFieldTextbox:qr,WbButtonWrapper:At},props:{message:{type:String,default(){return"Dialog Message"}},confirm:{type:Boolean,default:!1},prompt:{type:Boolean,default:!1},promptType:{type:String,default:"text"},promptStep:{type:Number,default:void 0},promptValue:{type:String,default:null},password:{type:Boolean,default:!1},apply:{type:Function,default(){return null}},abort:{type:Function,default(){return null}},applyLabel:{type:String,default(){return"Continue"}},abortLabel:{type:String,default(){return"Cancel"}},yesLabel:{type:String,default(){return"Yes"}},noLabel:{type:String,default(){return"No"}}},emits:["apply","abort"],data(){return{inputModel:{value:this.promptValue}}},computed:{isNumber(){return this.promptType==="number"},type(){return this.password?"password":this.promptType},formattedMessage(){return this.message.replace(/\\n|\n/g,"<br>")}},methods:{onClickApply(){const n=this.inputModel.value||!0;typeof this.apply=="function"?this.apply(n):this.$emit("apply",n)},onClickAbort(){typeof this.abort=="function"?this.abort():this.$emit("abort")}}},wp={class:"wb-env-molecule-dialog-content"},xp=["innerHTML"],vp={key:1,class:"input"};function Ep(n,e,t,r,s,i){const a=R("wb-form-field-textbox"),o=R("wb-button"),l=R("wb-button-wrapper");return x(),D("div",wp,[E("div",null,[t.message?(x(),D("p",{key:0,innerHTML:i.formattedMessage},null,8,xp)):B("",!0),t.prompt?(x(),D("div",vp,[N(a,{ref:"dialogInput",model:s.inputModel,placeholder:null,step:t.promptStep,type:i.type,label:null},null,8,["model","step","type"])])):B("",!0),N(l,{align:t.abortLabel?"outer":"center",class:"buttons"},{default:Y(()=>[t.applyLabel||t.confirm&&t.yesLabel?(x(),U(o,{key:0,"style-type":"dialog",label:t.confirm?t.yesLabel:t.applyLabel,onClick:i.onClickApply},null,8,["label","onClick"])):B("",!0),t.abortLabel||t.confirm&&t.noLabel?(x(),U(o,{key:1,"style-type":"dialog",label:t.confirm?t.noLabel:t.abortLabel,onClick:i.onClickAbort},null,8,["label","onClick"])):B("",!0)]),_:1},8,["align"])])])}const Xo=j(yp,[["render",Ep],["__scopeId","data-v-2d929a47"]]),Bp=Object.freeze(Object.defineProperty({__proto__:null,default:Xo},Symbol.toStringTag,{value:"Module"})),Sp=({module:n,core:e})=>{const{files:t,windows:r,symbols:s}=e.modules,i=t.fs;return[{name:["openDirectory","openDir"],description:"Opens the specified directory.",args:[new b({index:0,name:"path",description:"Path to the directory."}),new b({name:"sortSymbols",description:"Sort Symbols",flag:!0}),new b({name:"windowSize",description:"Window Size"}),new b({name:"windowPosition",description:"Window Position"}),new b({name:"windowScale",description:"Window Scale"}),new b({name:"windowScrollX",description:"Window Scroll-X"}),new b({name:"windowScrollY",description:"Window Scroll-Y"}),new b({name:"windowSidebar",description:"Window Sidebar"}),new b({name:"windowFullSize",description:"Window Full-Size"})],async action({path:a,sortSymbols:o,windowSize:l,windowPosition:u,windowScale:d,windowScrollX:h,windowScrollY:m,windowSidebar:p,windowFullSize:v}){if(!a)throw L.get("bad_args");const _=await i.get(a),k=await s.addFileSystemWrapper(_),W=s.symbolWrappers.get(k),C=Le({value:_.size/_.maxSize}),$=r.addWindow({title:_.name,layout:{size:A(...(l||"400,200").split(",").map(Q=>Number(Q))),position:A(...(u||"0,0").split(",").map(Q=>Number(Q)))},symbolWrapper:W,sidebarComponent:Jf,sidebarComponentData:C,component:bp,componentData:{wrapper:W,parentScrollable:h||m},options:{sidebar:p!==void 0?p:!0,scale:d!==void 0?d:!0,scrollX:h!==void 0?h:!0,scrollY:m!==void 0?m:!0,center:!u}},{active:!0,full:v}),_e=()=>{C.value=_.size/_.maxSize},le=[W.events.subscribe(_e)];return new Promise(Q=>{$.events.subscribe(({name:Xi})=>{Xi==="ready"&&o?window.requestAnimationFrame(()=>{W.rearrangeIcons()}):Xi==="close"?(le.forEach(Zo=>Zo.unsubscribe()),s.removeWrapper(k),Q()):_e()})})}},{name:["openDialog"],description:"Open a Dialog.",args:[new b({index:0,name:["message"],description:"Message from Dialog."}),new b({index:1,name:["title"],description:"Title from Dialog."}),new b({name:["apply"],description:"Title from apply button."}),new b({name:["abort"],description:"Title from abort button."}),new b({name:["confirm"],flag:!0,description:"Defines the confirm dialog"}),new b({name:["prompt"],flag:!0,description:"Defines the prompt dialog"}),new b({name:["promptType"],description:"Type from prompt dialog (e.g. text, number, email). (Default: text)"}),new b({name:["promptStep"],description:"Step from prompt dialog (e.g. 1, 0.1, 0.01). (Default: 1)"}),new b({name:["promptValue"],description:"Default value from prompt dialog."}),new b({name:["secret"],flag:!1,description:"Input is illegible."})],action:(a,o)=>{const{title:l=null,message:u=null,apply:d=null,abort:h=null,confirm:m=!1,prompt:p=!1,promptType:v="text",promptStep:_=void 0,promptValue:k=null,secret:W=!1}=a;let C;const $=Q=>{C(Q)},_e=()=>{C(!1)},le=n.addWindow(new nr({title:l,component:Xo,componentData:{title:l,message:u,secret:W,confirm:m,prompt:p,promptType:v,promptStep:Number(_),promptValue:k,applyLabel:d||"Continue",abortLabel:h,apply:$,abort:_e},options:{scaleX:!1,scaleY:!1,scrollX:!1,scrollY:!1,close:!1}}));return le.awaitClose().then(()=>_e()),new Promise(Q=>{C=Q}).then(Q=>(le.close(),Q))}}]};var In;class qo extends Cs{constructor(t){const{core:r}=Object.assign({core:null},t);super({config:Pf,commands:Sp,core:r});g(this,In,new Map);f(this,"contentWrapper");f(this,"globalWrapper");f(this,"contextMenu",Le(new Rf(this)));this.contentWrapper=this.getWrapper(this.addWrapper(new ua(r))),this.globalWrapper=this.getWrapper(this.addWrapper(new ua(r)))}addWindow(t,r){return t instanceof nr||(t=new nr(t)),t.componentData&&(t.componentData.core=z(this.core)),r=Object.assign({global:!1},r),r.global?t=this.globalWrapper.add(t,r):t=this.contentWrapper.add(t,r),t}getWrapper(t){return c(this,In).get(t)}addWrapper(t){return c(this,In).set(t.id,t),t.id}removeWrapper(t){typeof t!="string"&&(t=t.id),c(this,In).delete(t)}isContextMenu(t){return t.id===this.getActiveContextMenu().id}setup(){this.contextMenu.addDefaultItems(new Ht(Lf,{core:this.core})),this.contextMenu.addDefaultItems(new Ht(Mf,{core:this.core}))}clear(){this.contentWrapper.clear(),this.globalWrapper.clear()}getActiveContextMenu(){return this.contextMenu.getActiveItems()}setActiveContextMenu(t){return this.contextMenu.setActiveItems(t)}}In=new WeakMap,f(qo,"NAME","Windows");const Ip={[w.DEFAULT]:()=>O(()=>import("./default.8c8db41a.js"),["./default.8c8db41a.js","./entry.252f118a.js"],import.meta.url).then(n=>n.default),[w.DIRECTORY]:()=>O(()=>import("./directory.424396f9.js"),["./directory.424396f9.js","./entry.252f118a.js"],import.meta.url).then(n=>n.default),[w.DIRECTORY_PREFS]:()=>O(()=>import("./directory_prefs.ef7ee06d.js"),["./directory_prefs.ef7ee06d.js","./entry.252f118a.js"],import.meta.url).then(n=>n.default),[w.CLOUD_DISK]:()=>O(()=>import("./cloud_disk.ca6a630a.js"),["./cloud_disk.ca6a630a.js","./entry.252f118a.js"],import.meta.url).then(n=>n.default),[w.HARD_DISK]:()=>O(()=>import("./hard_disk.33e7a57c.js"),["./hard_disk.33e7a57c.js","./entry.252f118a.js"],import.meta.url).then(n=>n.default),[w.RAM_DISK]:()=>O(()=>import("./ram_disk.e76e0c02.js"),["./ram_disk.e76e0c02.js","./entry.252f118a.js"],import.meta.url).then(n=>n.default),[w.TMP_DISK]:()=>O(()=>import("./tmp_disk.e76e0c02.js"),["./tmp_disk.e76e0c02.js","./entry.252f118a.js"],import.meta.url).then(n=>n.default),[w.DISK_1]:()=>O(()=>Promise.resolve().then(()=>lp),void 0,import.meta.url).then(n=>n.default),[w.DISK_2]:()=>O(()=>import("./disk_2.96b421af.js"),["./disk_2.96b421af.js","./entry.252f118a.js"],import.meta.url).then(n=>n.default),[w.DISK_WORKBENCH13]:()=>O(()=>import("./disk_workbench13.c8acff9b.js"),["./disk_workbench13.c8acff9b.js","./entry.252f118a.js"],import.meta.url).then(n=>n.default),[w.DISK_MARKDOWN]:()=>O(()=>import("./disk_markdown.6d7aca5e.js"),["./disk_markdown.6d7aca5e.js","./entry.252f118a.js"],import.meta.url).then(n=>n.default),[w.DISK_BASIC]:()=>O(()=>import("./disk_basic.20f27a28.js"),["./disk_basic.20f27a28.js","./entry.252f118a.js"],import.meta.url).then(n=>n.default),[w.WORK]:()=>O(()=>import("./work.3cbee168.js"),["./work.3cbee168.js","./entry.252f118a.js"],import.meta.url).then(n=>n.default),[w.CONSOLE]:()=>O(()=>import("./console.e2a3bdc9.js"),["./console.e2a3bdc9.js","./entry.252f118a.js"],import.meta.url).then(n=>n.default),[w.SETTINGS]:()=>O(()=>import("./settings.e28488e5.js"),["./settings.e28488e5.js","./entry.252f118a.js"],import.meta.url).then(n=>n.default),[w.TRASHCAN]:()=>O(()=>import("./trashcan.b1b6c5fb.js"),["./trashcan.b1b6c5fb.js","./entry.252f118a.js"],import.meta.url).then(n=>n.default),[w.COMPUTER_1]:()=>O(()=>import("./computer_1.e63ab81d.js"),["./computer_1.e63ab81d.js","./entry.252f118a.js"],import.meta.url).then(n=>n.default),[w.TELEPHONE]:()=>O(()=>import("./telephone.d4edb928.js"),["./telephone.d4edb928.js","./entry.252f118a.js"],import.meta.url).then(n=>n.default),[w.CURSOR]:()=>O(()=>import("./cursor.fe3761ed.js"),["./cursor.fe3761ed.js","./entry.252f118a.js"],import.meta.url).then(n=>n.default),[w.PREFERENCE]:()=>O(()=>import("./preference.bf910554.js"),["./preference.bf910554.js","./entry.252f118a.js"],import.meta.url).then(n=>n.default),[w.WEB_BASIC]:()=>O(()=>import("./web_basic.47cba26a.js"),["./web_basic.47cba26a.js","./entry.252f118a.js"],import.meta.url).then(n=>n.default),[w.WEB_PAINTING]:()=>O(()=>import("./web_painting.5f4a8fc8.js"),["./web_painting.5f4a8fc8.js","./entry.252f118a.js"],import.meta.url).then(n=>n.default),[w.COLORS]:()=>O(()=>import("./colors.3e9bd017.js"),["./colors.3e9bd017.js","./entry.252f118a.js"],import.meta.url).then(n=>n.default),[w.PRINT_1]:()=>O(()=>import("./print_1.d8fc5e61.js"),["./print_1.d8fc5e61.js","./entry.252f118a.js"],import.meta.url).then(n=>n.default),[w.PRINT_2]:()=>O(()=>import("./print_2.8c5009d6.js"),["./print_2.8c5009d6.js","./entry.252f118a.js"],import.meta.url).then(n=>n.default),[w.NOTEPAD]:()=>O(()=>import("./notepad.ce7a5027.js"),["./notepad.ce7a5027.js","./entry.252f118a.js"],import.meta.url).then(n=>n.default),[w.BASIC]:()=>O(()=>import("./basic.225a0c10.js"),["./basic.225a0c10.js","./entry.252f118a.js"],import.meta.url).then(n=>n.default),[w.IMAGE]:()=>O(()=>import("./image.7211230c.js"),["./image.7211230c.js","./entry.252f118a.js"],import.meta.url).then(n=>n.default),[w.NOTE]:()=>O(()=>import("./note.7ba6c075.js"),["./note.7ba6c075.js","./entry.252f118a.js"],import.meta.url).then(n=>n.default),[w.NOTE_BLANK]:()=>O(()=>import("./note_blank.40c45cda.js"),["./note_blank.40c45cda.js","./entry.252f118a.js"],import.meta.url).then(n=>n.default),[w.LARGE_NOTE]:()=>O(()=>import("./large_note.477ff7d6.js"),["./large_note.477ff7d6.js","./entry.252f118a.js"],import.meta.url).then(n=>n.default),[w.LARGE_NOTE_RICH]:()=>O(()=>import("./large_note_rich.7130d891.js"),["./large_note_rich.7130d891.js","./entry.252f118a.js"],import.meta.url).then(n=>n.default),[w.FULLSCREEN]:()=>O(()=>import("./fullscreen.ff2a9777.js"),["./fullscreen.ff2a9777.js","./entry.252f118a.js"],import.meta.url).then(n=>n.default),[w.CALCULATOR]:()=>O(()=>import("./calculator.e49db3af.js"),["./calculator.e49db3af.js","./entry.252f118a.js"],import.meta.url).then(n=>n.default),[w.CLOCK]:()=>O(()=>import("./clock.c029ba2b.js"),["./clock.c029ba2b.js","./entry.252f118a.js"],import.meta.url).then(n=>n.default),[w.KEYBOARD_QUESTION]:()=>O(()=>import("./keyboard_question.cf2dfe22.js"),["./keyboard_question.cf2dfe22.js","./entry.252f118a.js"],import.meta.url).then(n=>n.default),[w.LARGE_NOTEPAD]:()=>O(()=>import("./large_notepad.f4f6afa4.js"),["./large_notepad.f4f6afa4.js","./entry.252f118a.js"],import.meta.url).then(n=>n.default),[w.LARGE_NOTEPAD_HELP]:()=>O(()=>import("./large_notepad_help.3c721b76.js"),["./large_notepad_help.3c721b76.js","./entry.252f118a.js"],import.meta.url).then(n=>n.default),[w.RABBIT]:()=>O(()=>import("./rabbit.839f8842.js"),["./rabbit.839f8842.js","./entry.252f118a.js"],import.meta.url).then(n=>n.default),[w.MORE]:()=>O(()=>import("./more.1829f0bd.js"),["./more.1829f0bd.js","./entry.252f118a.js"],import.meta.url).then(n=>n.default),[w.SAY]:()=>O(()=>import("./say.e5548846.js"),["./say.e5548846.js","./entry.252f118a.js"],import.meta.url).then(n=>n.default),[w.GITHUB]:()=>O(()=>import("./github.8e863d69.js"),["./github.8e863d69.js","./entry.252f118a.js"],import.meta.url).then(n=>n.default),[w.LAMMPEE]:()=>O(()=>import("./lammpee.18d9b475.js"),["./lammpee.18d9b475.js","./entry.252f118a.js"],import.meta.url).then(n=>n.default),[w.CUBY]:()=>O(()=>import("./cuby.8206629a.js"),["./cuby.8206629a.js","./entry.252f118a.js"],import.meta.url).then(n=>n.default),[w.NUXT]:()=>O(()=>import("./nuxt.7d0496d3.js"),["./nuxt.7d0496d3.js","./entry.252f118a.js"],import.meta.url).then(n=>n.default),[w.CLOWN]:()=>O(()=>import("./clown.f6db876a.js"),["./clown.f6db876a.js","./entry.252f118a.js"],import.meta.url).then(n=>n.default),[w.DISALLOW_1]:()=>O(()=>import("./disallow_1.da236c41.js"),["./disallow_1.da236c41.js","./entry.252f118a.js"],import.meta.url).then(n=>n.default),[w.COPY_1]:()=>O(()=>import("./copy_1.1462bfd7.js"),["./copy_1.1462bfd7.js","./entry.252f118a.js"],import.meta.url).then(n=>n.default),[w.COPY_2]:()=>O(()=>import("./copy_2.9b874795.js"),["./copy_2.9b874795.js","./entry.252f118a.js"],import.meta.url).then(n=>n.default),[w.DISPLAY_KEYBOARD]:()=>O(()=>import("./display_keyboard.26116423.js"),["./display_keyboard.26116423.js","./entry.252f118a.js"],import.meta.url).then(n=>n.default),[w.PALETTE]:()=>O(()=>import("./palette.5be8b0b2.js"),["./palette.5be8b0b2.js","./entry.252f118a.js"],import.meta.url).then(n=>n.default),[w.SIGN_1]:()=>O(()=>import("./sign_1.551bee7a.js"),["./sign_1.551bee7a.js","./entry.252f118a.js"],import.meta.url).then(n=>n.default),[w.DOCUMENT_EDITOR]:()=>O(()=>import("./document_editor.03dfb369.js"),["./document_editor.03dfb369.js","./entry.252f118a.js"],import.meta.url).then(n=>n.default),[w.DOCUMENT_READER]:()=>O(()=>import("./document_reader.548a5003.js"),["./document_reader.548a5003.js","./entry.252f118a.js"],import.meta.url).then(n=>n.default),[w.SYNTHESIZER]:()=>O(()=>import("./synthesizer.a2d742a4.js"),["./synthesizer.a2d742a4.js","./entry.252f118a.js"],import.meta.url).then(n=>n.default)},Ap=({module:n,core:e})=>[{order:11,title:"Symbol",items:[{type:te.CHECKBOX,title:"Show Invisible Symbols",model:e.config.observable,name:Z.SHOW_INVISIBLE_SYMBOLS,action(t){return e.config.set(Z.SHOW_INVISIBLE_SYMBOLS,t)}},{title:"Rearrange Symbols",hotKey:"R",keyCode:82,action(){const t=n.getDefaultWrapper(),r=n.getPrimaryWrapper();return r.id!==t.id?(r.rearrangeIcons(),we(r.fsItem)):(t.rearrangeIcons({root:!0}),we(t.fsItem))}},{title:"Order Type",items:[{model:e.config.observable,type:te.RADIO,name:Z.ORDER_TYPE,value:ke.NAME,title:"Name",action(){return e.config.set(Z.ORDER_TYPE,ke.NAME)}},{model:e.config.observable,type:te.RADIO,name:Z.ORDER_TYPE,value:ke.TYPE,title:"Type",action(){return e.config.set(Z.ORDER_TYPE,ke.TYPE)}},{model:e.config.observable,type:te.RADIO,name:Z.ORDER_TYPE,value:ke.CREATED_DATE,title:"Created Date",action(){return e.config.set(Z.ORDER_TYPE,ke.CREATED_DATE)}},{model:e.config.observable,type:te.RADIO,name:Z.ORDER_TYPE,value:ke.EDITED_DATE,title:"Edited Date",action(){return e.config.set(Z.ORDER_TYPE,ke.EDITED_DATE)}}]},{title:"Order Direction",items:[{model:e.config.observable,type:te.RADIO,name:Z.ORDER_DIRECTION,value:Tt.ASCENDING,title:"Ascending",action(){return e.config.set(Z.ORDER_DIRECTION,Tt.ASCENDING)}},{model:e.config.observable,type:te.RADIO,name:Z.ORDER_DIRECTION,value:Tt.DESCENDING,title:"Descending",action(){return e.config.set(Z.ORDER_DIRECTION,Tt.DESCENDING)}}]}]}],kp=({module:n,core:e})=>[{name:["rearrangeIcons"],description:"Rearrange Icons",args:[new b({name:"id",description:"Wraper id"}),new b({name:"root",description:"Use root wrapper",flag:!0})],async action({id:t,root:r}){const s=n.getDefaultWrapper(),i=n.getPrimaryWrapper();if(await new Promise(a=>window.requestAnimationFrame(a)),r)return s.rearrangeIcons({root:!0}),we(s.fsItem);{let a=i;return t&&(a=n.get(t)),a.rearrangeIcons(),we(a.fsItem)}}}];var bt,zt,Qe,An,Bt,Br;class Ko extends Cs{constructor(t){const{core:r}=Object.assign({core:null},t);super({config:ep,commands:kp,contextMenu:Ap,core:r});g(this,bt,new $e);g(this,zt,new Map);g(this,Qe,new Map);g(this,An,{});f(this,"hasSelectedItems",!1);g(this,Bt,void 0);g(this,Br,void 0);f(this,"activeWrapper");f(this,"defaultWrapper");f(this,"primaryWrapper");f(this,"secondaryWrapper")}addWrapper(t){return t=z(t),c(this,Qe).set(t.id,t),c(this,An)[t.id]=t,t.events.subscribe(this.onEventWrapper.bind(this)),t.id}onEventWrapper({name:t,value:r}){const{wrapper:s}=r;(t==="selectItem"||t==="unselectItem")&&(this.hasSelectedItems=s.selectedItems.value.length>0,c(this,bt).next(new G("hasSelectedItems",this.hasSelectedItems)))}removeWrapper(t){typeof t!="string"&&(t=t.id),c(this,Qe).delete(t),delete c(this,An)[String(t)]}getActiveWrapper(t){const r=this.core.modules.windows.contentWrapper.getActiveWindow();return r&&r.symbolWrapper?r.symbolWrapper:t?null:this.activeWrapper}getSelectedItems(){return Array.from(c(this,Qe).values()).reduce((t,r)=>(t.push(...r.selectedItems.value.map(s=>r.get(s))),t),[])}clearSelectedItems(){return Array.from(c(this,Qe).values()).forEach(t=>{t.clearSelectedItems()})}async addFileSystemWrapper(t,r){const s=new Zn(this.core,null,r);return await s.setup(t),this.addWrapper(s)}async setup(){await this.loadCoreSymbols(),this.setDefaultWrapper(await this.addFileSystemWrapper(this.core.modules.files.fs.root,!0))}loadCoreSymbols(){return Promise.all(Object.values(w).map(async t=>c(this,zt).set(t,await Ip[String(t)]())))}get(t){return c(this,Qe).get(t)}setDefaultWrapper(t){I(this,Br,t),this.primaryWrapper=this.secondaryWrapper=this.activeWrapper=this.defaultWrapper=this.symbolWrappers.get(t)}getDefaultWrapper(){return this.defaultWrapper}getPrimaryWrapper(){return this.primaryWrapper||this.defaultWrapper}getSecondaryWrapper(){return this.secondaryWrapper||this.defaultWrapper}setPrimaryWrapper(t){t instanceof Ut&&(t=t.id),this.primaryWrapper=this.symbolWrappers.get(t),c(this,bt).next(new G("setPrimaryWrapper",this.getPrimaryWrapper()))}setSecondaryWrapper(t){t instanceof Ut&&(t=t.id),this.secondaryWrapper=this.symbolWrappers.get(t),c(this,bt).next(new G("setSecondaryWrapper",this.secondaryWrapper))}setActiveWrapper(t){t instanceof Ut&&(t=t.id);let r=this.symbolWrappers.get(c(this,Bt));return t!==c(this,Bt)&&(I(this,Bt,t),this.activeWrapper=this.symbolWrappers.get(c(this,Bt)),r=this.activeWrapper||this.symbolWrappers.get(c(this,Br)),c(this,bt).next(new G("setActiveWrapper",r))),r}addSymbol(t,r){c(this,zt).set(t,r)}removeSymbol(t){c(this,zt).delete(t)}get wrappersObservable(){return c(this,An)}get events(){return c(this,bt)}get symbols(){return c(this,zt)}get symbolWrappers(){return c(this,Qe)}}bt=new WeakMap,zt=new WeakMap,Qe=new WeakMap,An=new WeakMap,Bt=new WeakMap,Br=new WeakMap,f(Ko,"NAME","Symbols");const Kr=new li;Kr.addModule(Mo);Kr.addModule(Go);Kr.addModule(qo);Kr.addModule(Ko);const sn=Kr,Vp=Object.freeze(Object.defineProperty({__proto__:null,default:sn},Symbol.toStringTag,{value:"Module"}));export{Ur as $,b as A,Cp as B,P as C,_o as D,zc as E,Bc as F,qt as G,Gt as H,Yu as I,$p as J,wc as K,qs as L,Cs as M,Ae as N,Ha as O,Gn as P,Uo as Q,Ol as R,Vr as S,Yc as T,uu as U,y as V,ua as W,w as X,X as Y,je as Z,en as _,qc as a,ef as a0,Nn as a1,eo as a2,$e as a3,G as a4,pm as a5,Co as a6,Pn as a7,It as a8,zi as a9,qr as aa,_h as ab,fd as ac,Mf as ad,Mp as ae,At as af,Ht as ag,Bp as ah,Vp as ai,Us as b,xi as c,Np as d,Qs as e,ac as f,A as g,no as h,Qc as i,lt as j,ct as k,bp as l,la as m,ut as n,Dp as o,Yd as p,te as q,go as r,Lp as s,ss as t,ot as u,Vt as v,sn as w,vo as x,K as y,Qu as z};
