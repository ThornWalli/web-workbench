import{W as e}from"./Caob76XJ.js";import{W as a}from"./CnxF4DWy.js";import{W as l}from"./CH0i9kLA.js";import{d as t,o as s}from"./BSzGBLGV.js";import{d as u,k as o,r as n,O as v,a0 as i,o as d,a1 as r,y as m,z as p,A as c,C as b,S as f,ac as y,D as h,F as g,I as w,_ as k}from"./BfpYGSxR.js";const I={class:"wb-module-files-elements-file-select"},V=k(u({__name:"FileSelect",props:{modelValue:{},fileSystem:{},fsItem:{},backLabel:{},upLabel:{},downLabel:{},maxVisibleItems:{}},emits:["update:model-value","select","refresh"],setup(u,{emit:k}){const V=k,x=u,L=o(()=>x.backLabel||"../"),_=o(()=>x.upLabel||"Up"),j=o(()=>x.downLabel||"Down"),S=o(()=>x.maxVisibleItems||5),W=o(()=>({title:"",items:D.value,modelValue:x.modelValue,"onUpdate:model-value":e=>{V("update:model-value",e)}})),A=n(x.fsItem||v(x.fileSystem.root)),C=n([]),M=n(0),P=o(()=>({back:!A.value.parent,up:M.value-1<0,down:M.value+1>C.value.length-S.value})),z=o(()=>x.modelValue),D=o(()=>{const e=C.value.slice(M.value,M.value+S.value).map(e=>({label:e.id,value:e.getPath()})).concat(Array(Math.max(S.value-C.value.length,0)).fill({label:"&nbsp;",disabled:!0}));return C.value.length<1&&(e[Math.floor(e.length/2)]={label:"Empty",disabled:!0}),e});i(()=>z.value,async()=>{"string"==typeof x.modelValue&&(A.value=v(await x.fileSystem.get(x.modelValue)),A.value instanceof t&&(C.value=Array.from((await A.value.getItems()).values()).map(v),M.value=0),(A.value instanceof s||A.value instanceof t)&&V("select",A.value))}),d(async()=>{var e;C.value=Array.from((await(null==(e=A.value)?void 0:e.getItems())||[]).values()).map(e=>v(e)),r(()=>{V("refresh",{reset:!0,resize:!1,scroll:!1})})});const onClicBack=()=>{var e,a,l,s,u,o;let n;if(A.value instanceof t||!(null==(a=null==(e=A.value)?void 0:e.parent)?void 0:a.parent)?A.value.parent&&(n=null==(o=A.value.parent)?void 0:o.getPath()):n=null==(u=null==(s=null==(l=A.value)?void 0:l.parent)?void 0:s.parent)?void 0:u.getPath(),!n)throw new Error("No parent found");V("update:model-value",n)},onClickUp=()=>{M.value=Math.max(M.value-1,0)},onClickDown=()=>{M.value=Math.min(M.value+1,C.value.length-S.value)};return(t,s)=>(p(),m("div",I,[c("div",null,[b(l,f(y(W.value)),null,16)]),c("div",null,[b(a,{align:"outer",full:"",direction:"vertical"},{default:h(()=>[b(e,{"style-type":"secondary",label:L.value,disabled:P.value.back,onClick:onClicBack},null,8,["label","disabled"]),b(e,{"style-type":"secondary",label:_.value,disabled:P.value.up,onClick:onClickUp},null,8,["label","disabled"]),j.value?(p(),g(e,{key:0,"style-type":"secondary",label:j.value,disabled:P.value.down,onClick:onClickDown},null,8,["label","disabled"])):w("",!0)]),_:1})])]))}}),[["__scopeId","data-v-a0eb7037"]]);export{V as W};
