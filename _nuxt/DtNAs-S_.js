import{W as e}from"./Dnkwg0NB.js";import{W as l}from"./Caob76XJ.js";import{W as a}from"./CnxF4DWy.js";import{W as o}from"./ChU3mOMn.js";import{W as u}from"./Hx5fWSap.js";import{W as t}from"./CP7cPb5u.js";import{_ as d}from"./Ce5YywOu.js";import{I as i}from"./D1WZfvAb.js";import{u as n}from"./Dkhtr-D7.js";import{d as s,r as v,k as m,y as r,z as c,C as b,D as p,A as f,X as y,Y as V,F as j,G as U,P as k,_ as g}from"./BfpYGSxR.js";import"./BWKGU6Bw.js";import"./BHmTNEz3.js";import"./DDPzVXKz.js";import"./BEk8nzL5.js";import"./C98WWl5r.js";import"./jSR9Z_uS.js";const h={class:"wb-module-files-edit"},C={class:"table-wrapper"},I={class:"items"},S={class:"name"},N={class:"value"},_={class:"type"},M={class:"navigation style-filled"},A={class:"create"},W=g(s({__name:"ItemMeta",props:{fsItem:{},model:{}},emits:["close"],setup(s,{emit:g}){const{core:W}=n(),w=v([]),O=s,D=g,J=v(Array.from(O.fsItem.meta.entries()).map(([e,l])=>({name:e,value:l,valid:!0,type:typeof l}))),z=v(),B=m(()=>O.fsItem.locked),x=m(()=>{const e=Array.from(Object.values(i)).filter(e=>!function hasItem(e){return J.value.some(l=>l.name===e)}(e)).map(e=>({title:e,value:e}));return e.unshift({title:"Select Item Meta",value:""}),{label:"Item Meta",modelValue:z.value,options:e,"onUpdate:modelValue":e=>{z.value=e}}}),F=m(()=>({hideLabel:!0,label:"Value Format",options:[{title:"String",value:"string"},{title:"Number",value:"number"},{title:"Boolean",value:"boolean"},{title:"JSON",value:"object"}]}));function onUpdateModelValue(e,l){const a=function getItem(e){return J.value.find(l=>l.name===e)}(e);if("boolean"===a.type)a.value="true"===l,a.valid="boolean"==typeof a.value&&null!==a.value&&void 0!==a.value;else if("number"===a.type)a.value=Number(l),a.valid=!isNaN(a.value)&&null!==a.value&&void 0!==a.value;else if("string"===a.type)a.value=String(l),a.valid=null!==a.value&&void 0!==a.value;else try{a.value=JSON.parse(l),a.valid=null!==a.value&&void 0!==a.value}catch(o){a.valid=!1,console.warn(o)}}const Y=m(()=>J.value.some(e=>!e.valid));function onClickCancel(){D("close")}async function onSubmit(){if(!O.fsItem.locked&&!Y.value){const e=Object.fromEntries(J.value.map(e=>[e.name,e.value]));await O.model.actions.saveItemMeta(O.fsItem,e,!0),D("close")}}function onClickAdd(){z.value&&J.value.push({name:z.value||"",value:"",valid:!0,type:"string"}),z.value=""}function onClickDelete(){J.value=J.value.filter(e=>!w.value.includes(e.name))}return(i,n)=>(c(),r("div",h,[b(e,{class:"form",onSubmit:onSubmit},{default:p(()=>[f("div",C,[f("div",I,[(c(!0),r(y,null,V(J.value,(e,l)=>(c(),r("div",{key:l,class:"item"},[f("div",S,[b(u,{modelValue:w.value,"onUpdate:modelValue":n[0]||(n[0]=e=>w.value=e),disabled:B.value,label:e.name,value:e.name},null,8,["modelValue","disabled","label","value"])]),f("div",N,["symbol"===e.name?(c(),j(d,{key:0,disabled:B.value,core:U(W),"hide-label":"",label:e.name,"model-value":e.value,"onUpdate:modelValue":l=>onUpdateModelValue(e.name,l)},null,8,["disabled","core","label","model-value","onUpdate:modelValue"])):"boolean"==typeof e.value?(c(),j(u,{key:1,disabled:B.value,"hide-label":"",label:e.name,"model-value":e.value,"onUpdate:modelValue":l=>onUpdateModelValue(e.name,l)},null,8,["disabled","label","model-value","onUpdate:modelValue"])):"string"==typeof e.value?(c(),j(o,{key:2,disabled:B.value,fluid:"",resize:"vertical","hide-label":"",label:e.name,"model-value":e.value,"onUpdate:modelValue":l=>onUpdateModelValue(e.name,l)},null,8,["disabled","label","model-value","onUpdate:modelValue"])):(c(),j(o,{key:3,disabled:B.value,fluid:"",resize:"vertical","hide-label":"",label:e.name,"model-value":JSON.stringify(e.value)||"","onUpdate:modelValue":l=>onUpdateModelValue(e.name,l)},null,8,["disabled","label","model-value","onUpdate:modelValue"]))]),f("div",_,[b(t,k({disabled:B.value,"model-value":e.type},{ref_for:!0},F.value,{"onUpdate:modelValue":l=>function onUpdateValueType(e,l){const a=J.value.find(l=>l.name===e);if(a)if(a.valid=!0,"string"===l)a.value=String((null==a?void 0:a.value)||""),a.valid=null!==a.value&&void 0!==a.value;else if("number"===l)a.value=Number((null==a?void 0:a.value)||""),a.valid=!isNaN(a.value)&&null!==a.value&&void 0!==a.value;else if("boolean"===l)a.value=Boolean((null==a?void 0:a.value)||""),a.valid="boolean"==typeof a.value&&null!==a.value&&void 0!==a.value;else if("object"===l)try{a.value=JSON.parse(String((null==a?void 0:a.value)||""))}catch(o){a.valid=!1,console.warn(o)}}(e.name,l)}),null,16,["disabled","model-value","onUpdate:modelValue"])])]))),128))])]),f("div",M,[f("div",A,[b(t,k({disabled:B.value,"hide-label":""},x.value),null,16,["disabled"]),b(l,{disabled:!z.value,label:"Add","style-type":"secondary",onClick:onClickAdd},null,8,["disabled"]),b(l,{disabled:w.value.length<1,label:`DeleteÂ (${w.value.length})`,"style-type":"secondary",onClick:onClickDelete},null,8,["disabled","label"])]),b(a,{align:"outer",full:""},{default:p(()=>[b(l,{label:"Cancel","style-type":"secondary",onClick:onClickCancel}),b(l,{disabled:B.value||Y.value,label:"Save","style-type":"secondary",type:"submit"},null,8,["disabled"])]),_:1})])]),_:1})]))}}),[["__scopeId","data-v-9bbc55a0"]]);export{W as default};
