import{E as S}from"./Cz6ozejB.js";import{z as h,u as T}from"./ZHhSaUdj.js";import{C as x}from"./CxKYomUj.js";import{i as I,j as p}from"./B-6Wl6ov.js";import{d as b,a as n,b as N,u as y}from"./jI0uH-Zs.js";import{S as B}from"./BTa_gj15.js";import{K as f}from"./B2exwp0w.js";import{O as W,d as K,r as R,k as g,a0 as _,o as A,a1 as C,y as P,z as V,C as D,G as M,_ as Y}from"./Bx1Gqxs7.js";import{u as F}from"./Dq_gnHze.js";import"./DG6QdPnO.js";import"./On0xenC3.js";import"./CZZPvNTk.js";import"./CpIyErmU.js";import"./djI3_XgP.js";import"./D4lI5vpz.js";import"./Ce6njBYG.js";import"./6C4StZv5.js";import"./DdQrQ7-5.js";import"./RAasLaaH.js";import"./BE-N3i2n.js";import"./6jpuwjT2.js";import"./DNvW6rqi.js";import"./DI3A0fxi.js";import"./BlhZwPhK.js";import"./DLyaWjaL.js";import"./BWR5uye1.js";import"./CV0dHcg-.js";import"./eeW43C70.js";import"./DMzq3-W3.js";import"./CJLX7oOC.js";import"./CNlRQWZy.js";import"./ol2dnVJx.js";import"./D9awfk1U.js";import"./CNkvSXuu.js";import"./B8lSKJ9-.js";import"./Cc_Og2B_.js";import"./Bu9-HbQ4.js";import"./9V19AFUE.js";import"./Cpj98o6Y.js";import"./CHpeLE9u.js";import"./WZmY4AAg.js";import"./BC_yceLI.js";import"./CaAbksje.js";import"./A4CL5M2A.js";const H=b(({core:a,model:t})=>{return[new n({order:0,title:"Editor",items:[new n({title:"New",hotKey:{alt:!0,code:f.KEY_N,title:"N"},action:v}),new n({title:"Open…",hotKey:{alt:!0,code:f.KEY_O,title:"O"},action:w}),new n({title:"Save",hotKey:{alt:!0,code:f.KEY_S,title:"S"},action:l}),new n({title:"Save As…",action:r}),new B,new n({hotKey:{alt:!0,code:f.KEY_I,title:"I"},title:"Info",action(){var e;return(e=t.actions)==null?void 0:e.openInfo()}}),new n({title:"Close",action(){var e;return(e=t.actions)==null?void 0:e.close()}})]}),new n({order:1,title:"Document Settings",items:[new n({title:"Has Window Output",type:N.CHECKBOX,name:x.HAS_WINDOW_OUTPUT,model:t.value})]}),new n({order:1,title:"Run",hotKey:{code:f.KEY_R,title:"R"},action:E}),new n({order:2,title:"Preview",type:N.CHECKBOX,name:I.WEB_BASIC_SHOW_PREVIEW,model:a.config.observable,action({checked:e}){return a.config.set(I.WEB_BASIC_SHOW_PREVIEW,e)}})];function v(){var e;(e=t.actions)==null||e.reset()}function l(){return d()}function r(){return d(!0)}async function d(e=!1){const u={...t.value,content:t.value[p.CONTENT].split(/\n/g)},s=await h(JSON.stringify(u));let i;if(!e&&t.fsItem)return i=await a.executeCommand(`editfile "${t.fsItem.getPath()}" --data="${s}"`),i?a.executeCommand('openDialog "File saved."'):a.executeCommand('openDialog "File could not be saved."');{const m=await a.executeCommand(`saveFileDialog --data="${s}" --extension="bs"`);return m?(t.fsItem=W(m),t.fsItem):null}}async function w(){const e=await a.executeCommand("openFileDialog");if(e)if(p.CONTENT in e.value){const u={...e.value,[p.CONTENT]:[].concat(e.value[p.CONTENT]).join(`
`)};t.fsItem=e.fsItem,t.value=u}else throw new Error("Can't read file content")}async function E(){var u;const e=[];await((u=a.modules.parser)==null?void 0:u.parseBasic(t.value[p.CONTENT].split(/\n/),async(s,i)=>{const m=await a.executeCommand(s,i);return i.message&&(Array.isArray(i.message)?e.push(...i.message):e.push(i.message)),m})),t.output=e.map(s=>T(s))}}),k={class:"wb-disks-extras13-web-basic"},$=K({__name:"WebBasic",props:{model:{}},emits:["refresh","update:value"],setup(a,{emit:t}){const v=R(null),l=t,r=a,{core:d}=y(),{setContextMenu:w,preserveContextMenu:E,parentFocused:e}=F();w(H,{model:r.model}),E();const u=g(()=>r.model.value.content),s=g(()=>{var o;return!!((o=d.value)!=null&&o.config.observable[I.WEB_BASIC_SHOW_PREVIEW])});_(()=>r.model.value,()=>{O()}),_(()=>u.value,o=>{o&&(l("update:value",{...r.model.value,content:o}),C(()=>{var c;(c=v.value)==null||c.resetSelection(),l("refresh",{scroll:!0})}))}),_(()=>s.value,o=>{var c;(c=r.model.actions)==null||c.togglePreview(o)}),A(()=>{s.value&&C(()=>{var o;(o=r.model.actions)==null||o.togglePreview()})});function i(o){l("update:value",{...r.model.value,content:o})}function m(){O()}function O(){C(()=>{l("refresh",{scroll:!0})})}return(o,c)=>(V(),P("div",k,[D(S,{ref:"input","override-focused":M(e)||!1,"model-value":o.model.value.content,"onUpdate:modelValue":i,onRefresh:m},null,8,["override-focused","model-value"])]))}}),Ae=Y($,[["__scopeId","data-v-5c2d6b8b"]]);export{Ae as default};
