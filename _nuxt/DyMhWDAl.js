import{z as H,d as f,c as L,t as v}from"./BtIHGerc.js";import{_ as w,t as r,v as o,x as l,$ as d,F as h,a1 as y,ac as k,Y as T}from"./uxbH2UW2.js";import{o as M,c as g,S as C,f as E}from"./BxO05Tpb.js";import{f as b}from"./CyGzEvzg.js";import{b as K}from"./qrnS2E05.js";function _(i,t){return t===void 0&&(t=K),M(function(u,c){var n=null,e=null,s=null,m=function(){if(n){n.unsubscribe(),n=null;var a=e;e=null,c.next(a)}};function S(){var a=s+i,p=t.now();if(p<a){n=this.schedule(void 0,a-p),c.add(n);return}m()}u.subscribe(g(c,function(a){e=a,s=t.now(),n||(n=t.schedule(S,i),c.add(n))},function(){m(),c.complete()},void 0,function(){e=n=null}))})}const A={props:{rootElement:{type:HTMLElement,default(){return null}},options:{type:Object,default(){return{focused:!1}}},readonly:{type:Boolean,required:!1,default:!1},multiline:{type:Boolean,required:!1,default:!0},name:{type:String,default:"value"},model:{type:Object,required:!1,default(){return{value:"Input Value"}}}},emits:["input","refresh","keydown","keyup","enter"],data(){return{escapeHtml:H,selectionLength:null,selectionStart:null,selectionEnd:null,controlShiftActive:!1,controlCapsLockActive:!1,focusedSubscriptions:new C,refreshFrame:null}},computed:{focused(){return this.options.focused},value:{get(){return this.model[this.name]},set(i){this.model[this.name]=i}},styleClasses(){return{readonly:this.readonly,multiline:this.multiline,"selection-empty":!this.selectionLength,focused:this.focused,"shift-active":this.controlShiftActive,"caps-lock-active":this.controlCapsLockActive}}},watch:{focused(i){i?(this.focusedSubscriptions.add(f.get("click").pipe(E(({target:t})=>!L(t,this.rootElement||this.$parent.$el)),b()).subscribe(this.blur.bind(this)),f.get("keypress").subscribe((function(){var t;(t=this.$refs.input)==null||t.focus()}).bind(this)),f.get("keydown").subscribe(({keyCode:t})=>{switch(t){case 16:this.controlShiftActive=!0;break;case 20:this.controlCapsLockActive=!this.controlCapsLockActive;break}}),f.get("keyup").subscribe(({keyCode:t})=>{switch(t){case 16:this.controlShiftActive=!1;break}this.$emit("keyup",t)})),this.$refs.input.focus()):(this.focusedSubscriptions.unsubscribe(),this.$refs.input.blur())}},unmounted(){window.cancelAnimationFrame(this.refreshFrame),this.focusedSubscriptions.unsubscribe()},mounted(){this.$refs.input.setSelectionRange(this.value.length,this.value.length),this.refresh(),this.focused&&this.$refs.input.focus()},methods:{focus(){this.setFocus(!0)},blur(){this.setFocus(!1)},resetSelection(){const i=this.$refs.input;this.selectionStart=i.selectionStart=0,this.selectionEnd=i.selectionEnd=0,this.selectionLength=0},refresh(){const i=this.$refs.input;this.selectionStart=i.selectionStart,this.selectionEnd=i.selectionEnd,this.selectionLength=this.selectionEnd-this.selectionStart,this.$emit("refresh")},setFocus(i){this.options.focused=i},onPointerDown(){const i=f.pointerMove.pipe(_(128)).subscribe(t=>{v(t),this.refresh()});f.pointerUp.pipe(b()).subscribe(t=>{v(t),i.unsubscribe()})},onInput(){this.refresh(),this.$emit("input")},onClick(){this.focused?this.refresh():this.setFocus(!0)},onKeydown(i){!this.multiline&&i.keyCode===13?(i.preventDefault(),i.stopPropagation(),this.$emit("enter",this.model[this.name]),this.refresh()):(this.$emit("keydown",i),this.refresh())},onKeyup(i){this.$emit("keyup",i.keyCode),this.refresh()}}},F={class:"result"},I=["innerHTML"],x=["innerHTML"],P=["innerHTML"],D=["innerHTML"],V=["innerHTML"],B=["innerHTML"],q=["innerHTML"],O=["innerHTML"],U={key:1,class:"selected"},j=["innerHTML"],z=["innerHTML"],N={class:"input"},R=["readonly"],W=["readonly"];function Y(i,t,u,c,n,e){return r(),o("div",{class:T(["wb-env-atom-input-text",e.styleClasses])},[l("div",null,[l("div",F,[e.value.length>0&&n.selectionEnd>0?(r(),o(d,{key:0},[n.selectionStart>=0&&n.selectionEnd===e.value.length?(r(),o(d,{key:0},[l("span",{innerHTML:n.escapeHtml(e.value.slice(0,n.selectionStart))},null,8,I),l("span",{class:"selected",innerHTML:n.escapeHtml(e.value.slice(n.selectionStart,n.selectionEnd+1))||" "},null,8,x)],64)):n.selectionStart&&n.selectionStart===n.selectionEnd?(r(),o(d,{key:1},[l("span",{innerHTML:n.escapeHtml(e.value.slice(0,n.selectionStart))},null,8,P),l("span",{class:"selected",innerHTML:n.escapeHtml(e.value.slice(n.selectionStart,n.selectionStart+1))||" "},null,8,D),l("span",{innerHTML:n.escapeHtml(e.value.slice(n.selectionStart+1,e.value.length))},null,8,V)],64)):(r(),o(d,{key:2},[l("span",{innerHTML:n.escapeHtml(e.value.slice(0,n.selectionStart))},null,8,B),l("span",{class:"selected",innerHTML:n.escapeHtml(e.value.slice(n.selectionStart,n.selectionEnd))},null,8,q),l("span",{innerHTML:n.escapeHtml(e.value.slice(n.selectionEnd,e.value.length))},null,8,O)],64))],64)):h("",!0),!n.selectionStart&&e.value===""?(r(),o("span",U," ")):e.value.length>0&&!n.selectionStart&&n.selectionStart===n.selectionEnd?(r(),o(d,{key:2},[l("span",{class:"selected",innerHTML:n.escapeHtml(e.value.slice(0,1))},null,8,j),l("span",{innerHTML:n.escapeHtml(e.value.slice(1,e.value.length))},null,8,z)],64)):h("",!0)]),l("div",N,[u.multiline?y((r(),o("textarea",{key:0,ref:"input","onUpdate:modelValue":t[0]||(t[0]=s=>e.value=s),readonly:u.readonly,onPointerdown:t[1]||(t[1]=(...s)=>e.onPointerDown&&e.onPointerDown(...s)),onInput:t[2]||(t[2]=(...s)=>e.onInput&&e.onInput(...s)),onClick:t[3]||(t[3]=(...s)=>e.onClick&&e.onClick(...s)),onKeydown:t[4]||(t[4]=(...s)=>e.onKeydown&&e.onKeydown(...s)),onKeyup:t[5]||(t[5]=(...s)=>e.onKeyup&&e.onKeyup(...s)),onFocus:t[6]||(t[6]=(...s)=>e.onClick&&e.onClick(...s))},null,40,R)),[[k,e.value]]):h("",!0),u.multiline?h("",!0):y((r(),o("input",{key:1,ref:"input","onUpdate:modelValue":t[7]||(t[7]=s=>e.value=s),type:"text",readonly:u.readonly,onPointerdown:t[8]||(t[8]=(...s)=>e.onPointerDown&&e.onPointerDown(...s)),onInput:t[9]||(t[9]=(...s)=>e.onInput&&e.onInput(...s)),onClick:t[10]||(t[10]=(...s)=>e.onClick&&e.onClick(...s)),onKeydown:t[11]||(t[11]=(...s)=>e.onKeydown&&e.onKeydown(...s)),onKeyup:t[12]||(t[12]=(...s)=>e.onKeyup&&e.onKeyup(...s)),onFocus:t[13]||(t[13]=(...s)=>e.onClick&&e.onClick(...s))},null,40,W)),[[k,e.value]])])])],2)}const $=w(A,[["render",Y],["__scopeId","data-v-9da5d603"]]);export{$ as A};
