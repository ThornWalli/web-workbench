import{d as j,r as b,j as A,$ as P,o as G,V as Y,t as d,x as o,F as E,Y as M,D as r,a2 as K,ac as O,X as z,v as f,a9 as W,_ as X}from"./CSrBrIb-.js";import{e as c}from"./BZctIkfj.js";import{d as H,K as k,c as J}from"./CI-V28mB.js";import{S as R}from"./2o4skMhU.js";import{c as Q,f as Z}from"./DNGU8wv-.js";import{f as U}from"./CkllZCFh.js";import{a as ee}from"./SdfA2v9k.js";import{o as ne}from"./CNtMeql4.js";function le(p,m){return m===void 0&&(m=ee),ne(function(S,s){var l=null,i=null,v=null,L=function(){if(l){l.unsubscribe(),l=null;var a=i;i=null,s.next(a)}};function t(){var a=v+p,y=m.now();if(y<a){l=this.schedule(void 0,a-y),s.add(l);return}L()}S.subscribe(Q(s,function(a){i=a,v=m.now(),l||(l=m.schedule(t,p),s.add(l))},function(){L(),s.complete()},void 0,function(){i=l=null}))})}const te={class:"result"},ae=["innerHTML"],ue=["innerHTML"],se=["innerHTML"],oe=["innerHTML"],ie=["innerHTML"],re=["innerHTML"],ce=["innerHTML"],ve=["innerHTML"],de={key:1,class:"selected"},fe=["innerHTML"],pe=["innerHTML"],me={class:"input"},ye=["readonly"],_e=["readonly"],Te=j({__name:"InputText",props:{rootElement:{type:HTMLElement,default(){return null}},overrideFocused:{type:Boolean,default:!1},readonly:{type:Boolean,required:!1,default:!1},multiline:{type:Boolean,required:!1,default:!0},name:{type:String,default:"value"},modelValue:{type:String,default:void 0},model:{type:Object,required:!1,default(){return{value:"Input Value"}}}},emits:["blur","refresh","input","update:model-value","enter","keydown","keyup"],setup(p,{expose:m,emit:S}){const s=p,l=S,i=b(null),v=b(s.overrideFocused),L=b(0),t=b(0),a=b(0),y=b(!1),w=b(!1);let _=new R;const n=A({get(){return s.modelValue||""},set(e){l("update:model-value",e)}}),q=A(()=>({readonly:s.readonly,multiline:s.multiline,"selection-empty":!L.value,focused:v.value,"shift-active":y.value,"caps-lock-active":w.value}));P(()=>s.overrideFocused,e=>{v.value=e}),P(()=>v.value,e=>{e?F():I()}),G(()=>{var e;(e=i.value)==null||e.setSelectionRange(n.value.length,n.value.length),T(),v.value&&F()}),Y(()=>{_.unsubscribe()});function F(){var e;_.add(H.pointerDown.pipe(Z(({target:u})=>{var D;const h=W(),$=s.rootElement||((D=h==null?void 0:h.parent)==null?void 0:D.vnode.el);return!J(u,$)}),U()).subscribe(I)),_.add(H.keyPress.subscribe(()=>{var u;(u=i.value)==null||u.focus()})),_.add(H.keyDown.subscribe(({code:u})=>{switch(u){case k.SHIFT_LEFT:case k.SHIFT_RIGHT:y.value=!0;break;case k.CAPS_LOCK:w.value=!w.value;break}})),_.add(H.keyUp.subscribe(u=>{switch(u.code){case k.SHIFT_LEFT:case k.SHIFT_RIGHT:y.value=!1;break}l("keyup",u)})),(e=i.value)==null||e.focus()}function I(){var e;_.unsubscribe(),_=new R,(e=i.value)==null||e.blur(),l("blur")}function T(){const e=i.value;e&&(t.value=e.selectionStart||0,a.value=e.selectionEnd||0,L.value=a.value-t.value,l("refresh"))}function N(e){v.value=e}function x(){const e=H.pointerMove.pipe(le(128)).subscribe(()=>{T()});H.pointerUp.pipe(U()).subscribe(()=>{e.unsubscribe()})}function C(){T(),l("input")}function g(){v.value?T():N(!0)}function V(e){!s.multiline&&e.code===k.ENTER?(e.preventDefault(),e.stopPropagation(),l("enter",n.value),T()):(l("keydown",e),T())}function B(e){l("keyup",e),T()}return m({controlShiftActive:y,controlCapsLockActive:w}),(e,u)=>(f(),d("div",{class:z(["wb-env-atom-input-text",q.value])},[o("div",null,[o("div",te,[n.value.length>0&&a.value>0?(f(),d(M,{key:0},[t.value>=0&&a.value===n.value.length?(f(),d(M,{key:0},[o("span",{innerHTML:r(c)(n.value.slice(0,t.value))},null,8,ae),o("span",{class:"selected",innerHTML:r(c)(n.value.slice(t.value,a.value+1))||" "},null,8,ue)],64)):t.value&&t.value===a.value?(f(),d(M,{key:1},[o("span",{innerHTML:r(c)(n.value.slice(0,t.value))},null,8,se),o("span",{class:"selected",innerHTML:r(c)(n.value.slice(t.value,t.value+1))||" "},null,8,oe),o("span",{innerHTML:r(c)(n.value.slice(t.value+1,n.value.length))},null,8,ie)],64)):(f(),d(M,{key:2},[o("span",{innerHTML:r(c)(n.value.slice(0,t.value))},null,8,re),o("span",{class:"selected",innerHTML:r(c)(n.value.slice(t.value,a.value))},null,8,ce),o("span",{innerHTML:r(c)(n.value.slice(a.value,n.value.length))},null,8,ve)],64))],64)):E("",!0),!t.value&&n.value===""?(f(),d("span",de," ")):n.value.length>0&&!t.value&&t.value===a.value?(f(),d(M,{key:2},[o("span",{class:"selected",innerHTML:r(c)(n.value.slice(0,1))},null,8,fe),o("span",{innerHTML:r(c)(n.value.slice(1,n.value.length))},null,8,pe)],64)):E("",!0)]),o("div",me,[p.multiline?K((f(),d("textarea",{key:0,ref_key:"inputEl",ref:i,"onUpdate:modelValue":u[0]||(u[0]=h=>n.value=h),readonly:p.readonly,onPointerdown:x,onInput:C,onClick:g,onKeydown:V,onKeyup:B,onFocus:g},null,40,ye)),[[O,n.value]]):E("",!0),p.multiline?E("",!0):K((f(),d("input",{key:1,ref_key:"inputEl",ref:i,"onUpdate:modelValue":u[1]||(u[1]=h=>n.value=h),type:"text",readonly:p.readonly,onPointerdown:x,onInput:C,onClick:g,onKeydown:V,onKeyup:B,onFocus:g},null,40,_e)),[[O,n.value]])])])],2))}}),Ee=X(Te,[["__scopeId","data-v-6ab93f2f"]]);export{Ee as A};
