var b=Object.defineProperty;var j=(t,e,s)=>e in t?b(t,e,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[e]=s;var n=(t,e,s)=>j(t,typeof e!="symbol"?e+"":e,s);import{v as W}from"./C6aID195.js";import{r as x,j as h,$ as L,o as K,a0 as S,V as X,R as y,D as g}from"./CSrBrIb-.js";function q(t){return e=>t(e)}var M=(t=>(t[t.DEFAULT=0]="DEFAULT",t[t.SEPARATOR=1]="SEPARATOR",t[t.SPACER=2]="SPACER",t[t.TEXT=3]="TEXT",t[t.CHECKBOX=4]="CHECKBOX",t[t.RADIO=5]="RADIO",t[t.UPLOAD=6]="UPLOAD",t))(M||{});class F{constructor({type:e=0,model:s,options:d,action:m,command:w,url:c,order:f=-1,title:r,text:i,items:v=[],name:l,value:a,hotKey:A,keyCode:p,onInit:C}){n(this,"id");n(this,"type");n(this,"model");n(this,"name");n(this,"value");n(this,"url");n(this,"action");n(this,"command");n(this,"hotKey");n(this,"keyCode");n(this,"order");n(this,"title");n(this,"text");n(this,"items");n(this,"options",{disabled:!1,checked:!1});this.id=W(),this.type=e,this.model=s||this.model,this.options=Object.assign(d||{},this.options,Object.assign({},d)),e===5&&(this.options.checked=this.options.checked?!!a:!1),this.action=m,this.command=w,this.url=c,this.name=l,this.value=a,this.order=f,this.title=r,this.text=i,this.items=k(v),this.hotKey=A,this.keyCode=p,C&&C(this)}getValue(){if(this.model&&this.name)return this.model[this.name];throw new Error("Model or name is not defined")}setValue(e){if(this.model&&this.name)this.model[this.name]=e;else throw new Error("Model or name is not defined")}}function k(t){return t.map(e=>e instanceof F?e:new F(e))}class R{constructor(e,s){n(this,"id",W());n(this,"items",[]);e&&s&&(this.items=k(e(s)))}add(e){e instanceof R&&this.items.push(...e.items)}}function z(){const t=x(!1),e=y("core"),s=y("window"),d=y("window:refresh"),m=h(()=>s.value.id),w=h(()=>s.value.layout),c=h(()=>s.value.options.focused||!1),f=h(()=>s.value.parentWindow),r=x(),i=x(),v=h(()=>s.value.options.embed),l=x(!1),a=(o=!0)=>{l.value=o},A=(o,u={})=>{i.value=new R(o,{core:e,mainWindow:g(s),parentWindow:g(f),preserveContextMenu:a,...u})},p=o=>{var u,O,D;i.value&&(o?r.value=(u=e.modules.windows)==null?void 0:u.setActiveContextMenu(i.value):!l.value&&((O=e.modules.windows)==null?void 0:O.getActiveContextMenu())===r.value&&!v.value&&((D=e.modules.windows)==null||D.setActiveContextMenu(null)))};L(c,o=>p(o)),L(i,o=>{var u;r.value=(u=e.modules.windows)==null?void 0:u.setActiveContextMenu(o)}),K(()=>{S(()=>{t.value=!0,p(!0)})}),X(()=>{var o,u;i.value&&((o=e.modules.windows)!=null&&o.isContextMenu(r.value))&&((u=e.modules.windows)==null||u.setActiveContextMenu(null))});const C=h(()=>t.value);return new V({isReady:C,id:m,parentFocused:c,parentLayout:w,core:e,window:s,setContextMenu:A,preserveContextMenu:a,contextMenu:i,currentContextMenu:r,refresh:d})}class V{constructor(e){n(this,"isReady");n(this,"id");n(this,"parentFocused");n(this,"parentLayout");n(this,"core");n(this,"window");n(this,"setContextMenu");n(this,"preserveContextMenu");n(this,"contextMenu");n(this,"currentContextMenu");n(this,"refresh");const{isReady:s,id:d,parentFocused:m,parentLayout:w,core:c,window:f,setContextMenu:r,preserveContextMenu:i,contextMenu:v,currentContextMenu:l,refresh:a}=e;this.isReady=s,this.id=d,this.parentFocused=m,this.parentLayout=w,this.core=c,this.window=f,this.setContextMenu=r,this.preserveContextMenu=i,this.contextMenu=v,this.currentContextMenu=l,this.refresh=a}}export{R as C,M,q as d,k as g,z as u};
