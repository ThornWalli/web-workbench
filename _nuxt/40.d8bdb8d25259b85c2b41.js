(window.webpackJsonp=window.webpackJsonp||[]).push([[40],{425:function(n,t,e){"use strict";e.r(t),function(n){e.d(t,"default",(function(){return v}));var o,r=e(121),c=e(122),l=(e(272),e(8),e(19),e(273),e(274),e(275),e(276),e(277),e(278),e(279),e(280),e(281),e(282),e(283),e(284),e(285),e(22),e(26),e(38),e(65),e(256)),h=e(267),v=function(){function n(t){Object(r.a)(this,n),this.subscriptions=[],this.displaySubscriptions=new Map,this.runSubscriptions=[],this._app=t,this._pressed=!1}return Object(c.a)(n,[{key:"registerDisplay",value:function(n){this.displaySubscriptions.set(n,[h.a.get("mousedown",n.canvas).subscribe(this.onPointerDown(n).bind(this)),h.a.get("mouseenter",n.canvas).subscribe(this.onPointerEnter(n).bind(this))])}},{key:"unregisterDisplay",value:function(n){this.displaySubscriptions.has(n)&&(this.displaySubscriptions.get(n).forEach((function(n){return n.unsubscribe()})),this.displaySubscriptions.delete(n))}},{key:"register",value:function(){}},{key:"unregister",value:function(){}},{key:"onContextMenu",value:function(n){var t=this;return function(e){t.runActionResult(P.bind(t)(e,n))}}},{key:"onPointerEnter",value:function(n){var t=this;return function(e){t.app.setDisplay(n);var o=h.a.get("mouseleave",e.target).subscribe((function(e){o.unsubscribe(),t.onPointerLeave(n)(e)}))}}},{key:"onPointerLeave",value:function(n){return function(n){}}},{key:"onPointerDown",value:function(n){var t=this;return function(e){t.app.setDisplay(n),t._pointerEvent=f.bind(t)(e,n),t._pressed=!0,t.runActionResult(y.bind(t)(e,n),e,n),t.app.display.renderCanvas()}}},{key:"onPointerLeaveAndUp",value:function(n){var t=this;return function(e){d(),t.runActionResult(k.bind(t)(e,n))}}},{key:"onPointerMove",value:function(n){var t=this;return function(e){t.runActionResult(m.bind(t)(e,n))}}},{key:"app",get:function(){return this._app}},{key:"pressed",get:function(){return this._pressed}},{key:"runActionResult",value:function(n,t,e){n&&(n.events&&(this.runSubscriptions=[h.a.get("contextmenu",t.target).subscribe(this.onContextMenu(e).bind(this)),h.a.get("mouseleave",t.target).subscribe(this.onPointerLeaveAndUp(e).bind(this)),h.a.get("mousemove",t.target).subscribe(this.onPointerMove(e).bind(this)),h.a.get("mouseup",t.target).subscribe(this.onPointerLeaveAndUp(e).bind(this))]),n.save&&this.app.canvas.saveStack(),n.revert&&this.app.canvas.revertStack(),n.render&&this.app.canvas.render())}},{key:"unsubscribeRun",value:function(){this.runSubscriptions.filter((function(n){return!n.unsubscribe()}))}}]),n}();function d(){n.clearInterval(o),o=null}function f(n,t){var e=this,o=t.canvasLayout,r=Object(l.e)(n.clientX-t.bounds.min.x,n.clientY-t.bounds.min.y),c=Object(l.e)((function(){return r-o.position}));this.app.globalBounds&&(console.log(this.app.globalBounds.min.toString()),r=Object(l.e)((function(){return r-e.app.globalBounds.min})),c=Object(l.e)((function(){return c-e.app.globalBounds.min})));var v=Object(l.e)((function(){return Math.round(c)})),d=Object(l.e)((function(){return Math.round(c/t.zoomFactor+t.zoomBounds.min)}));return{position:d,origin:v,app:this.app,x:d.x,y:d.y,originX:v.x,originY:v.y,leftClick:2!==n.button,rightClick:2===n.button,holdAlt:h.a.altActive,holdCtrl:h.a.cmdActive}}function y(){var t,e=this,r={events:!0};return this.app.tool.pointerDownHold?(t=function(){e.runActionResult(e.app.tool.onPointerDown(e._pointerEvent,e)),e.app.canvas.render()},d(),o=n.setInterval(t,20),r):Object.assign(r,this.app.tool.onPointerDown(this._pointerEvent,this))}function k(n,t){return this._pressed=!1,this._pointerEvent=null,this.unsubscribeRun(),this.app.tool.onPointerUp(f.bind(this)(n,t),this)}function m(n,t){return this._pointerEvent=f.bind(this)(n,t),this.app.tool.onPointerMove(this._pointerEvent,this)}function P(n,t){return n.preventDefault(),n.stopPropagation(),this.app.tool.onContextMenu(f.bind(this)(n,t),this)}}.call(this,e(36))}}]);