import{W as e}from"./Caob76XJ.js";import{a,N as s}from"./Ci-h6nfG.js";import{N as t}from"./G8w6tKzW.js";import{r as n}from"./BteAwo4N.js";import{d as r,r as o,k as i,o as l,a1 as m,y as d,z as c,X as u,Y as h,I as f,_ as v,A as C,C as p,G as w}from"./BfpYGSxR.js";import"./BHmTNEz3.js";import"./B-meQdOw.js";import"./CybH7Zs2.js";import"./D1WZfvAb.js";import"./jSR9Z_uS.js";import"./BKiSbNd3.js";import"./C98WWl5r.js";import"./BVLmgizW.js";const y=["data-key"],g=["width","height"],j=v(r({__name:"NoteCanvas",props:{density:{type:Number,default:()=>window.devicePixelRatio||1},notes:{type:Array,default:()=>[[["C#","2m"],["C#2","2m"],["C#2","2m."],["C#","1m"],["C#2","1m"],["C#2","1m."],["C#","2n."],["C#2","2n"],["C#2","2n."],["C#2","4n."]],[["","2m"],["","1m"],["","2n"],["","4n"],["","8n"],["","16n"],["","32n"]],[["C4","2m"],["C4","1m"],["C4","2n"],["C4","4n"],["C4","8n"],["C4","16n"],["C4","32n"]],[["C4","2m."],["C4","1m."],["C4","2n."],["C4","4n."],["C4","8n."],["C4","16n."],["C4","32n."]]]}},emits:["refresh"],setup(e,{emit:r}){const v=o(),C=r,p=o(),w=o(),j=e,N=i(()=>j.notes.flat().map(([e,a])=>new t({note:e,time:a}))),_=i(()=>p.value?N.value:[]);l(()=>{const e=(new DOMParser).parseFromString(a,"image/svg+xml").querySelector("svg");if(!e)throw new Error("SVG node not found");window.svgNode=w.value=e,p.value=new s({svgNode:w.value}),m(async()=>{var e;const a=Array.from((null==(e=v.value)?void 0:e.querySelectorAll("canvas"))||[]);await Promise.all(a.map((e,a)=>render(e,N.value[Number(a)]))),C("refresh")})});const render=async(e,a)=>{var s;const t=e.getContext("2d");if(!t)throw new Error("Canvas context not found");t.clearRect(0,0,e.width,e.height);const r=await(null==(s=p.value)?void 0:s.render(a,{colors:{primary:"#ffffff",secondary:"#000000",tertiary:"#ff0000"}}));e.width=r.canvas.width*j.density,e.height=r.canvas.height*j.density,e.style=`width: ${r.canvas.width}px; height: ${r.canvas.height}px;`;const o=n(r.canvas,e.width);t.drawImage(o,0,0)};return(e,a)=>(c(),d("ul",{ref_key:"rootEl",ref:v},[(c(!0),d(u,null,h(_.value,e=>(c(),d("li",{key:e.name,"data-key":e.name},[p.value?(c(),d("canvas",{key:0,width:p.value.dimension.x,height:p.value.dimension.y},null,8,g)):f("",!0)],8,y))),128))],512))}}),[["__scopeId","data-v-62b4303f"]]),N={class:"wb-disks-extras13-synthesizer-debug-notes"},_=v(r({__name:"Notes",emits:["refresh"],setup(a,{emit:t}){const n=t,r=new s;return l(()=>{console.log("DEBUG",{noteRenderer:r}),m(()=>{n("refresh")})}),(a,s)=>(c(),d("div",N,[C("fieldset",null,[s[2]||(s[2]=C("legend",null,"Note Cache",-1)),p(e,{label:`Clear Cache (${w(r).cache.size} Bitmaps)`,onClick:s[0]||(s[0]=e=>w(r).cache.clear())},null,8,["label"])]),C("fieldset",null,[s[3]||(s[3]=C("legend",null,"Notes",-1)),p(j,{onRefresh:s[1]||(s[1]=e=>n("refresh"))})])]))}}),[["__scopeId","data-v-d2cc321d"]]);export{_ as default};
