var D=Object.defineProperty;var k=(a,t,e)=>t in a?D(a,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):a[t]=e;var p=(a,t,e)=>(k(a,typeof t!="symbol"?t+"":t,e),e);import{b as O,V as v,P,D as B,c as A,C as y,r as w,d as q,e as j,f as K,h as L,a as Y,s as H}from"./index.e13bb504.js";import{E as b,_ as I,f as N,k as d,l as m,q as z,W as C,o as F,m as S,t as E,L as h,P as V,a5 as x,N as g,O as T,z as U,I as Z,C as W}from"./entry.6790753e.js";import{Q as X,j as G,k as J,u as Q,q as l,ad as $}from"./index.34d90011.js";class wt{constructor(t,e){p(this,"track");p(this,"playing",!1);p(this,"noteIndex",-1);p(this,"currentSequence");p(this,"instrument");p(this,"autoplay");const{autoplay:s}=e||{};this.track=t,this.autoplay=s!==void 0?s:!0}refresh(){const t=O(this.track.notes);return this.createSequence(t,()=>{this.clearSequence(),this.playing=!1}),t}play(t){var s;if(!this.instrument)throw new Error("TrackPlayer requires an instrument");const e=this.refresh(t);if(e.length-1===this.noteIndex&&(this.noteIndex=-1),this.autoplay){const o=this.instrument.context.transport;o.stop(),o.seconds=t>-1&&((s=e[t+1])==null?void 0:s.time)||0,o.start(),this.currentSequence.start(0),this.playing=!0}return this.currentSequence}pause(){this.instrument.context.transport.pause(),this.playing=!1}stop(){this.clearSequence(),this.playing=!1,this.noteIndex=-1}restart(){this.stop(),this.play()}reset(){this.clearSequence(),this.stop(),this.track.notes=[]}destroy(){var t;(t=this.instrument)==null||t.dispose(),this.clearSequence()}createInstrument(t){var n;(n=this.instrument)==null||n.dispose();const e=A[String(t)],s=new v(-100).toDestination(),o=new e().connect(s).toDestination();this.instrument=b(o),console.log(" this.instrument",this.instrument)}createSequence(t,e){var s;if(!this.currentSequence){(s=this.currentSequence)==null||s.dispose();let o;this.currentSequence=b(new P((n,{name:r,time:_,velocity:f})=>{if(r)try{this.instrument.triggerAttackRelease(r,`${this.track.noteCount}n`,n,f),o={name:r,time:n}}catch{console.log(o)}B.schedule(()=>{this.noteIndex++},n),this.noteIndex===t.length-1&&e&&e()},t))}}clearSequence(){var t;(t=this.currentSequence)==null||t.dispose(),this.currentSequence=null}}const M={components:{AtomMarkdown:X},props:{...G,model:{type:Object,required:!0}},emits:[...J],setup(a,t){return{windowContext:Q(a,t)}},data(){return{content:["# Synthesizer","Simple synthesizer with notes view.","",`Version: **0.1**  
Created by **Thorn-Welf Walli**`,"","Thanks to [Tone.js](https://tonejs.github.io/)"].join(`
`)}}},tt={class:"wb-disks-debug-synthesizer-info"};function et(a,t,e,s,o,n){const r=N("atom-markdown");return d(),m("div",tt,[z(r,{content:o.content},null,8,["content"])])}const st=I(M,[["render",et],["__scopeId","data-v-6b58070e"]]),bt=({core:a,mainWindow:t,parentWindow:e,preserveContextMenu:s,model:o,trackModel:n})=>{const{windows:r}=a.modules;function _(){return(e||t).close()}const f=o[y.SYNTHESIZER_PROJECT],c=n&&n[y.SYNTHESIZER_TRACK];return[{title:"Synthesizer",items:[{hotKey:"I",keyCode:73,title:"Info",async action(){s(!0),await r.addWindow({title:"Info",component:st,componentData:{model:o},options:{prompt:!1,scaleX:!1,scaleY:!1,scrollX:!1,scrollY:!1}},{group:"extras13Synthesizer"}).awaitClose(),s(!1),t.focus()}},{type:l.SEPARATOR},{title:"Debug",hotKey:"D",async action(){s(!0);const{window:i}=o.actions.openDebug();await i.awaitClose(),s(!1),t.focus()}},{type:l.SEPARATOR},{title:"Close",action:_}]},...n?[]:[{title:"Project",items:[{title:"New…",action:async()=>{s(!0),await o.actions.newProject(),s(!1),t.focus()}},{title:"Edit Name…",action:async()=>{s(!0);const i=await w(a,"Project renaming:",f.name);i&&(f.name=i),s(!1),t.focus()}}]},{title:"Track",items:[{title:"New…",action:async()=>{s(!0),await o.actions.newTrack(),s(!1),t.focus()}},{type:l.SEPARATOR},{title:"Clear",async action(){s(!0),await o.actions.clearTracks(),s(!1),t.focus()}}]}],{title:"Options",items:[{type:l.DEFAULT,title:`BPM (${o[y.SYNTHESIZER_BPM]})`,items:[30,60,120,240,480].map(i=>({type:l.RADIO,title:String(i),model:o,name:y.SYNTHESIZER_BPM,value:i}))}]},...n&&[{title:"Track Options",items:[{type:l.CHECKBOX,title:"Show Note Labels",name:y.SYNTHESIZER_TRACK_SHOW_NOTE_LABELS,model:n},{type:l.CHECKBOX,title:"Show Keyboard",name:y.SYNTHESIZER_TRACK_SHOW_KEYBOARD,model:n},{type:l.DEFAULT,title:"Keyboard Size",items:Object.entries(q()).map(([i,u])=>({type:l.RADIO,title:u,model:n,name:y.SYNTHESIZER_TRACK_KEYBOARD_SIZE,value:i}))},{type:l.DEFAULT,title:"Keyboard Alignment",items:Object.entries(j()).map(([i,u])=>({type:l.RADIO,title:u,model:n,name:y.SYNTHESIZER_TRACK_KEYBOARD_ALIGNMENT,value:i}))},{type:l.SEPARATOR},{title:"Edit Name…",action:async()=>{s(!0);const i=await w(a,"Track renaming:",c.name);i&&(c.name=i,t.options.title=c.name),s(!1),t.focus()}},{type:l.DEFAULT,title:"Note Count",items:Object.entries(K()).map(([i,u])=>({type:l.RADIO,title:`${i} (${u})`,model:c,name:"noteCount",value:u}))},{type:l.DEFAULT,title:"Base Note",items:Object.entries(L()).map(([i,u])=>({type:l.RADIO,title:i,model:c,name:"baseNote",value:u}))},{type:l.SEPARATOR},{type:l.DEFAULT,title:"Beat Count",items:Array(9).fill({}).map((i,u)=>({type:l.RADIO,title:String(u+1),model:c,name:"beatCount",value:u+1}))}]}]||[],...$({core:a})].filter(Boolean)},nt=Symbol("pending"),at=Symbol("fulfilled"),it=Symbol("rejected");class ot{constructor(){this.promise=new Promise((t,e)=>{this.resolve=t,this.reject=e,this.state=nt}).then(t=>(this.state=at,t)).catch(t=>{throw this.state=it,new Error(t)})}}const R=new ot,lt=C({destination:null,transport:Y,ready:!1,awaitReady:R.promise,async start(){await H(),this.ready=!0,R.resolve()},setBpm(a,t){const e=this.tone.transport;e.stop(),e.bpm.value=120,e.seconds=0,t(),e.bpm.value=a,e.start()}});function gt(){return F(()=>{window.Tone=A}),{tone:lt}}const rt={props:{selected:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},text:{type:String,default:null},title:{type:String,default:""},name:{type:String,default:""},value:{type:[String,Number],default:void 0},model:{type:Object,default(){return{}}},action:{type:Function,default:null}},computed:{styleClasses(){return{selected:this.selected}}},methods:{onClick(a){typeof this.action=="function"&&Promise.resolve(this.action(a)).catch(t=>{throw t})},onInput(){typeof this.action=="function"&&Promise.resolve(this.action(this.model[this.name])).catch(a=>{throw a})}}},ct=["disabled"],ut=["disabled","value","type"],dt=["disabled"];function mt(a,t,e,s,o,n){return e.text?(d(),m("div",{key:0,class:h(n.styleClasses)},[S("span",null,E(e.text),1)],2)):e.name?(d(),m("label",{key:1,class:h(n.styleClasses),disabled:e.disabled?!0:void 0},[V(S("input",{"onUpdate:modelValue":t[0]||(t[0]=r=>e.model[e.name]=r),disabled:e.disabled?!0:void 0,value:e.value,type:e.value===void 0?"checkbox":"radio",onInput:t[1]||(t[1]=(...r)=>n.onInput&&n.onInput(...r))},null,40,ut),[[x,e.model[e.name]]]),S("span",null,E(e.title),1)],10,ct)):(d(),m("button",{key:2,class:h(n.styleClasses),disabled:e.disabled,onClick:t[2]||(t[2]=(...r)=>n.onClick&&n.onClick(...r))},[S("span",null,E(e.title),1)],10,dt))}const yt=I(rt,[["render",mt],["__scopeId","data-v-b9f1e088"]]);const pt=C({}),ft={components:{NavigationItem:yt},props:{direction:{type:String,default:"horizontal"},model:{type:Object,default(){return pt}},multline:{type:Boolean,default:!1},items:{type:Array,default(){return[{id:1,title:"Play"},{id:2,title:"Pause"},{id:2,title:"Stop"},{id:2,title:"Reset"},{id:1,title:"Item 1 R",value:"item-1",name:"test"},{id:2,title:"Item 2 R",value:"item-2",name:"test"},{id:2,title:"Item 3 R",value:"item-3",name:"test"},{id:2,title:"Item 4 R",value:"item-4",name:"test"},{id:1,title:"Item 1 C",name:"item1Value"},{id:2,title:"Item 2 C",name:"item2Value"},{id:2,title:"Item 3 C",name:"item3Value"},{id:2,title:"Item 4 C",name:"item4Value"}]}}},computed:{preparedItems(){return this.items.find(a=>Array.isArray(a))?this.items:[this.items]},styleClasses(){return{multline:this.multline,[`direction-${this.direction}`]:this.direction}}}};function ht(a,t,e,s,o,n){const r=N("navigation-item");return d(),m("div",{class:h(n.styleClasses)},[(d(!0),m(g,null,T(n.preparedItems,(_,f)=>(d(),m("ul",{key:f},[(d(!0),m(g,null,T(_,(c,i)=>(d(),m("li",{key:i,class:h({spacer:c.spacer,fill:c.fill})},[c.spacer?W("",!0):(d(),U(r,Z({key:0,model:e.model},c),null,16,["model"]))],2))),128))]))),128))],2)}const Tt=I(ft,[["render",ht],["__scopeId","data-v-2822fedf"]]);export{Tt as N,wt as T,bt as c,gt as u};
