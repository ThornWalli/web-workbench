import{j as k,k as v,u as f}from"./index.69ac9e5a.js";import{N as y,g as T,C as m,T as w,a as C}from"./index.01a5c491.js";import{N,c as g,u as x,T as P}from"./Navigation.905ae09b.js";import{T as j}from"./TimelineCanvas.dec8cd2e.js";import{_ as $,S as E,f as d,k as o,l as r,q as c,H as p,a3 as u,m as h,C as b,N as D,O as S}from"./entry.e14887ae.js";import"./index.56665add.js";import"./viewport.b344546e.js";import"./math.2df7af34.js";import"./async.59d11cc0.js";window.NoteDescription=y;const M={components:{Navigation:N,SynthesizerTimelineCanvas:j},props:{...k,model:{type:Object,default:T()}},emits:[...v,"refresh"],setup(t,e){const s=E(t,"model"),a=f(t,e);return a.setContextMenu(g,{model:s.value}),{...a,...x()}},data:function(){return{toneDestination:null}},computed:{project(){return this.model[m.SYNTHESIZER_PROJECT]},tracks:{get(){return this.project.tracks},set(t){this.project.tracks=t}},bpm(){return Number(this.model[m.SYNTHESIZER_BPM])},controlsNavigation(){return{model:this.model,items:[[{text:`Project: ${this.project.name} | Tracks: ${this.tracks.length}`}]]}}},watch:{bpm:{handler(t){const e=this.tone.transport;e.stop(),e.bpm.value=120,e.seconds=0,e.bpm.value=t,e.start()}}},mounted(){this.$nextTick(()=>{this.$emit("refresh")})},unmounted(){this.model.actions.closeTracks()},methods:{async onClickPlay(){await this.tone.start(),this.players=this.tracks.map(s=>{const a=new P(s,{autoplay:!1});return a.createInstrument("Synth"),a});const t=C;t.stop(),t.seconds=0,t.start(),this.players.map(s=>s.play()).map(s=>s.start(0))},getControls(t){const e=t.getDuration();return{items:[{text:t.name},{spacer:!0},{text:` ${e}`},{title:"Edit",onClick:async()=>{await this.tone.start(),this.editTrack(new w(t),{toneDestination:this.toneDestination})}},{title:"Remove",onClick:async()=>{this.preserveContextMenu(!0),await this.model.actions.removeTrack(t),this.preserveContextMenu(!1),this.$emit("refresh")}}]}},async editTrack(...t){const{close:e}=this.model.actions.editTrack(...t),s=await e;this.tracks=this.tracks.map(a=>a.id===s.id?s:a),this.$nextTick(()=>{this.$emit("refresh")})}}},R={class:"wb-disks-extras13-synthesizer-project"},z={class:"tracks"},I={key:0,class:"no-tracks"},B={class:"sheet"};function O(t,e,s,a,q,n){const l=d("navigation"),_=d("synthesizer-timeline-canvas");return o(),r("div",R,[c(l,p(u(n.controlsNavigation)),null,16),h("div",z,[n.tracks.length<1?(o(),r("div",I,"No tracks availableâ€¦")):b("",!0),(o(!0),r(D,null,S(n.tracks,i=>(o(),r("div",{key:i.id,class:"track"},[h("div",B,[c(_,{track:i,onRefresh:e[0]||(e[0]=H=>t.$emit("refresh"))},null,8,["track"])]),c(l,p(u(n.getControls(i))),null,16)]))),128))])])}const K=$(M,[["render",O],["__scopeId","data-v-0ddde545"]]);export{K as default};
