import{j as k,k as v,u as f}from"./index.eb95d3b6.js";import{N as y,g as T,C as m,T as g,a as w}from"./index.c407afae.js";import{N as C,c as N,u as x,T as P}from"./Navigation.bc026fba.js";import{T as j}from"./TimelineCanvas.fbba13c1.js";import{_ as $,S as E,f as d,k as a,l as r,q as c,H as u,a3 as p,m as h,C as D,N as S,O as M}from"./entry.211f2c5a.js";import"./index.56665add.js";import"./viewport.be0c4ff7.js";import"./math.2c224f08.js";import"./async.a8557e7e.js";window.NoteDescription=y;const R={components:{Navigation:C,SynthesizerTimelineCanvas:j},props:{...k,model:{type:Object,default:T()}},emits:[...v,"refresh"],setup(t,s){const e=E(t,"model"),n=f(t,s);return n.setContextMenu(N,{model:e.value}),{...n,...x()}},data:function(){return{toneDestination:null}},computed:{project(){return this.model[m.SYNTHESIZER_PROJECT]},tracks:{get(){return this.project.tracks},set(t){this.project.tracks=t}},bpm(){return Number(this.model[m.SYNTHESIZER_BPM])},controlsNavigation(){return{model:this.model,items:[[{text:`Project: ${this.project.name} | Tracks: ${this.tracks.length}`}]]}}},mounted(){this.$nextTick(()=>{this.$emit("refresh")})},unmounted(){this.model.actions.closeTracks()},methods:{async onClickPlay(){await this.tone.start(),this.players=this.tracks.map(e=>{const n=new P(e,{autoplay:!1});return n.createInstrument("Synth"),n});const t=w;t.stop(),t.seconds=0,t.start(),this.players.map(e=>e.play()).map(e=>e.start(0))},getControls(t){const s=t.getDuration();return{items:[{text:t.name},{spacer:!0},{text:` ${s}`},{title:"Edit",onClick:async()=>{await this.tone.start(),this.editTrack(new g(t),{toneDestination:this.toneDestination})}},{title:"Remove",onClick:async()=>{this.preserveContextMenu(!0),await this.model.actions.removeTrack(t),this.preserveContextMenu(!1),this.$emit("refresh")}}]}},async editTrack(...t){const{close:s}=this.model.actions.editTrack(...t),e=await s;console.log(e.notes),this.tracks=this.tracks.map(n=>n.id===e.id?e:n),this.$nextTick(()=>{this.$emit("refresh")})}}},b={class:"wb-disks-extras13-synthesizer-project"},z={class:"tracks"},I={key:0,class:"no-tracks"},B={class:"sheet"};function O(t,s,e,n,q,o){const l=d("navigation"),_=d("synthesizer-timeline-canvas");return a(),r("div",b,[c(l,u(p(o.controlsNavigation)),null,16),h("div",z,[o.tracks.length<1?(a(),r("div",I,"No tracks availableâ€¦")):D("",!0),(a(!0),r(S,null,M(o.tracks,i=>(a(),r("div",{key:i.id,class:"track"},[h("div",B,[c(_,{track:i,onRefresh:s[0]||(s[0]=H=>t.$emit("refresh"))},null,8,["track"])]),c(l,u(p(o.getControls(i))),null,16)]))),128))])])}const K=$(R,[["render",O],["__scopeId","data-v-12e623e8"]]);export{K as default};
