import{W as R}from"./C8ezGx9i.js";import{a as B,N}from"./CzBXAPyu.js";import{N as z}from"./BLIBATZL.js";import{g as S}from"./BG0OyHeb.js";import{d as _,r as C,j as g,o as x,a1 as $,t as m,v as d,Z as D,$ as V,F as A,_ as k,x as u,z as w,D as y}from"./DoVacF4u.js";import"./BGIFtisS.js";import"./D4lI5vpz.js";import"./CzhYkgbF.js";import"./ByT9DFw9.js";import"./W_y6kICn.js";import"./DoGjLmTD.js";import"./C5mdboMC.js";import"./CNkvSXuu.js";const F=["data-key"],I=["width","height"],P=_({__name:"NoteCanvas",props:{density:{type:Number,default(){return window.devicePixelRatio||1}},notes:{type:Array,default:()=>[[["C#","2m"],["C#2","2m"],["C#2","2m."],["C#","1m"],["C#2","1m"],["C#2","1m."],["C#","2n."],["C#2","2n"],["C#2","2n."],["C#2","4n."]],[["","2m"],["","1m"],["","2n"],["","4n"],["","8n"],["","16n"],["","32n"]],[["C4","2m"],["C4","1m"],["C4","2n"],["C4","4n"],["C4","8n"],["C4","16n"],["C4","32n"]],[["C4","2m."],["C4","1m."],["C4","2n."],["C4","4n."],["C4","8n."],["C4","16n."],["C4","32n."]]]}},emits:["refresh"],setup(v,{emit:p}){const a=C(),i=p,o=C(),e=C(),l=v,h=g(()=>l.notes.flat().map(([t,s])=>new z({note:t,time:s}))),b=g(()=>o.value?h.value:[]);x(()=>{const s=new DOMParser().parseFromString(B,"image/svg+xml").querySelector("svg");if(!s)throw new Error("SVG node not found");window.svgNode=e.value=s,o.value=new N({svgNode:e.value}),$(async()=>{var r;const n=Array.from(((r=a.value)==null?void 0:r.querySelectorAll("canvas"))||[]);await Promise.all(n.map((f,c)=>E(f,h.value[Number(c)]))),i("refresh")})});const E=async(t,s)=>{var c;const n=t.getContext("2d");if(!n)throw new Error("Canvas context not found");n.clearRect(0,0,t.width,t.height);const r=await((c=o.value)==null?void 0:c.render(s,{colors:{primary:"#ffffff",secondary:"#000000",tertiary:"#ff0000"}}));t.width=r.canvas.width*l.density,t.height=r.canvas.height*l.density,t.style=`width: ${r.canvas.width}px; height: ${r.canvas.height}px;`;const f=S(r.canvas,t.width);n.drawImage(f,0,0)};return(t,s)=>(d(),m("ul",{ref_key:"rootEl",ref:a},[(d(!0),m(D,null,V(b.value,n=>(d(),m("li",{key:n.name,"data-key":n.name},[o.value?(d(),m("canvas",{key:0,width:o.value.dimension.x,height:o.value.dimension.y},null,8,I)):A("",!0)],8,F))),128))],512))}}),q=k(P,[["__scopeId","data-v-1138c7c6"]]),G={class:"wb-disks-extras13-synthesizer-debug-notes"},M=_({__name:"Notes",emits:["refresh"],setup(v,{emit:p}){const a=p,i=new N;return x(()=>{console.log("DEBUG",{noteRenderer:i}),$(()=>{a("refresh")})}),(o,e)=>(d(),m("div",G,[u("fieldset",null,[e[2]||(e[2]=u("legend",null,"Note Cache",-1)),w(R,{label:`Clear Cache (${y(i).cache.size} Bitmaps)`,onClick:e[0]||(e[0]=l=>y(i).cache.clear())},null,8,["label"])]),u("fieldset",null,[e[3]||(e[3]=u("legend",null,"Notes",-1)),w(q,{onRefresh:e[1]||(e[1]=l=>a("refresh"))})])]))}}),ee=k(M,[["__scopeId","data-v-a4366b5a"]]);export{ee as default};
