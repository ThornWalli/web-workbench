import{a8 as g,j as y,k as N,u as $}from"./index.faf1b937.js";import{N as k,T as l}from"./Track.b965352d.js";import{S as R,N as h,T as x}from"./TimelineCanvas.c22cbf02.js";import{_ as u,k as s,l as o,N as b,O as v,m as r,f as c,q as p,z as T,x as B,y as E}from"./entry.7783902a.js";import"./index.56665add.js";import"./index.64b4a7f6.js";import"./viewport.f3ae7a6b.js";import"./math.693619eb.js";import"./async.0270444a.js";const P={emits:["refresh"],data:function(){return{noteRenderer:null,svgNode:null,notes:[[["C#","2m"],["C#2","2m"],["C#2","2m."],["C#","1m"],["C#2","1m"],["C#2","1m."],["C#","2n."],["C#2","2n"],["C#2","2n."],["C#2","4n."]],[["","2m"],["","1m"],["","2n"],["","4n"],["","8n"],["","16n"],["","32n"]],[["C4","2m"],["C4","1m"],["C4","2n"],["C4","4n"],["C4","8n"],["C4","16n"],["C4","32n"]],[["C4","2m."],["C4","1m."],["C4","2n."],["C4","4n."],["C4","8n."],["C4","16n."],["C4","32n."]]].flat().map(([e,t])=>new k({note:e,time:t})),durations:[["1m","2m","2n","4n","8n","16n","32n"],["1m","2m","2n","4n.","8n.","16n.","32n."]].flat()}},computed:{visibleNotes(){return this.noteRenderer?this.notes:[]}},mounted(){const e=new DOMParser;window.svgNode=this.svgNode=e.parseFromString(R,"image/svg+xml").querySelector("svg"),this.noteRenderer=new h(this.svgNode),this.$nextTick(async()=>{const t=Array.from(this.$el.querySelectorAll("canvas"));await Promise.all(t.map((a,n)=>this.render(a,this.notes[Number(n)]))),this.$emit("refresh")})},methods:{async render(e,t){const a=e.getContext("2d");a.clearRect(0,0,e.width,e.height);const n=await this.noteRenderer.render(t,{colors:{primary:"#ffffff",secondary:"#000000",tertiary:"#ff0000"}});e.width=n.canvas.width,e.height=n.canvas.height,a.drawImage(n.canvas,0,0)}}},I=["width","height"];function D(e,t,a,n,C,f){return s(),o("ul",null,[(s(!0),o(b,null,v(f.visibleNotes,m=>(s(),o("li",{key:m},[r("canvas",{width:e.noteRenderer.dimension.x,height:e.noteRenderer.dimension.y},null,8,I)]))),128))])}const F=u(P,[["render",D],["__scopeId","data-v-299820b6"]]);const q={components:{NoteCanvas:F,TimelineCanvas:x,WbButton:g},props:{...y},emits:[...N,"refresh"],setup(e,t){return{...$(e,t)}},data:function(){return{tracks:z(),noteRenderer:new h}},mounted(){console.log("DEBUG",{noteRenderer:this.noteRenderer}),this.$nextTick(()=>{this.$emit("refresh")})}},z=()=>[new l({name:"Pause",type:"Synth",notes:[{name:"",duration:.25},{name:"",duration:.25},{name:"",duration:.25},{name:"",duration:.25},{name:"",duration:1},{name:"",duration:1},{name:"",duration:1},{name:"",duration:1}],beatCount:4}),new l({name:"Pause",type:"Synth",notes:[{name:"C#5 ",time:"16n"},{name:"Db4",time:"16n"},{name:"Eb4",time:"16n"},{name:"Gb4",time:"16n"},{name:"Ab4",time:"16n"},{name:"C4",time:"16n"},{name:"E4",time:"16n"},{name:"F4",time:"16n"},{name:"C5",time:"16n"},{name:"C5",time:"16n"},{name:"F4",time:"16n"},{name:"E4",time:"16n"},{name:"C4",time:"16n"}],beatCount:2}),new l({name:"Pause",type:"Synth",notes:[{name:"C2",time:"2n"},{name:"C5",time:"2n"}],beatCount:4}),new l({name:"Pause",type:"Synth",notes:[{note:{name:"c",octave:2,sharp:!1,doubleSharp:!1},time:{number:2,character:"n",dot:!1,triplet:!1}},{note:{name:"c",octave:5,sharp:!1,doubleSharp:!1},time:{number:2,character:"n",dot:!1,triplet:!1}},{note:{name:"c",octave:4,sharp:!1,doubleSharp:!1},time:{number:4,character:"n",dot:!1,triplet:!1}},{note:{name:"f",octave:3,sharp:!1,doubleSharp:!1},time:{number:2,character:"n",dot:!1,triplet:!1}},{note:{name:"c",octave:8,sharp:!1,doubleSharp:!1},time:{number:2,character:"n",dot:!1,triplet:!1}},{note:{name:"e",octave:8,sharp:!1,doubleSharp:!1},time:{number:2,character:"n",dot:!1,triplet:!1}},{note:{name:"b",octave:8,sharp:!1,doubleSharp:!1},time:{number:2,character:"n",dot:!1,triplet:!1}},{note:{name:"d",octave:9,sharp:!1,doubleSharp:!1},time:{number:2,character:"n",dot:!1,triplet:!1}},{note:{name:"f",octave:2,sharp:!1,doubleSharp:!1},time:{number:2,character:"n",dot:!1,triplet:!1}},{note:{name:"b",octave:2,sharp:!1,doubleSharp:!1},time:{number:2,character:"n",dot:!1,triplet:!1}},{note:{name:"d",octave:3,sharp:!1,doubleSharp:!1},time:{number:2,character:"n",dot:!1,triplet:!1}},{note:{name:"d",octave:2,sharp:!0,doubleSharp:!1},time:{number:2,character:"n",dot:!1,triplet:!1}},{note:{name:"g",octave:2,sharp:!1,doubleSharp:!1},time:{number:2,character:"n",dot:!1,triplet:!1}},{note:{name:"e",octave:2,sharp:!1,doubleSharp:!1},time:{number:2,character:"n",dot:!1,triplet:!1}},{note:{name:"c",octave:3,sharp:!1,doubleSharp:!1},time:{number:2,character:"n",dot:!1,triplet:!1}},{note:{name:"e",octave:3,sharp:!1,doubleSharp:!1},time:{number:2,character:"n",dot:!1,triplet:!1}},{note:{name:"f",octave:3,sharp:!1,doubleSharp:!1},time:{number:2,character:"n",dot:!1,triplet:!1}},{note:{name:"a",octave:3,sharp:!1,doubleSharp:!1},time:{number:2,character:"n",dot:!1,triplet:!1}},{note:{name:"g",octave:3,sharp:!1,doubleSharp:!1},time:{number:2,character:"n",dot:!1,triplet:!1}}],beatCount:4})],d=e=>(B("data-v-630ada8b"),e=e(),E(),e),A={class:"wb-disks-extras13-synthesizer-debug"},G=d(()=>r("legend",null,"Timelines",-1)),O=d(()=>r("legend",null,"Note Cache",-1)),V=d(()=>r("legend",null,"Notes",-1));function W(e,t,a,n,C,f){const m=c("timeline-canvas"),_=c("wb-button"),w=c("note-canvas");return s(),o("div",A,[r("fieldset",null,[G,(s(!0),o(b,null,v(e.tracks,(i,S)=>(s(),T(m,{key:S,track:i,onRefresh:t[0]||(t[0]=j=>e.$emit("refresh"))},null,8,["track"]))),128))]),r("fieldset",null,[O,p(_,{label:`Clear Cache (${e.noteRenderer.cache.size} Bitmaps)`,onClick:t[1]||(t[1]=i=>e.noteRenderer.cache.clear())},null,8,["label"])]),r("fieldset",null,[V,p(w,{onRefresh:t[2]||(t[2]=i=>e.$emit("refresh"))})])])}const Z=u(q,[["render",W],["__scopeId","data-v-630ada8b"]]);export{Z as default};
