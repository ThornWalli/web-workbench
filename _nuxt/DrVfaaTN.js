import{W as B}from"./E3_DWDMo.js";import{a as R,N}from"./B0Lefq6F.js";import{N as z}from"./fGiKISgP.js";import{r as S}from"./D9awfk1U.js";import{d as _,r as C,k as w,o as x,a1 as k,y as m,z as d,X as A,Y as I,I as V,_ as $,A as u,C as y,G as g}from"./CotJlvW-.js";import"./CpIyErmU.js";import"./D4lI5vpz.js";import"./Bx1YEHQ7.js";import"./DOMGF9Hs.js";import"./DKrsSnpo.js";import"./CaAbksje.js";import"./9V19AFUE.js";import"./CNkvSXuu.js";const D=["data-key"],G=["width","height"],P=_({__name:"NoteCanvas",props:{density:{type:Number,default(){return window.devicePixelRatio||1}},notes:{type:Array,default:()=>[[["C#","2m"],["C#2","2m"],["C#2","2m."],["C#","1m"],["C#2","1m"],["C#2","1m."],["C#","2n."],["C#2","2n"],["C#2","2n."],["C#2","4n."]],[["","2m"],["","1m"],["","2n"],["","4n"],["","8n"],["","16n"],["","32n"]],[["C4","2m"],["C4","1m"],["C4","2n"],["C4","4n"],["C4","8n"],["C4","16n"],["C4","32n"]],[["C4","2m."],["C4","1m."],["C4","2n."],["C4","4n."],["C4","8n."],["C4","16n."],["C4","32n."]]]}},emits:["refresh"],setup(h,{emit:p}){const a=C(),i=p,o=C(),e=C(),l=h,v=w(()=>l.notes.flat().map(([t,s])=>new z({note:t,time:s}))),b=w(()=>o.value?v.value:[]);x(()=>{const s=new DOMParser().parseFromString(R,"image/svg+xml").querySelector("svg");if(!s)throw new Error("SVG node not found");window.svgNode=e.value=s,o.value=new N({svgNode:e.value}),k(async()=>{var r;const n=Array.from(((r=a.value)==null?void 0:r.querySelectorAll("canvas"))||[]);await Promise.all(n.map((f,c)=>E(f,v.value[Number(c)]))),i("refresh")})});const E=async(t,s)=>{var c;const n=t.getContext("2d");if(!n)throw new Error("Canvas context not found");n.clearRect(0,0,t.width,t.height);const r=await((c=o.value)==null?void 0:c.render(s,{colors:{primary:"#ffffff",secondary:"#000000",tertiary:"#ff0000"}}));t.width=r.canvas.width*l.density,t.height=r.canvas.height*l.density,t.style=`width: ${r.canvas.width}px; height: ${r.canvas.height}px;`;const f=S(r.canvas,t.width);n.drawImage(f,0,0)};return(t,s)=>(d(),m("ul",{ref_key:"rootEl",ref:a},[(d(!0),m(A,null,I(b.value,n=>(d(),m("li",{key:n.name,"data-key":n.name},[o.value?(d(),m("canvas",{key:0,width:o.value.dimension.x,height:o.value.dimension.y},null,8,G)):V("",!0)],8,D))),128))],512))}}),q=$(P,[["__scopeId","data-v-62b4303f"]]),F={class:"wb-disks-extras13-synthesizer-debug-notes"},M=_({__name:"Notes",emits:["refresh"],setup(h,{emit:p}){const a=p,i=new N;return x(()=>{console.log("DEBUG",{noteRenderer:i}),k(()=>{a("refresh")})}),(o,e)=>(d(),m("div",F,[u("fieldset",null,[e[2]||(e[2]=u("legend",null,"Note Cache",-1)),y(B,{label:`Clear Cache (${g(i).cache.size} Bitmaps)`,onClick:e[0]||(e[0]=l=>g(i).cache.clear())},null,8,["label"])]),u("fieldset",null,[e[3]||(e[3]=u("legend",null,"Notes",-1)),y(q,{onRefresh:e[1]||(e[1]=l=>a("refresh"))})])]))}}),ee=$(M,[["__scopeId","data-v-d2cc321d"]]);export{ee as default};
