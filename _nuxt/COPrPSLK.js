const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./CshrRwMP.js","./Cpj98o6Y.js"])))=>i.map(i=>d[i]);
import{d as H,ab as J,r as f,k as m,o as j,W as X,F as I,z as b,D as v,A as c,C as u,y as E,X as Q,Y as Z,G as ee,B as A,S as le,ac as te,P as ae,K as oe,_ as ne}from"./BUU1NkbK.js";import{W as ue}from"./B1olVgM4.js";import{W as y}from"./C0s6aVd8.js";import{W as d}from"./Uu07fvcW.js";import{W as B}from"./B4Wca970.js";import{C as W,P as k,e as F}from"./BndwZjjR.js";import{W as se}from"./CNCxDPtt.js";import{d as re}from"./On0xenC3.js";import{K as ie}from"./CZZPvNTk.js";import{a as de,P as ce,g as pe}from"./B8jsBC7u.js";import{S as me}from"./6C4StZv5.js";import{f as ve}from"./DNvW6rqi.js";import"./CZFypg2d.js";import"./DcvgOCRL.js";import"./7MFW2ODw.js";import"./CpIyErmU.js";import"./BE-N3i2n.js";import"./D4lI5vpz.js";import"./Ce6njBYG.js";import"./DdQrQ7-5.js";import"./6jpuwjT2.js";import"./eeW43C70.js";import"./DMzq3-W3.js";import"./CJLX7oOC.js";import"./CNlRQWZy.js";import"./ol2dnVJx.js";import"./BlhZwPhK.js";import"./D9awfk1U.js";import"./CNkvSXuu.js";import"./B2exwp0w.js";import"./BSdpnwYg.js";import"./Bu9-HbQ4.js";import"./9V19AFUE.js";import"./Cpj98o6Y.js";import"./DG6QdPnO.js";import"./BnQx2YJv.js";import"./RAasLaaH.js";import"./CxKYomUj.js";import"./CHpeLE9u.js";import"./WZmY4AAg.js";import"./BWR5uye1.js";import"./CV0dHcg-.js";import"./djI3_XgP.js";const fe={class:"colors style-scrollbar"},be=["id","name","value","checked","onInput"],ye=["for"],Pe={class:"info"},_e={class:"font-bit-font"},ke={class:"font-bit-font"},Ce=H({__name:"ColorPalette",props:{core:{},model:{}},setup(S){const D=J(),t=f(),o=m(()=>t.value?t.value.colors:[]),s=f(),N=f(null),p=S;function T(e,l){l.setColor(e),_()}const P=f(pe()),C=m(()=>[...P.value,...n.value]),n=m({get:()=>(p.core.config.get(W.WEB_PAINT_PALETTES)||[]).map(e=>new k(e)),set:e=>{p.core.config.set(W.WEB_PAINT_PALETTES,e)}});function _(){n.value=[...n.value]}const U=m(()=>({label:"Colors from Palette",hideLabel:!0,modelValue:"","onUpdate:model-value":e=>{const l=C.value.find(r=>r.id===e);t.value&&l&&(t.value.colors.push(...l.colors),_())},options:[{label:"Colors from Palette",value:""},...n.value.length>0?[{label:"Custom Palettes",options:n.value.map(e=>({label:e.name,value:e.id}))}]:[],{label:"Built-in Palettes",options:P.value.map(e=>({label:e.name,value:e.id}))}]})),V=m(()=>{var e;return{label:"Palette",hideLabel:!0,modelValue:(e=t.value)==null?void 0:e.id,"onUpdate:model-value":l=>t.value=C.value.find(r=>r.id===l),options:[{label:"New Palette",value:""},...n.value.length>0?[{label:"Custom Palettes",options:n.value.map(l=>({label:l.name,value:l.id,group:"custom"}))}]:[],{label:"Built-in Palettes",options:P.value.map(l=>({label:l.name,value:l.id,group:"test"}))}]}}),g=new me;j(()=>{t.value=de(ce.WIN_256),g.add(re.keyDown.pipe(ve(e=>e.key===ie.BACKSPACE)).subscribe(()=>{h()}))}),X(()=>{g.unsubscribe()});function L(){if(!s.value)return;const e=o.value.findIndex(l=>l.equal(s.value));if(e>0){const l=o.value[e-1];o.value[e-1]=o.value[e],o.value[e]=l}}function M(){if(!s.value)return;const e=o.value.findIndex(l=>l.equal(s.value));if(e<o.value.length-1){const l=o.value[e+1];o.value[e+1]=o.value[e],o.value[e]=l}}function q(){n.value=[...n.value,new k({name:"New Palette",colors:[]})],t.value=n.value[n.value.length-1]}function R(){if(!t.value)return;const e=n.value.findIndex(l=>l.id===t.value.id);e!==-1&&(n.value.splice(e,1),t.value=void 0),t.value=n.value[Math.max(e-1,0)]}async function K(){var e;if(t.value){const l=(e=await p.model.actions.prompt({text:"Rename Palette",type:"text",value:t.value.name||""}))==null?void 0:e.value;t.value.name=l,_()}}function O(){o.value.push(new F),s.value=o.value[o.value.length-1]}function h(){if(!s.value)return;const e=o.value.findIndex(l=>l.equal(s.value));e!==-1&&(o.value.splice(e,1),s.value=void 0),s.value=o.value[Math.max(e-1,0)]}async function G(e){if(e&&e[0]){const l=new k(JSON.parse(await e[0].text()));n.value.find(({id:r})=>l.id===r)?n.value=n.value.map(r=>r.id===l.id?l:r):n.value=[...n.value,l]}}async function Y(){const e=await oe(()=>import("./CshrRwMP.js").then(l=>l.F),__vite__mapDeps([0,1]),import.meta.url).then(l=>l.default);try{await e.saveAs(new Blob([JSON.stringify(t.value)]),Date.now()+"-palette.json")}catch(l){console.error("An error occurred during export.",l)}}async function $(){var l;const{payload:e}=await p.model.app.actions.getColors();e.colors.length>1e3&&console.warn("Palette must not exceed 100 colors."),(l=t.value)!=null&&l.colors&&(t.value.colors=e.colors.slice(0,1e3).map(r=>new F({color:r})))}function z(){t.value&&p.model.app.setColorPalette(t.value)}return(e,l)=>(b(),I(ue,{class:"wb-disks-extras13-web-paint-color-palette"},{default:v(()=>{var r;return[c("div",fe,[c("ul",{ref_key:"itemsEl",ref:N},[(b(!0),E(Q,null,Z(o.value,a=>(b(),E("li",{key:a.id},[c("input",{id:a.id,type:"radio",name:`${ee(D)}-palette-color`,value:a.id,checked:a.equal(s.value),onInput:i=>s.value=a},null,40,be),c("label",{for:a.id},[(b(),I(se,{key:a.color.toHex(),selected:a.equal(s.value),readonly:!a.equal(s.value),embed:"","model-value":a.color,"onUpdate:modelValue":i=>T(i,a)},null,8,["selected","readonly","model-value","onUpdate:modelValue"]))],8,ye)]))),128))],512)]),c("div",Pe,[c("span",_e,"Total: "+A(o.value.flat().length),1),c("span",ke,A((r=s.value)==null?void 0:r.color.toHex()),1)]),u(B,le(te(V.value)),null,16),u(y,null,{default:v(()=>{var a,i,x,w;return[u(d,{disabled:(a=t.value)==null?void 0:a.locked,type:"button","style-type":"secondary",label:"Add",onClick:O},null,8,["disabled"]),u(d,{disabled:(i=t.value)==null?void 0:i.locked,type:"button","style-type":"secondary",label:"Del",onClick:h},null,8,["disabled"]),u(d,{disabled:(x=t.value)==null?void 0:x.locked,type:"button","style-type":"secondary",label:"<",onClick:L},null,8,["disabled"]),u(d,{disabled:(w=t.value)==null?void 0:w.locked,type:"button","style-type":"secondary",label:">",onClick:M},null,8,["disabled"])]}),_:1}),u(y,null,{default:v(()=>{var a,i;return[u(B,ae({disabled:(a=t.value)==null?void 0:a.locked},U.value),null,16,["disabled"]),u(d,{style:{flex:"0"},type:"button","style-type":"secondary",label:"Colors From Image",disabled:(i=t.value)==null?void 0:i.locked,onClick:$},null,8,["disabled"])]}),_:1}),u(y,null,{default:v(()=>{var a,i;return[u(d,{type:"button","style-type":"secondary",label:"Add Palette",onClick:q}),u(d,{disabled:(a=t.value)==null?void 0:a.locked,type:"button","style-type":"secondary",label:"Del Palette",onClick:R},null,8,["disabled"]),u(d,{disabled:(i=t.value)==null?void 0:i.locked,type:"button","style-type":"secondary",label:"Rename Palette",onClick:K},null,8,["disabled"])]}),_:1}),u(y,null,{default:v(()=>[u(d,{type:"upload","style-type":"secondary",label:"Import",onUpload:G}),u(d,{type:"button","style-type":"secondary",label:"Export",onClick:Y}),u(d,{disabled:!t.value,type:"button","style-type":"secondary",label:"Apply Palette",onClick:z},null,8,["disabled"])]),_:1})]}),_:1}))}}),cl=ne(Ce,[["__scopeId","data-v-50560e06"]]);export{cl as default};
