const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./CrmfUNPX.js","./CYlf7ZdY.js","./BY0KaPQX.js","./C5mdboMC.js","./B6KsP_aU.js","./gfIAX8eU.js","./DlfJZ9EB.js","./D4lI5vpz.js","./JXQ19Fa6.js","./6C4StZv5.js","./C6aID195.js","./CSlkdJUE.js","./__NSLBDc.js"])))=>i.map(i=>d[i]);
var Qe=Object.defineProperty;var we=n=>{throw TypeError(n)};var Ke=(n,e,t)=>e in n?Qe(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t;var b=(n,e,t)=>Ke(n,typeof e!="symbol"?e+"":e,t),Ie=(n,e,t)=>e.has(n)||we("Cannot "+t);var oe=(n,e,t)=>(Ie(n,e,"read from private field"),t?t.call(n):e.get(n)),de=(n,e,t)=>e.has(n)?we("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(n):e.set(n,t),Oe=(n,e,t,o)=>(Ie(n,e,"write to private field"),o?o.call(n,t):e.set(n,t),t);import{I as Be,d as ue,r as x,$ as D,t as V,v as M,z as P,A as z,x as S,K as q,Y as ze,Z as Ve,W as ie,a2 as Ze,aa as Je,y as pe,C as U,F as Q,_ as me,j as E,N as le,m as et,J as re,H as ae,o as ke,V as De,X as Ue,M as Ne,a9 as tt,D as st,a0 as Ce}from"./CYlf7ZdY.js";import{c as ot}from"./C5mdboMC.js";import{b as at,d as nt,A as J,T as Te,c as k,e as xe,L as ge,g as $e,p as lt}from"./C6HPuhbs.js";import{v as rt,x as Ge,u as ce,f as it,y as Me,e as ct,z as ut,g as mt,q as dt}from"./B6KsP_aU.js";import{I as v,S as X}from"./__NSLBDc.js";import{h as Re,r as pt}from"./CNkvSXuu.js";import{P as ne,D as ft,a as vt}from"./BY0KaPQX.js";import{C as y,b as ht,c as gt}from"./CGk7t0fz.js";import{W as je}from"./BXIB5LbF.js";import{W as yt}from"./CL8geYCd.js";import{_ as fe}from"./B1316_8w.js";import{W as Ae}from"./BN92RPm7.js";import{W as He}from"./DogGH0My.js";import{W as Ye}from"./Ck78BBCY.js";import{u as _t,C as St}from"./Dr9DEtSu.js";import{u as ye}from"./BWMaiRCQ.js";import{W as ve,a as bt}from"./D6W2Pk7K.js";import{S as We}from"./DlfJZ9EB.js";import{R as Et}from"./DmCMAY6H.js";import{i as c,p as wt}from"./gfIAX8eU.js";import{n as It,d as he}from"./0lJVpglL.js";import{S as Ot}from"./6C4StZv5.js";import{f as Nt}from"./DghZOmHd.js";class Ct{constructor(e,t){b(this,"entries",new Map);b(this,"observable",Be({}));b(this,"storage");b(this,"ready");const o=rt(t||Ge.NONE);this.storage=new o({name:e}),this.ready=this.storage.load().then(s=>(this.entries=new Map(s),Object.assign(this.observable,Object.fromEntries(this.entries)),this)).catch(s=>{throw s})}setDefaults(e){Object.keys(e).forEach(t=>{this.has(t)||this.set(t,e[String(t)])})}get(e){return this.entries.get(e)}has(e){return this.entries.has(e)}set(e,t){return typeof e=="string"?(this.entries.set(e,t),this.observable[String(e)]=t):e&&typeof e=="object"&&!(e instanceof Map)&&Object.keys(e).forEach(o=>{t=e[o],this.entries.set(o,t),this.observable[o]=t}),this.storage.save(Array.from(this.entries))}}class Tt extends at{constructor(t){super();b(this,"core");this.core=t}prompt(t){const o=["openDialog","--prompt"];return t&&o.push(`--message="${ce(t)}"`),this.core.executeCommand(o.join(" "))}confirm(t){const o=["openDialog","--confirm"];return t&&o.push(`--message="${ce(t)}"`),this.core.executeCommand(o.join(" "))}}const xt={class:"wb-module-core-color-settings"},Mt={class:"col-1"},Rt={class:"colors-select-list"},At=["value"],Wt={class:"col-1 colors"},Lt={class:"color-controls"},Pt={class:"color-preview"},Ft=ue({__name:"ColorSettings",emits:["close"],setup(n,{emit:e}){var g,N;const{core:t}=ye();_t();const o=e,s=x(((N=(g=t.value)==null?void 0:g.config)==null?void 0:N.get(y.THEME))||ne[ft]),a=x(s.value.colors[1]),l=x(Re(s.value.colors[1])),f=x("Save"),r=x(),I=x({presets:{label:"Presets",options:[{title:"Select Theme",value:""},...Object.keys(ne).map(m=>({title:ne[m].name,value:m}))]},filter:{label:"Filter",options:[{title:"Invert",value:"invert(100%)"},{title:"Brightness",value:"brightness(50%)"}]}});D(()=>r.value,m=>{if(m){const d=ne[m];s.value={name:d.name,colors:d.colors,filter:d.filter},console.log({name:d.name,colors:d.colors,filter:d.filter}),a.value=s.value.colors[0]}}),D(()=>a.value,m=>{l.value=Re(m)}),D(()=>l.value,m=>{const d=Object.values(m).map(p=>Number(p));a.value=s.value.colors[s.value.colors.indexOf(a.value)]=pt(...d)},{deep:!0});function u(){var d,p,_;const m=s.value;(d=t.value)==null||d.config.set(y.THEME,m),(_=(p=t.value)==null?void 0:p.modules.screen)==null||_.setTheme(new vt("custom",m)),o("close")}return(m,d)=>(M(),V("div",xt,[P(je,{class:"form",onSubmit:u},{default:z(()=>[S("div",null,[S("div",Mt,[P(Ae,q(I.value.presets,{modelValue:r.value,"onUpdate:modelValue":d[0]||(d[0]=p=>r.value=p)}),null,16,["modelValue"]),P(yt,{label:"Colors",class:"color-select"},{default:z(()=>[S("div",Rt,[(M(!0),V(ze,null,Ve(s.value.colors,(p,_)=>(M(),V("label",{key:_,style:ie({"--color":p})},[Ze(S("input",{"onUpdate:modelValue":d[1]||(d[1]=T=>a.value=T),type:"radio",name:"color",value:p},null,8,At),[[Je,a.value]])],4))),128))])]),_:1}),P(Ae,q(I.value.filter,{modelValue:s.value.filter,"onUpdate:modelValue":d[2]||(d[2]=p=>s.value.filter=p)}),null,16,["modelValue"])]),S("div",Wt,[S("div",Lt,[S("div",Pt,[S("i",{style:ie(`background-color: rgb(${l.value.join(", ")});`)},null,4)]),S("div",null,[S("div",null,[P(fe,{modelValue:l.value[0],"onUpdate:modelValue":d[3]||(d[3]=p=>l.value[0]=p),"style-type":"color-select",label:"Red",class:"color-slider",max:255,min:0,step:1,"handle-size":.2},{after:z(()=>[S("span",null,pe(l.value[0].toString(16).toUpperCase()),1)]),_:1},8,["modelValue"])]),S("div",null,[P(fe,{modelValue:l.value[1],"onUpdate:modelValue":d[4]||(d[4]=p=>l.value[1]=p),"style-type":"color-select",label:"Green",class:"color-slider",max:255,min:0,step:1,"handle-size":.2},{after:z(()=>[S("span",null,pe(l.value[1].toString(16).toUpperCase()),1)]),_:1},8,["modelValue"])]),S("div",null,[P(fe,{modelValue:l.value[2],"onUpdate:modelValue":d[5]||(d[5]=p=>l.value[2]=p),"style-type":"color-select",label:"Blue",class:"color-slider",max:255,min:0,step:1,"handle-size":.2},{after:z(()=>[S("span",null,pe(l.value[2].toString(16).toUpperCase()),1)]),_:1},8,["modelValue"])])])])])]),P(Ye,{align:"outer",full:""},{default:z(()=>[f.value?(M(),U(He,{key:0,"style-type":"primary",label:f.value,type:"submit"},null,8,["label"])):Q("",!0)]),_:1})]),_:1})]))}}),Bt=me(Ft,[["__scopeId","data-v-5e724e59"]]),zt={class:"wb-module-core-settings"},Vt={class:"cols"},kt={class:"col-2"},Dt={class:"col-2"},Le="Save",Ut=ue({__name:"Settings",emits:["close"],setup(n,{emit:e}){var N,m,d,p,_,T,H;const t=e,{core:o}=ye(),s=x({[y.SCREEN_1084_FRAME]:((N=o.value)==null?void 0:N.config.get(y.SCREEN_1084_FRAME))||!1,[y.SCREEN_REAL_LOOK]:((m=o.value)==null?void 0:m.config.get(y.SCREEN_REAL_LOOK))||!1,[y.SCREEN_SCAN_LINES]:((d=o.value)==null?void 0:d.config.get(y.SCREEN_SCAN_LINES))||!1,[y.SCREEN_ACTIVE_ANIMATION]:((p=o.value)==null?void 0:p.config.get(y.SCREEN_ACTIVE_ANIMATION))||!1,[y.BOOT_WITH_SEQUENCE]:((_=o.value)==null?void 0:_.config.get(y.BOOT_WITH_SEQUENCE))||!1,[y.BOOT_WITH_WEBDOS]:((T=o.value)==null?void 0:T.config.get(y.BOOT_WITH_WEBDOS))||!1,[y.FILE_EXTENSION_ASSIGNMENT]:((H=o.value)==null?void 0:H.config.get(y.FILE_EXTENSION_ASSIGNMENT))||[]}),a=O=>O.map(W=>W.join(" ")).join(`
`),l=O=>O.split(`
`).map(W=>{const[,$,K]=W.match(/^([^ ]+) +(.*)$/)||[];return[$,K]}),f=E(()=>({modelValue:a(s.value[y.FILE_EXTENSION_ASSIGNMENT]),"onUpdate:model-value":O=>{s.value[y.FILE_EXTENSION_ASSIGNMENT]=l(O)},name:y.FILE_EXTENSION_ASSIGNMENT,label:"File Extension assignment to Application",placeholder:"e.g. md openPreview…"})),r=E(()=>({label:"",items:[],modelValue:s.value,"onUpdate:model-value":O=>s.value=O})),I=E(()=>({label:"Screen - Settings",items:[{label:"Use 1084 Frame with 640x480",name:y.SCREEN_1084_FRAME},{label:"Screen with Real-Look",name:y.SCREEN_REAL_LOOK},{label:"Screen with Scan-Lines",name:y.SCREEN_SCAN_LINES},{label:"Screen with On/Off Animation",name:y.SCREEN_ACTIVE_ANIMATION}],modelValue:s.value,"onUpdate:model-value":O=>s.value=O})),u=E(()=>({label:"BOOT - Settings",items:[{label:"Boot with Sequence?",name:y.BOOT_WITH_SEQUENCE},{label:"Boot with WebDos?",name:y.BOOT_WITH_WEBDOS}],modelValue:s.value,"onUpdate:model-value":O=>s.value=O})),g=()=>{var O;(O=o.value)==null||O.config.set(s.value),t("close")};return(O,W)=>(M(),V("div",zt,[P(je,{onSubmit:g},{default:z(()=>[S("div",Vt,[S("div",kt,[r.value.items.length>0?(M(),U(ve,le(q({key:0},r.value)),null,16)):Q("",!0),I.value.items.length>0?(M(),U(ve,le(q({key:1},I.value)),null,16)):Q("",!0),u.value.items.length>0?(M(),U(ve,le(q({key:2},u.value)),null,16)):Q("",!0)]),S("div",Dt,[P(bt,q(f.value,{"label-top":"",rows:10,resize:null}),null,16)])]),P(Ye,{align:"outer",full:""},{default:z(()=>[Le?(M(),U(He,{key:0,"style-type":"primary",label:Le,type:"submit"})):Q("",!0)]),_:1})]),_:1})]))}}),$t=me(Ut,[["__scopeId","data-v-2fc8171f"]]);var ee,te;class Gt{constructor(e){de(this,ee);de(this,te,[]);Oe(this,ee,e)}command(e,t){oe(this,te).push({value:e,targetValue:t})}run(){return Promise.all(oe(this,te).map(({value:e,targetValue:t})=>oe(this,ee).executeCommand(e).then(o=>{const s=o===t;return s||console.warn(`[ ${e} ]; ${o} === ${t}`),{value:e,targetValue:t,result:o,success:s}})))}async start(){const e=await this.run();return[[e.length,"Tests processed"],[e.filter(t=>t.success).length,"Tests success"],[e.filter(t=>!t.success).length,"Tests failed"]]}}ee=new WeakMap,te=new WeakMap;const jt=nt(({core:n})=>[{name:["execute"],description:"Execute file.",args:[new J({index:0,name:"path",description:"Path to the file"})],async action({path:e}){var a,l;let t=e;const o=new Map(n.config.get(y.FILE_EXTENSION_ASSIGNMENT));if(!t)throw it.get("bad_args");let s;if(o.has(Me(t))?s=await((a=n.modules.files)==null?void 0:a.fs.get(o.get(Me(t)))):(s=await((l=n.modules.files)==null?void 0:l.fs.get(t)),t=void 0),typeof(s==null?void 0:s.action)=="function")return s.action(n,t);if(s!=null&&s.data&&typeof(s==null?void 0:s.data)=="object"&&"type"in s.data){const f=s.data,r=[`openPreview "${s.getPath()}"`];return f.openMaximized&&r.push("-maximized"),n.executeCommand(r.join(" "))}}},{name:["openColorSettings"],async action(){var e;(e=n.modules.windows)==null||e.addWindow({component:Bt,componentData:{},options:{title:"Color Settings",prompt:!1,scaleX:!1,scaleY:!1,scrollX:!1,scrollY:!1}})}},{name:["openSettings"],async action(){var e;(e=n.modules.windows)==null||e.addWindow({component:$t,componentData:{},options:{title:"Settings",prompt:!1,scaleX:!1,scaleY:!1,scrollX:!1,scrollY:!1}})}},{name:["echo","print"],args:[new J({name:["newline","n"],flag:!0})],async action({newline:e},t){const o=s=>ce(s).replace(/\\"/g,'"').replace(/\\n/g,`
`);if(e)t.message(t.commandArgs.map(s=>o(s)));else{let s=await t.core.executeCommand(t.commandValue);typeof s=="object"&&(s=JSON.stringify(s)),t.message(`${ce(o(s))}`)}}},{name:"commands",action(e,t){const o=new Te({headerPadding:1});return o.addColumns([{value:"Command(s)",align:"left",maxWidth:20},{value:"Description/Arguments",align:"left",maxWidth:60}]),o.addRows(k.items.reduce((s,a)=>{const l=a.args||[],f=[];a.description&&(f.push(a.description),f.push("")),l.length&&(f.push("Arguments:"),f.push(""));const{flagNames:r,kwargNames:I}=l.reduce((g,N)=>{const m=N.name.join(", ");return N.flag?g.flagNames.push({name:`-${m}`,description:N.description}):g.kwargNames.push({name:`--${m}`,description:N.description}),g},{flagNames:[],kwargNames:[]}),u={paddingChr:"Â",showHeaders:!1,config:{name:{minWidth:15},description:{minWidth:10,maxWidth:30}}};return f.push(xe(r,Object.assign({},u))),r.length>0&&I.length>0&&f.push(""),f.push(xe(I,Object.assign({},u))),s.push([a.name.join(", "),f.join(`
`)]),s},[])),t.message(["Commands:",o]),Promise.resolve()}},{name:["CLS","CLEAR"],async action(){n.consoleInterface.clear()}},{name:["prompt","input","PROMPT","INPUT"],args:[new J({index:0,name:"text",description:"Text from prompt."}),new J({index:1,name:"variable",description:"Variable"})],action:({text:e,variable:t,unresolved:o})=>(o.text&&!o.variable?(t=o.text,e=void 0):t=o.variable,n.consoleInterface.prompt(e).then(s=>{var a;return ct(s)&&(s=Number(s)),t&&((a=n.modules.parser)==null||a.memory.set(t,s)),s}))},{name:["confirm","CONFIRM"],args:[new J({index:0,name:"text",description:"Text from confirm."})],action({text:e}){return n.consoleInterface.confirm(e)}},{name:["selfCheck"],async action(e,t){const o=new Te;o.addColumns([{value:"Count",align:"left",minWidth:8},{value:"Description",align:"left",minWidth:15}]),o.addRows(await Ht(n)),t.message(['"Command Tests:"',o,'"For failures, look in the web console of the browser."'])}}]);function Ht(n){const e=new Gt(n);return e.command('"foo" +"bar"','"foobar"'),e.command("(-3+-6)+1",-8),e.command("(-3-+6)+1",-8),e.command("(-3*-6)+1",-3*-6+1),e.command("(-3/-6)+1",-3/-6+1),e.command("(-3+6)+1",4),e.command("(-3-6)+1",-8),e.command("(-3*6) + 1",-3*6+1),e.command("(-3/6)+1",-3/6+1),e.command("INT(PI)",3),e.command("(POW(2,2)+1)",5),e.command('ASC("D")',68),e.command("CHR$(68)",'"D"'),e.command('LEN("ABC")',3),e.command('"a" + "b"','"ab"'),e.command("STRING$(3,0)",'"000"'),e.command("SQRT(2,2)",Math.sqrt(2)),e.command("128 >> (256 + 5)",4),e.command("-2+4+SQRT(2,2)",2+Math.sqrt(2)),e.command("-2- 2 * 2",-2-2*2),e.command("(1+1)",2),e.command("2*2",2*2),e.command("1+2+3+(POW(2,2)+1)+5*8-(50/2)",6+(2**2+1)+5*8-50/2),e.start()}const{version:Yt}=et().public,j=class j{constructor(){b(this,"setupComplete",!1);b(this,"events",re(new We));b(this,"errorObserver",re(new We));b(this,"ready",re(new Et(0)));b(this,"modules",{});b(this,"consoleInterface",new Tt(this));b(this,"logger",new ge({core:this,debug:!1,consoleInterface:this.consoleInterface}));b(this,"executionCounter",0);b(this,"config",new Ct(ht,Ge.SESSION));b(this,"value");this.value=this,this.log(`${j.NAME}; ${j.VERSION}`)}get version(){return j.VERSION}addExecution(){return this.executionCounter++,()=>{this.executionCounter--}}async setup(){if(this.setupComplete)return console.warn("Setup is complete!"),this;this.setupComplete=!0,k.add($e(jt({core:this}))),await this.config.ready,this.config.setDefaults(gt);const e=Object.values(this.modules);return await Promise.all(e.map(t=>Promise.resolve(t==null?void 0:t.beforeSetup()))),await Promise.all(e.map(t=>Promise.resolve(t==null?void 0:t.setup()))),this.modules.files&&await Xt(this.modules.files.fs),this.ready.next(this),this}destroy(){k.clear()}addModule(e,t){const o=new e({core:this,...t});this.modules[ot(o.name)]=o}async removeModule(e){await e.destroy(),Reflect.deleteProperty(this.modules,e.name)}executeCommands(e){const t=e.shift();if(t)return this.executeCommand(t).then(()=>this.executeCommands(e))}async executeCommand(e,t){var f,r,I;typeof e=="string"&&(e=e.replace(/(.*[^\\])\n(\S*)/gm,"$1\\n$2"));const o=(t==null?void 0:t.show)||!1,s=[];(Array.isArray(t==null?void 0:t.message)||typeof(t==null?void 0:t.message)=="string")&&s.push(...s.concat(t==null?void 0:t.message));const a={commandBucket:k,core:this,logger:this.logger,show:o,...t,message:u=>{if(o){let g=u;typeof u=="string"&&(u=u.replace(/\\n/g,`
`),g=`"${u}"`),s.push(...[].concat(g))}}};let l;try{if(e){const u=await((f=this.modules.parser)==null?void 0:f.parseCommand(e));u&&((r=a.commandBucket)!=null&&r.has(u.command)?l=await Fe(e,u,a.commandBucket,a):k.has(u.command)?l=await Fe(e,u,k,a):(I=this.modules.parser)!=null&&I.isMathValue(e)?l=await this.modules.parser.parseMath(e):/^\w+$/.test(e)&&console.warn(`can\\'t use variable or method "${e}"`))}}catch(u){let g=u;Array.isArray(u)&&(g=new Error(u[u.length-1])),this.errorObserver.next(g)}return l!==void 0&&l!=="undefined"&&typeof l=="string"&&a.show&&s.length<1&&s.push(l),s.forEach(u=>{var g;return(g=a.logger)==null?void 0:g.add(u,{type:ge.TYPE.OUTPUT})}),l}log(e){this.logger.add(e,{namespace:"Core"})}};b(j,"VERSION",Yt||"0.0.0"),b(j,"NAME","web-workbench");let Pe=j;async function Fe(n,e,t,o){var a;const s=t.get(e.command);if(s){const l=o.show,f=lt(s,e),r=await s.action(f,Object.assign({command:e.command,commandValue:e.commandValue,commandArgs:e.args},o));return l&&o.showCommand&&((a=o.logger)==null||a.add("> "+n,{type:ge.TYPE.OUTPUT})),r}}async function Xt(n){const{FONT_FAMILES:e,DEFAULT_FONT_SIZE:t}=await ae(async()=>{const{FONT_FAMILES:r,DEFAULT_FONT_SIZE:I}=await import("./CrmfUNPX.js");return{FONT_FAMILES:r,DEFAULT_FONT_SIZE:I}},__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12]),import.meta.url),[o,s,a]=(await Promise.all([ae(()=>import("./C6lqZdm9.js"),[],import.meta.url),ae(()=>import("./DYb_MdBR.js"),[],import.meta.url),ae(()=>import("./C1rnC5hf.js"),[],import.meta.url)])).map(r=>r.default||r);await n.createRootFile("Cuby_Generator.link","Cuby Generator",null,{meta:[[v.POSITION,{x:236,y:394}],[v.IGNORE_SYMBOL_REARRANGE,!0],[v.WEB_URL,"https://cuby.lammpee.de"],[v.SYMBOL,X.CUBY]]}),await n.createRootFile("Nuxt_Booster.link","Nuxt Booster",null,{meta:[[v.POSITION,{x:357,y:378}],[v.IGNORE_SYMBOL_REARRANGE,!0],[v.WEB_URL,"https://basics.github.io/nuxt-booster/"],[v.SYMBOL,X.NUXT_BOOSTER]]}),await n.createRootFile("Vue_Semantic_Structure.link","Vue Semantic Structure",null,{meta:[[v.POSITION,{x:222,y:275}],[v.IGNORE_SYMBOL_REARRANGE,!0],[v.WEB_URL,"https://basics.github.io/vue-semantic-structure/"],[v.SYMBOL,X.VUE_SEMANTIC_STRUCTURE]]}),await n.createRootFile("Github.link","Github",null,{meta:[[v.POSITION,{x:159,y:386}],[v.IGNORE_SYMBOL_REARRANGE,!0],[v.WEB_URL,"https://github.com/ThornWalli/web-workbench"],[v.SYMBOL,X.GITHUB]]});const l=[{id:"Imprint.md",name:"Imprint",content:s,position:{x:0,y:390},fontFamily:e.Monospace["Courier New"],fontSize:14},{id:"Disclaimer.md",name:"Disclaimer",content:a,position:{x:80,y:390},fontFamily:e.Monospace["Courier New"],fontSize:14},{id:"Changelog.md",name:"Changelog",content:o,position:{x:0,y:305},fontFamily:e.Monospace["Courier New"],fontSize:14}];return(await n.createRootDir("Press","Press",{meta:[[v.WINDOW_SIDEBAR,!1],[v.WINDOW_SCALE,!1],[v.WINDOW_SCROLL_X,!1],[v.WINDOW_SCROLL_Y,!1],[v.POSITION,{x:80,y:320}],[v.WINDOW_SIZE,{x:100,y:120}],[v.IGNORE_SYMBOL_REARRANGE,!0]]})).addItems([{id:"Amiga-News.link",name:"Amiga-News.de",meta:[[v.WEB_URL,"https://www.amiga-news.de/de/news/AN-2022-07-00094-DE.html"],[v.SYMBOL,X.LARGE_NOTE_RICH],[v.POSITION,{x:10,y:10}]]}]),Promise.all(l.map(({id:r,name:I,content:u,position:g,fontFamily:N,fontSize:m})=>n.createRootFile(r,I,{openMaximized:!0,type:"markdown",content:u,fontFamily:N||e.SansSerif.Arial,fontSize:m||t},{meta:[[v.POSITION,g],[v.IGNORE_SYMBOL_REARRANGE,!0],[v.SYMBOL,X.LARGE_NOTE_RICH]]}))).catch(r=>{throw new Error(r)})}class Ns{constructor({name:e,core:t,config:o={},commands:s,contextMenu:a}){b(this,"config");b(this,"commands");b(this,"name");b(this,"core");b(this,"contextMenu");this.name=e||"Module",this.core=t,this.config=o,this.commands=s,this.contextMenu=a}beforeSetup(){var t,o;const e=this.core;e.config.setDefaults(this.config),typeof this.commands=="function"&&(this.commands=$e(this.commands({core:e,module:this})),k.add(this.commands)),typeof this.contextMenu=="function"&&(this.contextMenu=new St(this.contextMenu,{core:e,module:this}),(o=(t=this.core.modules.windows)==null?void 0:t.contextMenu)==null||o.addDefaultItems(this.contextMenu))}setup(){this.log(this.name)}destroy(){Array.isArray(this.commands)&&k.remove(this.commands)}log(e){this.core.logger.add(e,{namespace:this.name})}}const qt={xmlns:"http://www.w3.org/2000/svg",width:"31",height:"30",class:"wb_symbol_disk_1"};function Xe(n,e){return M(),V("svg",qt,e[0]||(e[0]=[S("path",{d:"M0 0h25v2h2v2h2v2h2v24H0z",class:"svg-secondary"},null,-1),S("path",{fill:"#FFF",d:"M2 2v26h27V6h-2V4h-2V2",class:"svg-primary"},null,-1),S("path",{fill:"#FA5",d:"M7 2h13v10H7z",class:"svg-tertiary"},null,-1),S("path",{d:"M11 2h5v8h-5z",class:"svg-secondary"},null,-1)]))}const qe={render:Xe},Cs=Object.freeze(Object.defineProperty({__proto__:null,default:qe,render:Xe},Symbol.toStringTag,{value:"Module"})),Qt=["data-id"],Kt={key:0},Zt=["innerHTML"],Jt=ue({__name:"Item",props:{parentLayout:{type:Object,default(){return null}},clampGlobal:{type:Boolean,default:!1},container:{type:Boolean,default(){return!1}},item:{type:ut,default(){return{id:null,command:null,model:{title:"Item Title",url:null,symbol:qe,used:!1,visible:!0},layout:{position:c(0,0),size:c(50,50)}}}},scrollOffset:{type:Object,default(){return c(0,0)}},wrapper:{type:Object,default:null}},emits:["click"],setup(n,{emit:e}){var _e,Se;const t=n,{core:o}=ye(),s=e,a=x(t.wrapper.selectedItems),l=x(null),f=x(!1),r=Be({start:c(0,0),move:c(0,0),lastPosition:c(0,0),offset:c(0,0),scrollOffset:c(0,0)}),I=new Ot,u=x(null),g=x(null),N=(_e=o.value)==null?void 0:_e.modules.screen,m=(Se=o.value)==null?void 0:Se.modules.symbols,d=E(()=>t.item.command),p=E(()=>t.item.id),_=E(()=>t.item.model),T=E(()=>t.item.layout),H=E(()=>_.value.url?"a":"span"),O=E(()=>_.value.url?{href:_.value.url,target:_.value.url?"_blank":null,title:_.value.title}:{}),W=E(()=>(N==null?void 0:N.contentLayout)||{position:c(0,0),size:c(0,0)}),$=E(()=>a.value.includes(p.value)),K=E(()=>({moving:f.value,selected:$.value,"symbol-used":_.value.used}));D(()=>_.value,()=>{i()},{deep:!0}),ke(()=>{var h;g.value=(h=u.value)==null?void 0:h.parentElement,i()}),De(()=>{I.unsubscribe(),t.wrapper.unselectItem(p)});function G(h){t.item.setLayout(h)}let Z;function i(){G({size:c(200,200)}),window.cancelAnimationFrame(Z),Z=window.requestAnimationFrame(()=>{var w;const h=(w=u.value)==null?void 0:w.children[0];h&&h instanceof HTMLElement&&G({size:c(h.offsetWidth||0,h.offsetHeight||0)})})}function C(h){const{width:w,height:R,left:L,top:A}=h.getBoundingClientRect();return{position:c(L,A),size:c(w,R)}}function F(h){var R;h=It(h);const w=p.value;if(!(_.value.url&&$.value)&&(h.preventDefault(),!_.value.used)){if(d.value&&$.value){const L={showCommand:!1,show:!0};return t.wrapper.unselectItem(w),_.value.used=!0,(R=o.value)==null?void 0:R.executeCommand(d.value,L).then(()=>_.value.used=!1)}he.shiftActive?t.wrapper.isSelectedItem(w)?t.wrapper.unselectItem(w):t.wrapper.selectItem(w):(m&&m.getSelectedItems().length>0&&m.clearSelectedItems(),t.wrapper.selectItem(w)),se(c(h.x,h.y)),s("click")}}function B(){if(m){const h=m.getSelectedItems().filter(R=>R.id!==p.value),w=t.wrapper.get(p.value);h.length>0&&w.fsItem instanceof mt&&h.forEach(R=>t.wrapper.moveItemToItem(R.fsItem,w.fsItem))}}function se(h){if(g.value){const w=C(g.value);r.lastPosition=c(T.value.position.x,T.value.position.y),r.scrollOffset=c(t.scrollOffset.x,t.scrollOffset.y),r.start=h,r.offset=c(()=>r.start-T.value.position),Y(h,w,!0),f.value=!0;let R=h;const L=he.pointerMove.subscribe(A=>{R=c(A.x,A.y),Y(c(A.x,A.y),w,!0)});I.add(he.pointerUp.pipe(Nt()).subscribe(()=>{if(L.unsubscribe(),m&&m.getSecondaryWrapper().id!==t.wrapper.id)return t.wrapper.moveItem(p.value,m.getSecondaryWrapper()).then(A=>{var be,Ee;return A||G({position:c((be=r.lastPosition)==null?void 0:be.x,(Ee=r.lastPosition)==null?void 0:Ee.y)}),l.value=null,f.value=!1,A});if(f.value=!1,Y(R,w),!T.value.position.equals(c(()=>r.start-r.offset)))return t.wrapper.savePosition(p.value,T.value.position)}))}}function Y(h,w,R=!1){const L={min:c(0,0),max:c(()=>w.size-T.value.size)};r.move=c(()=>h-r.start);let A=c(()=>Math.round(r.start+r.move-r.offset));R?(L.min=w.position,L.max=c(()=>L.max+W.value.position),A=c(()=>Math.round(A+L.min)),t.clampGlobal?l.value=c(()=>Math.max(Math.min(A,W.value.position+t.wrapper.size-T.value.size),L.min)):l.value=A):(t.wrapper.root?G({position:c(()=>Math.max(Math.min(A,t.wrapper.size-T.value.size),0))}):G({position:c(()=>Math.max(A,0))}),l.value=null)}return(h,w)=>(M(),V("figure",{ref_key:"rootEl",ref:u,"data-id":p.value,class:Ue(["wb-env-atom-symbol-wrapper-item",K.value]),style:ie([T.value.size.toCSSVars("item-size"),(l.value||T.value.position).toCSSVars("item-position")]),"touch-action":"none",onPointerdown:F,onPointerup:B},[(M(),U(Ne(H.value),le(tt(O.value)),{default:z(()=>{var R;return[_.value.symbol?(M(),V("i",Kt,[(M(),U(Ne((R=st(m))==null?void 0:R.symbols.get(_.value.symbol))))])):Q("",!0),S("figcaption",{innerHTML:_.value.title},null,8,Zt)]}),_:1},16))],46,Qt))}}),es=me(Jt,[["__scopeId","data-v-a9c4c82c"]]),ts=ue({__name:"SymbolWrapper",props:{core:{type:Object,default:null},parentLayout:{type:Object,default(){return{size:c(window.innerWidth,window.innerHeight)}}},parentScrollable:{type:Boolean,default:!0},parentFocused:{type:Boolean,default:!1},clampSymbols:{type:Boolean,default:!1},wrapperId:{type:String,required:!0}},emits:["ready","refresh"],setup(n,{emit:e}){var Z;const t=x(null),o=x(null),s=x(null),a=n,l=x((Z=a.core.modules.symbols)==null?void 0:Z.get(a.wrapperId)),f=e,r=E(()=>l.value.items.value),I=x(l.value.selectedItems),u=re(a.core.config.observable),g=E(()=>l.value.layout),N=E(()=>{var i;return{"parent-scrollable":a.parentScrollable,active:(((i=a.core.modules.symbols)==null?void 0:i.primaryWrapper)||{}).id===l.value.id}}),m=E(()=>a.parentLayout&&"scrollOffset"in a.parentLayout?a.parentLayout.scrollOffset:c(0,0)),d=E(()=>{const i=[m.value.toCSSVars("symbol-wrapper-scroll-offset")];return a.parentScrollable?i.push(p.value.toCSSVars("symbol-wrapper-size")):i.push(g.value.size.toCSSVars("symbol-wrapper-size")),i}),p=E(()=>r.value.map(i=>({item:i,index:I.value.indexOf(i.id)+1})).sort((i,C)=>i.index>C.index?1:i.index<C.index?-1:0).reduce((i,{item:C})=>{const F=C.layout.position.x+C.layout.size.x,B=C.layout.position.y+C.layout.size.y;return i.x=i.x<F?F:i.x,i.y=i.y<B?B:i.y,i},wt(0,0))),_=E(()=>u[dt.SHOW_INVISIBLE_SYMBOLS]),T=E(()=>r.value.filter($)),H=E(()=>(a.parentLayout||{}).size);D(()=>a.parentFocused,i=>{O(i)}),D(()=>a.wrapperId,i=>{var C;(C=a.core.modules.symbols)==null||C.get(i),W()}),D(()=>H,()=>{W()}),D(()=>p,()=>{Ce(()=>{f("refresh",{scroll:!0})})}),ke(()=>{Ce(()=>{W(),O(a.parentFocused),f("ready")})}),De(()=>{var i,C,F,B,se,Y;(i=a.core.modules.symbols)!=null&&i.getPrimaryWrapper()&&((C=a.core.modules.symbols)==null?void 0:C.getPrimaryWrapper().id)===l.value.id&&((F=a.core.modules.symbols)==null||F.setPrimaryWrapper(null)),(B=a.core.modules.symbols)!=null&&B.getSecondaryWrapper()&&((se=a.core.modules.symbols)==null?void 0:se.getSecondaryWrapper().id)===l.value.id&&((Y=a.core.modules.symbols)==null||Y.setSecondaryWrapper(null))});function O(i=!1){a.core.modules.symbols&&(i?a.core.modules.symbols.setPrimaryWrapper(l.value):a.core.modules.symbols.getPrimaryWrapper()&&a.core.modules.symbols.getPrimaryWrapper().id===l.value.id&&a.core.modules.symbols.setPrimaryWrapper(null))}function W(){if(t.value){const{left:i,top:C}=t.value.getBoundingClientRect();l.value.setLayout({position:c(i,C),size:a.parentLayout.size}),l.value.setSize(c(t.value.offsetWidth,t.value.offsetHeight)),l.value.setParentSize(a.parentLayout.size)}}function $(i){return _.value||!_.value&&i.model.visible}function K(){var i;(i=a.core.modules.symbols)==null||i.setSecondaryWrapper(l.value)}function G(i){(i.target===o.value||i.target===s.value)&&l.value.clearSelectedItems()}return(i,C)=>(M(),V("div",{ref_key:"rootEl",ref:t,class:Ue(["wb-env-symbol-wrapper",N.value]),style:ie(d.value),onPointerdown:G,onPointermove:K},[S("div",{ref_key:"helperEl",ref:o,class:"helper"},null,512),S("div",{ref_key:"itemsEl",ref:s,class:"items"},[(M(!0),V(ze,null,Ve(T.value,(F,B)=>(M(),U(es,{key:B,item:F,"clamp-global":n.clampSymbols,wrapper:l.value,"parent-layout":g.value,"scroll-offset":m.value},null,8,["item","clamp-global","wrapper","parent-layout","scroll-offset"]))),128))],512)],38))}}),Ts=me(ts,[["__scopeId","data-v-0de2d623"]]);export{Pe as C,Ns as M,Ts as W,Cs as d};
