const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./PS5SoCZn.js","./Cd9UeY_V.js","./CfrwDXeG.js","./D4lI5vpz.js","./AyGIKDDV.js","./BOYliybv.js","./CYlf7ZdY.js","./DPrRmE96.js","./CzhC_tPS.js","./CS4M017p.js","./CE3sgpCi.js","./BL5nqs-c.js","./BvRISv78.js","./CwcNSeQ9.js","./C5mdboMC.js","./C6HPuhbs.js","./Cpj98o6Y.js","./B6KsP_aU.js","./gfIAX8eU.js","./DlfJZ9EB.js","./JXQ19Fa6.js","./6C4StZv5.js","./C6aID195.js","./CSlkdJUE.js","./__NSLBDc.js","./CNkvSXuu.js","./BY0KaPQX.js","./CGk7t0fz.js","./BXIB5LbF.js","./C3zvzGZe.css","./CL8geYCd.js","./x2UXwtQn.css","./B1316_8w.js","./B_usvsmx.css","./BN92RPm7.js","./M1_-lv_V.css","./DogGH0My.js","./iKMg5t-_.css","./Ck78BBCY.js","./8q2Z1dNm.css","./Dr9DEtSu.js","./BWMaiRCQ.js","./Dwimt4ZI.js","./BZb93yOb.js","./D0k1iu44.css","./D6W2Pk7K.js","./Bh1f2B9j.css","./DmCMAY6H.js","./0lJVpglL.js","./D7n7Xkqx.js","./DghZOmHd.js","./EI17i-bG.js","./CZcN4aev.css","./DYdbFn8U.js","./CyPS_EfQ.js","./mUv7Us8e.js","./CU7nMArO.js","./FwzKVvsF.js","./BXMp5RLQ.js","./D-ayEwVc.js","./Bj7_mC34.js","./DF9gzcSG.js","./CzufHaTc.js","./BiyAQ2W_.js","./Bf7OyeoU.js","./DPYYzmKN.js","./CeE_iCN-.js","./qIUDYtRx.js","./DSa_b-wf.js","./B2T_rDao.js","./Dwavv3_s.js","./6A-9wLFC.js","./aqFMQJ2H.js","./BKoQiQOy.js","./DnSGt5Pz.js","./BCqR3XYH.js","./D6EmXOSU.js","./D2B2Q84m.js","./CZfA0VOl.js","./B6CFzlle.js","./CV7vdT3F.js","./oVgEpH-i.js","./RJTi0z-P.js","./BcBY3IVj.js","./D6dU8o4d.js","./DBEmKHU_.js","./BXot0GSt.js","./BvrJyH6c.js","./CNUZDaVi.js","./Byqm8odu.js","./CzCWicxH.js","./uSzHJ9u_.js","./DLeaTRmW.js","./esh0LbWA.js","./Dvds7d43.js","./DEXMY_Zs.js","./qTsJual8.js","./DRSOMj1Z.js","./G3rjhkDV.js","./C0MNuf2_.js","./BHdfLvOx.js","./CGJAvQPZ.js"])))=>i.map(i=>d[i]);
var Kt=Object.defineProperty;var Et=a=>{throw TypeError(a)};var Zt=(a,e,t)=>e in a?Kt(a,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):a[e]=t;var E=(a,e,t)=>Zt(a,typeof e!="symbol"?e+"":e,t),vt=(a,e,t)=>e.has(a)||Et("Cannot "+t);var c=(a,e,t)=>(vt(a,e,"read from private field"),t?t.call(a):e.get(a)),L=(a,e,t)=>e.has(a)?Et("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(a):e.set(a,t),M=(a,e,t,r)=>(vt(a,e,"write to private field"),r?r.call(a,t):e.set(a,t),t);var te=(a,e,t,r)=>({set _(i){M(a,e,i,t)},get _(){return c(a,e,r)}});import{M as Ze,W as qt,C as Jt}from"./CwcNSeQ9.js";import{a as at,b as _t,l as Qt,r as er,s as Ne,c as st}from"./DghZOmHd.js";import{u as k,d as it,e as se,w as Be,f as D,g as fe,h as tr,p as xt,j as rr,k as nt,D as ot,T as Ue,F as xe,R as ar,l as sr,m as yt,n as It,S as ir,C as nr,o as or,b as lt,a as St,q as U,O as me,r as Ye,s as ze,t as lr,I as et,E as Ge}from"./B6KsP_aU.js";import{c as Wt,a as Ct}from"./C5mdboMC.js";import{d as Me,A as h,T as Xe}from"./C6HPuhbs.js";import{J as N,d as ne,j as I,r as j,$ as ur,o as ht,a0 as cr,t as x,v as T,x as W,z as S,N as be,a9 as Ee,A as ie,C as ce,F as B,_ as oe,K as Ie,D as Te,Y as ut,Z as ct,y as mt,a7 as mr,I as He,H as b,a as dr,W as pr}from"./CYlf7ZdY.js";import{i as gt}from"./gfIAX8eU.js";import{W as qe}from"./BXIB5LbF.js";import{W as K}from"./DogGH0My.js";import{W as De}from"./Ck78BBCY.js";import{W as fr}from"./fxYYEoKC.js";import{W as ge}from"./CVVz7dGi.js";import{u as Je}from"./BWMaiRCQ.js";import{u as Qe,d as wt,M as z,C as dt}from"./Dr9DEtSu.js";import{A as Vt}from"./DlyVNOZd.js";import{C as hr,a as gr}from"./ey0azPGz.js";import{I as R,S as w}from"./__NSLBDc.js";import{W as kt}from"./BN92RPm7.js";import{W as At}from"./D6W2Pk7K.js";import{c as wr}from"./dKD_XmLJ.js";import{O as br,a as Ft}from"./JXQ19Fa6.js";import{p as Er,a as vr,f as Mt}from"./BJf3EjpZ.js";import{m as _r,e as yr}from"./D7n7Xkqx.js";import{c as Ir}from"./CSlkdJUE.js";import{S as Sr}from"./DlfJZ9EB.js";import"./CNkvSXuu.js";import"./BY0KaPQX.js";import"./CGk7t0fz.js";import"./CL8geYCd.js";import"./B1316_8w.js";import"./DmCMAY6H.js";import"./D4lI5vpz.js";import"./0lJVpglL.js";import"./6C4StZv5.js";import"./EI17i-bG.js";import"./C6aID195.js";import"./Cpj98o6Y.js";import"./Dwimt4ZI.js";import"./BZb93yOb.js";import"./CJLX7oOC.js";var Ar=Array.isArray,Rr=Object.getPrototypeOf,Tr=Object.prototype,Dr=Object.keys;function $r(a){if(a.length===1){var e=a[0];if(Ar(e))return{args:e,keys:null};if(Pr(e)){var t=Dr(e);return{args:t.map(function(r){return e[r]}),keys:t}}}return{args:a,keys:null}}function Pr(a){return a&&typeof a=="object"&&Rr(a)===Tr}function Lr(a,e){return a.reduce(function(t,r,i){return t[r]=e[i],t},{})}function Nr(){for(var a=[],e=0;e<arguments.length;e++)a[e]=arguments[e];var t=Er(a),r=vr(a),i=$r(a),s=i.args,n=i.keys;if(s.length===0)return Mt([],t);var l=new br(Or(s,t,n?function(o){return Lr(n,o)}:Ft));return r?l.pipe(_r(r)):l}function Or(a,e,t){return t===void 0&&(t=Ft),function(r){Rt(e,function(){for(var i=a.length,s=new Array(i),n=i,l=i,o=function(m){Rt(e,function(){var g=Mt(a[m],e),d=!1;g.subscribe(Ir(r,function(p){s[m]=p,d||(d=!0,l--),l||r.next(t(s.slice()))},function(){--n||r.complete()}))},r)},u=0;u<i;u++)o(u)},r)}}function Rt(a,e,t){a?yr(t,a,e):e()}var pt=(a=>(a.STRING="string",a.ANY="any",a.INTEGER="integer",a.TERM="term",a.BOOLEAN="boolean",a.DOUBLE="double",a))(pt||{});function Oe(a,e){return a.separator===e}function xr(a){return{rawCommand:"",mergeArgs:!1,mergeArgsBy:/^[+,]$/,hasProgram:!1,activeArgument:void 0,isLongArgument:!1,isKeyWordArgument:!1,isString:!1,stringTmpValue:void 0,additionSpecial:!1,specialChar:["+",";",","],isBufferWrite:!1,isBufferValue:!1,isBufferString:!1,rawBuffer:void 0,lastChar:void 0,isSeparating:!1,escaped:!1,currentTick:Yt,isClamp:!1,...a,separator:a.separator||Bt}}function ve(a,{separator:e,forceProgram:t,mergeArgs:r,mergeArgsBy:i}={}){var l,o;const s=xr({separator:e||Bt});a=`${String(a).trim()}${s.separator}`,s.rawCommand=a,s.mergeArgs=r||!1,s.mergeArgsBy=i||s.mergeArgsBy;const n=[];for(;s.rawCommand.length;){const u=s.rawCommand[0];s.rawCommand=s.rawCommand.slice(1);const m=s.rawCommand[0];if(Oe(s,m)){if(s.isSeparating&&Oe(s,u))s.isSeparating=!1;else if(!s.isBufferWrite&&Oe(s,u)){s.isSeparating=!0;continue}}else s.isSeparating=!1;if((Oe(s,u)&&!s.isClamp||s.rawCommand.length<1)&&(!s.escaped&&s.isBufferValue&&!s.isBufferString&&(s.isBufferWrite=!1),!s.isBufferWrite&&(s.isBufferValue&&zr(s),s.activeArgument))){Xr(s,n);continue}if(u===Ut&&s.activeArgument){s.isKeyWordArgument=!0;continue}else if((u===tt&&(/[ +a-zA-Z]/.test(m)||m===tt)||s.activeArgument&&!s.isKeyWordArgument)&&!s.isBufferWrite&&!s.specialChar.includes(u))if(s.activeArgument){!((o=(l=s.activeArgument)==null?void 0:l.name)!=null&&o.length)&&u===tt?s.isLongArgument=!0:s.activeArgument.name+=u;continue}else{s.activeArgument={name:he},s.isLongArgument&&(s.activeArgument.long=s.isLongArgument);continue}Yr(s,u)}return Fr(n,{forceProgram:t,mergeArgs:r,mergeArgsBy:i})}function Wr(a){var e,t,r;return((e=a.value)==null?void 0:e.type)==="any"&&!a.name&&((t=a.value)==null?void 0:t.raw)&&/^[a-zA-Z]+$/.test((r=a.value)==null?void 0:r.raw)||!1}function Cr(a){var e;return((e=a.value)==null?void 0:e.raw)==="+"}function Vr(a,e=/^[+]$/){return a.reduce((t,r)=>{var n,l,o,u,m,g;const i=(l=(n=t[t.length-1])==null?void 0:n.value)==null?void 0:l.raw,s=i&&i[String(i).length-1];if(typeof e=="string"&&(String((o=r.value)==null?void 0:o.raw)===e||String(s)===e)||e instanceof RegExp&&(e.test(String((u=r.value)==null?void 0:u.raw))||e.test(String(s)))){const d=t[t.length-1].value;d&&d.raw&&typeof d.value=="string"&&(d.raw+=(m=r.value)==null?void 0:m.raw,d.value+=((g=r.value)==null?void 0:g.value)||"",d.type="any")}else t.push(r);return t},Array())}function kr(a,e){const t=[];return a&&t.push(a),t.push(...e.map(r=>{var i,s;if(r.plain)return((i=r.value)==null?void 0:i.raw)||r.name||he;{const n=r.long?"--":"-",l=r.name||he,o=((s=r.value)==null?void 0:s.raw)||he,u=r.value?Ut:"";return`${n}${l}${u}${o}`}})),t}function Fr(a,{forceProgram:e,mergeArgs:t,mergeArgsBy:r}={}){var u;const i=a[0],s=a[1];let n;(!s||!Cr(s))&&i&&(Wr(i)||e)&&(a=a.filter(m=>m!==i),n=(u=i.value)==null?void 0:u.raw);let l=a;t&&(l=Vr(a,r));const o=kr(n,l);return{program:n,args:l,rawArgs:o}}const Mr="\\",he="",Bt=" ",tt="-",Ut="=",Yt='"',Br="'";function Ur(a){return a===Mr}function Yr(a,e){Ur(e)?a.escaped=!0:(!a.escaped&&!a.isBufferValue&&!Oe(a,e)?(a.isBufferWrite=!0,a.isBufferValue=!0,(e===Br||e===Yt)&&!a.isClamp&&(a.currentTick=e,a.isBufferString=!0),a.isBufferString=e===a.currentTick,a.rawBuffer=void 0,a.activeArgument=a.activeArgument||{value:void 0,plain:!0}):e===a.currentTick&&a.isBufferString&&!a.escaped&&!a.isClamp&&(a.isBufferWrite=!1),(e!==a.currentTick||a.isClamp||a.escaped&&e===a.currentTick)&&((!a.isBufferWrite&&a.isBufferString||a.isBufferWrite&&!a.isBufferString)&&!a.isClamp&&a.specialChar.includes(e)&&!a.additionSpecial?(a.rawCommand=" "+e+" "+a.rawCommand,a.additionSpecial=!0):(a.additionSpecial=!1,a.rawBuffer=(a.rawBuffer||"")+e)),a.escaped=!1),a.isBufferWrite&&(e==="("?a.isClamp=!0:e===")"&&(a.isClamp=!1)),a.lastChar=e}function Gr(a){var e,t,r;return a.plain&&!a.name&&((e=a.value)==null?void 0:e.type)==="any"&&(((t=a.value)==null?void 0:t.raw)===void 0||((r=a.value)==null?void 0:r.raw)===he)}function Xr(a,e){a.activeArgument&&(a.isLongArgument&&(a.activeArgument.long=a.isLongArgument),Gr(a.activeArgument)||e.push(a.activeArgument)),a.activeArgument=void 0,a.isLongArgument=!1,a.isKeyWordArgument=!1}function zr(a){const e=a.rawBuffer||he;if(a.isBufferString)a.activeArgument.value={type:"string",value:a.rawBuffer,raw:`${a.currentTick}${a.rawBuffer||""}${a.currentTick}`};else{let t="any",r=e;/^[+-]?\d+$/.test(e)?(t="integer",r=Math.round(Number(e))):/^[+-]?(?:\d+\.?\d*|\.\d+)$/.test(e)?(t="double",r=Number(e)):/^true|false$/.test(e)?(t="boolean",r=e==="true"):/^[a-zA-Z$]+$/.test(e)?(t="any",r=String(e).replace(/ /g,he)):/^[\d+\-*./a-zA-Z$]+$/.test(e)&&(t="term",r=String(e).replace(/ /g,he)),a.activeArgument.value={type:t,value:r,raw:a.rawBuffer}}a.rawBuffer=void 0,a.isBufferValue=!1,a.isBufferString=!1}var We;const J=class J{constructor(e){L(this,We);M(this,We,e)}async parse(e){const t=ve(e,{forceProgram:!0}),r=await this.getArguments(t);return{origin:e,unresolved:jr(t),args:r.args,kwargs:r.kwargs,command:t.program||"",commandValue:e}}async getArguments(e){return{args:await Promise.all(e.args.filter(t=>t.plain).map(t=>{if(t.value)return this.parseValue(t.value)})),kwargs:Object.fromEntries(await Promise.all(e.args.filter(t=>!t.plain).map(async t=>[Wt(t.name||""),t.value&&await this.parseValue(t.value)||void 0])))}}parseValue({value:e,type:t}){return typeof e=="string"&&[pt.ANY,pt.TERM].includes(t)?c(this,We).parse(e.replace(/ *([a-zA-Z_-]+) */,"$1")):Promise.resolve(e)}static extractStrings(e){let t=!1,r=0;const i=[];let s=!1;for(let l=e.length-1;l>=0;l--){const o=e[Number(l)],u=e[l-1];!s&&o==='"'&&u!=="\\"?t?(t=!1,i.push(e.slice(l,r+1))):(s=!1,t=!0,r=l):(!t&&s||s)&&o==="'"&&u!=="\\"&&(t?(s=!1,t=!1,i.push(e.slice(l,r+1))):(s=!0,t=!0,r=l))}if(t)throw new Error("can't extract values; "+e);return{result:i.reduce((l,o,u)=>l.replace(o,J.resolveKey(u)),e),values:i}}static extractValues(e,t=" "){let r=!1,i=0;const s=[];let n=!1;for(let o=e.length-1;o>=0;o--){const u=e[Number(o)],m=e[o-1];!n&&u==='"'&&m!=="\\"?r?(r=!1,s.push(e.slice(o,i+1))):(n=!1,r=!0,i=o):(!r&&n||n)&&u==="'"&&m!=="\\"&&(r?(n=!1,r=!1,s.push(e.slice(o,i+1))):(n=!0,r=!0,i=o))}if(r)throw new Error("can't extract values; "+e);return s.forEach((o,u)=>{e=e.replace(o,J.resolveKey(u))}),{params:e.split(t).filter(o=>o),values:s}}static resolveKey(e){return`$$$$$$${e}`}static resolveValues({params:e,values:t}){return e.map(r=>J.resolveValue(r,t))}static valueUnresolved(e){return typeof e=="string"&&J.REGEX_VALUE_RESOLVE.test(e)}static resolveValue(e,t){var i;let r=e;if(J.valueUnresolved(e)){if(r=(i=String(e).match(/[$]{3}(\d+)/g))==null?void 0:i.reduce((s,n)=>s.replace(n,t[Number(n.replace(J.REGEX_VALUE_RESOLVE,"$1"))]),String(e)),/[\w]+[$%]?[ ]*\(/.test(r||""))return r;if(typeof r=="string"){if(r==="undefined")return;if(Hr(r))return Number(r);if(!r.startsWith('"'))return r}}return r}};We=new WeakMap,E(J,"REGEX_VALUE_RESOLVE",/[$]{3}(\d+)/),E(J,"REGEX_COMMAND_REPLACE",/^([a-zA-Z]+[a-zA-Z0-9_]+) (.*)$/),E(J,"REGEX_PARAM_KWARG",/^[-]{0,2}([\\-\w]+)=(.*)$/),E(J,"REGEX_PARAM_ARG",/^[-]{1,2}([\\-\w]+)$/);let H=J;function Hr(a){return!isNaN(Number(a))}function jr(a){return{args:a.args.filter(e=>e.plain).map(e=>{var t;return((t=e.value)==null?void 0:t.raw)||""}),kwargs:Object.fromEntries(a.args.filter(e=>!e.plain).map(e=>{var t;return[Wt(e.name||""),((t=e.value)==null?void 0:t.raw)||""]}))}}var Se;class Gt{constructor(e,t,r,i){E(this,"name");L(this,Se);E(this,"global",!1);E(this,"readonly",!1);this.name=e,M(this,Se,t),this.global=r||this.global,this.readonly=i||this.readonly}get value(){return c(this,Se)}set value(e){this.readonly||M(this,Se,e)}}Se=new WeakMap;class Kr extends Gt{constructor(e,t,r=!1){super(e,t,r,!0)}async execute(...e){if(typeof this.value=="function")return this.value(...e)}}class ft extends Gt{}var F,de,Y;class bt{constructor(){L(this,F,new Map);L(this,de,new Map);L(this,Y,[])}reset(){this.resetPrefixStack(),c(this,F).clear(),c(this,de).clear()}resetPrefixStack(){M(this,Y,[])}get prefixStack(){return c(this,Y)}get currentPrefixStack(){return c(this,Y)[c(this,Y).length-1]}has(e){var t;return e=e.replace(/(.*[^ ])[ ]+$/,"$1"),e=e.replace(/[$%]$/,""),(!c(this,F).get(e)||c(this,F).get(e)&&!((t=c(this,F).get(e))!=null&&t.global))&&(e=this.prepareName(e)),c(this,F).has(e)}add(e,t,r=!1,i=!1){e=e.replace(/(.*[^ ])[ ]+$/,"$1"),/\$$/.test(e)?t===void 0&&(t=""):/\\%$/.test(e)&&t===void 0&&(t=0),e=e.replace(/[$%]$/,""),e=this.prepareName(e),this.has(e)||c(this,F).set(e,new ft(e,t,r,i))}get(e){var i;e=e.replace(/(.*[^ ])[ ]+$/,"$1");const t=e;e=e.replace(/[$%]$/,""),(!c(this,F).get(e)||c(this,F).get(e)&&!((i=c(this,F).get(e))!=null&&i.global))&&(e=this.prepareName(e));const r=c(this,F).get(e);if(r){let s=r.value;return s&&typeof s=="string"&&(/\$$/.test(t)?s=String(s):/\\%$/.test(t)||/^\d+$/.test(s)?s=parseInt(s):/^[\d.]+$/.test(s)&&(s=parseFloat(s))),s}}set(e,t,r=!1,i=!1){if(e=e.replace(/(.*[^ ])[ ]+$/,"$1"),typeof t=="string"&&(/[$]$/.test(e)?t===void 0?t="":t=String(t):/[%]$/.test(e)&&(t===void 0?t=0:t=parseInt(t))),e=e.replace(/[$%]$/,""),e=this.prepareName(e),this.has(e)){const s=c(this,F).get(e);s instanceof ft&&s&&(s.value=t)}else this.add(e,t,r,i)}addSub(e,t){e=this.prepareName(e,!1),this.has(e)||c(this,de).set(e,new Kr(e,t))}async executeSub(e,t=[],r=!1){t=t||[],e=this.prepareName(e,!1),c(this,Y).push({name:`${Math.round(Math.random()*1e4)}`,global:r});const i=c(this,de).get(e);return i==null?void 0:i.execute(...t).then(s=>(c(this,F).forEach(n=>{RegExp(`[$]{3}${c(this,Y)[c(this,Y).length-1].name}$`).test(n.name)&&c(this,F).delete(n.name)}),c(this,Y).pop(),s))}hasSub(e){return e=this.prepareName(e,!1),c(this,de).has(e)}prepareName(e,t=!0){return typeof e=="string"&&(e=e.replace(/ /g,"")),t&&c(this,Y).length&&!/[$]{3}/.test(e)&&(e=`${e}$$$${c(this,Y)[c(this,Y).length-1].name}`),e}get dims(){return c(this,F)}get subs(){return c(this,de)}}F=new WeakMap,de=new WeakMap,Y=new WeakMap;var _e,Ce,V,Q,le,Ve,ke,X,Fe,ye,ue,G,pe,re,ae,Ot;let Zr=(Ot=class{constructor(e,t,r,i,s,n){E(this,"debug",!1);L(this,_e);L(this,Ce);L(this,V);L(this,Q);L(this,le);L(this,Ve,9999999999);L(this,ke,0);L(this,X);L(this,Fe,[]);L(this,ye,0);L(this,ue,[]);L(this,G,-1);L(this,pe,[]);L(this,re,[]);L(this,ae,-1);M(this,le,e),M(this,Q,t||(()=>Promise.resolve(void 0))),M(this,V,r||new bt),M(this,_e,i),M(this,Ce,s),this.debug=n!==void 0?n:this.debug}get memory(){return c(this,V)}get lines(){return c(this,le)}parse(e){var r;e=e||Array().concat(c(this,le));const t=(r=e.shift())==null?void 0:r.trim();return new Promise(i=>{if(c(this,X)&&t!=="END SUB"){t&&c(this,X).lines.push(t),i(void 0);return}if(c(this,Ve)>0&&c(this,ke)>c(this,Ve))throw new Error("BASIC INTERPRETER OVERFLOW");if(te(this,ke)._++,c(this,ae)>=0){const s=c(this,re)[c(this,ae)];if(s){if(c(this,re).forEach(n=>{s.count===0&&n&&t&&n.count===0&&n.lines.push(t)}),t&&(t==="WEND"||/NEXT /.test(t)))return s.condition().then(async n=>{if(s.tmpLines=s.tmpLines||e,n){const l=s.lines;return s.count++,s&&typeof s.step=="function"&&await s.step(),l.length>0?this.parse(Array().concat(l)):(c(this,re)[c(this,ae)]=!1,te(this,ae)._--,c(this,re).pop(),null)}else return c(this,re)[c(this,ae)]=!1,te(this,ae)._--,c(this,re).pop(),null}).then(i);i(void 0)}else i(void 0)}else i(void 0)}).then(()=>{if(!c(this,X)&&c(this,G)>=-1&&(c(this,pe)[c(this,G)]!==void 0&&c(this,ue)[c(this,G)]===void 0&&c(this,ue).push(!c(this,pe)[c(this,G)]),t==="ELSE"&&c(this,ye)<1&&(c(this,ue)[c(this,G)]=!c(this,ue)[c(this,G)])),c(this,ue)[c(this,G)])t&&/^IF (\((.*)\)|(.*)) THEN$/.test(t)&&te(this,ye)._++;else return this.parseLine(t,e);return null}).then(()=>(c(this,G)>-1&&(t==="ENDIF"||t==="END IF")&&(c(this,ye)<1?(te(this,G)._--,c(this,pe).pop(),c(this,ue).pop()):te(this,ye)._--),e.length?this.parse(e):c(this,Fe)))}parseLine(e,t){return new Promise((r,i)=>{if(e=(e||"").replace(/^[ \t]+/g,""),/^ *[#/]+/.test(e)){r(void 0);return}if(/^GOTO +([\w\d]+)$/.test(e)){const s=e.match(/^GOTO +([\w\d]+)$/)||[];this.commandGoto(t,s[1]),e=""}if(/^SUB (.*) STATIC$/.test(e)){const s=e.match(/^SUB (.*) STATIC$/)||[];return this.commandSubStatic(s[1]).then(r)}else{if(e==="END SUB")return this.commandEndSub().then(r);if(c(this,X)){r(void 0);return}}if(/^IF (\((.*)\)|(.*)) THEN$/.test(e)){const s=e.match(/^IF (\((.*)\)|(.*)) THEN$/)||[],n=s[3]||s[2];return this.commandIfThen(n).then(r)}else if(e==="ELSE"||e==="ENDIF"||e==="END IF"){r(void 0);return}if(/^WHILE (.*)$/.test(e)){const s=e.match(/^WHILE (.*)$/)||[];return this.commandWhile(s[1]).then(r)}else if(e==="WEND"){r(void 0);return}if(/^FOR (.*)$/.test(e)){const s=e.match(/^FOR (.*)$/)||[];return this.commandFor(s[1]).then(r)}else if(e.startsWith("NEXT ")){r(void 0);return}if(/^([\w\d]+):$/.test(e)){r(void 0);return}if(/^DIM( SHARED)? +(.*)$/.test(e)){const s=e.match(/^DIM( SHARED)? +(.*)$/)||[];return this.commandDimShared(s[2],!!s[1]).then(r)}if(/^LET +([\w,$%]+)(\((.*)\))? *= *(.*)$/.test(e)){const s=e.match(/^LET +([\w,$%]+)(\((.*)\))? *= *(.*)$/)||[];return this.commandLet(s[1],s[4],s[3]).then(()=>r(void 0))}if(/^READ +([\w, $%]+)$/.test(e)){const s=e.match(/^READ +([\w, $%]+)$/)||[];return this.commandRead(s[1]).then(r)}if(/^END[ ]*$/.test(e))return this.commandEnd().then(r);if(/^(PAUSE|SLEEP) +(.+)/.test(e)){const n=(e.match(/^(PAUSE|SLEEP) +(.+)/)||[])[2];return this.commandPause(n).then(r)}if(/^CALL *(.*)/.test(e)){const s=e.match(/^CALL *(.*)/)||[];return this.commandCall(s[1],t).then(r)}if(/^EXECUTE *(FILE|EVAL) *(.*)/.test(e)){const s=e.match(/^EXECUTE *(FILE|EVAL) *(.*)/)||[];return this.commandExecute(s[1],s[2]).then(r).catch(i)}if(/^PRINT +USING +.*$/.test(e)){const s=e.match(/^PRINT +USING +(.*)$/)||[];return this.commandPrintUsing(s[1]).then(r)}if(/^PRINT +(.*)$/.test(e)){const s=e.match(/^PRINT +(.*)$/)||[];return this.commandPrint(s[1]).then(r)}if(/^DATA +(.*)$/.test(e)){const s=e.match(/^DATA +(.*)$/)||[];return this.commandDataVar(s[1]).then(r)}c(this,Q).call(this,e,{show:!0}).then(s=>{s!==void 0&&c(this,Fe).push(s)}).then(r).catch(i)})}async setReadStack(e,t){let r=await this.parseValue(t,!0);return typeof r=="string"&&se(r)&&(r=parseFloat(r)),c(this,V).set(e,r,!0)}async addDataStack(e){let t=await this.parseValue(e,!0);return typeof t=="string"&&se(t)&&(t=parseFloat(t)),c(this,_e).push(t)}async setStack({name:e,value:t,index:r,global:i}){let s=await this.parseValue(t,!0);if(typeof s=="string"&&se(s)&&(s=parseFloat(s)),r!==void 0){r=Number(await this.parseValue(r,!0));const n=c(this,V).get(e);if(typeof n=="object")return n[r-1]=s,s;throw new Error(`Index ${r} out of range`)}else return c(this,V).set(e,s,i)}async setGotoMarkStack(e,t){c(this,Ce).set(e,await this.parseValue(t,!0))}async parseValue(e,t=!0,r=!1){if(e===void 0)return e;if(Array.isArray(e))return e;if(typeof e=="boolean")return e;if(typeof e=="number")return Number(e);if(typeof e=="string"){if(/^ *(true|false|TRUE|FALSE) *$/.test(e))return e.toLowerCase()==="true";if(/^[\d]+$/.test(e.trim())||/^ *([\\-]?[\d.]+(e[-+]?\d+)?) *$/.test(e.trim()))return parseFloat(e);if(/^ *@"((.|\n)*)" *$/.test(e.trim()))return e.replace(/^ *@"((.|\n)*)" *$/,'"$1"');if(/^"((\\"|[^"])+)"$/.test(e.trim()))return e.trim().replace(/^"((\\"|[^"])+)"$/,'"$1"');if(/^[^"]?(.+)[^"]? *$/.test(e.replace(/ /g,""))){if(e=e.replace(/^ */g,""),c(this,V).has(e.replace(/ /g,"")))return e=e.replace(/ /g,""),this.parseValue(c(this,V).get(e),!0);if(r)throw new Error(`Value processing continues: ${e.slice(0,20)}…'`);return c(this,Q).call(this,e,{message:t?void 0:e})}}}async executeCondition(e,t,r){const i=await this.parseValue(e,!0),s=await this.parseValue(r,!0);return/^[=]?==$/.test(t)?i===s:t==="<>"?i!==s:/^([<>][=]|[<>])?$/.test(t)?qr(i,t,s):/^!=[=]?$/.test(t)?i!==s:!1}commandIfThen(e){const t=e.match(/([^<>]*) *(<>|<=|>=|<|>|[=!]{2,3}) *([^<>].*)/);return t?this.executeCondition(t[1],t[2],t[3]).then(r=>(c(this,pe).push(r),te(this,G)._++,r)):this.parseValue(e[1],!0).then(r=>{let i=r;return r instanceof ft&&(i=r.value),c(this,pe).push(!!i),te(this,G)._++,i})}commandWhile(e){const t=e.match(/([^<>]*) *(<>|<=|>=|<|>|[=!]{2,3}) *([^<>].*)/);return t?this.executeCondition(t[1],t[2],t[3]).then(r=>{if(r)return c(this,re).push({count:0,lines:[],condition:()=>this.executeCondition(t[1],t[2],t[3])}),te(this,ae)._++,r}):Promise.resolve(void 0)}async commandFor(e){const t=e.match(/(.*) *= *(.*) +TO +(.*) +STEP[ ](.*)/)||e.match(/(.*) *= *(.*) +TO +(.*)/);if(t){const r=await this.parseValue(t[2],!0),i=await this.parseValue(t[3],!0);c(this,V).set(t[1],r),te(this,ae)._++;const s=async(n=!0)=>{let l=1;return t[4]&&(l=await this.parseValue(t[4],!0)),n&&c(this,V).set(t[1],Number(c(this,V).get(t[1]))+l),l};return c(this,re).push({step:s,count:0,lines:[],condition:async()=>{const n=await s(!1);return n===0?!1:this.executeCondition(`(${t[1]}  )`,n<0?">":"<",String(i))}})}}commandSubStatic(e){const t=e.match(/^([\w,$%]+)(\((.*)\))?$/)||[],r=t[1],i=H.resolveValues(H.extractValues(t[3]||"",","));return M(this,X,{name:r,lines:[],args:i}),Promise.resolve(void 0)}commandEndSub(){if(c(this,X)){const e=c(this,X).lines,t=c(this,X).args;c(this,V).addSub(c(this,X).name,async(...r)=>{(await Promise.all(t.map((s,n)=>this.parseValue(r[Number(n)]).then(l=>({arg:s,value:l}))))).forEach(({arg:s,value:n})=>{s&&c(this,V).add(String(s),n)}),await this.parse(Array().concat(e))}),M(this,X,void 0)}else throw new Error("has no active SUB");return Promise.resolve(void 0)}commandGoto(e,t){return e.splice(0,e.length),this.parse(c(this,le).slice(c(this,le).indexOf(`${t}:`),c(this,le).length))}commandDimShared(e,t){return H.resolveValues(H.extractValues(e,",")).reduce((i,s)=>{const n=String(s||"").match(/^([\w, $%]+)?(\((.*)\))?$/)||[];return c(this,V).has(n[1])||(n[3]&&(i=i.then(()=>this.parseValue(n[3],!0))),i=i.then(l=>(this.setStack({name:n[1],value:l?Array(l):void 0,global:t}),l))),i},Promise.resolve(void 0))}commandLet(e,t,r){if(c(this,V).has(e))return this.setStack({name:e,value:t,index:r});throw new Error(`Variable ${e} not defined`)}async commandPrintUsing(e){const t=ve(e,{mergeArgs:!0,mergeArgsBy:/^[+,]$/}).rawArgs,r=ve(t[2],{mergeArgs:!0}).rawArgs.filter(n=>n!==",").map(n=>this.parseValue(n)),i=await Promise.all(r);let s=k(t[0]);for(;s.includes("#");){const n=i.shift(),l=s.match(/(#+\.#+)|(#+)/);if(l&&/(#+\.#+)/.test(l[0])){const[o,u]=l[0].split("."),[m,g]=String(n).split("."),d=at(String(m||"").slice(0,o.length),o.length,!0," ")+"."+at(String(g||"").slice(0,u.length),u.length,!1,"0");s=s.replace(/(#+\.#+)/,k(String(d)))}else s=s.replace(/(#+|#+\.#+)/,k(String(n)))}return c(this,Q).call(this,null,{message:`"${k(s)}"`})}commandDataVar(e){if(c(this,_e).length===0)return Promise.all(e.split(",").map(t=>this.addDataStack(t)));throw new Error("DATA has already been declared")}async commandPrint(e){if(/^((".*"|[^"]*);([^;]*))$/.test(e)){const t=e.match(/(.*);(.*)$/)||[],r=await this.parseValue(t[1],!0),{rawArgs:i}=ve(String(t[2]),{mergeArgs:!0});let s=await Promise.all(i.map(l=>this.parseValue(l,!0)));s=s.map(l=>k(l));const n=s.map(l=>`${k(r)}${l}`).join(" ");return c(this,Q).call(this,null,{message:it(n)||se(n)?n:`"${n}"`})}else{let t=await this.parseValue(e);const{rawArgs:r}=ve(String(t),{mergeArgs:!0});let i=await Promise.all(r.map(s=>this.parseValue(s,!0)));return i=i.map(s=>k(s)),i.length>1?t=i.join(""):t=i[0],c(this,Q).call(this,null,{message:it(t)||se(t)?t:`"${t}"`})}}commandEnd(){return Promise.resolve(void 0)}async commandPause(e){const t=Number(await this.parseValue(e));return new Promise(r=>window.setTimeout(()=>{r(void 0)},t))}commandRead(e){const t=e.split(",");return Promise.all(t.map(r=>{const i=c(this,_e).shift();return this.setReadStack(r,i),Promise.resolve(void 0)}))}commandCall(e,t){const i=(e.match(/([^(]+)\(.*\)/)||[])[1];if(c(this,V).hasSub(i))return this.parseLine(e,t);throw new Error(`SUB ${i} NOT FOUND`)}async commandExecute(e,t){if(!c(this,Q))throw new Error("No callback available for readfile");let r;switch(e){case"FILE":if(r=await c(this,Q).call(this,`readfile ${t}`,{show:!1}),r&&typeof r=="object"&&"content"in r)return c(this,Q).call(this,r.content,{show:!0});throw new Error("File Content is empty");case"EVAL":return this.parseValue(t,!1)}}},_e=new WeakMap,Ce=new WeakMap,V=new WeakMap,Q=new WeakMap,le=new WeakMap,Ve=new WeakMap,ke=new WeakMap,X=new WeakMap,Fe=new WeakMap,ye=new WeakMap,ue=new WeakMap,G=new WeakMap,pe=new WeakMap,re=new WeakMap,ae=new WeakMap,Ot);function qr(a,e,t){switch(a=String(a),t=String(t),(e.match(/^([<>][=]|[<>])$/)||[])[1]){case"<":return parseFloat(a)<parseFloat(t);case">":return parseFloat(a)>parseFloat(t);case"<=":return parseFloat(a)<=parseFloat(t);case">=":return parseFloat(a)>=parseFloat(t);default:return null}}var Ae,Re,je,Ke;class Jr{constructor(e,t){L(this,Ae);L(this,Re);L(this,je,new Map);L(this,Ke,[]);M(this,Re,t),M(this,Ae,e)}get callback(){return c(this,Re)}get memory(){return c(this,Ae)}async parse(e,t,r){if(e.length===0)return;e.length>1&&await this.readData(e);const i=[];return new Zr(e,async(n,l)=>{l={...l,...r};const o=await(t||c(this,Re)||(()=>{}))(n,l);return l.show&&o!==void 0&&i.push(o),o},c(this,Ae),c(this,Ke),c(this,je)).parse().then(()=>i)}readData(e){const t=e.find(r=>/^[ ]*DATA[ +]/.test(r));if(t){const r=e.splice(e.indexOf(t),1);return this.parse(r)}return Promise.resolve(void 0)}}Ae=new WeakMap,Re=new WeakMap,je=new WeakMap,Ke=new WeakMap;function q(...a){if(a.includes(void 0))throw new Error("invalid arguments")}const O={};try{O.brackets=/([^\w$%]?)\(([^\\(\\)]+)\)/,O.brackets_start=/^\((.*)\)$/,O.multiply=new RegExp("[^\\d$\\-\\w]?(?<a>([+-]?[\\w.]+e\\+\\d+)|([+-]?[\\w$%.]+)|(^[+-]?[\\w$%.]+)|([\\w$%.]+)|([$]{3}\\d+))[ ]*(?<operator>[\\^*%\\/]|MOD|XOR|AND|OR|<<|>>|>>>)[ ]*(?<b>([-]?[\\w.]+e\\+\\d+)|([-]?[\\w$%.]+)|(^[+-]?[\\w$%.]+)|([\\w$%.]+)|([$]{3}\\d+))"),O.add_subtract=/([+-]?[\w.]+e\+\d+|[+-]?[\w$%.]+|[$]{3}\d+)[ ]*([+-])[ ]*([+-]?[\w.]+e\+\d+|[+-]?[\w$%.]+|[$]{3}\d+)/,O.function=/([\w]+[a-zA-Z0-9_.]+[$%]?)[ ]*\(([^\\(\\)]*)\)/,O.function_start=/^([\w]+[a-zA-Z0-9_.]+[$%]?)[ ]*\(([^\\(\\)]*)\)/,O.variable=/^([\w]+[a-zA-Z0-9_.]?[$%]?)/,O.number=/^([+-]?[\d.]+e\+\d+|[+-]?[\d.])+($|$)/}catch(a){console.error(a)}class Qr{constructor(e,t){E(this,"debug",!1);E(this,"memory");this.memory=this.createMemory(e),this.debug=t!==void 0?t:this.debug}createMemory(e){const t=e||new bt;return t.addSub("RND",()=>Promise.resolve(Math.random())),t.addSub("PI",()=>Promise.resolve(Math.PI)),t.addSub("POW",(r,i)=>{if(q(r,i),typeof r=="string")throw new Error("Parameter is not a number");if(typeof i=="string")throw new Error("Parameter is not B number");return Promise.resolve(r**(i||2))}),t.addSub("SQRT",r=>{if(q(r),typeof r=="string")throw new Error("Parameter is not a number");return Promise.resolve(Math.sqrt(r))}),t.addSub("INT",async r=>(q(r),await parseInt(k(String(r))))),t.addSub("SPC",r=>{if(q(r),typeof r=="string")throw new Error("Parameter is not a number");return Promise.resolve(`"${_t(r," ")}"`)}),t.addSub("LEN",r=>(q(r),Promise.resolve(k(String(r)).length))),t.addSub("ASC",r=>(q(r),Promise.resolve(String(k(r)).charCodeAt(0)))),t.addSub("CHR$",r=>{if(q(r),typeof r=="string")throw new Error("Parameter is not a number");return Promise.resolve(Be(String.fromCharCode(r)))}),t.addSub("LEFT$",(r,i)=>{if(q(r,i),typeof i=="string")throw new Error("Parameter is not B number");return Promise.resolve(`"${Qt(k(r),i)}"`)}),t.addSub("RIGHT$",(r,i)=>{if(q(r,i),typeof i=="string")throw new Error("Parameter is not B number");return Promise.resolve(Be(er(String(k(r)),i)))}),t.addSub("STRING$",(r,i)=>{if(q(r,i),typeof r=="string")throw new Error("Parameter is not a number");return Promise.resolve(Be(_t(r,String(k(i)))))}),t.addSub("TIME%",()=>Promise.resolve(Date.now())),t.addSub("HEX_ENC$",r=>(q(r),Promise.resolve(Be(Number(k(r)).toString(16))))),t.addSub("HEX_DEC$",r=>(q(r),r=parseInt(String(k(r)),16),Promise.resolve(r))),t}async parse(e){const r=await new ta(this).parse(e);return this.debug&&console.debug("Result:",typeof r,r),r}validInput(e){return e&&/[/*\-+^()]?/.test(e)}}const ea=5e3;class ta{constructor(e,{debug:t}={}){E(this,"debug",!1);E(this,"parser");E(this,"parsedValues",[]);E(this,"timeout",0);this.parser=e,this.debug=t!==void 0?t:this.debug}async parse(e){if(this.debug&&console.debug("PARSE ".padEnd(20,"-")),this.timeout>ea)throw new Error(`Can't parse ${e}`);this.timeout++;const{result:t,values:r}=H.extractStrings(String(e));let i=ve(t).rawArgs;this.parsedValues=this.parsedValues.concat(r),i=i.map(o=>/^MOD|XOR|AND|OR$/.test(o)?` ${o} `:o);let s=i.join("");se(s)?s=Number(s):it(s)&&(s=!!s);const n=s,l=await this.action(s);if(this.debug&&console.debug("action:",typeof l,l),l!==void 0){let o;return typeof l=="string"&&l!==n&&!/^".*"$/.test(String(l))?(o=await this.parse(l),this.debug&&console.debug("parse:",typeof o,o),o):(o=await this.resolveValue(l),this.debug&&console.debug("$v:",typeof o,o),o)}}async action(e){var t,r,i,s,n,l;if(typeof e=="string"){if((t=O.brackets_start)!=null&&t.test(e)){const o=e.match(O.brackets_start);if(o){const[u,m]=o;e=e.replace(u,m)}else throw new Error("Invalid expression")}if((r=O.function)!=null&&r.test(e)){const o=e.match(O.function);if(o){const[u,m,g,d]=o,p=m||d;let f=ve(g||"",{separator:","}).rawArgs;const v=g.includes(",")&&f.join("")!==g;v&&(f=g.split(","));let _=await Promise.all(f.map($=>this.parse($)));if(_=v?_:[await this.parse(_.join(""))],this.parser.memory.has(p))return e.replace(u,(i=this.parser.memory.get(p))==null?void 0:i[Number(_[0])-1]);if(this.parser.memory.hasSub(p))return e.replace(u,this.cacheValue(await this.parser.memory.executeSub(p,_)))}}if((s=O.brackets)!=null&&s.test(e)){const o=e.match(O.brackets);if(o){const[u,m,g]=o;return e.replace(u,m+await this.parse(g))}else throw new Error("Invalid expression")}if((n=O.multiply)!=null&&n.test(e))return this.operation(e,O.multiply);if((l=O.add_subtract)!=null&&l.test(e))return this.operation(e,O.add_subtract)}return this.resolveValue(e)}async operation(e,t){const r=e.match(t);if(r){let i,s,n;const l=r[0];"groups"in r&&r.groups?(i=r.groups.a,s=r.groups.b,n=r.groups.operator):(i=r[1],n=r[2],s=r[3]);let o=e,u=await this.parse(i);se(u)||(u=k(u));let m=await this.parse(s);switch(se(m)||(m=k(m)),this.debug&&console.debug({valueA:u,valueB:m}),u=u,m=m,n){case"+":o=u+m;break;case"-":o=u-m;break;case"*":o=u*m;break;case"/":o=u/m;break;case">":o=u>m;break;case"<":o=u<m;break;case"^":o=u^m;break;case"%":o=u%m;break;case"MOD":o=u%m;break;case"AND":o=u&m;break;case"OR":o=u|m;break;case"XOR":o=u^m;break;case"<<":o=u<<m;break;case">>":o=u>>m;break;case">>>":o=u>>>m;break}return se(o)||(o=`"${o}"`),e.replace(l,l.replace(RegExp(`[${i}]{${String(i).length}}[ ]*[${n}]{${String(n).length}}[ ]*[${s}]{${String(s).length}}`),"")+this.cacheValue(o))}else throw new Error("Invalid expression")}async resolveValue(e){var t,r,i;if(typeof e!="function"&&H.valueUnresolved(e))return H.resolveValue(e,this.parsedValues);if(typeof e=="string"){if(e=e.replace(/^[ ]*([^ ].*[^ ])[ ]*$/,"$1"),(t=O.number)!=null&&t.test(e)){if(se(e))return Number(e)}else if((r=O.function_start)!=null&&r.test(String(e))){const s=e.match(O.function_start);if(s){const[,n,l]=s;if(this.parser.memory.hasSub(n))return this.parser.memory.executeSub(n,H.resolveValues(H.extractValues(l,",")));throw new Error(`can't find sub "${n}" in memory`)}else throw new Error("Invalid expression")}else if((i=O.variable)!=null&&i.test(String(e))){const s=e.replace(O.variable,"$1");if(this.parser.memory.hasSub(s))return this.parser.memory.executeSub(s);if(this.parser.memory.has(s))return this.parser.memory.get(s)}}return e}cacheValue(e){return this.parsedValues.push(e),H.resolveKey(this.parsedValues.length-1)}}const ra=["CLS","READ max","DIM fib%(max)","LET fib(1) = 1","LET fib(2) = 2","FOR i=3 TO max","LET fib(i) = fib(i - 2) + fib(i -1)","NEXT i","FOR i=1 TO max","PRINT fib(i)","NEXT i","DATA 10","END"],aa=["CLS","DIM w%,h%,a%","LET w%=12","LET h%=4","LET a%=w%*h%",'PRINT "With the width " + w%','PRINT " and the height " + h%','PRINT " you have the area " + a%'],sa=["CLS","DIM r,a","LET r=5","READ pi","LET a=r*r*pi",'PRINT USING "With the radius ##.##"; r','PRINT USING "we have the area ##.##"; a',"DATA 3.14","END"],ia=["GuessTheNumber","CLS","READ max%","DIM number%, guess%, guesses%",'PRINT "The number is between 1-1000."',"LET number% = INT(RND * max%) + 1","LET guess% = 1","LET guesses% = 0","WHILE guess%<>number%",'PRINT "Guess the number"',"INPUT guess%","IF (guess%<>number%) THEN","IF (guess%>number%) THEN",'PRINT "Your guess was too high"',"ELSE",'PRINT "Your guess was too low"',"ENDIF","ENDIF","LET guesses% = guesses% + 1","WEND",'PRINT USING "You found the number in # tries"; guesses%',"DATA 1000","END"],na=["DIM result",'PRINT "Calculate the factorial of"',"INPUT n","LET result = 1","FOR i = n TO 1 STEP -1","LET result = result * i","NEXT i",'PRINT USING "#! = #"; n, result',"END"],oa=["CLS","DIM stars$",'PRINT "Enter the height of the pyramid"',"INPUT height",'LET stars$ = ""',"FOR i = 1 TO height",'LET stars$ = ""',"FOR j = 1 TO (i+i-1)",'LET stars$ = stars$ + "*"',"NEXT j","PRINT SPC(height - i) + stars","NEXT i","END"],la=['PRINT "Step 1"','PRINT "Step 2"','PRINT "Step 3"',"GOTO ignore",'PRINT "Step 4"',"ignore:",'PRINT "Step 5"'],ua=["DIM A, B","LET A = 2000",'LET B = "Hello World"','PRINT USING "A: #"; A','PRINT USING "B: #"; B'],ca=["DIM A, B","LET A = 1","LET B = 2","IF A == B THEN",'PRINT "true"',"ELSE",'PRINT "false"',"END","IF (A < B) THEN",'PRINT "true"',"END"],ma=["DIM i%","FOR i% = 1 TO 5",'PRINT USING "For Number #"; i%',"NEXT i%"],da=["DIM i%","LET i%=0","WHILE i% < 5",'PRINT USING "While Number #"; i%',"LET i% = i% + 1","WEND"],pa=["DIM duration","LET duration = 2500",'PRINT USING "Start with Pause #ms"; duration',"PAUSE duration",'PRINT "End Pause"','PRINT USING "Start with Sleep #ms"; duration',"PAUSE duration",'PRINT "End Sleep"'],fa={Fibonacci:ra,Area:aa,Circle:sa,"Your Name":["CLS",'PRINT "What is your name?"',"INPUT n$",'PRINT "What is your shoe size?"',"INPUT size",'PRINT "Hello "; n$','PRINT USING "your shoe size is ##.##"; size',"END"],GuessTheNumber:ia,Factorial:na,Pyramid:oa,"Bubble Sort":["CLS","READ max","DIM SHARED numbers(max)","SUB CreateList(max) STATIC","FOR i=1 TO max","LET numbers(i) = INT(RND * 100)","NEXT i","END SUB","SUB PrintList(max) STATIC","FOR i=1 TO max","PRINT numbers(i)","NEXT i","END SUB","SUB SwapValues(i%, j%) STATIC","LET numbers(i%) = numbers(i%) XOR numbers(j%)","LET numbers(j%) = numbers(i%) XOR numbers(j%)","LET numbers(i%) = numbers(i%) XOR numbers(j%)","END SUB","SUB Sort(max) STATIC","FOR i%=1 TO (max - 1)","FOR j%=i% TO max","IF numbers(i%)>numbers(j%) THEN","CALL SwapValues(i%, j%)","END IF","NEXT j%","NEXT i%","END SUB","CreateList(max)","Sort(max)","PrintList(max)","DATA 10","END"],Goto:la,Vars:ua,If:ca,For:ma,"For Step":["CLS","FOR i% = 0 TO 6 STEP 2",'PRINT "For Step Number #"; i%',"NEXT i%"],While:da,Pause:pa},ha=Me(({module:a,core:e})=>[{name:["basic"],args:[new h({index:0,name:"path",description:"Path to basic script"})],async action({path:t},r){var s;if(!t)throw D.get("bad_args");const i=await((s=e.modules.files)==null?void 0:s.fileSystem.get(t));if(typeof(i==null?void 0:i.data)=="object"){const n=i.data;if(n.type==="basic"&&Array.isArray(n.content))return a.parseBasic(n.content,void 0,{logger:r.logger})}else throw new TypeError(`Can't read file ${t}`)}},{name:["basicExamples"],args:[new h({index:0,name:"name",description:"Name from example"})],action({name:t}){return a.parseBasic(fa[String(t)])}}]);class ga extends Ze{constructor({core:t}){super({name:"Parser",commands:r=>[...ha(r)],core:t});E(this,"basicInterpreter");E(this,"memory",N(new bt));E(this,"mathParser",N(new Qr(this.memory)));E(this,"commandParser",N(new H(this.mathParser)));this.basicInterpreter=N(new Jr(this.memory,t.executeCommand.bind(t)))}parse(t,r,i){return this.basicInterpreter.parse(t,r,i)}parseBasic(t,r,i={}){let s=t;return Array.isArray(t)||(s=t.split(`
`)),this.basicInterpreter.parse(s,r,i)}async parseCommand(t){return this.commandParser.parse(t)}parseMath(t){return this.mathParser.parse(t)}isMathValue(t){return this.mathParser.validInput(t)}}const wa={class:"wb-module-files-atoms-file-select"},ba=ne({__name:"FileSelect",props:{modelValue:{},fileSystem:{},fsItem:{},backLabel:{},upLabel:{},downLabel:{},maxVisibleItems:{}},emits:["update:model-value","select","refresh"],setup(a,{emit:e}){const t=e,r=a,i=I(()=>r.backLabel||"../"),s=I(()=>r.upLabel||"Up"),n=I(()=>r.downLabel||"Down"),l=I(()=>({title:"",items:f.value,modelValue:r.modelValue,"onUpdate:model-value":P=>{typeof P=="string"&&t("update:model-value",P)}})),o=I(()=>r.maxVisibleItems||5),u=j(r.fsItem||N(r.fileSystem.root)),m=j([]),g=j(0),d=I(()=>({back:!u.value.parent,up:g.value-1<0,down:g.value+1>m.value.length-o.value})),p=I(()=>r.modelValue),f=I(()=>{const P=m.value.slice(g.value,g.value+o.value).map(A=>({label:A.id,value:A.getPath()})).concat(Array(Math.max(o.value-m.value.length,0)).fill({label:"&nbsp;",disabled:!0}));return m.value.length<1&&(P[Math.floor(P.length/2)]={label:"Empty",disabled:!0}),P});ur(()=>p.value,async()=>{typeof r.modelValue=="string"&&(u.value=N(await r.fileSystem.get(r.modelValue)),u.value instanceof fe&&(m.value=Array.from((await u.value.getItems()).values()).map(N),g.value=0),(u.value instanceof tr||u.value instanceof fe)&&t("select",u.value))}),ht(async()=>{var P;m.value=Array.from((await((P=u.value)==null?void 0:P.getItems())||[]).values()).map(A=>N(A)),cr(()=>{t("refresh",{reset:!0,resize:!1,scroll:!1})})});const v=()=>{var A,C,y,ee,Z,we;let P;if(!(u.value instanceof fe)&&((C=(A=u.value)==null?void 0:A.parent)!=null&&C.parent)?P=(Z=(ee=(y=u.value)==null?void 0:y.parent)==null?void 0:ee.parent)==null?void 0:Z.getPath():u.value.parent&&(P=(we=u.value.parent)==null?void 0:we.getPath()),P)t("update:model-value",P);else throw new Error("No parent found")},_=()=>{g.value=Math.max(g.value-1,0)},$=()=>{g.value=Math.min(g.value+1,m.value.length-o.value)};return(P,A)=>(T(),x("div",wa,[W("div",null,[S(fr,be(Ee(l.value)),null,16)]),W("div",null,[S(De,{align:"outer",full:"",direction:"vertical"},{default:ie(()=>[S(K,{"style-type":"secondary",label:i.value,disabled:d.value.back,onClick:v},null,8,["label","disabled"]),S(K,{"style-type":"secondary",label:s.value,disabled:d.value.up,onClick:_},null,8,["label","disabled"]),n.value?(T(),ce(K,{key:0,"style-type":"secondary",label:n.value,disabled:d.value.down,onClick:$},null,8,["label","disabled"])):B("",!0)]),_:1})])]))}}),Xt=oe(ba,[["__scopeId","data-v-0e57c7f7"]]),Ea={class:"wb-module-files-save"},va=ne({__name:"Save",props:{fsItem:{},id:{},model:{}},emits:["close"],setup(a,{emit:e}){var P,A,C;const{core:t}=Je();if(!((P=t.value)!=null&&P.modules.files))throw new Error("Files module not found");const r=a,i=e,s=j({...r.model}),n=((A=t.value)==null?void 0:A.modules.files)&&N((C=t.value)==null?void 0:C.modules.files),l={cancel:"Cancel",save:"Save"},o=I(()=>({label:null,placeholder:"Path…",modelValue:s.value.path})),u=I(()=>({label:null,placeholder:"Filename…",modelValue:s.value.filename,"onUpdate:model-value":y=>{s.value.filename=y}})),m=I(()=>({name:"path",modelValue:s.value.path,"onUpdate:model-value":y=>{s.value.path=y},onSelect:v})),g=j(r.fsItem||N(n.fs.root)),d=I(()=>{var y,ee,Z;return r.fsItem?r.fsItem:(ee=(y=t.value)==null?void 0:y.modules.files)!=null&&ee.fs.root?(Z=t.value)==null?void 0:Z.modules.files.fs.root:null}),p=I(()=>g.value?g.value.locked:!1),f=I(()=>!s.value.filename),v=y=>{g.value=N(y),y instanceof fe?s.value.path=y.getPath():y.name&&(s.value.filename=y.name)};ht(()=>{r.id&&(s.value.filename=r.id)});const _=()=>{i("close")},$=()=>{const y=xt(s.value.path,s.value.filename);i("close",y)};return(y,ee)=>(T(),x("div",Ea,[S(qe,{onSubmit:$},{default:ie(()=>[S(ge,Ie(o.value,{readonly:""}),null,16),S(Xt,Ie(m.value,{"file-system":Te(n).fileSystem,"fs-item":d.value}),null,16,["file-system","fs-item"]),S(ge,be(Ee(u.value)),null,16),S(De,{align:"outer",full:""},{default:ie(()=>[S(K,{"style-type":"secondary",label:l.cancel,onClick:_},null,8,["label"]),S(K,{"style-type":"primary",label:l.save,type:"submit",disabled:p.value||f.value},null,8,["label","disabled"])]),_:1})]),_:1})]))}}),_a=oe(va,[["__scopeId","data-v-5e1aad86"]]),ya={class:"wb-module-files-open"},Ia=ne({__name:"Open",props:{fsItem:{},model:{}},emits:["close"],setup(a,{emit:e}){var v,_,$,P;const{core:t}=Je();if(!((v=t.value)!=null&&v.modules.files))throw new Error("Files module not found");Qe();const r=a,i=e,s=j({...r.model,path:((_=r.model)==null?void 0:_.path)||r.fsItem.getPath()}),n={cancel:"Cancel",open:"Open"},l=I(()=>({label:null,placeholder:"Path…",modelValue:s.value.path})),o=I(()=>({name:"path",modelValue:s.value.path,"onUpdate:model-value":A=>{s.value.path=A},onSelect:d})),u=j(r.fsItem||((P=($=t.value)==null?void 0:$.modules.files)==null?void 0:P.fs.root)),m=I(()=>u.value instanceof fe),g=I(()=>{var A,C,y;return r.fsItem?r.fsItem:(C=(A=t.value)==null?void 0:A.modules.files)!=null&&C.fs.root?(y=t.value)==null?void 0:y.modules.files.fs.root:null}),d=A=>{u.value=N(A),A instanceof fe&&(s.value.path=A.getPath())},p=()=>{i("close")},f=()=>{i("close",s.value.path)};return(A,C)=>(T(),x("div",ya,[S(qe,{onSubmit:f},{default:ie(()=>{var y,ee,Z;return[S(ge,Ie(l.value,{readonly:""}),null,16),(ee=(y=Te(t))==null?void 0:y.modules.files)!=null&&ee.fileSystem?(T(),ce(Xt,Ie({key:0},o.value,{"file-system":(Z=Te(t))==null?void 0:Z.modules.files.fileSystem,"fs-item":g.value}),null,16,["file-system","fs-item"])):B("",!0),S(De,{align:"outer",full:""},{default:ie(()=>[S(K,{"style-type":"secondary",label:n.cancel,onClick:p},null,8,["label"]),S(K,{"style-type":"primary",label:n.open,type:"submit",disabled:m.value},null,8,["label","disabled"])]),_:1})]}),_:1})]))}}),Sa=oe(Ia,[["__scopeId","data-v-04a47770"]]),Aa={class:"wb-module-files-preview"},Ra={key:0,class:"basic"},Ta=["innerHTML"],Da=["src"],$a=ne({__name:"Preview",props:{type:{},content:{}},setup(a){const{core:e}=Je(),t=a;Qe();const r=j([]);return ht(()=>{t.type==="basic"&&window.requestAnimationFrame(()=>{var i,s;r.value=[],(s=(i=e.value)==null?void 0:i.modules.parser)==null||s.parseBasic(t.content,async(n,l)=>{var u;const o=await((u=e.value)==null?void 0:u.executeCommand(n,l));return l.message!==void 0&&r.value.push(k(String(l.message))),o})})}),(i,s)=>(T(),x("div",Aa,[i.type==="basic"?(T(),x("ul",Ra,[(T(!0),x(ut,null,ct(r.value,(n,l)=>(T(),x("li",{key:l},mt(n),1))),128))])):B("",!0),i.type==="markdown"&&typeof i.content=="string"?(T(),ce(Vt,{key:1,content:i.content},null,8,["content"])):B("",!0),i.type==="html"?(T(),x("div",{key:2,innerHTML:i.content},null,8,Ta)):B("",!0),i.type==="image"&&typeof i.content=="string"?(T(),x("img",{key:3,src:i.content},null,8,Da)):B("",!0)]))}}),Pa=oe($a,[["__scopeId","data-v-5f9f5609"]]);async function La(a,e,t){const r=await a.executeCommand(`exist "${e}"`);let i=!1;r&&(i=await a.executeCommand('openDialog "File exist, overwrite?" --confirm'));const s=[`makefile "${e}"`];return t&&s.push(`--data="${t}"`),i?s.push("--override"):s.push("--ignore"),a.executeCommand(s.join(" "))}async function Na(a,e){var i;const t=await((i=a.modules.files)==null?void 0:i.fs.get(e)),r=await a.executeCommand(`readfile "${e}"`);return{fsItem:t,value:r}}const Oa=Me(({module:a,core:e})=>{const{fileSystem:t}=a;return[{name:"openPreview",args:[new h({index:0,name:"path",description:"Path to the file"}),new h({name:"maximized",description:"If set, window is maximized."})],async action({path:r,maximized:i}){var u,m;const s=await t.get(r),{type:n,content:l,openMaximized:o}=s.data;n==="basic"&&!s.data[hr.HAS_WINDOW_OUTPUT]?await((u=e.modules.parser)==null?void 0:u.parseBasic(l,async(g,d)=>await e.executeCommand(g,d))):(m=e.modules.windows)==null||m.addWindow({component:Pa,componentData:{type:n,content:l},options:{title:s.name,scaleX:!0,scaleY:!0,scrollX:!0,scrollY:!0},layout:{size:gt(420,360)}},{full:o||i||!1})}},{name:"saveFileDialog",args:[new h({index:0,name:"data",description:"File Content"}),new h({index:1,name:"id",description:"File Id"}),new h({index:2,name:"extension",description:"File Extension"})],async action({data:r,id:i,extension:s}){var l;const n=(l=e.modules.windows)==null?void 0:l.addWindow({component:_a,componentData:{fsItem:t.root&&N(t.root),id:i},options:{title:"Save File",scaleX:!1,scaleY:!1,scrollX:!1,scrollY:!1}});if(n){const{value:o}=await n.awaitClose();if(o){const u=rr(o,s),m=await La(e,u,r);if(m)return N(mr(m))}}}},{name:"openFileDialog",args:[],async action(){var i;const r=(i=e.modules.windows)==null?void 0:i.addWindow({component:Sa,componentData:{fsItem:t.root&&N(t.root)},options:{title:"Open File",scaleX:!1,scaleY:!1,scrollX:!1,scrollY:!1}});if(r){const{value:s}=await r.awaitClose();return s&&Na(e,s)}}},{name:"fileinfo",description:"Get info from File or Directory",args:[new h({index:0,name:"path",description:"Path to the file"}),new h({index:1,name:"name",description:"Name from the Info"}),new h({index:2,name:["list","ls"],flag:!0,description:"List all Infos"})],async action({path:r,name:i,list:s},n){const l=await t.getItemMetaList(r);if(s){const o=new Xe;o.addColumns([{value:"Name",align:"left",minWidth:20},{value:"Value",align:"left",minWidth:20}]),o.addRows(l.map(({name:u,value:m})=>{let g=m;return Array.isArray(m)&&(g=m.join(" ")),[u,g]})),n.message([o])}else return l.find(o=>o.name===i)}},{name:["info","i"],args:[new h({index:0,name:"path",description:"Path to the file"})],async action({path:r},i){let s=t.root;r&&(s=await t.get(r)),s!=null&&s.parent&&(s=s.parent);const n=await(s==null?void 0:s.getItems()),l=new Xe;l.addColumns([{value:"Unit",align:"left",minWidth:8},{value:"Size",align:"right",minWidth:6},{value:"Used",align:"right",minWidth:6},{value:"Free",align:"right",minWidth:6},{value:"Full",minWidth:4},{value:"Errs",align:"center",minWidth:4},{value:"Status",align:"center",minWidth:10},{value:"Name",align:"right",minWidth:14}]);const o=Array.from((n==null?void 0:n.values())||[]).filter(m=>m instanceof nt);l.addRows(o.map(m=>{let g=0;return(m.size>0||m.maxSize>0)&&(g=m.size/m.maxSize*100),[`${m.id}:`,Ne(m.maxSize),Ne(m.size),Ne(m.maxSize-m.size),`${g}%`,"0",m.locked?"Read":"Read/Write",`${m.name||""}`]}));const u=["","Mounted disks:",l,"","Volumes available:"];o.forEach(m=>{u.push(`${m.name}: [Mounted]`)}),u.push(""),i.message(u)}},{name:["list","ls"],args:[new h({index:0,name:"path",description:"Path to the file"}),new h({name:"dir-size",flag:!0,description:"Show Directory Size."})],async action({path:r,dirSize:i},s){let n=t.currentItem;r&&(n=await t.get(r));const l=Array.from((await(n==null?void 0:n.getItems())||[]).values()),o=new Xe;o.addColumns([{value:"Name",align:"left",minWidth:26},{value:"Size",align:"right",minWidth:8},{value:"Access",align:"center",minWidth:12},{value:"Date / Time",align:"center",minWidth:18}]),o.addRows(l.reduce((g,d)=>{let p;d instanceof fe&&!i?p="DIR":p=at(Ne(d.size),8,!0,"0");const f=d.isLocked()?"Read":"Read/Write";return g.push([`${d.id}:`,p,f,d.createdDate?st("D-mm-y H:I:S",d.createdDate):""]),g},[]));const u=l.reduce((g,d)=>(d instanceof ot&&g++,g),0),m=l.reduce((g,d)=>(g+=d.size,g),0);return s.message([o,`${l.length} files - ${u} directories - ${m} blocks used`]),Promise.resolve()}}]}),xa={class:"wb-module-files-edit"},Wa={class:"cols"},Ca={class:"col-2"},Va={class:"col-2"},Tt="Cancel",Dt="Save",ka=ne({__name:"Edit",props:{fsItem:{},model:{}},emits:["close"],setup(a,{emit:e}){const t=a,r=e,i=j({...t.model}),s=I(()=>({disabled:t.fsItem.locked,label:"Others",name:"",items:[{label:"Symbol Visible",name:R.VISIBLE},{label:"Ignore Symbol Rearrange ",name:R.IGNORE_SYMBOL_REARRANGE}],modelValue:i.value,"onUpdate:modelValue":d=>{i.value=d}})),n=I(()=>({disabled:t.fsItem.locked,label:"Window Settings",name:"",items:[{label:"Has Scale ?",name:R.WINDOW_SCALE},{label:"Has Scroll-X ?",name:R.WINDOW_SCROLL_X},{label:"Has Scroll-Y ?",name:R.WINDOW_SCROLL_Y},{label:"Is Full-Size ?",name:R.WINDOW_FULL_SIZE},{label:"Sort Symbols (Directory)",name:R.WINDOW_SYMBOL_REARRANGE},{label:"Has Sidebar?",name:R.WINDOW_SIDEBAR}],modelValue:i.value,"onUpdate:modelValue":d=>{i.value=d}})),l=I(()=>({disabled:t.fsItem.locked,label:"Symbol",name:"symbol",options:Object.keys(w).map(d=>({title:Ct(d),value:w[d]})),modelValue:String(i.value.symbol),"onUpdate:modelValue":d=>{i.value.symbol=d}})),o=I(()=>({disabled:t.fsItem.locked,label:"Id",name:"id",modelValue:i.value.id,"onUpdate:modelValue":d=>{i.value.id=d}})),u=I(()=>({disabled:t.fsItem.locked,label:"Name",name:"name",modelValue:i.value.name,"onUpdate:modelValue":d=>{i.value.name=d}})),m=()=>{r("close")},g=async()=>{t.fsItem.locked||await t.model.actions.save(i.value,t.fsItem),r("close")};return(d,p)=>(T(),x("div",xa,[S(qe,{class:"form",onSubmit:g},{default:ie(()=>[W("div",null,[S(ge,be(Ee(o.value)),null,16),S(ge,be(Ee(u.value)),null,16),S(kt,be(Ee(l.value)),null,16),W("div",Wa,[W("div",Ca,[S(At,be(Ee(s.value)),null,16)]),W("div",Va,[S(At,be(Ee(n.value)),null,16)])])]),S(De,{align:"outer",full:""},{default:ie(()=>[Tt?(T(),ce(K,{key:0,"style-type":"secondary",label:Tt,onClick:m})):B("",!0),Dt?(T(),ce(K,{key:1,"style-type":"primary",label:Dt,type:"submit"})):B("",!0)]),_:1})]),_:1})]))}}),Fa=oe(ka,[["__scopeId","data-v-23a97280"]]),Ma={class:"wb-module-files-web-link"},$t="Cancel",Pt="Save",Ba=ne({__name:"WebLink",props:{fsItem:{},model:{}},emits:["close"],setup(a,{emit:e}){const t=a,r=e,i=j((t.fsItem||{}).locked),s=j({...t.model}),n=I(()=>({disabled:i.value,placeholder:"Name",label:"Name"})),l=I(()=>({disabled:i.value,placeholder:"http://…",label:"Url"})),o=I(()=>({disabled:i.value,label:"Symbol",options:Object.keys(w).map(d=>({title:Ct(d),value:w[d]}))})),u=I(()=>!s.value.name||!s.value.url||!s.value.symbol);function m(){r("close")}async function g(){await t.model.actions.save(s.value,t.fsItem)&&r("close")}return(d,p)=>(T(),x("div",Ma,[S(qe,{onSubmit:g},{default:ie(()=>[S(ge,Ie(n.value,{modelValue:s.value.name,"onUpdate:modelValue":p[0]||(p[0]=f=>s.value.name=f)}),null,16,["modelValue"]),S(ge,Ie(l.value,{modelValue:s.value.url,"onUpdate:modelValue":p[1]||(p[1]=f=>s.value.url=f),type:"url"}),null,16,["modelValue"]),S(kt,Ie(o.value,{modelValue:s.value.symbol,"onUpdate:modelValue":p[2]||(p[2]=f=>s.value.symbol=f)}),null,16,["modelValue"]),S(De,{align:"outer",full:""},{default:ie(()=>[$t?(T(),ce(K,{key:0,"style-type":"secondary",label:$t,onClick:m})):B("",!0),Pt?(T(),ce(K,{key:1,"style-type":"primary",label:Pt,type:"submit",disabled:u.value},null,8,["disabled"])):B("",!0)]),_:1})]),_:1})]))}}),Lt=oe(Ba,[["__scopeId","data-v-1f96f2a0"]]),Ua={class:"wb-module-files-info"},Ya=["innerHTML"],Ga=["innerHTML"],Xa=ne({__name:"Info",props:{fsItem:{}},setup(a){const e=a;Qe();const t=I(()=>e.fsItem?Array.from(e.fsItem.meta).map(([i,s])=>{if(typeof s=="object")try{s=JSON.stringify(s)}catch(n){console.error(n)}return{title:i,value:s}}):[]),r=I(()=>{const i=e.fsItem;return i?[{title:"Id",value:i.id},{title:"Name",value:i.name},{title:"Type",value:i.type},{title:"Path",value:i.getPath()},{title:"Size",value:Ne(i.size)},{title:"Locked",value:i.locked?"Yes":"No"},{title:"Created Date",value:`<nobr>${st("H:I:S D.M.Y",i.createdDate)}</nobr>`},{title:"Modified Date",value:`<nobr>${st("H:I:S D.M.Y",i.editedDate)}</nobr>`}]:[]});return(i,s)=>(T(),x("div",Ua,[W("table",null,[(T(!0),x(ut,null,ct(r.value,({title:n,value:l},o)=>(T(),x("tr",{key:o},[W("td",null,mt(n)+":",1),W("td",{innerHTML:l},null,8,Ya)]))),128))]),W("fieldset",null,[s[0]||(s[0]=W("legend",null,"Meta:",-1)),W("table",null,[(T(!0),x(ut,null,ct(t.value,({title:n,value:l},o)=>(T(),x("tr",{key:o},[W("td",null,mt(n)+":",1),W("td",{innerHTML:l},null,8,Ga)]))),128))])])]))}}),za=oe(Xa,[["__scopeId","data-v-32aaac66"]]),Ha=wt(({core:a})=>{const e=a.modules.symbols||{},t=a.modules.windows||{},r=He({open:{disabled:!1},edit:{disabled:!1},duplicate:{disabled:!1},container:{disabled:!1},emptyTrashcan:{disabled:!1},discard:{disabled:!1},info:{disabled:!1},webLink:{disabled:!1},webLinkNew:{disabled:!1},webLinkEdit:{disabled:!1}});function i(){const d=e.getSelectedItems()||[],p=e.getPrimaryWrapper();r.info.disabled=d.length<1,r.open.disabled=d.length<1,r.edit.disabled=d.length<1||!!d.find(f=>(f==null?void 0:f.locked)||f instanceof Ue),r.duplicate.disabled=d.length<1||!!d.find(({fsItem:f})=>(f==null?void 0:f.locked)||f instanceof Ue||f instanceof nt),r.container.disabled=!r.open.disabled||p instanceof xe&&p.fsItem&&(p.fsItem instanceof ar||p.fsItem.locked)||!p,r.webLinkEdit.disabled=d.length<1||!!d.find(f=>{var v;return!((v=f==null?void 0:f.fsItem)!=null&&v.meta.get(R.WEB_URL))}),r.webLinkNew.disabled=r.container.disabled,r.webLink.disabled=r.webLinkNew.disabled&&r.webLinkEdit.disabled,r.emptyTrashcan.disabled=d.length<1||!!d.find(f=>!((f==null?void 0:f.fsItem)instanceof Ue)),r.discard.disabled=d.length<1||!!d.find(({fsItem:f})=>(f==null?void 0:f.locked)||f instanceof Ue||f instanceof nt)}return e.events.subscribe(()=>i()),i(),[{order:1,title:"File",items:[{title:"Open",options:r.open,action:s},{title:"Edit",options:r.edit,action:u},{type:z.SEPARATOR},{title:"Web Link",options:r.webLink,items:[{title:"New",options:r.webLinkNew,action:l},{title:"Edit",options:r.webLinkEdit,action:o}]},{type:z.SEPARATOR},{title:"Duplicate",options:r.duplicate,action(){const d=e.getSelectedItems()||[];return Promise.all(d.filter(p=>p.fsItem).map(async({fsItem:p})=>{const f=await(p==null?void 0:p.getPath());return a.executeCommand(`copy "${f}" "${f}" -ignore`)}))}},{title:"Make Dir",options:r.container,async action(){var p;const d=(p=e.getPrimaryWrapper())==null?void 0:p.fsItem;if(d){const f=xt(await d.getPath(),"Directory");return console.log(`makedir "${f}" -ignore`),a.executeCommand(`makedir "${f}" -ignore`)}else throw new Error("No item found")}},{type:z.SEPARATOR},{title:"Discard",options:r.discard,action(){const d=e.getSelectedItems()||[];return Promise.all(d.filter(p=>p.fsItem).map(async({fsItem:p})=>{const f=await(p==null?void 0:p.getPath());return a.executeCommand(`remove "${f}" -r`)}))}},{title:"Empty Trashcan",options:r.emptyTrashcan,action(){const d=e.getSelectedItems()||[];return Promise.all(d.filter(p=>p.fsItem).map(async({fsItem:p})=>{const f=await(p==null?void 0:p.getItems())||[];return Promise.all(Array.from(f.values()).map(async v=>{const _=await v.getPath();return a.executeCommand(`remove "${_}" -r -ignore`)}))}))}},{type:z.SEPARATOR},{title:"Info",options:r.info,action(){(e.getSelectedItems()||[]).filter(p=>p.fsItem).forEach(p=>{if(p.fsItem)t.addWindow({component:za,componentData:{fsItem:N(p.fsItem)},layout:{size:gt(460,280)},options:{title:`Info File ${p.fsItem.name}`,scaleX:!0,scaleY:!0,prompt:!1,scrollX:!0,scrollY:!0}});else throw new Error(`Item has no fsItem. ${p.id}`)})}}]}];function s(){(e.getSelectedItems()||[]).filter(p=>p.fsItem).forEach(p=>{if(p.command){const f={showCommand:!1,show:!0};return a.executeCommand(p.command,f)}})}async function n({name:d,url:p,symbol:f},v){if(v||(v=await a.executeCommand(`saveFileDialog --id="${sr(d)}"`)),v){const _=a.addExecution();try{const $=v.getPath();await a.executeCommand(`rename "${$}" "${d}" -n`),await a.executeCommand(`editfilemeta "${$}" "${R.WEB_URL}" "${p}"`),await a.executeCommand(`editfilemeta "${$}" "${R.SYMBOL}" "${f}"`)}catch($){throw _(),$}return _(),!0}return!1}function l(){return t.addWindow({component:Lt,componentData:{model:{actions:{save:n},name:null,url:null,symbol:"default"}},options:{title:"Make Link",prompt:!1,scaleX:!1,scaleY:!1,scrollX:!1,scrollY:!1}}).awaitClose()}function o(){e.getSelectedItems().filter(p=>p.fsItem).forEach(p=>{const f=p.fsItem;if(f)t.addWindow({component:Lt,componentData:{fsItem:N(f),model:{actions:{save:n},name:f.name,url:f.meta.get(R.WEB_URL),symbol:f.meta.get(R.SYMBOL)}},options:{title:"Edit Link",prompt:!1,scaleX:!1,scaleY:!1,scrollX:!1,scrollY:!1}});else throw new Error(`Item has no fsItem. ${p.id}`)})}function u(){e.getSelectedItems().filter(p=>p.fsItem).forEach(p=>{const f=p.fsItem;if(f){const v=He({actions:{save:g},id:f.id,name:f.name});[R.SYMBOL,R.VISIBLE,R.IGNORE_SYMBOL_REARRANGE,R.WINDOW_SCALE,R.WINDOW_SCROLL_X,R.WINDOW_SCROLL_Y,R.WINDOW_FULL_SIZE,R.WINDOW_SYMBOL_REARRANGE,R.WINDOW_SIDEBAR].forEach(_=>{v[_]=f.meta.has(_)?f.meta.get(_):!1}),t.addWindow({component:Fa,componentData:{fsItem:N(f),model:v},options:{title:`Edit File ${f.name}`,prompt:!1,scaleX:!1,scaleY:!1,scrollX:!1,scrollY:!1}})}else throw new Error(`Item has no fsItem. ${p.id}`)})}function m(){return[R.SYMBOL,R.VISIBLE,R.IGNORE_SYMBOL_REARRANGE,R.WINDOW_SCALE,R.WINDOW_SCROLL_X,R.WINDOW_SCROLL_Y,R.WINDOW_FULL_SIZE,R.WINDOW_SYMBOL_REARRANGE,R.WINDOW_SIDEBAR]}async function g(d,p){const{id:f,name:v}=d,_=p.getPath();if(!f)throw new Error("Id is emoty!");let $;const P=a.addExecution();try{await Promise.all(m().map(A=>{let C=d[A];return typeof C=="string"&&(C=`"${C}"`),a.executeCommand(`editfilemeta "${_}" "${A}" ${C}`)})),v&&f!==v?await a.executeCommand(`rename "${_}" "${v}" -n`):$=a.executeCommand(`rename "${_}" "${f}" -rn`),$=a.executeCommand(`rename "${_}" "${f}"`)}catch(A){throw P(),A}return P(),$}}),ja=Me(({module:a})=>{const{fileSystem:e,core:t,disks:r}=a;return[{name:["mountDisk"],description:"Mount Disk",args:[new h({index:0,name:"id",description:"Disk ID"})],async action({id:i},s){const n=t.addExecution(),l=await r[i]();try{const o=await e.addFloppyDisk(()=>l({core:t}));s.message(`Mount Disk <strong>${o.name}</strong> <strong>(${o.id})</strong> successful!`),n()}catch(o){throw console.error(o),D.get("cant_find_disk",i)}}},{name:["changeDirectory","cd"],description:"cd %path%",args:[new h({index:0,name:"path",description:"Directory path"})],async action({path:i}){if(!i)throw D.get("bad_args");try{await e.changeDirectory(i)}catch(s){throw console.error(s),D.get("cant_find",i)}}},{name:["exist"],description:"Check if file exists.",args:[new h({index:0,name:"path",description:"Filename"})],async action({path:i},s){if(!i)throw D.get("bad_args");const n=yt(i),l=await e.exist(i);return l?s.message(`File ${n} exists`):s.message(`File ${n} does not exist`),l}},{name:["makedir","mkdir"],args:[new h({index:0,name:"path",description:"Filename"}),new h({index:1,name:"name",description:"Name"}),new h({name:"ignore",flag:!0,description:"Ignore file exist."})],async action({path:i,name:s,ignore:n},l){if(!i)throw D.get("bad_args");const o=await e.makedir(i,s||yt(i),{override:n});return l.message(`Directory "${o.name}" created`),o}},{name:["remove","rm"],args:[new h({index:0,name:"path",description:"Filename"}),new h({name:["recursive","r"],flag:!0,description:"Remove Directory Items and Directories."}),new h({name:["ignore"],flag:!0,description:"Ignore the specified file is deleted."})],async action({path:i,recursive:s,ignore:n},l){if(!i)throw D.get("bad_args");return(await e.remove(i,s,{ignore:n})||[]).map(u=>{const m=u.type===ot.TYPE?"Directory":"File";return l.message(`Removed ${m}: ${u.name}`),u})}},{name:["readfile","getfile"],description:"Get file content",args:[new h({index:0,name:"path",description:"Filename"})],async action({path:i}){if(!i)throw D.get("bad_args");return(await e.get(i)).data}},{name:["makefile","mkfile"],description:"Creates a file with the specified attributes.",args:[new h({index:0,name:"path",description:"Filename"}),new h({index:1,name:"name",description:"Name"}),new h({index:3,name:"data",description:"Data"}),new h({name:"override",flag:!0,description:"Deletes existing file and recreates."})],async action({path:i,name:s,data:n,override:l=!1},o){if(!i)throw D.get("bad_args");typeof n=="string"&&(n=It(n));const u=await e.makefile(i,s,n,{override:l||!1,meta:[]});return o.message(`File "${u.name}" created`),u}},{name:["editfile"],description:"Edits file with specified attributes.",args:[new h({index:0,name:"path",description:"Filename"}),new h({index:1,name:"data",description:"Data"})],async action({path:i,data:s},n){if(!i)throw D.get("bad_args");typeof s=="string"&&(s=It(s));const l=await e.editfile(i,s);return n.message(`File "${l.name}" edited`),l}},{name:["editfilemeta"],description:"Edits file with specified attributes.",args:[new h({index:0,name:"path",description:"Filename"}),new h({index:1,name:"name",description:"Name"}),new h({index:2,name:"value",description:"Value"})],async action({path:i,name:s,value:n},l){if(!i)throw D.get("bad_args");const o=await e.editfileMeta(i,s,n);return l.message(`File  "${o.name}" Meta edited`),o}},{name:["makelink","mklink"],description:"Creates a link to the specified path.",args:[new h({index:0,name:"ref",description:"Reference path with id (example.ext)."}),new h({index:1,name:"name",description:"Displayed Name"}),new h({index:2,name:"dest",description:"Destination directory."})],async action({ref:i,name:s,dest:n},l){if(!i)throw D.get("bad_args");n=n||".";const o=await e.get(i),u=await e.makelink(o,s);return await e.get(n)!==e.currentItem&&await e.move(u,n,{override:!0}),l.message(`Created link "${s}" with "${await o.getPath()}"`),u}},{name:["editlink"],description:"",args:[new h({index:0,name:"path",description:"Reference filepath with id (example.ext)."}),new h({index:1,name:"ref",description:"Destination directory."})],async action({path:i,ref:s},n){if(!(i&&s))throw D.get("bad_args");const l=await e.get(s),o=await e.editlink(i,l);return n.message(`Edited link "${name}" with "${await l.getPath()}"`),o}},{name:"rename",description:"Renamed a file",args:[new h({index:0,name:"path",description:"Filepath with id (example.ext)."}),new h({index:1,name:"value",description:"Value for id or displayed name."}),new h({name:["name","n"],flag:!0,description:"When set, changes the display name."}),new h({name:["removeName","rn"],flag:!0,description:"When set, removes the display name."})],async action({path:i,value:s,name:n,removeName:l},o){if(!l&&(!i||!s))throw D.get("bad_args");const u=await e.get(i),m=n?u.name:u.id;return await e.rename(i,s,{name:n,removeName:l}),o.message(`Renamed from "${m}" to "${s}"`),u}},{name:["cp","copy"],args:[new h({index:0,name:"from",description:"Source Filepath with id (example.ext)."}),new h({index:1,name:"dest",description:"Destination Filepath with id (example.ext)."}),new h({name:["ignore","i"],flag:!0,description:"When sets, creates a new file if exists."})],async action({from:i,dest:s,ignore:n},l){let o=s;if(!o&&n&&(o=i),!o||!i)throw D.get("bad_args");const u=await e.copy(i,o,{ignore:n});return l.message(`Copied from "${i}" to "${o}"`),u}},{name:["mv","move"],description:"move %from% %to%",args:[new h({index:0,name:"from",description:"From path"}),new h({index:1,name:"to",description:"To path"}),new h({index:2,name:"item-position",description:"Sets the position in the Icon view. (x,y)"})],async action({from:i,to:s,itemPosition:n},l){if(!s||!i)throw D.get("bad_args");const o=await e.move(i,s);n&&o.meta.set(R.POSITION,[0,0].map((m,g)=>{const d=n.split(",");return parseInt(d[Number(g)]||"0")})),o.save();let u;return o instanceof ot?u="Directory":u="File",l.message(`${u} moved ${o.name}`),o}},{name:["executeFile"],description:"Execute file.",args:[new h({index:0,name:"path",description:"Path to the file"})],async action({path:i}){if(!i)throw D.get("bad_args");const s=await e.get(i);if(typeof s.action=="function")return s.action(t);throw D.get("cant_find_action",i)}}]});D.add("cant_find_action","Can't find action %1");D.add("cant_find_disk","Can't find disk %1");const Ka=new class{constructor(){E(this,"firebase",null)}get(){return this.firebase||(this.firebase=this.getImports())}getImports(){return Promise.all([b(()=>import("./PS5SoCZn.js"),__vite__mapDeps([0,1]),import.meta.url).then(e=>e.default||e),b(()=>import("./CfrwDXeG.js"),__vite__mapDeps([2,1,3]),import.meta.url).then(e=>e.default||e),b(()=>import("./AyGIKDDV.js"),__vite__mapDeps([4,1]),import.meta.url).then(e=>e.default||e)]).then(([e,t,r])=>({app:e,auth:t,database:r}))}},rt=new Map;class Za extends ir{constructor(){super(...arguments);E(this,"modules");E(this,"services");E(this,"app")}get name(){var t;return(t=this.app)==null?void 0:t.name}async connect(t,{apiKey:r,url:i}){if(this.modules=await Ka.get(),this.app)rt.has(t)&&(this.app=rt.get(t));else{const s=this.modules.app.initializeApp({apiKey:r,databaseURL:i},t);rt.set(s.name,s),this.app=s}return this.app}async disconnect(){var t;if(!this.app)throw D.get("FirebaseWrapper_noApp");Pe(this),await this.logout(),await((t=this.modules)==null?void 0:t.app.deleteApp(this.app)),this.app=void 0}get locked(){return!!this.app&&!this.isLogged()}get currentUser(){var t;if((t=this.modules)!=null&&t.auth){const{getAuth:r}=this.modules.auth;return r(this.app).currentUser}}isLogged(){return!!this.app&&!!this.currentUser}login(t,r){var i;if((i=this.modules)!=null&&i.auth){const{getAuth:s,signInWithEmailAndPassword:n}=this.modules.auth,l=s(this.app);return Pe(this),n(l,t,r)}}logout(){var t;if(this.app&&((t=this.modules)!=null&&t.auth)){const{getAuth:r,signOut:i}=this.modules.auth,s=r(this.app);return i(s)}else throw D.get("FirebaseWrapper_notConnected")}remove(t){var r;if(Pe(this),(r=this.modules)!=null&&r.database){const{remove:i,ref:s,getDatabase:n}=this.modules.database,l=n(this.app),o=s(l,t);return i(o)}}get(t){var r;if(Pe(this),(r=this.modules)!=null&&r.database){const{ref:i,onValue:s,getDatabase:n}=this.modules.database,l=n(this.app),o=i(l,t);return new Promise(u=>{s(o,m=>u(m.val()))})}}async set(t,r){var i;if(Pe(this),(i=this.modules)!=null&&i.database){const{ref:s,set:n,getDatabase:l}=this.modules.database,o=l(this.app),u=s(o,t);return await n(u,r),r}}}function Pe(a){if(!a.app)throw D.get("FirebaseWrapper_notConnected")}D.add([["FirebaseWrapper_notConnected",["Not connected","Not connected"]],["FirebaseWrapper_noApp",["No app available","No app available"]],["FirebaseWrapper_hasApp",["App already available",'App "%1" already available']]]);class qa extends nr{constructor(e){super({...e,storage:new Za})}async mount(e){if(e.onDisconnect=()=>{this.unmount()},this.storage)return await this.storage.connect(e.id,{apiKey:e.apiKey,url:e.url}),this;throw new Error("no storage")}async unmount(){if(this.storage)return await this.storage.disconnect(),this;throw new Error("no storage")}async load(){if(this.storage){let e=await this.storage.get(this.name);return e||(e={},this.storage.locked||await this.storage.set(this.name,e)),this.data=e,e}else throw new Error("no storage")}async save(e){if(this.storage)return e=zt(e),this.data=e||this.data,await this.storage.set(this.name,e),this.data;throw new Error("no storage")}get locked(){var e;return((e=this.storage)==null?void 0:e.locked)||!1}}function zt(a){return Object.fromEntries(Object.entries(a).filter(([,e])=>e).map(([e,t])=>(t&&typeof t=="object"&&(t=zt(t)),[e,t])))}const Le=new Map,Ja=Me(({module:a,core:e})=>{const{fileSystem:t}=a;return[{name:"cloudList",args:[new h({name:"json",flag:!0,description:"Get JSON Export"})],action({json:r},i){const s=Array.from(Le.values());if(r)return Promise.resolve(s);{const n=new Xe;return n.addColumns([{value:"Storage (Id)",align:"left",minWidth:15},{value:"Name",align:"left",minWidth:15},{value:"Logged In",align:"center",minWidth:9}]),n.addRows(s.reduce((l,o)=>(l.push([o.id,o.name,o.storage.storage.isLogged()?"yes":"no"]),l),[])),i.message([n]),Promise.resolve()}}},{name:"cloudMount",args:[new h({index:0,name:"id",flag:!0,description:"Id from Storage."}),new h({index:1,name:"apiKey",description:"Firebase Api-Key."}),new h({index:2,name:"url",description:"Firebase Database-Url."})],async action({id:r,apiKey:i,url:s},n){if(!i||!s)throw D.get("bad_args");const l=e.addExecution(),o=await t.connect(qa,{id:r,apiKey:i,url:s});return Le.set(o.id,o),n.message(`Mount <strong>${o.name}</strong> <strong>(${o.id})</strong> successful!`),l(),o}},{name:"cloudUnmount",args:[new h({index:0,name:"id",flag:!0,description:"Id from Storage."})],async action({id:r},i){if(!r)throw D.get("bad_args");const s=e.addExecution();try{const n=Le.get(r);await t.disconnect(n),Le.delete(n.id),i.message(`Unmount "${n.name}" successful!`),s()}catch(n){throw s(),n}}},{name:"cloudAuth",args:[new h({name:"login",flag:!0,description:"Storage Login"}),new h({name:"logout",flag:!0,description:"Logout from Storage."}),new h({name:"email",description:"Email for Login."}),new h({name:"password",description:"Password for Login."}),new h({name:"storage",description:"Specifies which drive is logged on."})],async action({email:r,password:i,storage:s,login:n,logout:l},o){const u=s;if(!u)throw D.get("bad_args");const m=e.addExecution(),g=Le.get(u);let d;if(g)try{if(n){if(!r||!i)throw D.get("bad_args");d=await g.storage.storage.login(r,i),o.message(`Login with ${g.id} (${g.id}) successful!`)}else l&&(d=await g.storage.storage.logout(),o.message(`Logout from ${g.id} (${g.id}) successful!`))}catch(p){if(m(),p instanceof Error&&"code"in p){switch(p.code){case"auth/user-not-found":case"auth/wrong-password":return p}throw p}}else throw new Error(`${u} is not mounted.`);return m(),d}}]}),Nt=N(new or("web_workbench_FS"));class Ht extends Ze{constructor({core:t}){super({name:"Files",commands:({module:r,core:i})=>[...Oa({module:r,core:i}),...ja({module:r}),...Ja({module:r,core:i})],contextMenu:Ha,core:t});E(this,"fileSystem",Nt);E(this,"fs",Nt);E(this,"disks",{})}async addDisks(t){Object.entries(t).forEach(([r,i])=>{this.disks[String(r)]=i})}}E(Ht,"NAME","Files");class Qa{constructor(e){E(this,"defaultItems",new dt);E(this,"activeItems");E(this,"core");this.core=e,this.activeItems=this.defaultItems}addDefaultItems(e){this.defaultItems.add(e)}getActiveItems(){return this.activeItems}setActiveItems(e){return this.activeItems=e||this.defaultItems}}const es={class:"wb-module-core-info"},ts=ne({__name:"Info",setup(a){Qe();const{core:e}=Je(),t=j(dr().versions),r=I(()=>{var i,s;return`# Web-Workbench 1.3
<nobr>Created by Thorn-Welf Walli</nobr><br>Email: lammpee@gmail.com<br>Homepage: [lammpee.de](https://lammpee.de)<br><br>Version: <strong>${(i=e.value)==null?void 0:i.version}</strong><br>Nuxt: <strong>${(s=t.value)==null?void 0:s.nuxt}</strong><br>Vue: <strong>${t.value.vue}</strong>`});return(i,s)=>(T(),x("div",es,[S(Vt,{content:Te(r)},null,8,["content"])]))}}),rs=oe(ts,[["__scopeId","data-v-451bf105"]]),as=wt(({core:a})=>{const{windows:e}=a.modules;return[{order:0,title:"Web-Workbench",items:[{title:"Settings",action(){return a.executeCommand("openSettings")}},{type:z.SEPARATOR},{hotKey:"I",keyCode:73,title:"Info",action(){e==null||e.addWindow({component:rs,componentData:{},options:{title:"Info",prompt:!1,scaleX:!1,scaleY:!1,scrollX:!1,scrollY:!1}})}},{type:z.SEPARATOR},{title:"Imprint",action(){return a.executeCommand('execute "Imprint.md"')}},{title:"Disclaimer",action(){return a.executeCommand('execute "Disclaimer.md"')}}]}]}),ss={xmlns:"http://www.w3.org/2000/svg",width:"6",height:"10",viewBox:"0.5 50.5 6 10"};function is(a,e){return T(),x("svg",ss,e[0]||(e[0]=[W("path",{fill:"#020203",d:"M.5 50.5h6v2h-4v2h2v2h-2v4h-2z"},null,-1)]))}const ns={render:is},os={xmlns:"http://www.w3.org/2000/svg",width:"6",height:"10"};function ls(a,e){return T(),x("svg",os,e[0]||(e[0]=[W("path",{d:"M0 10h6V8H2V6h2V4H2V2h4V0H0z"},null,-1)]))}const us={render:ls},cs={class:"icon full"},ms={class:"icon empty"},ds=ne({__name:"StorageBar",props:{visible:{type:Boolean,default:!0},value:{type:Number,default:.8}},setup(a){const e=a,t=I(()=>({"--bar-height":Math.min(e.value,1)}));return(r,i)=>a.visible?(T(),x("div",{key:0,class:"wb-env-atom-storage-bar",style:pr(t.value)},[W("div",null,[W("div",cs,[S(Te(ns))]),i[0]||(i[0]=W("span",{class:"size"},[W("span",{class:"helper"})],-1)),W("div",ms,[S(Te(us))])])],4)):B("",!0)}}),ps=oe(ds,[["__scopeId","data-v-3d4c6ce7"]]),fs={class:"wb-env-molecule-dialog-content"},hs=["innerHTML"],gs={key:1,class:"input"},ws=ne({__name:"DialogContent",props:{message:{type:String,default(){return"Dialog Message"}},confirm:{type:Boolean,default:!1},prompt:{type:Boolean,default:!1},promptType:{type:String,default:"text"},promptStep:{type:Number,default:void 0},promptValue:{type:String,default:""},password:{type:Boolean,default:!1},apply:{type:Function,default(){return null}},abort:{type:Function,default(){return null}},applyLabel:{type:String,default(){return"Continue"}},abortLabel:{type:String,default(){return"Cancel"}},yesLabel:{type:String,default(){return"Yes"}},noLabel:{type:String,default(){return"No"}}},emits:["apply","abort"],setup(a,{emit:e}){const t=a,r=e,i=j(t.promptValue),s=I(()=>t.password?"password":t.promptType),n=I(()=>t.message.replace(/\\n|\n/g,"<br>")),l=()=>{const u=i.value||!0;typeof t.apply=="function"?t.apply(u):r("apply",u)},o=()=>{typeof t.abort=="function"?t.abort():r("abort")};return(u,m)=>(T(),x("div",fs,[W("div",null,[a.message?(T(),x("p",{key:0,innerHTML:n.value},null,8,hs)):B("",!0),a.prompt?(T(),x("div",gs,[S(ge,{ref:"dialogInput",modelValue:i.value,"onUpdate:modelValue":m[0]||(m[0]=g=>i.value=g),step:a.promptStep,type:s.value,label:null},null,8,["modelValue","step","type"])])):B("",!0),S(De,{align:a.abortLabel?"outer":"center",class:"buttons"},{default:ie(()=>[a.applyLabel||a.confirm&&a.yesLabel?(T(),ce(K,{key:0,"style-type":"dialog",label:a.confirm?a.yesLabel:a.applyLabel,onClick:l},null,8,["label"])):B("",!0),a.abortLabel||a.confirm&&a.noLabel?(T(),ce(K,{key:1,"style-type":"dialog",label:a.confirm?a.noLabel:a.abortLabel,onClick:o},null,8,["label"])):B("",!0)]),_:1},8,["align"])])]))}}),bs=oe(ws,[["__scopeId","data-v-302c1124"]]),Es=Me(({module:a,core:e})=>{var s;const t=(s=e.modules.files)==null?void 0:s.fs,r=e.modules.symbols,i=e.modules.windows;return[{name:["openDirectory","openDir"],description:"Opens the specified directory.",args:[new h({index:0,name:"path",description:"Path to the directory."}),new h({name:"sortSymbols",description:"Sort Symbols",flag:!0}),new h({name:"windowSize",description:"Window Size"}),new h({name:"windowPosition",description:"Window Position"}),new h({name:"windowScale",description:"Window Scale"}),new h({name:"windowScrollX",description:"Window Scroll-X"}),new h({name:"windowScrollY",description:"Window Scroll-Y"}),new h({name:"windowSidebar",description:"Window Sidebar"}),new h({name:"windowFullSize",description:"Window Full-Size"})],async action({path:n,sortSymbols:l,windowSize:o,windowPosition:u,windowScale:m,windowScrollX:g,windowScrollY:d,windowSidebar:p,windowFullSize:f}){if(!n)throw D.get("bad_args");const v=await(t==null?void 0:t.get(n));if(!v)throw D.get("FileSystemItem_itemNotFound",n);if(!(v instanceof fe))throw D.get("FileSystemItem_itemNotContainer",n);const _=await(r==null?void 0:r.addFileSystemWrapper(v)),$=r==null?void 0:r.getWrapper(String(_)),P=He({value:v.size/v.maxSize}),A=Z=>{const[we,$e]=Z.split(",");return gt(Number(we),Number($e))},C=i==null?void 0:i.addWindow({layout:{size:A(o||"400,200"),position:A(u||"0,0")},sidebarComponent:ps,sidebarComponentData:P,component:qt,componentData:{wrapperId:_,parentScrollable:g||d},options:{title:v.name,sidebar:p!==void 0?p:!0,scale:m!==void 0?m:!0,scrollX:g!==void 0?g:!0,scrollY:d!==void 0?d:!0,center:!u}},{active:!0,full:f}),y=()=>{P.value=v.size/v.maxSize},ee=[$==null?void 0:$.events.subscribe(y)];return new Promise(Z=>{C==null||C.events.subscribe(({name:we})=>{we==="ready"&&l?window.requestAnimationFrame(()=>{$==null||$.rearrangeIcons()}):we==="close"?(ee.forEach($e=>$e==null?void 0:$e.unsubscribe()),_&&(r==null||r.removeWrapper(_)),Z(!0)):y()})})}},{name:["openDialog"],description:"Open a Dialog.",args:[new h({index:0,name:["message"],description:"Message from Dialog."}),new h({index:1,name:["title"],description:"Title from Dialog."}),new h({name:["apply"],description:"Title from apply button."}),new h({name:["abort"],description:"Title from abort button."}),new h({name:["confirm"],flag:!0,description:"Defines the confirm dialog"}),new h({name:["prompt"],flag:!0,description:"Defines the prompt dialog"}),new h({name:["promptType"],description:"Type from prompt dialog (e.g. text, number, email). (Default: text)"}),new h({name:["promptStep"],description:"Step from prompt dialog (e.g. 1, 0.1, 0.01). (Default: 1)"}),new h({name:["promptValue"],description:"Default value from prompt dialog."}),new h({name:["secret"],flag:!1,description:"Input is illegible."})],action:n=>{const{title:l,message:o=null,apply:u=null,abort:m=null,confirm:g=!1,prompt:d=!1,promptType:p="text",promptStep:f=void 0,promptValue:v=null,secret:_=!1}=n;let $;const P=y=>{$(y)},A=()=>{$(!1)},C=a.addWindow(new lt({component:bs,componentData:{title:l,message:o,secret:_,confirm:g,prompt:d,promptType:p,promptStep:Number(f),promptValue:v,applyLabel:u||"Continue",abortLabel:m,apply:P,abort:A},options:{scaleX:!1,scaleY:!1,scrollX:!1,scrollY:!1,close:!1}}));return C.awaitClose().then(()=>A()),new Promise(y=>{$=y}).then(y=>(C.close(),y))}}]});class vs extends Ze{constructor(t){super({config:gr,commands:Es,...t,name:"Windows"});E(this,"wrappers",N(new Map));E(this,"contentWrapper");E(this,"globalWrapper");E(this,"contextMenu");this.contextMenu=He(new Qa(this.core)),this.contentWrapper=this.getWrapper(this.addWrapper(new St(this.core))),this.globalWrapper=this.getWrapper(this.addWrapper(new St(this.core))),Nr({contentWrapper:this.contentWrapper.events,globalWrapper:this.globalWrapper.events}).subscribe(r=>{console.log("event",r)})}addWindow(t,r={}){let i;return t instanceof lt?i=t:i=new lt(t),i.componentData&&(i.componentData.core=N(this.core)),r={global:!1,...r},r.global?i=this.globalWrapper.add(i,r):i=this.contentWrapper.add(i,r),i}getWrapper(t){return this.wrappers.get(t)}getFocusedWrapper(){return Array.from(this.wrappers.values()).map(({models:t})=>t.value).flat().find(t=>t.options.focused)}addWrapper(t){return this.wrappers.set(t.id,t),t.id}removeWrapper(t){typeof t!="string"&&(t=t.id),this.wrappers.delete(t)}isContextMenu(t){return t.id===this.getActiveContextMenu().id}setup(){this.contextMenu.addDefaultItems(new dt(as,{core:this.core})),this.contextMenu.addDefaultItems(new dt(wr,{core:this.core}))}clear(){this.contentWrapper.clear(),this.globalWrapper.clear()}getActiveContextMenu(){return this.contextMenu.getActiveItems()}setActiveContextMenu(t){return this.contextMenu.setActiveItems(t)}}const _s={[w.DEFAULT]:()=>b(()=>import("./BOYliybv.js"),__vite__mapDeps([5,6]),import.meta.url).then(a=>a.default),[w.DIRECTORY]:()=>b(()=>import("./DPrRmE96.js"),__vite__mapDeps([7,6]),import.meta.url).then(a=>a.default),[w.DIRECTORY_PREFS]:()=>b(()=>import("./CzhC_tPS.js"),__vite__mapDeps([8,6]),import.meta.url).then(a=>a.default),[w.CLOUD_DISK]:()=>b(()=>import("./CS4M017p.js"),__vite__mapDeps([9,6]),import.meta.url).then(a=>a.default),[w.HARD_DISK]:()=>b(()=>import("./CE3sgpCi.js"),__vite__mapDeps([10,6]),import.meta.url).then(a=>a.default),[w.RAM_DISK]:()=>b(()=>import("./BL5nqs-c.js"),__vite__mapDeps([11,6]),import.meta.url).then(a=>a.default),[w.TMP_DISK]:()=>b(()=>import("./BvRISv78.js"),__vite__mapDeps([12,6]),import.meta.url).then(a=>a.default),[w.DISK_1]:()=>b(()=>import("./CwcNSeQ9.js").then(a=>a.d),__vite__mapDeps([13,6,14,15,16,17,18,19,3,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52]),import.meta.url).then(a=>a.default),[w.DISK_2]:()=>b(()=>import("./DYdbFn8U.js"),__vite__mapDeps([53,6]),import.meta.url).then(a=>a.default),[w.DISK_WORKBENCH13]:()=>b(()=>import("./CyPS_EfQ.js"),__vite__mapDeps([54,6]),import.meta.url).then(a=>a.default),[w.DISK_MARKDOWN]:()=>b(()=>import("./mUv7Us8e.js"),__vite__mapDeps([55,6]),import.meta.url).then(a=>a.default),[w.DISK_BASIC]:()=>b(()=>import("./CU7nMArO.js"),__vite__mapDeps([56,6]),import.meta.url).then(a=>a.default),[w.WORK]:()=>b(()=>import("./FwzKVvsF.js"),__vite__mapDeps([57,6]),import.meta.url).then(a=>a.default),[w.CONSOLE]:()=>b(()=>import("./BXMp5RLQ.js"),__vite__mapDeps([58,6]),import.meta.url).then(a=>a.default),[w.SETTINGS]:()=>b(()=>import("./D-ayEwVc.js"),__vite__mapDeps([59,6]),import.meta.url).then(a=>a.default),[w.TRASHCAN]:()=>b(()=>import("./Bj7_mC34.js"),__vite__mapDeps([60,6]),import.meta.url).then(a=>a.default),[w.COMPUTER_1]:()=>b(()=>import("./DF9gzcSG.js"),__vite__mapDeps([61,6]),import.meta.url).then(a=>a.default),[w.TELEPHONE]:()=>b(()=>import("./CzufHaTc.js"),__vite__mapDeps([62,6]),import.meta.url).then(a=>a.default),[w.CURSOR]:()=>b(()=>import("./BiyAQ2W_.js"),__vite__mapDeps([63,6]),import.meta.url).then(a=>a.default),[w.PREFERENCE]:()=>b(()=>import("./Bf7OyeoU.js"),__vite__mapDeps([64,6]),import.meta.url).then(a=>a.default),[w.WEB_BASIC]:()=>b(()=>import("./DPYYzmKN.js"),__vite__mapDeps([65,6]),import.meta.url).then(a=>a.default),[w.WEB_PAINTING]:()=>b(()=>import("./CeE_iCN-.js"),__vite__mapDeps([66,6]),import.meta.url).then(a=>a.default),[w.COLORS]:()=>b(()=>import("./qIUDYtRx.js"),__vite__mapDeps([67,6]),import.meta.url).then(a=>a.default),[w.PRINT_1]:()=>b(()=>import("./DSa_b-wf.js"),__vite__mapDeps([68,6]),import.meta.url).then(a=>a.default),[w.PRINT_2]:()=>b(()=>import("./B2T_rDao.js"),__vite__mapDeps([69,6]),import.meta.url).then(a=>a.default),[w.NOTEPAD]:()=>b(()=>import("./Dwavv3_s.js"),__vite__mapDeps([70,6]),import.meta.url).then(a=>a.default),[w.BASIC]:()=>b(()=>import("./6A-9wLFC.js"),__vite__mapDeps([71,6]),import.meta.url).then(a=>a.default),[w.IMAGE]:()=>b(()=>import("./aqFMQJ2H.js"),__vite__mapDeps([72,6]),import.meta.url).then(a=>a.default),[w.NOTE]:()=>b(()=>import("./BKoQiQOy.js"),__vite__mapDeps([73,6]),import.meta.url).then(a=>a.default),[w.NOTE_BLANK]:()=>b(()=>import("./DnSGt5Pz.js"),__vite__mapDeps([74,6]),import.meta.url).then(a=>a.default),[w.LARGE_NOTE]:()=>b(()=>import("./BCqR3XYH.js"),__vite__mapDeps([75,6]),import.meta.url).then(a=>a.default),[w.LARGE_NOTE_RICH]:()=>b(()=>import("./D6EmXOSU.js"),__vite__mapDeps([76,6]),import.meta.url).then(a=>a.default),[w.FULLSCREEN]:()=>b(()=>import("./D2B2Q84m.js"),__vite__mapDeps([77,6]),import.meta.url).then(a=>a.default),[w.CALCULATOR]:()=>b(()=>import("./CZfA0VOl.js"),__vite__mapDeps([78,6]),import.meta.url).then(a=>a.default),[w.CLOCK]:()=>b(()=>import("./B6CFzlle.js"),__vite__mapDeps([79,6]),import.meta.url).then(a=>a.default),[w.KEYBOARD_QUESTION]:()=>b(()=>import("./CV7vdT3F.js"),__vite__mapDeps([80,6]),import.meta.url).then(a=>a.default),[w.LARGE_NOTEPAD]:()=>b(()=>import("./oVgEpH-i.js"),__vite__mapDeps([81,6]),import.meta.url).then(a=>a.default),[w.LARGE_NOTEPAD_HELP]:()=>b(()=>import("./RJTi0z-P.js"),__vite__mapDeps([82,6]),import.meta.url).then(a=>a.default),[w.RABBIT]:()=>b(()=>import("./BcBY3IVj.js"),__vite__mapDeps([83,6]),import.meta.url).then(a=>a.default),[w.MORE]:()=>b(()=>import("./D6dU8o4d.js"),__vite__mapDeps([84,6]),import.meta.url).then(a=>a.default),[w.SAY]:()=>b(()=>import("./DBEmKHU_.js"),__vite__mapDeps([85,6]),import.meta.url).then(a=>a.default),[w.GITHUB]:()=>b(()=>import("./BXot0GSt.js"),__vite__mapDeps([86,6]),import.meta.url).then(a=>a.default),[w.LAMMPEE]:()=>b(()=>import("./BvrJyH6c.js"),__vite__mapDeps([87,6]),import.meta.url).then(a=>a.default),[w.CUBY]:()=>b(()=>import("./CNUZDaVi.js"),__vite__mapDeps([88,6]),import.meta.url).then(a=>a.default),[w.NUXT]:()=>b(()=>import("./Byqm8odu.js"),__vite__mapDeps([89,6]),import.meta.url).then(a=>a.default),[w.CLOWN]:()=>b(()=>import("./CzCWicxH.js"),__vite__mapDeps([90,6]),import.meta.url).then(a=>a.default),[w.DISALLOW_1]:()=>b(()=>import("./uSzHJ9u_.js"),__vite__mapDeps([91,6]),import.meta.url).then(a=>a.default),[w.COPY_1]:()=>b(()=>import("./DLeaTRmW.js"),__vite__mapDeps([92,6]),import.meta.url).then(a=>a.default),[w.COPY_2]:()=>b(()=>import("./esh0LbWA.js"),__vite__mapDeps([93,6]),import.meta.url).then(a=>a.default),[w.DISPLAY_KEYBOARD]:()=>b(()=>import("./Dvds7d43.js"),__vite__mapDeps([94,6]),import.meta.url).then(a=>a.default),[w.PALETTE]:()=>b(()=>import("./DEXMY_Zs.js"),__vite__mapDeps([95,6]),import.meta.url).then(a=>a.default),[w.SIGN_1]:()=>b(()=>import("./qTsJual8.js"),__vite__mapDeps([96,6]),import.meta.url).then(a=>a.default),[w.DOCUMENT_EDITOR]:()=>b(()=>import("./DRSOMj1Z.js"),__vite__mapDeps([97,6]),import.meta.url).then(a=>a.default),[w.DOCUMENT_READER]:()=>b(()=>import("./G3rjhkDV.js"),__vite__mapDeps([98,6]),import.meta.url).then(a=>a.default),[w.SYNTHESIZER]:()=>b(()=>import("./C0MNuf2_.js"),__vite__mapDeps([99,6]),import.meta.url).then(a=>a.default),[w.VUE_SEMANTIC_STRUCTURE]:()=>b(()=>import("./BHdfLvOx.js"),__vite__mapDeps([100,6]),import.meta.url).then(a=>a.default),[w.NUXT_BOOSTER]:()=>b(()=>import("./CGJAvQPZ.js"),__vite__mapDeps([101,6]),import.meta.url).then(a=>a.default)},ys=wt(({module:a,core:e})=>[{order:30,title:"Symbol",items:[{type:z.CHECKBOX,title:"Show Invisible Symbols",model:e.config.observable,name:U.SHOW_INVISIBLE_SYMBOLS,action(t){return e.config.set(U.SHOW_INVISIBLE_SYMBOLS,t)}},{title:"Rearrange Symbols",hotKey:"R",keyCode:82,action(){const t=a.getDefaultWrapper(),r=a.getPrimaryWrapper();if(r instanceof xe&&(r==null?void 0:r.id)!==(t==null?void 0:t.id)){if(r==null||r.rearrangeIcons(),r!=null&&r.fsItem)return ze(r==null?void 0:r.fsItem);throw new Error("No fsItem found")}else if(t instanceof xe){if(t==null||t.rearrangeIcons({root:!0}),t!=null&&t.fsItem)return ze(t==null?void 0:t.fsItem);throw new Error("No fsItem found")}}},{title:"Order Type",items:[{model:e.config.observable,type:z.RADIO,name:U.ORDER_TYPE,value:me.NAME,title:"Name",action(){return e.config.set(U.ORDER_TYPE,me.NAME)}},{model:e.config.observable,type:z.RADIO,name:U.ORDER_TYPE,value:me.TYPE,title:"Type",action(){return e.config.set(U.ORDER_TYPE,me.TYPE)}},{model:e.config.observable,type:z.RADIO,name:U.ORDER_TYPE,value:me.CREATED_DATE,title:"Created Date",action(){return e.config.set(U.ORDER_TYPE,me.CREATED_DATE)}},{model:e.config.observable,type:z.RADIO,name:U.ORDER_TYPE,value:me.EDITED_DATE,title:"Edited Date",action(){return e.config.set(U.ORDER_TYPE,me.EDITED_DATE)}}]},{title:"Order Direction",items:[{model:e.config.observable,type:z.RADIO,name:U.ORDER_DIRECTION,value:Ye.ASCENDING,title:"Ascending",action(){return e.config.set(U.ORDER_DIRECTION,Ye.ASCENDING)}},{model:e.config.observable,type:z.RADIO,name:U.ORDER_DIRECTION,value:Ye.DESCENDING,title:"Descending",action(){return e.config.set(U.ORDER_DIRECTION,Ye.DESCENDING)}}]}]}]),Is=({module:a})=>[{name:["rearrangeIcons"],description:"Rearrange Icons",args:[new h({name:"id",description:"Wraper id"}),new h({name:"root",description:"Use root wrapper",flag:!0})],async action({id:e,root:t}){const r=a.getDefaultWrapper(),i=a.getPrimaryWrapper();if(await new Promise(s=>window.requestAnimationFrame(s)),t){if(r.fsItem)return r==null||r.rearrangeIcons({root:!0}),ze(r.fsItem);throw new Error("No fsItem found")}else{let s=i;if(e&&(s=a.get(e),s instanceof xe&&s.fsItem))return s.rearrangeIcons(),ze(s.fsItem)}}}];class Ss extends Ge{}class jt extends Ze{constructor(t){const{core:r}=Object.assign({core:null},t);super({name:"Symbols",config:lr,commands:Is,contextMenu:ys,core:r});E(this,"events",N(new Sr));E(this,"symbols",N(new Map));E(this,"wrappers",N(new Map));E(this,"wrappersObservable",{});E(this,"hasSelectedItems",!1);E(this,"_activeWrapper");E(this,"_defaultWrapper");E(this,"activeWrapper");E(this,"defaultWrapper");E(this,"primaryWrapper");E(this,"secondaryWrapper")}addWrapper(t){return t=N(t),this.wrappers.set(t.id,t),this.wrappersObservable[t.id]=t,t.events.subscribe(this.onEventWrapper.bind(this)),t.id}onEventWrapper({name:t,value:r}){var i;r!=null&&r.wrapper&&(t==="selectItem"||t==="unselectItem")&&(this.hasSelectedItems=((i=r==null?void 0:r.wrapper.selectedItems.value)==null?void 0:i.length)>0,this.events.next(new Ss({name:"hasSelectedItems",value:this.hasSelectedItems})))}getWrapper(t){return typeof t!="string"&&(t=t.id),this.wrappers.get(t)}removeWrapper(t){typeof t!="string"&&(t=t.id),this.wrappers.delete(t),Reflect.deleteProperty(this.wrappersObservable,t)}getActiveWrapper(t=!1){var i;const r=(i=this.core.modules.windows)==null?void 0:i.contentWrapper.getActiveWindow();return r&&r.symbolWrapper?r.symbolWrapper:t?null:this.activeWrapper}getSelectedItems(){return Array.from(this.wrappers.values()).reduce((t,r)=>(r.selectedItems.value.forEach(s=>{const n=r.get(s);n&&t.push(n)}),t),[])}clearSelectedItems(){return Array.from(this.wrappers.values()).forEach(t=>{t.clearSelectedItems()})}async addFileSystemWrapper(t,r=!1){const i=new xe(this.core,void 0,r);return await i.setup(t),this.addWrapper(i)}async setup(){var r;const t=(r=this.core.modules.files)==null?void 0:r.fs.root;t&&(await this.loadCoreSymbols(),this.setDefaultWrapper(await this.addFileSystemWrapper(t,!0)))}loadCoreSymbols(){return Promise.all(Object.values(w).map(async t=>this.symbols.set(t,await _s[t]())))}get(t){return this.wrappers.get(t)}setDefaultWrapper(t){this._defaultWrapper=t;const r=this.wrappers.get(t);r&&(this.primaryWrapper=r,this.secondaryWrapper=r,this.activeWrapper=r,this.defaultWrapper=r)}getDefaultWrapper(){return this.defaultWrapper}getPrimaryWrapper(){return this.primaryWrapper||this.defaultWrapper}getSecondaryWrapper(){return this.secondaryWrapper||this.defaultWrapper}setPrimaryWrapper(t){if(t){let r;t instanceof et?r=t.id:r=t,this.primaryWrapper=this.wrappers.get(r)}else this.primaryWrapper=void 0;this.events.next(new Ge({name:"setPrimaryWrapper",value:this.getPrimaryWrapper()}))}setSecondaryWrapper(t){if(t){let r;t instanceof et?r=t.id:r=t,this.secondaryWrapper=this.wrappers.get(r)}else this.primaryWrapper=void 0;this.events.next(new Ge({name:"setSecondaryWrapper",value:this.secondaryWrapper}))}setActiveWrapper(t){let r;t instanceof et?r=t.id:r=t;let i=this.wrappers.get(this._activeWrapper||"");return r!==this._activeWrapper&&(this._activeWrapper=r,this.activeWrapper=this.wrappers.get(this._activeWrapper),i=this.activeWrapper||this.wrappers.get(this._defaultWrapper||""),this.events.next(new Ge({name:"setActiveWrapper",value:i}))),i}addSymbol(t,r){this.symbols.set(t,r)}removeSymbol(t){this.symbols.delete(t)}}E(jt,"NAME","Symbols");function As(){const a=new Jt;return a.addModule(ga),a.addModule(Ht),a.addModule(vs),a.addModule(jt),a}const hi=As();export{hi as default};
