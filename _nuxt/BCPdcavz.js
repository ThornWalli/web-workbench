import{d as $,r as b,k as P,a0 as R,o as z,W,y as v,z as f,$ as j,A as i,I as w,X as M,G as r,a3 as U,ad as A,U as X,_ as Y}from"./BUU1NkbK.js";import{e as c}from"./DG6QdPnO.js";import{d as k}from"./On0xenC3.js";import{f as J}from"./CZZPvNTk.js";import{K as H}from"./B2exwp0w.js";import{o as Q,S as K}from"./6C4StZv5.js";import{f as Z}from"./DNvW6rqi.js";import{f as O}from"./DI3A0fxi.js";import{a as ee}from"./BWR5uye1.js";import{c as ne}from"./6jpuwjT2.js";function le(p,m){return m===void 0&&(m=ee),Q(function(S,u){var l=null,o=null,d=null,L=function(){if(l){l.unsubscribe(),l=null;var a=o;o=null,u.next(a)}};function t(){var a=d+p,y=m.now();if(y<a){l=this.schedule(void 0,a-y),u.add(l);return}L()}S.subscribe(ne(u,function(a){o=a,d=m.now(),l||(l=m.schedule(t,p),u.add(l))},function(){L(),u.complete()},void 0,function(){o=l=null}))})}const te={class:"result"},ae=["innerHTML"],se=["innerHTML"],ue=["innerHTML"],oe=["innerHTML"],ie=["innerHTML"],re=["innerHTML"],ce=["innerHTML"],de=["innerHTML"],ve={key:1,class:"selected"},fe=["innerHTML"],pe=["innerHTML"],me={class:"input"},ye=["readonly"],_e=["readonly"],Te=$({__name:"InputText",props:{rootElement:{type:HTMLElement,default(){return null}},overrideFocused:{type:Boolean,default:!1},readonly:{type:Boolean,required:!1,default:!1},multiline:{type:Boolean,required:!1,default:!0},name:{type:String,default:"value"},modelValue:{type:String,default:void 0},model:{type:Object,required:!1,default(){return{value:"Input Value"}}}},emits:["blur","refresh","input","update:model-value","enter","keydown","keyup"],setup(p,{expose:m,emit:S}){const u=p,l=S,o=b(null),d=b(u.overrideFocused),L=b(0),t=b(0),a=b(0),y=b(!1),E=b(!1);let _=new K;const n=P({get(){return u.modelValue||""},set(e){l("update:model-value",e)}}),q=P(()=>({readonly:u.readonly,multiline:u.multiline,"selection-empty":!L.value,focused:d.value,"shift-active":y.value,"caps-lock-active":E.value}));R(()=>u.overrideFocused,e=>{d.value=e}),R(()=>d.value,e=>{e?F():I()}),z(()=>{var e;(e=o.value)==null||e.setSelectionRange(n.value.length,n.value.length),T(),d.value&&F()}),W(()=>{_.unsubscribe()});function F(){var e;_.add(k.pointerDown.pipe(Z(({target:s})=>{var D;const h=X(),N=u.rootElement||((D=h==null?void 0:h.parent)==null?void 0:D.vnode.el);return!J(s,N)}),O()).subscribe(I)),_.add(k.keyPress.subscribe(()=>{var s;(s=o.value)==null||s.focus()})),_.add(k.keyDown.subscribe(({code:s})=>{switch(s){case H.SHIFT_LEFT:case H.SHIFT_RIGHT:y.value=!0;break;case H.CAPS_LOCK:E.value=!E.value;break}})),_.add(k.keyUp.subscribe(s=>{switch(s.code){case H.SHIFT_LEFT:case H.SHIFT_RIGHT:y.value=!1;break}l("keyup",s)})),(e=o.value)==null||e.focus()}function I(){var e;_.unsubscribe(),_=new K,(e=o.value)==null||e.blur(),l("blur")}function T(){const e=o.value;e&&(t.value=e.selectionStart||0,a.value=e.selectionEnd||0,L.value=a.value-t.value,l("refresh"))}function G(e){d.value=e}function x(){const e=k.pointerMove.pipe(le(128)).subscribe(()=>{T()});k.pointerUp.pipe(O()).subscribe(()=>{e.unsubscribe()})}function C(){T(),l("input")}function g(){d.value?T():G(!0)}function B(e){!u.multiline&&e.code===H.ENTER?(e.preventDefault(),e.stopPropagation(),l("enter",n.value),T()):(l("keydown",e),T())}function V(e){l("keyup",e),T()}return m({resetSelection:()=>{var e;(e=o.value)==null||e.setSelectionRange(0,0)},controlShiftActive:y,controlCapsLockActive:E}),(e,s)=>(f(),v("div",{class:j(["wb-env-element-input-text",q.value])},[i("div",null,[i("div",te,[n.value.length>0&&a.value>0?(f(),v(M,{key:0},[t.value>=0&&a.value===n.value.length?(f(),v(M,{key:0},[i("span",{innerHTML:r(c)(n.value.slice(0,t.value))},null,8,ae),i("span",{class:"selected",innerHTML:r(c)(n.value.slice(t.value,a.value+1))||" "},null,8,se)],64)):t.value&&t.value===a.value?(f(),v(M,{key:1},[i("span",{innerHTML:r(c)(n.value.slice(0,t.value))},null,8,ue),i("span",{class:"selected",innerHTML:r(c)(n.value.slice(t.value,t.value+1))||" "},null,8,oe),i("span",{innerHTML:r(c)(n.value.slice(t.value+1,n.value.length))},null,8,ie)],64)):(f(),v(M,{key:2},[i("span",{innerHTML:r(c)(n.value.slice(0,t.value))},null,8,re),i("span",{class:"selected",innerHTML:r(c)(n.value.slice(t.value,a.value))},null,8,ce),i("span",{innerHTML:r(c)(n.value.slice(a.value,n.value.length))},null,8,de)],64))],64)):w("",!0),!t.value&&n.value===""?(f(),v("span",ve," ")):n.value.length>0&&!t.value&&t.value===a.value?(f(),v(M,{key:2},[i("span",{class:"selected",innerHTML:r(c)(n.value.slice(0,1))},null,8,fe),i("span",{innerHTML:r(c)(n.value.slice(1,n.value.length))},null,8,pe)],64)):w("",!0)]),i("div",me,[p.multiline?U((f(),v("textarea",{key:0,ref_key:"inputEl",ref:o,"onUpdate:modelValue":s[0]||(s[0]=h=>n.value=h),readonly:p.readonly,onPointerdown:x,onInput:C,onClick:g,onKeydown:B,onKeyup:V,onFocus:g},null,40,ye)),[[A,n.value]]):w("",!0),p.multiline?w("",!0):U((f(),v("input",{key:1,ref_key:"inputEl",ref:o,"onUpdate:modelValue":s[1]||(s[1]=h=>n.value=h),type:"text",readonly:p.readonly,onPointerdown:x,onInput:C,onClick:g,onKeydown:B,onKeyup:V,onFocus:g},null,40,_e)),[[A,n.value]])])])],2))}}),Fe=Y(Te,[["__scopeId","data-v-5df8126c"]]);export{Fe as E};
