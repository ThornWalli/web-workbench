


import{j as k,k as v,u as f}from"./index.7c17a2aa.js";import{g as y,C as m,T,a as g}from"./index.7fd70862.js";import{N as C,c as w,u as x,T as N}from"./Navigation.69bd3066.js";import{T as P}from"./TimelineCanvas.3c29d824.js";import{_ as j,S as $,f as d,k as o,l as r,q as c,H as u,a5 as p,m as h,C as E,N as S,O as M}from"./entry.0f459a47.js";import"./index.bce42005.js";import"./viewport.caa1073f.js";import"./math.40e5f1d4.js";import"./async.d9ddb331.js";const R={components:{Navigation:C,SynthesizerTimelineCanvas:P},props:{...k,model:{type:Object,default:y()}},emits:[...v,"refresh"],setup(t,s){const e=$(t,"model"),a=f(t,s);return a.setContextMenu(w,{model:e.value}),{...a,...x()}},data:function(){return{toneDestination:null}},computed:{project(){return this.model[m.SYNTHESIZER_PROJECT]},tracks:{get(){return this.project.tracks},set(t){this.project.tracks=t}},bpm(){return Number(this.model[m.SYNTHESIZER_BPM])},controlsNavigation(){return{model:this.model,items:[[{text:`Project: ${this.project.name} | Tracks: ${this.tracks.length}`}]]}}},mounted(){this.$nextTick(()=>{this.$emit("refresh")})},unmounted(){this.model.actions.closeTracks()},methods:{async onClickPlay(){await this.tone.start(),this.players=this.tracks.map(e=>{const a=new N(e,{autoplay:!1});return a.createInstrument("Synth"),a});const t=g;t.stop(),t.seconds=0,t.start(),this.players.map(e=>e.play()).map(e=>e.start(0))},getControls(t){const s=t.getDuration();return{items:[{text:t.name},{spacer:!0},{text:` ${s}`},{title:"Edit",onClick:async()=>{await this.tone.start(),this.editTrack(new T(t),{toneDestination:this.toneDestination})}},{title:"Remove",onClick:async()=>{this.preserveContextMenu(!0),await this.model.actions.removeTrack(t),this.preserveContextMenu(!1),this.$emit("refresh")}}]}},async editTrack(...t){const{close:s}=this.model.actions.editTrack(...t),e=await s;console.log(e.notes),this.tracks=this.tracks.map(a=>a.id===e.id?e:a),this.$nextTick(()=>{this.$emit("refresh")})}}},D={class:"wb-disks-extras13-synthesizer-project"},b={class:"tracks"},z={key:0,class:"no-tracks"},I={class:"sheet"};function B(t,s,e,a,O,n){const l=d("navigation"),_=d("synthesizer-timeline-canvas");return o(),r("div",D,[c(l,u(p(n.controlsNavigation)),null,16),h("div",b,[n.tracks.length<1?(o(),r("div",z,"No tracks availableâ€¦")):E("",!0),(o(!0),r(S,null,M(n.tracks,i=>(o(),r("div",{key:i.id,class:"track"},[h("div",I,[c(_,{track:i,onRefresh:s[0]||(s[0]=q=>t.$emit("refresh"))},null,8,["track"])]),c(l,u(p(n.getControls(i))),null,16)]))),128))])])}const W=j(R,[["render",B],["__scopeId","data-v-5441a724"]]);export{W as default};
