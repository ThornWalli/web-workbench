(window.webpackJsonp=window.webpackJsonp||[]).push([[20,22,33,41,42],{114:function(t,e,r){"use strict";r.r(e),function(t){var h=r(73),n=r(78),o=r(115);class c{static invertImageData(t){for(var i=0,e=0;e<t.width;e++)for(var r=0;r<t.height;r++)i=4*(e+r*t.width),t.data[Number(i)]=255-t.data[Number(i)],t.data[i+1]=255-t.data[i+1],t.data[i+2]=255-t.data[i+2]}static createImageData(e,r,data){return new t.ImageData(new t.Uint8ClampedArray(data||4*e*r),e,r)}static resizeImageData(t){for(var e,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=t.data,o=t.width,h1=t.height,l=o*r,h2=h1*r,m=Array(l*h2*4),f=Object(h.e)(parseInt((o<<16)/l)+1,parseInt((h1<<16)/h2)+1),i=0;i<h2;i++)for(var v=0;v<l;v++)e=v*f.x>>16,d(4*((i*f.y>>16)*o+e),n,4*(i*l+v),m);return c.createImageData(l,h2,m)}static cropImageData(t,e,r,h,n){for(var o=t.data,l=Array(h*n*4),i=0;i<h;i++)for(var m=0;m<n;m++){d(4*(r*t.width+e)+4*(m*t.width+i),o,4*(m*h+i),l)}return c.createImageData(h,n,l)}getActiveContext(){return this._app.display.context}getDisplayContexts(){return this._app.displays.map(t=>t.context)}constructor(t){this._app=t;var e=t.options.size;this._bitmapData=new o.default(e.width,e.height),this._renderActions=[],this._passiveRenderActions=[],this.clearStack()}setSize(t,e){this._bitmapData=new o.default(t,e),this.clearStack(),this.render(),this._app.refresh()}loadImage(image){var t=this.getImageDataFromImage(image);this._bitmapData=new o.default(t.width,t.height),this.clearStack(),this._stacks.push(t),this.render(),this._app.refresh()}getImageDataFromImage(image){var canvas=document.createElement("canvas");canvas.width=image.width,canvas.height=image.height;var t=canvas.getContext("2d");t.drawImage(image,0,0);for(var e=c.createImageData(image.width,image.height),data=t.getImageData(0,0,canvas.width,canvas.height),i=0;i<data.length;i++)e.data[Number(i)]=data[Number(i)];return data}getColorFromPixel(t,e){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2]?this._renderImageData:this._stacks[this._stacks.length-1||0],data=r.data,h=e*(4*r.width)+4*t;return new n.default(data[Number(h)],data[h+1],data[h+2],data[h+3])}getPixel(t,e){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2]?this._renderImageData:this._stacks[this._stacks.length-1||0],data=r.data,h=e*(4*r.width)+4*t;return data[Number(h)]+data[h+1]+data[h+2]+data[h+3]}setPixel(t,e,r){r=r||this._app.primaryColor;var i=4*(t+e*this._renderImageData.width);this._renderImageData.data[i+0]=r.red,this._renderImageData.data[i+1]=r.green,this._renderImageData.data[i+2]=r.blue,this._renderImageData.data[i+3]=r.alpha>=0?r.alpha:255}putImageData(t,e,r){for(var h,n,o=0;o<t.width;o++)for(var c=0;c<t.height;c++)h=4*(c*t.width+o),n=4*((r+c)*this._renderImageData.width+(e+o)),d(h,t.data,n,this._renderImageData.data)}fillPixels(t,e,r,h,n){for(var o=e;o<Math.min(e+h,this._renderImageData.width);o++)for(var c=r;c<Math.min(r+n,this._renderImageData.height);c++)this.setPixel(o,c,t)}addRenderAction(t){this._renderActions.push(t)}addPassiveRenderAction(t){this._passiveRenderActions.push(t)}cleanPassiveRenderActions(){this._passiveRenderActions=[]}getTmpStack(){return c.createImageData(this._stacks[this._stacks.length-1].width,this._stacks[this._stacks.length-1].height,this._stacks[this._stacks.length-1].data)}render(){this._renderImageData=this.getTmpStack(),f(this._renderActions),f(this._passiveRenderActions,!0),t.cancelAnimationFrame(this._renderWait),this._renderWait=t.setTimeout(()=>{m.bind(this)(!0),this._renderWait=null},1e3/30),t.clearTimeout(this._renderWaitDisplays),this._renderWaitDisplays=t.setTimeout(()=>{m.bind(this)()},300)}get size(){return Object(h.e)(this._renderImageData.width,this._renderImageData.height)}get width(){return this._renderImageData.width}get height(){return this._renderImageData.height}get stacks(){return this._stacks}get renderImageData(){return this._renderImageData}clearStack(){this._renderImageData=c.createImageData(this._bitmapData.width,this._bitmapData.height),this._stacks=[this._renderImageData],this.render()}saveStack(){this._renderImageData=this.getTmpStack(),f(this._renderActions,!0),this._stacks.push(this._renderImageData),this.render()}revertStack(){this._stacks.length>1&&(this._renderImageData=this._stacks.pop(),this.render())}toBlob(){return new Promise(t=>{l(this._renderImageData).toBlob(t)})}toBase64(){return new Promise(t=>{t(l(this._renderImageData).toDataURL())})}}function d(t,e,r,h){h[Number(r)]=e[Number(t)],h[r+1]=e[t+1],h[r+2]=e[t+2],h[r+3]=e[t+3]}function l(t){var canvas=document.createElement("canvas");return canvas.width=t.width,canvas.height=t.height,canvas.getContext("2d").putImageData(t,0,0),canvas}function m(t){t?this._app.display&&(this._app.display.imageData=this._renderImageData):this._app.displays.forEach(t=>{t.imageData=this._renderImageData})}function f(t,e){if(e)for(;t.length>0;)t.shift()();else t.forEach(t=>{t()})}e.default=c}.call(this,r(7))},115:function(t,e,r){"use strict";r.r(e);var h=r(73);function n(t,e){if(!Object.prototype.hasOwnProperty.call(t,e))throw new TypeError("attempted to use private field on non-instance");return t}var o=0;var c="__private_"+o+++"_"+"size";e.default=class{constructor(t,e){Object.defineProperty(this,c,{writable:!0,value:Object(h.e)(0,0)}),n(this,c)[c]=Object(h.e)(t,e)}get width(){return n(this,c)[c].x}get height(){return n(this,c)[c].y}get size(){return n(this,c)[c]}}},164:function(t,e,r){"use strict";r.r(e),function(t){r.d(e,"default",(function(){return C}));var h=r(652),n=r(199),o=r(73),c=r(110),d=r(114),l=r(78),m=r(97);function f(t,e){if(!Object.prototype.hasOwnProperty.call(t,e))throw new TypeError("attempted to use private field on non-instance");return t}var v=0;function _(t){return"__private_"+v+++"_"+t}var w=_("id"),O=_("bounds"),j=_("cropBounds"),D=_("imageData"),y=_("tmpImageData"),I=_("el"),z=_("canvas"),x=_("context");class C{constructor(t){Object.defineProperty(this,w,{writable:!0,value:Object(h.a)()}),this.events=new n.a,Object.defineProperty(this,O,{writable:!0,value:new m.default}),this.size=Object(o.e)(),this.canvasLayout={size:Object(o.e)(),naturalSize:Object(o.e)(),position:Object(o.e)()},Object.defineProperty(this,j,{writable:!0,value:new m.default}),Object.defineProperty(this,D,{writable:!0,value:null}),Object.defineProperty(this,y,{writable:!0,value:null}),Object.defineProperty(this,I,{writable:!0,value:void 0}),Object.defineProperty(this,z,{writable:!0,value:void 0}),Object.defineProperty(this,x,{writable:!0,value:void 0}),this.zoomFactor=1,this.zoomPosition=Object(o.e)(.5,.5),this.zoomBounds=new m.default,this.offset=Object(o.f)(),this.cursorVisible=!1,this.app=t,this.cursorColor=new l.default(l.default.COLOR_BLACK),this.resetZoom()}showCursor(){this.cursorVisible=!0}hideCursor(){this.cursorVisible=!1,this.renderImageData()}setElement(element){f(this,I)[I]=element}setCanvas(canvas){f(this,z)[z]=canvas,f(this,x)[x]=canvas.getContext("2d"),Object.values(this.app.inputs).forEach(input=>{input.registerDisplay(this)})}destroy(){this.events.next(new c.a("destroy")),Object.values(this.app.inputs).forEach(input=>{input.unregisterDisplay(this)})}get canvas(){return f(this,z)[z]}get id(){return f(this,w)[w]}get bounds(){return f(this,O)[O]}get imageData(){return f(this,D)[D]}set imageData(t){f(this,y)[y]=f(this,D)[D]=t,this.maxZoomFactor=20,this.zoomBounds=this.calculateZoomBounds(this.zoomPosition,this.zoomFactor),this.renderImageData()}get canvasSize(){return Object(o.e)(f(this,z)[z].width,f(this,z)[z].height)}get naturalSize(){return Object(o.e)(f(this,z)[z].width,f(this,z)[z].height)}get naturalWidth(){return f(this,D)[D].width}get naturalHeight(){return f(this,D)[D].height}get width(){return this.zoomBounds.max.x-this.zoomBounds.min.x}get height(){return this.zoomBounds.max.y-this.zoomBounds.min.y}get zoomFactorWidth(){return f(this,z)[z].width/this.zoomFactor}setSize(t,e){var r;r="object"==typeof t?t:Object(o.e)(t,e),this.size=r,this.events.next(new c.a("change:size",r)),this.canvasAdjustment()}canvasAdjustment(){this.canvasLayout.size=Object(o.e)(()=>Math.min(Math.max(this.app.canvas.size*this.zoomFactor,0),this.size)),this.canvasLayout.naturalSize=this.app.canvas.size,this.canvasLayout.position=Object(o.e)(0,0)}setZoom(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Object(o.e)();(e=Math.min(e,this.maxZoomFactor))>=0&&(this.zoomFactor=e,this.canvasAdjustment(),this.zoomPosition=Object(o.e)(()=>r/this.canvasLayout.naturalSize),this.zoomBounds=this.calculateZoomBounds(this.zoomPosition,this.zoomFactor),this.resetOffset(),t.requestAnimationFrame(()=>{this.renderImageData(),this.events.next(new c.a("change:zoomFactor",e))}))}zoom(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Object(o.e)();this.zoomFactor+t>=0&&this.setZoom(this.zoomFactor+t,e)}renderImageData(){f(this,y)[y]=f(this,D)[D];var t=Object(o.e)(()=>this.zoomBounds.max-this.zoomBounds.min),e=Object(o.e)(()=>Object(o.e)(this.offset)+this.zoomBounds.min);f(this,y)[y]=d.default.cropImageData(f(this,y)[y],e.x,e.y,t.x,t.y),f(this,y)[y]=d.default.resizeImageData(f(this,y)[y],this.zoomFactor),this.renderCanvas()}get cursorColor(){return this._cursorColor}set cursorColor(t){this._cursorColorRGBA=t.toRGBA(),this._cursorColor=t}renderCanvas(){f(this,y)[y]&&(f(this,x)[x].putImageData(f(this,y)[y],-this.offset.x,-this.offset.y),this.renderRaster())}reset(){this.resetZoom(),this.resetOffset(),this.renderCanvas()}resetOffset(){this.offset=Object(o.f)(0,0)}resetZoom(){f(this,D)[D]&&this.setZoom(1)}renderRaster(){var t=[];this.zoomFactor>this.maxZoomFactor-3&&t.push({size:Object(o.e)(1,1),width:1,color:"#CCCCCC"});var e=f(this,x)[x];e.globalCompositeOperation="destination-over",t.forEach(t=>{var r=Object(o.e)(()=>this.canvasLayout.naturalSize/t.size);e.lineWidth=t.width,e.beginPath();for(var h=0;h<r.x+1;h++){var n=Math.floor(h*t.size.x*this.zoomFactor)+t.width/2;e.moveTo(n,0),e.lineTo(n,f(this,z)[z].height);for(var c=0;c<r.y+1;c++){var d=Math.floor(c*t.size.y*this.zoomFactor)+t.width/2;e.moveTo(0,d),e.lineTo(f(this,z)[z].width,d)}}e.strokeStyle=t.color,e.stroke()})}refresh(){var rect={left:f(this,z)[z].offsetLeft+f(this,I)[I].offsetLeft,top:f(this,z)[z].offsetTop+f(this,I)[I].offsetTop,width:f(this,z)[z].offsetWidth,height:f(this,z)[z].offsetHeight};f(this,O)[O]=new m.default(Object(o.e)(rect.left,rect.top),Object(o.e)(rect.left+rect.width,rect.top+rect.height)),f(this,D)[D]&&this.renderImageData()}setOffset(t){this.offset=Object(o.f)(t.x,t.y)}calculateZoomBounds(t,e){e=e||1;var r=this.app.canvas.size;t=Object(o.e)(()=>Math.floor(t*r));var h=Object(o.e)(()=>this.size/r),n=Object(o.e)(()=>Math.ceil(Math.min(h/e*r,r))),c=Object(o.e)(()=>Math.min(Math.max(t-Math.ceil(n/2),0),r-n)),d=Object(o.e)(()=>c+n);return new m.default(c,d)}}}.call(this,r(7))},78:function(t,e,r){"use strict";r.r(e);var h=r(79);function n(t,e){if(!Object.prototype.hasOwnProperty.call(t,e))throw new TypeError("attempted to use private field on non-instance");return t}var o=0;function c(t){return"__private_"+o+++"_"+t}var d=c("red"),l=c("green"),m=c("blue");class f{constructor(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,h=arguments.length>3&&void 0!==arguments[3]?arguments[3]:255;Object.defineProperty(this,d,{writable:!0,value:0}),Object.defineProperty(this,l,{writable:!0,value:0}),Object.defineProperty(this,m,{writable:!0,value:0}),this.set(t,e,r,h)}set(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,h=arguments.length>3&&void 0!==arguments[3]?arguments[3]:255;Array.isArray(t)&&(h=t[3],r=t[2],e=t[1],t=t[0]),this.red=t,this.green=e,this.blue=r,this.alpha=void 0===h?255:h}get r(){return n(this,d)[d]}get red(){return n(this,d)[d]}set red(t){n(this,d)[d]=Object(h.b)(t,0,255)}get g(){return this._green}get green(){return this._green}set green(t){this._green=Object(h.b)(t,0,255)}get blue(){return this._blue}get b(){return this._blue}set blue(t){this._blue=Object(h.b)(t,0,255)}get a(){return this._alpha}get alpha(){return this._alpha}set alpha(t){this._alpha=Object(h.b)(t,0,255)}get sum(){return n(this,d)[d]+this._blue+this._green+this._alpha}toRGB(){return"rgb(".concat(n(this,d)[d],",").concat(this._green,",").concat(this._blue,")")}toRGBA(){return"rgba(".concat(n(this,d)[d],",").concat(this._green,",").concat(this._blue,",").concat(this._alpha/255,")")}toJSON(){return{red:this.red,green:this.green,blue:this.blue,alpha:this.alpha}}is(t){return this.red===t.red&&this.blue===t.blue&&this.green===t.green&&this.alpha===t.alpha}invert(){return n(this,d)[d]=255-n(this,d)[d],this._green=255-this._green,this._blue=255-this._blue,this}add(t){this.red=Object(h.b)(this.red+t.red,0,255),this.green=Object(h.b)(this.green+t.green,0,255),this.blue=Object(h.b)(this.blue+t.blue,0,255)}subtract(t){this.red=Object(h.b)(this.red-t.red,0,255),this.green=Object(h.b)(this.green-t.green,0,255),this.blue=Object(h.b)(this.blue-t.blue,0,255)}multiply(t){this.red=Object(h.b)(this.red*t.red,0,255),this.green=Object(h.b)(this.green*t.green,0,255),this.blue=Object(h.b)(this.blue*t.blue,0,255)}divide(t){this.red=Object(h.b)(this.red/t.red,0,255),this.green=Object(h.b)(this.green/t.green,0,255),this.blue=Object(h.b)(this.blue/t.blue,0,255)}}f.COLOR_BLACK=[0,0,0,255],f.COLOR_WHITE=[255,255,255,255],f.COLOR_TRANSPARENT=[0,0,0,0],e.default=f},79:function(t,e,r){"use strict";r.d(e,"b",(function(){return n})),r.d(e,"d",(function(){return o})),r.d(e,"c",(function(){return c})),r.d(e,"a",(function(){return d}));var h=r(73);function n(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;return Math.min(Math.max(t,e),r)}function o(t){return Math.atan2(t.y,t.x)+Math.PI}function c(t){var e=window.getComputedStyle(t).transform,r=new DOMMatrix(e);return Math.atan2(r.b,r.a)}function d(t,e){var r=Math.cos(e)*t.x-Math.sin(e)*t.y,n=Math.sin(e)*t.x+Math.cos(e)*t.y;return new h.c(r,n)}},97:function(t,e,r){"use strict";r.r(e),r.d(e,"default",(function(){return n}));var h=r(73);class n{constructor(t,e){this.min=Object(h.e)(0,0),this.max=Object(h.e)(0,0),this.min=t||this.min,this.max=e||this.max}}}}]);